<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>TourCompanion - Virtual Tour Dashboard</title>
    <meta name="description" content="Professional dashboard for managing virtual tours and client projects. Create, manage, and share immersive virtual experiences." />
    <meta name="author" content="TourCompanion" />
    <meta name="keywords" content="virtual tours, dashboard, project management, client portal, real estate, immersive experiences" />
    <meta name="robots" content="index, follow" />
    <meta name="theme-color" content="#3b82f6" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="TourCompanion" />
    <meta name="application-name" content="TourCompanion" />
    <meta name="msapplication-TileColor" content="#3b82f6" />
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://tourcompanion.com" />
    
    <!-- Icons - Cache busted for immediate updates -->
  <link rel="icon" type="image/png" href="icon-192x192.png?v=5" sizes="192x192" />
  <link rel="icon" type="image/png" href="icon-192x192.png?v=5" />
  <link rel="shortcut icon" href="icon-192x192.png?v=5" />
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png?v=5" />
    <meta name="apple-mobile-web-app-title" content="TourCompanion" />
  <link rel="manifest" href="site.webmanifest?v=5" />
    
    <!-- Additional PWA icon support -->
  <meta name="msapplication-TileImage" content="icon-192x192.png" />
  <meta name="msapplication-config" content="browserconfig.xml" />
    
    <!-- Preload favicon for faster loading -->
  <link rel="preload" href="icon-192x192.png?v=5" as="image" type="image/png" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="TourCompanion - Virtual Tour Dashboard" />
    <meta property="og:description" content="Professional dashboard for managing virtual tours and client projects. Create, manage, and share immersive virtual experiences." />
    <meta property="og:image" content="/icon-512x512.png" />
    <meta property="og:url" content="https://tourcompanion.com" />
    <meta property="og:site_name" content="TourCompanion" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="TourCompanion - Virtual Tour Dashboard" />
    <meta name="twitter:description" content="Professional dashboard for managing virtual tours and client projects. Create, manage, and share immersive virtual experiences." />
    <meta name="twitter:image" content="/icon-512x512.png" />
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  </head>

  <body>
    <div id="root"></div>
    <!-- Inline React scheduler polyfill: runs before bundled modules to avoid unstable_scheduleCallback errors -->
    <script>
      try {
        if (typeof window !== 'undefined') {
          // Minimal scheduler implementation used by React when the real scheduler
          // isn't available at runtime. We attach it to multiple globals to
          // maximize the chance the vendor bundle finds the expected API.
          const scheduler = {
            unstable_scheduleCallback: function(priority, callback) { return setTimeout(callback, 0); },
            unstable_cancelCallback: function(id) { clearTimeout(id); },
            unstable_now: function() { return performance.now(); },
            unstable_getCurrentPriorityLevel: function() { return 0; },
            unstable_shouldYield: function() { return false; },
            unstable_requestPaint: function() {},
            unstable_runWithPriority: function(p, cb) { return cb(); },
            unstable_wrapCallback: function(cb) { return cb; },
            unstable_getFirstCallbackNode: function() { return null; },
            unstable_pauseExecution: function() {},
            unstable_continueExecution: function() {},
            unstable_forceFrameRate: function() {}
          };

          // Attach where vendor code might look for it
          try { window.React = window.React || {}; } catch (e) {}
          try { window.ReactScheduler = window.ReactScheduler || scheduler; } catch (e) {}

          // Prefer attaching directly onto window.React to satisfy bundles that
          // check window.React.unstable_scheduleCallback
          try {
            if (!window.React.unstable_scheduleCallback) {
              window.React.unstable_scheduleCallback = scheduler.unstable_scheduleCallback;
              window.React.unstable_cancelCallback = scheduler.unstable_cancelCallback;
              window.React.unstable_now = scheduler.unstable_now;
              window.React.unstable_getCurrentPriorityLevel = scheduler.unstable_getCurrentPriorityLevel;
              window.React.unstable_shouldYield = scheduler.unstable_shouldYield;
              window.React.unstable_requestPaint = scheduler.unstable_requestPaint;
              window.React.unstable_runWithPriority = scheduler.unstable_runWithPriority;
              window.React.unstable_wrapCallback = scheduler.unstable_wrapCallback;
              window.React.unstable_getFirstCallbackNode = scheduler.unstable_getFirstCallbackNode;
              window.React.unstable_pauseExecution = scheduler.unstable_pauseExecution;
              window.React.unstable_continueExecution = scheduler.unstable_continueExecution;
              window.React.unstable_forceFrameRate = scheduler.unstable_forceFrameRate;
            }
          } catch (e) {
            // Ignore protected globals
          }

          // Ensure devtools hook is present to avoid errors from React internals
          try {
            if (!window.__REACT_DEVTOOLS_GLOBAL_HOOK__) {
              Object.defineProperty(window, '__REACT_DEVTOOLS_GLOBAL_HOOK__', {
                value: { supportsFiber: true, inject: () => {}, onCommitFiberRoot: () => {}, onCommitFiberUnmount: () => {} },
                configurable: true,
                writable: true
              });
            }
          } catch (e) {}

          console.log('Inline ReactScheduler polyfill applied');
        }
      } catch (e) { console.warn('ReactScheduler polyfill failed', e); }
    </script>
    <script type="module">
      // Ensure the scheduler fix module runs before the main app bundle.
      // Import the fix first, then dynamically import the main entry.
      try {
        import('./src/react-scheduler-fix.ts').catch(()=>{}).then(() => {
          import('./src/main.tsx').catch((e) => { console.error('Failed to load main:', e); });
        });
      } catch (e) {
        console.error('Module loader error', e);
      }
    </script>
  </body>
</html>
