var Ww=Object.defineProperty;var Wf=e=>{throw TypeError(e)};var zw=(e,t,r)=>t in e?Ww(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var kl=(e,t,r)=>zw(e,typeof t!="symbol"?t+"":t,r),Rl=(e,t,r)=>t.has(e)||Wf("Cannot "+r);var xe=(e,t,r)=>(Rl(e,t,"read from private field"),r?r.call(e):t.get(e)),Ye=(e,t,r)=>t.has(e)?Wf("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Me=(e,t,r,s)=>(Rl(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),ar=(e,t,r)=>(Rl(e,t,"access private method"),r);var Do=(e,t,r,s)=>({set _(n){Me(e,t,n,r)},get _(){return xe(e,t,s)}});import{r as L,j as a,V as M0,f as U0,g as $0,h as B0,X as yr,i as G0,D as V0,k as Yw,R as Te,l as Kw,m as H0,n as Xw,o as Qw,p as Jw,q as Zw,L as De,N as q0,s as Ki,Q as e_,t as t_,u as r_,v as Ur,w as a_,x as W0,y as s_,z as z0,F as n_,G as Y0,I as K0,H as X0,J as Q0,K as Ns,O as J0,W as i_,Y as Z0,Z as eg,_ as o_,$ as c_,a0 as tg,a1 as au,a2 as rg,a3 as l_,a4 as su,a5 as ag,a6 as sg,a7 as ng,a8 as d_,a9 as ig,aa as u_,ab as og,ac as cg,ad as f_,ae as h_,af as lg,ag as m_,ah as p_,S as ei,ai as js,aj as rs,ak as g_,al as zf,am as Yf,an as md,ao as x_,ap as Sa,aq as Ua,ar as tn,B as da,as as v_,at as Ka,au as y_,av as dg,aw as ug,ax as fg,ay as w_,b as it,az as pd,aA as Xs,aB as __,aC as Kf,aD as Xf,aE as hg,aF as mg,aG as pg,aH as gg,aI as xg,aJ as vg,aK as yg,aL as b_,aM as N_,aN as j_,aO as wg,aP as T_,aQ as _g,aR as lc,aS as E_,aT as Pt,E as Ot,U as gr,aU as oa,C as Yr,aV as Lr,aW as nu,aX as Yc,e as Ba,aY as Mt,aZ as bg,a_ as Ng,a$ as S_,b0 as jg,b1 as Tg,b2 as A_,b3 as C_,b4 as Eg,P as Ts,b5 as Hn,b6 as Qf,b7 as Jt,b8 as qn,c as Pr,b9 as Sg,ba as k_,bb as rc,bc as R_,bd as Kc,be as Fi,bf as Ag,bg as Jf,bh as I_,bi as O_,a as Or,bj as gd,bk as Zf,bl as Xc,bm as Xi,bn as P_,bo as Cg,bp as D_,bq as L_,br as eh,bs as Il,bt as F_,bu as Mi,bv as ac,bw as kg,bx as M_,by as Rg,bz as U_,bA as $_,bB as Ig,bC as B_,bD as G_,bE as Og,bF as V_,bG as th,bH as H_,bI as q_,bJ as rh}from"./react-vendor-Co8v5os9.js";import{c as Pg,t as W_,f as Dg,a as rn}from"./utils-BkWO3WEY.js";import{T as ah,D as z_}from"./dashboard-components-B0_FMTxR.js";import{R as Ol,a as Y_,b as sh,X as nh,Y as ih,T as Pl,c as oh,L as ch,d as K_,B as X_,P as Q_,e as J_,f as Z_}from"./charts-CWlq-tT4.js";import{c as eb}from"./supabase-7VZN9XpM.js";import"./ui-components-BA32w1ww.js";import"./index-BRJKGoUE.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();const tb="modulepreload",rb=function(e){return"/"+e},lh={},ma=function(t,r,s){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(r.map(l=>{if(l=rb(l),l in lh)return;lh[l]=!0;const d=l.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":tb,d||(f.as="script"),f.crossOrigin="",f.href=l,c&&f.setAttribute("nonce",c),document.head.appendChild(f),d)return new Promise((h,m)=>{f.addEventListener("load",h),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return n.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})};var ab=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function nt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function sb(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var n=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return e[s]}})}),r}var Lg={exports:{}},Fg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,F){var te=J.length;J.push(F);e:for(;0<te;){var fe=te-1>>>1,R=J[fe];if(0<n(R,F))J[fe]=F,J[te]=R,te=fe;else break e}}function r(J){return J.length===0?null:J[0]}function s(J){if(J.length===0)return null;var F=J[0],te=J.pop();if(te!==F){J[0]=te;e:for(var fe=0,R=J.length,G=R>>>1;fe<G;){var P=2*(fe+1)-1,C=J[P],K=P+1,D=J[K];if(0>n(C,te))K<R&&0>n(D,C)?(J[fe]=D,J[K]=te,fe=K):(J[fe]=C,J[P]=te,fe=P);else if(K<R&&0>n(D,te))J[fe]=D,J[K]=te,fe=K;else break e}}return F}function n(J,F){var te=J.sortIndex-F.sortIndex;return te!==0?te:J.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var l=[],d=[],u=1,f=null,h=3,m=!1,g=!1,p=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(J){for(var F=r(d);F!==null;){if(F.callback===null)s(d);else if(F.startTime<=J)s(d),F.sortIndex=F.expirationTime,t(l,F);else break;F=r(d)}}function j(J){if(p=!1,v(J),!g)if(r(l)!==null)g=!0,se(S);else{var F=r(d);F!==null&&W(j,F.startTime-J)}}function S(J,F){g=!1,p&&(p=!1,y(N),N=-1),m=!0;var te=h;try{for(v(F),f=r(l);f!==null&&(!(f.expirationTime>F)||J&&!A());){var fe=f.callback;if(typeof fe=="function"){f.callback=null,h=f.priorityLevel;var R=fe(f.expirationTime<=F);F=e.unstable_now(),typeof R=="function"?f.callback=R:f===r(l)&&s(l),v(F)}else s(l);f=r(l)}if(f!==null)var G=!0;else{var P=r(d);P!==null&&W(j,P.startTime-F),G=!1}return G}finally{f=null,h=te,m=!1}}var _=!1,T=null,N=-1,b=5,O=-1;function A(){return!(e.unstable_now()-O<b)}function E(){if(T!==null){var J=e.unstable_now();O=J;var F=!0;try{F=T(!0,J)}finally{F?U():(_=!1,T=null)}}else _=!1}var U;if(typeof w=="function")U=function(){w(E)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ee=Y.port2;Y.port1.onmessage=E,U=function(){ee.postMessage(null)}}else U=function(){x(E,0)};function se(J){T=J,_||(_=!0,U())}function W(J,F){N=x(function(){J(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,se(S))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(J){switch(h){case 1:case 2:case 3:var F=3;break;default:F=h}var te=h;h=F;try{return J()}finally{h=te}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,F){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var te=h;h=J;try{return F()}finally{h=te}},e.unstable_scheduleCallback=function(J,F,te){var fe=e.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?fe+te:fe):te=fe,J){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=te+R,J={id:u++,callback:F,priorityLevel:J,startTime:te,expirationTime:R,sortIndex:-1},te>fe?(J.sortIndex=te,t(d,J),r(l)===null&&J===r(d)&&(p?(y(N),N=-1):p=!0,W(j,te-fe))):(J.sortIndex=R,t(l,J),g||m||(g=!0,se(S))),J},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(J){var F=h;return function(){var te=h;h=F;try{return J.apply(this,arguments)}finally{h=te}}}})(Fg);Lg.exports=Fg;var lq=Lg.exports;const nb=1,ib=1e6;let Dl=0;function ob(){return Dl=(Dl+1)%Number.MAX_SAFE_INTEGER,Dl.toString()}const Ll=new Map,dh=e=>{if(Ll.has(e))return;const t=setTimeout(()=>{Ll.delete(e),Ui({type:"REMOVE_TOAST",toastId:e})},ib);Ll.set(e,t)},cb=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,nb)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?dh(r):e.toasts.forEach(s=>{dh(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===r||r===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},sc=[];let nc={toasts:[]};function Ui(e){nc=cb(nc,e),sc.forEach(t=>{t(nc)})}function lb({...e}){const t=ob(),r=n=>Ui({type:"UPDATE_TOAST",toast:{...n,id:t}}),s=()=>Ui({type:"DISMISS_TOAST",toastId:t});return Ui({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:n=>{n||s()}}}),{id:t,dismiss:s,update:r}}function vt(){const[e,t]=L.useState(nc);return L.useEffect(()=>(sc.push(t),()=>{const r=sc.indexOf(t);r>-1&&sc.splice(r,1)}),[e]),{...e,toast:lb,dismiss:r=>Ui({type:"DISMISS_TOAST",toastId:r})}}const uh=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,fh=Pg,wo=(e,t)=>r=>{var s;if((t==null?void 0:t.variants)==null)return fh(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:n,defaultVariants:i}=t,o=Object.keys(n).map(d=>{const u=r==null?void 0:r[d],f=i==null?void 0:i[d];if(u===null)return null;const h=uh(u)||uh(f);return n[d][h]}),c=r&&Object.entries(r).reduce((d,u)=>{let[f,h]=u;return h===void 0||(d[f]=h),d},{}),l=t==null||(s=t.compoundVariants)===null||s===void 0?void 0:s.reduce((d,u)=>{let{class:f,className:h,...m}=u;return Object.entries(m).every(g=>{let[p,x]=g;return Array.isArray(x)?x.includes({...i,...c}[p]):{...i,...c}[p]===x})?[...d,f,h]:d},[]);return fh(e,o,l,r==null?void 0:r.class,r==null?void 0:r.className)};function Ie(...e){return W_(Pg(e))}const db=Yw,Mg=L.forwardRef(({className:e,...t},r)=>a.jsx(M0,{ref:r,className:Ie("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Mg.displayName=M0.displayName;const ub=wo("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ug=L.forwardRef(({className:e,variant:t,...r},s)=>a.jsx(U0,{ref:s,className:Ie(ub({variant:t}),e),...r}));Ug.displayName=U0.displayName;const fb=L.forwardRef(({className:e,...t},r)=>a.jsx($0,{ref:r,className:Ie("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));fb.displayName=$0.displayName;const $g=L.forwardRef(({className:e,...t},r)=>a.jsx(B0,{ref:r,className:Ie("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:a.jsx(yr,{className:"h-4 w-4"})}));$g.displayName=B0.displayName;const Bg=L.forwardRef(({className:e,...t},r)=>a.jsx(G0,{ref:r,className:Ie("text-sm font-semibold",e),...t}));Bg.displayName=G0.displayName;const Gg=L.forwardRef(({className:e,...t},r)=>a.jsx(V0,{ref:r,className:Ie("text-sm opacity-90",e),...t}));Gg.displayName=V0.displayName;function hb(){const{toasts:e}=vt();return a.jsxs(db,{children:[e.map(function({id:t,title:r,description:s,action:n,...i}){return a.jsxs(Ug,{...i,children:[a.jsxs("div",{className:"grid gap-1",children:[r&&a.jsx(Bg,{children:r}),s&&a.jsx(Gg,{children:s})]}),n,a.jsx($g,{})]},t)}),a.jsx(Mg,{})]})}var hh=["light","dark"],mb="(prefers-color-scheme: dark)",pb=L.createContext(void 0),gb={setTheme:e=>{},themes:[]},xb=()=>{var e;return(e=L.useContext(pb))!=null?e:gb};L.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:s,enableColorScheme:n,defaultTheme:i,value:o,attrs:c,nonce:l})=>{let d=i==="system",u=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,f=n?hh.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(g,p=!1,x=!0)=>{let y=o?o[g]:g,w=p?g+"|| ''":`'${y}'`,v="";return n&&x&&!p&&hh.includes(g)&&(v+=`d.style.colorScheme = '${g}';`),r==="class"?p||y?v+=`c.add(${w})`:v+="null":y&&(v+=`d[s](n,${w})`),v},m=e?`!function(){${u}${h(e)}}()`:s?`!function(){try{${u}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${d})){var t='${mb}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}${d?"":"else{"+h(i,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}else{${h(i,!1,!1)};}${f}}catch(t){}}();`;return L.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:m}})});var vb=e=>{switch(e){case"success":return _b;case"info":return Nb;case"warning":return bb;case"error":return jb;default:return null}},yb=Array(12).fill(0),wb=({visible:e,className:t})=>Te.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Te.createElement("div",{className:"sonner-spinner"},yb.map((r,s)=>Te.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),_b=Te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Te.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),bb=Te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Te.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Nb=Te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),jb=Te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Te.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Tb=Te.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Te.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Te.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Eb=()=>{let[e,t]=Te.useState(document.hidden);return Te.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},xd=1,Sb=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...s}=e,n=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:xd++,i=this.toasts.find(c=>c.id===n),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(n)&&this.dismissedToasts.delete(n),i?this.toasts=this.toasts.map(c=>c.id===n?(this.publish({...c,...e,id:n,title:r}),{...c,...e,id:n,dismissible:o,title:r}):c):this.addToast({title:r,...s,dismissible:o,id:n}),n},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let s=e instanceof Promise?e:e(),n=r!==void 0,i,o=s.then(async l=>{if(i=["resolve",l],Te.isValidElement(l))n=!1,this.create({id:r,type:"default",message:l});else if(Cb(l)&&!l.ok){n=!1;let d=typeof t.error=="function"?await t.error(`HTTP error! status: ${l.status}`):t.error,u=typeof t.description=="function"?await t.description(`HTTP error! status: ${l.status}`):t.description;this.create({id:r,type:"error",message:d,description:u})}else if(t.success!==void 0){n=!1;let d=typeof t.success=="function"?await t.success(l):t.success,u=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"success",message:d,description:u})}}).catch(async l=>{if(i=["reject",l],t.error!==void 0){n=!1;let d=typeof t.error=="function"?await t.error(l):t.error,u=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"error",message:d,description:u})}}).finally(()=>{var l;n&&(this.dismiss(r),r=void 0),(l=t.finally)==null||l.call(t)}),c=()=>new Promise((l,d)=>o.then(()=>i[0]==="reject"?d(i[1]):l(i[1])).catch(d));return typeof r!="string"&&typeof r!="number"?{unwrap:c}:Object.assign(r,{unwrap:c})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||xd++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},br=new Sb,Ab=(e,t)=>{let r=(t==null?void 0:t.id)||xd++;return br.addToast({title:e,...t,id:r}),r},Cb=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",kb=Ab,Rb=()=>br.toasts,Ib=()=>br.getActiveToasts();Object.assign(kb,{success:br.success,info:br.info,warning:br.warning,error:br.error,custom:br.custom,message:br.message,promise:br.promise,dismiss:br.dismiss,loading:br.loading},{getHistory:Rb,getToasts:Ib});function Ob(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t==="top"&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}Ob(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Lo(e){return e.label!==void 0}var Pb=3,Db="32px",Lb="16px",mh=4e3,Fb=356,Mb=14,Ub=20,$b=200;function Zr(...e){return e.filter(Boolean).join(" ")}function Bb(e){let[t,r]=e.split("-"),s=[];return t&&s.push(t),r&&s.push(r),s}var Gb=e=>{var t,r,s,n,i,o,c,l,d,u,f;let{invert:h,toast:m,unstyled:g,interacting:p,setHeights:x,visibleToasts:y,heights:w,index:v,toasts:j,expanded:S,removeToast:_,defaultRichColors:T,closeButton:N,style:b,cancelButtonStyle:O,actionButtonStyle:A,className:E="",descriptionClassName:U="",duration:Y,position:ee,gap:se,loadingIcon:W,expandByDefault:J,classNames:F,icons:te,closeButtonAriaLabel:fe="Close toast",pauseWhenPageIsHidden:R}=e,[G,P]=Te.useState(null),[C,K]=Te.useState(null),[D,Q]=Te.useState(!1),[z,X]=Te.useState(!1),[ne,k]=Te.useState(!1),[Ce,_e]=Te.useState(!1),[me,pe]=Te.useState(!1),[ue,je]=Te.useState(0),[$e,ot]=Te.useState(0),tt=Te.useRef(m.duration||Y||mh),jt=Te.useRef(null),yt=Te.useRef(null),Xe=v===0,ut=v+1<=y,qe=m.type,Oe=m.dismissible!==!1,ze=m.className||"",tr=m.descriptionClassName||"",Fe=Te.useMemo(()=>w.findIndex(Be=>Be.toastId===m.id)||0,[w,m.id]),rt=Te.useMemo(()=>{var Be;return(Be=m.closeButton)!=null?Be:N},[m.closeButton,N]),ft=Te.useMemo(()=>m.duration||Y||mh,[m.duration,Y]),st=Te.useRef(0),Xt=Te.useRef(0),xi=Te.useRef(0),os=Te.useRef(null),[El,Po]=ee.split("-"),vi=Te.useMemo(()=>w.reduce((Be,at,ht)=>ht>=Fe?Be:Be+at.height,0),[w,Fe]),yi=Eb(),Sl=m.invert||h,wi=qe==="loading";Xt.current=Te.useMemo(()=>Fe*se+vi,[Fe,vi]),Te.useEffect(()=>{tt.current=ft},[ft]),Te.useEffect(()=>{Q(!0)},[]),Te.useEffect(()=>{let Be=yt.current;if(Be){let at=Be.getBoundingClientRect().height;return ot(at),x(ht=>[{toastId:m.id,height:at,position:m.position},...ht]),()=>x(ht=>ht.filter(Sr=>Sr.toastId!==m.id))}},[x,m.id]),Te.useLayoutEffect(()=>{if(!D)return;let Be=yt.current,at=Be.style.height;Be.style.height="auto";let ht=Be.getBoundingClientRect().height;Be.style.height=at,ot(ht),x(Sr=>Sr.find(Ar=>Ar.toastId===m.id)?Sr.map(Ar=>Ar.toastId===m.id?{...Ar,height:ht}:Ar):[{toastId:m.id,height:ht,position:m.position},...Sr])},[D,m.title,m.description,x,m.id]);let Er=Te.useCallback(()=>{X(!0),je(Xt.current),x(Be=>Be.filter(at=>at.toastId!==m.id)),setTimeout(()=>{_(m)},$b)},[m,_,x,Xt]);Te.useEffect(()=>{if(m.promise&&qe==="loading"||m.duration===1/0||m.type==="loading")return;let Be;return S||p||R&&yi?(()=>{if(xi.current<st.current){let at=new Date().getTime()-st.current;tt.current=tt.current-at}xi.current=new Date().getTime()})():tt.current!==1/0&&(st.current=new Date().getTime(),Be=setTimeout(()=>{var at;(at=m.onAutoClose)==null||at.call(m,m),Er()},tt.current)),()=>clearTimeout(Be)},[S,p,m,qe,R,yi,Er]),Te.useEffect(()=>{m.delete&&Er()},[Er,m.delete]);function Al(){var Be,at,ht;return te!=null&&te.loading?Te.createElement("div",{className:Zr(F==null?void 0:F.loader,(Be=m==null?void 0:m.classNames)==null?void 0:Be.loader,"sonner-loader"),"data-visible":qe==="loading"},te.loading):W?Te.createElement("div",{className:Zr(F==null?void 0:F.loader,(at=m==null?void 0:m.classNames)==null?void 0:at.loader,"sonner-loader"),"data-visible":qe==="loading"},W):Te.createElement(wb,{className:Zr(F==null?void 0:F.loader,(ht=m==null?void 0:m.classNames)==null?void 0:ht.loader),visible:qe==="loading"})}return Te.createElement("li",{tabIndex:0,ref:yt,className:Zr(E,ze,F==null?void 0:F.toast,(t=m==null?void 0:m.classNames)==null?void 0:t.toast,F==null?void 0:F.default,F==null?void 0:F[qe],(r=m==null?void 0:m.classNames)==null?void 0:r[qe]),"data-sonner-toast":"","data-rich-colors":(s=m.richColors)!=null?s:T,"data-styled":!(m.jsx||m.unstyled||g),"data-mounted":D,"data-promise":!!m.promise,"data-swiped":me,"data-removed":z,"data-visible":ut,"data-y-position":El,"data-x-position":Po,"data-index":v,"data-front":Xe,"data-swiping":ne,"data-dismissible":Oe,"data-type":qe,"data-invert":Sl,"data-swipe-out":Ce,"data-swipe-direction":C,"data-expanded":!!(S||J&&D),style:{"--index":v,"--toasts-before":v,"--z-index":j.length-v,"--offset":`${z?ue:Xt.current}px`,"--initial-height":J?"auto":`${$e}px`,...b,...m.style},onDragEnd:()=>{k(!1),P(null),os.current=null},onPointerDown:Be=>{wi||!Oe||(jt.current=new Date,je(Xt.current),Be.target.setPointerCapture(Be.pointerId),Be.target.tagName!=="BUTTON"&&(k(!0),os.current={x:Be.clientX,y:Be.clientY}))},onPointerUp:()=>{var Be,at,ht,Sr;if(Ce||!Oe)return;os.current=null;let Ar=Number(((Be=yt.current)==null?void 0:Be.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ga=Number(((at=yt.current)==null?void 0:at.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),La=new Date().getTime()-((ht=jt.current)==null?void 0:ht.getTime()),ur=G==="x"?Ar:ga,xa=Math.abs(ur)/La;if(Math.abs(ur)>=Ub||xa>.11){je(Xt.current),(Sr=m.onDismiss)==null||Sr.call(m,m),K(G==="x"?Ar>0?"right":"left":ga>0?"down":"up"),Er(),_e(!0),pe(!1);return}k(!1),P(null)},onPointerMove:Be=>{var at,ht,Sr,Ar;if(!os.current||!Oe||((at=window.getSelection())==null?void 0:at.toString().length)>0)return;let ga=Be.clientY-os.current.y,La=Be.clientX-os.current.x,ur=(ht=e.swipeDirections)!=null?ht:Bb(ee);!G&&(Math.abs(La)>1||Math.abs(ga)>1)&&P(Math.abs(La)>Math.abs(ga)?"x":"y");let xa={x:0,y:0};G==="y"?(ur.includes("top")||ur.includes("bottom"))&&(ur.includes("top")&&ga<0||ur.includes("bottom")&&ga>0)&&(xa.y=ga):G==="x"&&(ur.includes("left")||ur.includes("right"))&&(ur.includes("left")&&La<0||ur.includes("right")&&La>0)&&(xa.x=La),(Math.abs(xa.x)>0||Math.abs(xa.y)>0)&&pe(!0),(Sr=yt.current)==null||Sr.style.setProperty("--swipe-amount-x",`${xa.x}px`),(Ar=yt.current)==null||Ar.style.setProperty("--swipe-amount-y",`${xa.y}px`)}},rt&&!m.jsx?Te.createElement("button",{"aria-label":fe,"data-disabled":wi,"data-close-button":!0,onClick:wi||!Oe?()=>{}:()=>{var Be;Er(),(Be=m.onDismiss)==null||Be.call(m,m)},className:Zr(F==null?void 0:F.closeButton,(n=m==null?void 0:m.classNames)==null?void 0:n.closeButton)},(i=te==null?void 0:te.close)!=null?i:Tb):null,m.jsx||L.isValidElement(m.title)?m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title:Te.createElement(Te.Fragment,null,qe||m.icon||m.promise?Te.createElement("div",{"data-icon":"",className:Zr(F==null?void 0:F.icon,(o=m==null?void 0:m.classNames)==null?void 0:o.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||Al():null,m.type!=="loading"?m.icon||(te==null?void 0:te[qe])||vb(qe):null):null,Te.createElement("div",{"data-content":"",className:Zr(F==null?void 0:F.content,(c=m==null?void 0:m.classNames)==null?void 0:c.content)},Te.createElement("div",{"data-title":"",className:Zr(F==null?void 0:F.title,(l=m==null?void 0:m.classNames)==null?void 0:l.title)},typeof m.title=="function"?m.title():m.title),m.description?Te.createElement("div",{"data-description":"",className:Zr(U,tr,F==null?void 0:F.description,(d=m==null?void 0:m.classNames)==null?void 0:d.description)},typeof m.description=="function"?m.description():m.description):null),L.isValidElement(m.cancel)?m.cancel:m.cancel&&Lo(m.cancel)?Te.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||O,onClick:Be=>{var at,ht;Lo(m.cancel)&&Oe&&((ht=(at=m.cancel).onClick)==null||ht.call(at,Be),Er())},className:Zr(F==null?void 0:F.cancelButton,(u=m==null?void 0:m.classNames)==null?void 0:u.cancelButton)},m.cancel.label):null,L.isValidElement(m.action)?m.action:m.action&&Lo(m.action)?Te.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||A,onClick:Be=>{var at,ht;Lo(m.action)&&((ht=(at=m.action).onClick)==null||ht.call(at,Be),!Be.defaultPrevented&&Er())},className:Zr(F==null?void 0:F.actionButton,(f=m==null?void 0:m.classNames)==null?void 0:f.actionButton)},m.action.label):null))};function ph(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Vb(e,t){let r={};return[e,t].forEach((s,n)=>{let i=n===1,o=i?"--mobile-offset":"--offset",c=i?Lb:Db;function l(d){["top","right","bottom","left"].forEach(u=>{r[`${o}-${u}`]=typeof d=="number"?`${d}px`:d})}typeof s=="number"||typeof s=="string"?l(s):typeof s=="object"?["top","right","bottom","left"].forEach(d=>{s[d]===void 0?r[`${o}-${d}`]=c:r[`${o}-${d}`]=typeof s[d]=="number"?`${s[d]}px`:s[d]}):l(c)}),r}var Hb=L.forwardRef(function(e,t){let{invert:r,position:s="bottom-right",hotkey:n=["altKey","KeyT"],expand:i,closeButton:o,className:c,offset:l,mobileOffset:d,theme:u="light",richColors:f,duration:h,style:m,visibleToasts:g=Pb,toastOptions:p,dir:x=ph(),gap:y=Mb,loadingIcon:w,icons:v,containerAriaLabel:j="Notifications",pauseWhenPageIsHidden:S}=e,[_,T]=Te.useState([]),N=Te.useMemo(()=>Array.from(new Set([s].concat(_.filter(R=>R.position).map(R=>R.position)))),[_,s]),[b,O]=Te.useState([]),[A,E]=Te.useState(!1),[U,Y]=Te.useState(!1),[ee,se]=Te.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),W=Te.useRef(null),J=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),F=Te.useRef(null),te=Te.useRef(!1),fe=Te.useCallback(R=>{T(G=>{var P;return(P=G.find(C=>C.id===R.id))!=null&&P.delete||br.dismiss(R.id),G.filter(({id:C})=>C!==R.id)})},[]);return Te.useEffect(()=>br.subscribe(R=>{if(R.dismiss){T(G=>G.map(P=>P.id===R.id?{...P,delete:!0}:P));return}setTimeout(()=>{Kw.flushSync(()=>{T(G=>{let P=G.findIndex(C=>C.id===R.id);return P!==-1?[...G.slice(0,P),{...G[P],...R},...G.slice(P+1)]:[R,...G]})})})}),[]),Te.useEffect(()=>{if(u!=="system"){se(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?se("dark"):se("light")),typeof window>"u")return;let R=window.matchMedia("(prefers-color-scheme: dark)");try{R.addEventListener("change",({matches:G})=>{se(G?"dark":"light")})}catch{R.addListener(({matches:P})=>{try{se(P?"dark":"light")}catch(C){console.error(C)}})}},[u]),Te.useEffect(()=>{_.length<=1&&E(!1)},[_]),Te.useEffect(()=>{let R=G=>{var P,C;n.every(K=>G[K]||G.code===K)&&(E(!0),(P=W.current)==null||P.focus()),G.code==="Escape"&&(document.activeElement===W.current||(C=W.current)!=null&&C.contains(document.activeElement))&&E(!1)};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[n]),Te.useEffect(()=>{if(W.current)return()=>{F.current&&(F.current.focus({preventScroll:!0}),F.current=null,te.current=!1)}},[W.current]),Te.createElement("section",{ref:t,"aria-label":`${j} ${J}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},N.map((R,G)=>{var P;let[C,K]=R.split("-");return _.length?Te.createElement("ol",{key:R,dir:x==="auto"?ph():x,tabIndex:-1,ref:W,className:c,"data-sonner-toaster":!0,"data-theme":ee,"data-y-position":C,"data-lifted":A&&_.length>1&&!i,"data-x-position":K,style:{"--front-toast-height":`${((P=b[0])==null?void 0:P.height)||0}px`,"--width":`${Fb}px`,"--gap":`${y}px`,...m,...Vb(l,d)},onBlur:D=>{te.current&&!D.currentTarget.contains(D.relatedTarget)&&(te.current=!1,F.current&&(F.current.focus({preventScroll:!0}),F.current=null))},onFocus:D=>{D.target instanceof HTMLElement&&D.target.dataset.dismissible==="false"||te.current||(te.current=!0,F.current=D.relatedTarget)},onMouseEnter:()=>E(!0),onMouseMove:()=>E(!0),onMouseLeave:()=>{U||E(!1)},onDragEnd:()=>E(!1),onPointerDown:D=>{D.target instanceof HTMLElement&&D.target.dataset.dismissible==="false"||Y(!0)},onPointerUp:()=>Y(!1)},_.filter(D=>!D.position&&G===0||D.position===R).map((D,Q)=>{var z,X;return Te.createElement(Gb,{key:D.id,icons:v,index:Q,toast:D,defaultRichColors:f,duration:(z=p==null?void 0:p.duration)!=null?z:h,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:r,visibleToasts:g,closeButton:(X=p==null?void 0:p.closeButton)!=null?X:o,interacting:U,position:R,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:fe,toasts:_.filter(ne=>ne.position==D.position),heights:b.filter(ne=>ne.position==D.position),setHeights:O,expandByDefault:i,gap:y,loadingIcon:w,expanded:A,pauseWhenPageIsHidden:S,swipeDirections:e.swipeDirections})})):null}))});const qb=({...e})=>{const{theme:t="system"}=xb();return a.jsx(Hb,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})},Wb=["top","right","bottom","left"],Es=Math.min,Cr=Math.max,dc=Math.round,Fo=Math.floor,Ta=e=>({x:e,y:e}),zb={left:"right",right:"left",bottom:"top",top:"bottom"},Yb={start:"end",end:"start"};function vd(e,t,r){return Cr(e,Es(t,r))}function Xa(e,t){return typeof e=="function"?e(t):e}function Qa(e){return e.split("-")[0]}function ti(e){return e.split("-")[1]}function iu(e){return e==="x"?"y":"x"}function ou(e){return e==="y"?"height":"width"}const Kb=new Set(["top","bottom"]);function Na(e){return Kb.has(Qa(e))?"y":"x"}function cu(e){return iu(Na(e))}function Xb(e,t,r){r===void 0&&(r=!1);const s=ti(e),n=cu(e),i=ou(n);let o=n==="x"?s===(r?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=uc(o)),[o,uc(o)]}function Qb(e){const t=uc(e);return[yd(e),t,yd(t)]}function yd(e){return e.replace(/start|end/g,t=>Yb[t])}const gh=["left","right"],xh=["right","left"],Jb=["top","bottom"],Zb=["bottom","top"];function e2(e,t,r){switch(e){case"top":case"bottom":return r?t?xh:gh:t?gh:xh;case"left":case"right":return t?Jb:Zb;default:return[]}}function t2(e,t,r,s){const n=ti(e);let i=e2(Qa(e),r==="start",s);return n&&(i=i.map(o=>o+"-"+n),t&&(i=i.concat(i.map(yd)))),i}function uc(e){return e.replace(/left|right|bottom|top/g,t=>zb[t])}function r2(e){return{top:0,right:0,bottom:0,left:0,...e}}function Vg(e){return typeof e!="number"?r2(e):{top:e,right:e,bottom:e,left:e}}function fc(e){const{x:t,y:r,width:s,height:n}=e;return{width:s,height:n,top:r,left:t,right:t+s,bottom:r+n,x:t,y:r}}function vh(e,t,r){let{reference:s,floating:n}=e;const i=Na(t),o=cu(t),c=ou(o),l=Qa(t),d=i==="y",u=s.x+s.width/2-n.width/2,f=s.y+s.height/2-n.height/2,h=s[c]/2-n[c]/2;let m;switch(l){case"top":m={x:u,y:s.y-n.height};break;case"bottom":m={x:u,y:s.y+s.height};break;case"right":m={x:s.x+s.width,y:f};break;case"left":m={x:s.x-n.width,y:f};break;default:m={x:s.x,y:s.y}}switch(ti(t)){case"start":m[o]-=h*(r&&d?-1:1);break;case"end":m[o]+=h*(r&&d?-1:1);break}return m}const a2=async(e,t,r)=>{const{placement:s="bottom",strategy:n="absolute",middleware:i=[],platform:o}=r,c=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(t));let d=await o.getElementRects({reference:e,floating:t,strategy:n}),{x:u,y:f}=vh(d,s,l),h=s,m={},g=0;for(let p=0;p<c.length;p++){const{name:x,fn:y}=c[p],{x:w,y:v,data:j,reset:S}=await y({x:u,y:f,initialPlacement:s,placement:h,strategy:n,middlewareData:m,rects:d,platform:o,elements:{reference:e,floating:t}});u=w??u,f=v??f,m={...m,[x]:{...m[x],...j}},S&&g<=50&&(g++,typeof S=="object"&&(S.placement&&(h=S.placement),S.rects&&(d=S.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:n}):S.rects),{x:u,y:f}=vh(d,h,l)),p=-1)}return{x:u,y:f,placement:h,strategy:n,middlewareData:m}};async function Qi(e,t){var r;t===void 0&&(t={});const{x:s,y:n,platform:i,rects:o,elements:c,strategy:l}=e,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:h=!1,padding:m=0}=Xa(t,e),g=Vg(m),x=c[h?f==="floating"?"reference":"floating":f],y=fc(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(x)))==null||r?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(c.floating)),boundary:d,rootBoundary:u,strategy:l})),w=f==="floating"?{x:s,y:n,width:o.floating.width,height:o.floating.height}:o.reference,v=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c.floating)),j=await(i.isElement==null?void 0:i.isElement(v))?await(i.getScale==null?void 0:i.getScale(v))||{x:1,y:1}:{x:1,y:1},S=fc(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:w,offsetParent:v,strategy:l}):w);return{top:(y.top-S.top+g.top)/j.y,bottom:(S.bottom-y.bottom+g.bottom)/j.y,left:(y.left-S.left+g.left)/j.x,right:(S.right-y.right+g.right)/j.x}}const s2=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:s,placement:n,rects:i,platform:o,elements:c,middlewareData:l}=t,{element:d,padding:u=0}=Xa(e,t)||{};if(d==null)return{};const f=Vg(u),h={x:r,y:s},m=cu(n),g=ou(m),p=await o.getDimensions(d),x=m==="y",y=x?"top":"left",w=x?"bottom":"right",v=x?"clientHeight":"clientWidth",j=i.reference[g]+i.reference[m]-h[m]-i.floating[g],S=h[m]-i.reference[m],_=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let T=_?_[v]:0;(!T||!await(o.isElement==null?void 0:o.isElement(_)))&&(T=c.floating[v]||i.floating[g]);const N=j/2-S/2,b=T/2-p[g]/2-1,O=Es(f[y],b),A=Es(f[w],b),E=O,U=T-p[g]-A,Y=T/2-p[g]/2+N,ee=vd(E,Y,U),se=!l.arrow&&ti(n)!=null&&Y!==ee&&i.reference[g]/2-(Y<E?O:A)-p[g]/2<0,W=se?Y<E?Y-E:Y-U:0;return{[m]:h[m]+W,data:{[m]:ee,centerOffset:Y-ee-W,...se&&{alignmentOffset:W}},reset:se}}}),n2=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,s;const{placement:n,middlewareData:i,rects:o,initialPlacement:c,platform:l,elements:d}=t,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:p=!0,...x}=Xa(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const y=Qa(n),w=Na(c),v=Qa(c)===c,j=await(l.isRTL==null?void 0:l.isRTL(d.floating)),S=h||(v||!p?[uc(c)]:Qb(c)),_=g!=="none";!h&&_&&S.push(...t2(c,p,g,j));const T=[c,...S],N=await Qi(t,x),b=[];let O=((s=i.flip)==null?void 0:s.overflows)||[];if(u&&b.push(N[y]),f){const Y=Xb(n,o,j);b.push(N[Y[0]],N[Y[1]])}if(O=[...O,{placement:n,overflows:b}],!b.every(Y=>Y<=0)){var A,E;const Y=(((A=i.flip)==null?void 0:A.index)||0)+1,ee=T[Y];if(ee&&(!(f==="alignment"?w!==Na(ee):!1)||O.every(J=>J.overflows[0]>0&&Na(J.placement)===w)))return{data:{index:Y,overflows:O},reset:{placement:ee}};let se=(E=O.filter(W=>W.overflows[0]<=0).sort((W,J)=>W.overflows[1]-J.overflows[1])[0])==null?void 0:E.placement;if(!se)switch(m){case"bestFit":{var U;const W=(U=O.filter(J=>{if(_){const F=Na(J.placement);return F===w||F==="y"}return!0}).map(J=>[J.placement,J.overflows.filter(F=>F>0).reduce((F,te)=>F+te,0)]).sort((J,F)=>J[1]-F[1])[0])==null?void 0:U[0];W&&(se=W);break}case"initialPlacement":se=c;break}if(n!==se)return{reset:{placement:se}}}return{}}}};function yh(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function wh(e){return Wb.some(t=>e[t]>=0)}const i2=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:s="referenceHidden",...n}=Xa(e,t);switch(s){case"referenceHidden":{const i=await Qi(t,{...n,elementContext:"reference"}),o=yh(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:wh(o)}}}case"escaped":{const i=await Qi(t,{...n,altBoundary:!0}),o=yh(i,r.floating);return{data:{escapedOffsets:o,escaped:wh(o)}}}default:return{}}}}},Hg=new Set(["left","top"]);async function o2(e,t){const{placement:r,platform:s,elements:n}=e,i=await(s.isRTL==null?void 0:s.isRTL(n.floating)),o=Qa(r),c=ti(r),l=Na(r)==="y",d=Hg.has(o)?-1:1,u=i&&l?-1:1,f=Xa(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:g}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return c&&typeof g=="number"&&(m=c==="end"?g*-1:g),l?{x:m*u,y:h*d}:{x:h*d,y:m*u}}const c2=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,s;const{x:n,y:i,placement:o,middlewareData:c}=t,l=await o2(t,e);return o===((r=c.offset)==null?void 0:r.placement)&&(s=c.arrow)!=null&&s.alignmentOffset?{}:{x:n+l.x,y:i+l.y,data:{...l,placement:o}}}}},l2=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:s,placement:n}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:c={fn:x=>{let{x:y,y:w}=x;return{x:y,y:w}}},...l}=Xa(e,t),d={x:r,y:s},u=await Qi(t,l),f=Na(Qa(n)),h=iu(f);let m=d[h],g=d[f];if(i){const x=h==="y"?"top":"left",y=h==="y"?"bottom":"right",w=m+u[x],v=m-u[y];m=vd(w,m,v)}if(o){const x=f==="y"?"top":"left",y=f==="y"?"bottom":"right",w=g+u[x],v=g-u[y];g=vd(w,g,v)}const p=c.fn({...t,[h]:m,[f]:g});return{...p,data:{x:p.x-r,y:p.y-s,enabled:{[h]:i,[f]:o}}}}}},d2=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:s,placement:n,rects:i,middlewareData:o}=t,{offset:c=0,mainAxis:l=!0,crossAxis:d=!0}=Xa(e,t),u={x:r,y:s},f=Na(n),h=iu(f);let m=u[h],g=u[f];const p=Xa(c,t),x=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const v=h==="y"?"height":"width",j=i.reference[h]-i.floating[v]+x.mainAxis,S=i.reference[h]+i.reference[v]-x.mainAxis;m<j?m=j:m>S&&(m=S)}if(d){var y,w;const v=h==="y"?"width":"height",j=Hg.has(Qa(n)),S=i.reference[f]-i.floating[v]+(j&&((y=o.offset)==null?void 0:y[f])||0)+(j?0:x.crossAxis),_=i.reference[f]+i.reference[v]+(j?0:((w=o.offset)==null?void 0:w[f])||0)-(j?x.crossAxis:0);g<S?g=S:g>_&&(g=_)}return{[h]:m,[f]:g}}}},u2=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,s;const{placement:n,rects:i,platform:o,elements:c}=t,{apply:l=()=>{},...d}=Xa(e,t),u=await Qi(t,d),f=Qa(n),h=ti(n),m=Na(n)==="y",{width:g,height:p}=i.floating;let x,y;f==="top"||f==="bottom"?(x=f,y=h===(await(o.isRTL==null?void 0:o.isRTL(c.floating))?"start":"end")?"left":"right"):(y=f,x=h==="end"?"top":"bottom");const w=p-u.top-u.bottom,v=g-u.left-u.right,j=Es(p-u[x],w),S=Es(g-u[y],v),_=!t.middlewareData.shift;let T=j,N=S;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(N=v),(s=t.middlewareData.shift)!=null&&s.enabled.y&&(T=w),_&&!h){const O=Cr(u.left,0),A=Cr(u.right,0),E=Cr(u.top,0),U=Cr(u.bottom,0);m?N=g-2*(O!==0||A!==0?O+A:Cr(u.left,u.right)):T=p-2*(E!==0||U!==0?E+U:Cr(u.top,u.bottom))}await l({...t,availableWidth:N,availableHeight:T});const b=await o.getDimensions(c.floating);return g!==b.width||p!==b.height?{reset:{rects:!0}}:{}}}};function Qc(){return typeof window<"u"}function ri(e){return qg(e)?(e.nodeName||"").toLowerCase():"#document"}function Dr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Ra(e){var t;return(t=(qg(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function qg(e){return Qc()?e instanceof Node||e instanceof Dr(e).Node:!1}function fa(e){return Qc()?e instanceof Element||e instanceof Dr(e).Element:!1}function Aa(e){return Qc()?e instanceof HTMLElement||e instanceof Dr(e).HTMLElement:!1}function _h(e){return!Qc()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Dr(e).ShadowRoot}const f2=new Set(["inline","contents"]);function _o(e){const{overflow:t,overflowX:r,overflowY:s,display:n}=ha(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+r)&&!f2.has(n)}const h2=new Set(["table","td","th"]);function m2(e){return h2.has(ri(e))}const p2=[":popover-open",":modal"];function Jc(e){return p2.some(t=>{try{return e.matches(t)}catch{return!1}})}const g2=["transform","translate","scale","rotate","perspective"],x2=["transform","translate","scale","rotate","perspective","filter"],v2=["paint","layout","strict","content"];function lu(e){const t=du(),r=fa(e)?ha(e):e;return g2.some(s=>r[s]?r[s]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||x2.some(s=>(r.willChange||"").includes(s))||v2.some(s=>(r.contain||"").includes(s))}function y2(e){let t=Ss(e);for(;Aa(t)&&!Wn(t);){if(lu(t))return t;if(Jc(t))return null;t=Ss(t)}return null}function du(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const w2=new Set(["html","body","#document"]);function Wn(e){return w2.has(ri(e))}function ha(e){return Dr(e).getComputedStyle(e)}function Zc(e){return fa(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ss(e){if(ri(e)==="html")return e;const t=e.assignedSlot||e.parentNode||_h(e)&&e.host||Ra(e);return _h(t)?t.host:t}function Wg(e){const t=Ss(e);return Wn(t)?e.ownerDocument?e.ownerDocument.body:e.body:Aa(t)&&_o(t)?t:Wg(t)}function Ji(e,t,r){var s;t===void 0&&(t=[]),r===void 0&&(r=!0);const n=Wg(e),i=n===((s=e.ownerDocument)==null?void 0:s.body),o=Dr(n);if(i){const c=wd(o);return t.concat(o,o.visualViewport||[],_o(n)?n:[],c&&r?Ji(c):[])}return t.concat(n,Ji(n,[],r))}function wd(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function zg(e){const t=ha(e);let r=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const n=Aa(e),i=n?e.offsetWidth:r,o=n?e.offsetHeight:s,c=dc(r)!==i||dc(s)!==o;return c&&(r=i,s=o),{width:r,height:s,$:c}}function uu(e){return fa(e)?e:e.contextElement}function kn(e){const t=uu(e);if(!Aa(t))return Ta(1);const r=t.getBoundingClientRect(),{width:s,height:n,$:i}=zg(t);let o=(i?dc(r.width):r.width)/s,c=(i?dc(r.height):r.height)/n;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const _2=Ta(0);function Yg(e){const t=Dr(e);return!du()||!t.visualViewport?_2:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function b2(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Dr(e)?!1:t}function an(e,t,r,s){t===void 0&&(t=!1),r===void 0&&(r=!1);const n=e.getBoundingClientRect(),i=uu(e);let o=Ta(1);t&&(s?fa(s)&&(o=kn(s)):o=kn(e));const c=b2(i,r,s)?Yg(i):Ta(0);let l=(n.left+c.x)/o.x,d=(n.top+c.y)/o.y,u=n.width/o.x,f=n.height/o.y;if(i){const h=Dr(i),m=s&&fa(s)?Dr(s):s;let g=h,p=wd(g);for(;p&&s&&m!==g;){const x=kn(p),y=p.getBoundingClientRect(),w=ha(p),v=y.left+(p.clientLeft+parseFloat(w.paddingLeft))*x.x,j=y.top+(p.clientTop+parseFloat(w.paddingTop))*x.y;l*=x.x,d*=x.y,u*=x.x,f*=x.y,l+=v,d+=j,g=Dr(p),p=wd(g)}}return fc({width:u,height:f,x:l,y:d})}function fu(e,t){const r=Zc(e).scrollLeft;return t?t.left+r:an(Ra(e)).left+r}function Kg(e,t,r){r===void 0&&(r=!1);const s=e.getBoundingClientRect(),n=s.left+t.scrollLeft-(r?0:fu(e,s)),i=s.top+t.scrollTop;return{x:n,y:i}}function N2(e){let{elements:t,rect:r,offsetParent:s,strategy:n}=e;const i=n==="fixed",o=Ra(s),c=t?Jc(t.floating):!1;if(s===o||c&&i)return r;let l={scrollLeft:0,scrollTop:0},d=Ta(1);const u=Ta(0),f=Aa(s);if((f||!f&&!i)&&((ri(s)!=="body"||_o(o))&&(l=Zc(s)),Aa(s))){const m=an(s);d=kn(s),u.x=m.x+s.clientLeft,u.y=m.y+s.clientTop}const h=o&&!f&&!i?Kg(o,l,!0):Ta(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-l.scrollLeft*d.x+u.x+h.x,y:r.y*d.y-l.scrollTop*d.y+u.y+h.y}}function j2(e){return Array.from(e.getClientRects())}function T2(e){const t=Ra(e),r=Zc(e),s=e.ownerDocument.body,n=Cr(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),i=Cr(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let o=-r.scrollLeft+fu(e);const c=-r.scrollTop;return ha(s).direction==="rtl"&&(o+=Cr(t.clientWidth,s.clientWidth)-n),{width:n,height:i,x:o,y:c}}function E2(e,t){const r=Dr(e),s=Ra(e),n=r.visualViewport;let i=s.clientWidth,o=s.clientHeight,c=0,l=0;if(n){i=n.width,o=n.height;const d=du();(!d||d&&t==="fixed")&&(c=n.offsetLeft,l=n.offsetTop)}return{width:i,height:o,x:c,y:l}}const S2=new Set(["absolute","fixed"]);function A2(e,t){const r=an(e,!0,t==="fixed"),s=r.top+e.clientTop,n=r.left+e.clientLeft,i=Aa(e)?kn(e):Ta(1),o=e.clientWidth*i.x,c=e.clientHeight*i.y,l=n*i.x,d=s*i.y;return{width:o,height:c,x:l,y:d}}function bh(e,t,r){let s;if(t==="viewport")s=E2(e,r);else if(t==="document")s=T2(Ra(e));else if(fa(t))s=A2(t,r);else{const n=Yg(e);s={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return fc(s)}function Xg(e,t){const r=Ss(e);return r===t||!fa(r)||Wn(r)?!1:ha(r).position==="fixed"||Xg(r,t)}function C2(e,t){const r=t.get(e);if(r)return r;let s=Ji(e,[],!1).filter(c=>fa(c)&&ri(c)!=="body"),n=null;const i=ha(e).position==="fixed";let o=i?Ss(e):e;for(;fa(o)&&!Wn(o);){const c=ha(o),l=lu(o);!l&&c.position==="fixed"&&(n=null),(i?!l&&!n:!l&&c.position==="static"&&!!n&&S2.has(n.position)||_o(o)&&!l&&Xg(e,o))?s=s.filter(u=>u!==o):n=c,o=Ss(o)}return t.set(e,s),s}function k2(e){let{element:t,boundary:r,rootBoundary:s,strategy:n}=e;const o=[...r==="clippingAncestors"?Jc(t)?[]:C2(t,this._c):[].concat(r),s],c=o[0],l=o.reduce((d,u)=>{const f=bh(t,u,n);return d.top=Cr(f.top,d.top),d.right=Es(f.right,d.right),d.bottom=Es(f.bottom,d.bottom),d.left=Cr(f.left,d.left),d},bh(t,c,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function R2(e){const{width:t,height:r}=zg(e);return{width:t,height:r}}function I2(e,t,r){const s=Aa(t),n=Ra(t),i=r==="fixed",o=an(e,!0,i,t);let c={scrollLeft:0,scrollTop:0};const l=Ta(0);function d(){l.x=fu(n)}if(s||!s&&!i)if((ri(t)!=="body"||_o(n))&&(c=Zc(t)),s){const m=an(t,!0,i,t);l.x=m.x+t.clientLeft,l.y=m.y+t.clientTop}else n&&d();i&&!s&&n&&d();const u=n&&!s&&!i?Kg(n,c):Ta(0),f=o.left+c.scrollLeft-l.x-u.x,h=o.top+c.scrollTop-l.y-u.y;return{x:f,y:h,width:o.width,height:o.height}}function Fl(e){return ha(e).position==="static"}function Nh(e,t){if(!Aa(e)||ha(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Ra(e)===r&&(r=r.ownerDocument.body),r}function Qg(e,t){const r=Dr(e);if(Jc(e))return r;if(!Aa(e)){let n=Ss(e);for(;n&&!Wn(n);){if(fa(n)&&!Fl(n))return n;n=Ss(n)}return r}let s=Nh(e,t);for(;s&&m2(s)&&Fl(s);)s=Nh(s,t);return s&&Wn(s)&&Fl(s)&&!lu(s)?r:s||y2(e)||r}const O2=async function(e){const t=this.getOffsetParent||Qg,r=this.getDimensions,s=await r(e.floating);return{reference:I2(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function P2(e){return ha(e).direction==="rtl"}const D2={convertOffsetParentRelativeRectToViewportRelativeRect:N2,getDocumentElement:Ra,getClippingRect:k2,getOffsetParent:Qg,getElementRects:O2,getClientRects:j2,getDimensions:R2,getScale:kn,isElement:fa,isRTL:P2};function Jg(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function L2(e,t){let r=null,s;const n=Ra(e);function i(){var c;clearTimeout(s),(c=r)==null||c.disconnect(),r=null}function o(c,l){c===void 0&&(c=!1),l===void 0&&(l=1),i();const d=e.getBoundingClientRect(),{left:u,top:f,width:h,height:m}=d;if(c||t(),!h||!m)return;const g=Fo(f),p=Fo(n.clientWidth-(u+h)),x=Fo(n.clientHeight-(f+m)),y=Fo(u),v={rootMargin:-g+"px "+-p+"px "+-x+"px "+-y+"px",threshold:Cr(0,Es(1,l))||1};let j=!0;function S(_){const T=_[0].intersectionRatio;if(T!==l){if(!j)return o();T?o(!1,T):s=setTimeout(()=>{o(!1,1e-7)},1e3)}T===1&&!Jg(d,e.getBoundingClientRect())&&o(),j=!1}try{r=new IntersectionObserver(S,{...v,root:n.ownerDocument})}catch{r=new IntersectionObserver(S,v)}r.observe(e)}return o(!0),i}function dq(e,t,r,s){s===void 0&&(s={});const{ancestorScroll:n=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:l=!1}=s,d=uu(e),u=n||i?[...d?Ji(d):[],...Ji(t)]:[];u.forEach(y=>{n&&y.addEventListener("scroll",r,{passive:!0}),i&&y.addEventListener("resize",r)});const f=d&&c?L2(d,r):null;let h=-1,m=null;o&&(m=new ResizeObserver(y=>{let[w]=y;w&&w.target===d&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var v;(v=m)==null||v.observe(t)})),r()}),d&&!l&&m.observe(d),m.observe(t));let g,p=l?an(e):null;l&&x();function x(){const y=an(e);p&&!Jg(p,y)&&r(),p=y,g=requestAnimationFrame(x)}return r(),()=>{var y;u.forEach(w=>{n&&w.removeEventListener("scroll",r),i&&w.removeEventListener("resize",r)}),f==null||f(),(y=m)==null||y.disconnect(),m=null,l&&cancelAnimationFrame(g)}}const uq=c2,fq=l2,hq=n2,mq=u2,pq=i2,gq=s2,xq=d2,vq=(e,t,r)=>{const s=new Map,n={platform:D2,...r},i={...n.platform,_c:s};return a2(e,t,{...n,platform:i})},Zg=Xw,F2=Qw,M2=Jw,ex=L.forwardRef(({className:e,sideOffset:t=4,...r},s)=>a.jsx(H0,{ref:s,sideOffset:t,className:Ie("z-50 overflow-hidden rounded-md border bg-background px-3 py-1.5 text-sm text-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));ex.displayName=H0.displayName;var el=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},U2={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},hs,ru,C0,$2=(C0=class{constructor(){Ye(this,hs,U2);Ye(this,ru,!1)}setTimeoutProvider(e){Me(this,hs,e)}setTimeout(e,t){return xe(this,hs).setTimeout(e,t)}clearTimeout(e){xe(this,hs).clearTimeout(e)}setInterval(e,t){return xe(this,hs).setInterval(e,t)}clearInterval(e){xe(this,hs).clearInterval(e)}},hs=new WeakMap,ru=new WeakMap,C0),_d=new $2;function B2(e){setTimeout(e,0)}var tl=typeof window>"u"||"Deno"in globalThis;function ra(){}function G2(e,t){return typeof e=="function"?e(t):e}function V2(e){return typeof e=="number"&&e>=0&&e!==1/0}function H2(e,t){return Math.max(e+(t||0)-Date.now(),0)}function bd(e,t){return typeof e=="function"?e(t):e}function q2(e,t){return typeof e=="function"?e(t):e}function jh(e,t){const{type:r="all",exact:s,fetchStatus:n,predicate:i,queryKey:o,stale:c}=e;if(o){if(s){if(t.queryHash!==hu(o,t.options))return!1}else if(!eo(t.queryKey,o))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof c=="boolean"&&t.isStale()!==c||n&&n!==t.state.fetchStatus||i&&!i(t))}function Th(e,t){const{exact:r,status:s,predicate:n,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Zi(t.options.mutationKey)!==Zi(i))return!1}else if(!eo(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||n&&!n(t))}function hu(e,t){return((t==null?void 0:t.queryKeyHashFn)||Zi)(e)}function Zi(e){return JSON.stringify(e,(t,r)=>Nd(r)?Object.keys(r).sort().reduce((s,n)=>(s[n]=r[n],s),{}):r)}function eo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>eo(e[r],t[r])):!1}var W2=Object.prototype.hasOwnProperty;function tx(e,t){if(e===t)return e;const r=Eh(e)&&Eh(t);if(!r&&!(Nd(e)&&Nd(t)))return t;const n=(r?e:Object.keys(e)).length,i=r?t:Object.keys(t),o=i.length,c=r?new Array(o):{};let l=0;for(let d=0;d<o;d++){const u=r?d:i[d],f=e[u],h=t[u];if(f===h){c[u]=f,(r?d<n:W2.call(e,u))&&l++;continue}if(f===null||h===null||typeof f!="object"||typeof h!="object"){c[u]=h;continue}const m=tx(f,h);c[u]=m,m===f&&l++}return n===o&&l===n?e:c}function Eh(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Nd(e){if(!Sh(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Sh(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Sh(e){return Object.prototype.toString.call(e)==="[object Object]"}function z2(e){return new Promise(t=>{_d.setTimeout(t,e)})}function Y2(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?tx(e,t):t}function K2(e,t,r=0){const s=[...e,t];return r&&s.length>r?s.slice(1):s}function X2(e,t,r=0){const s=[t,...e];return r&&s.length>r?s.slice(0,-1):s}var mu=Symbol();function rx(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===mu?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Hs,ms,Ln,k0,Q2=(k0=class extends el{constructor(){super();Ye(this,Hs);Ye(this,ms);Ye(this,Ln);Me(this,Ln,t=>{if(!tl&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){xe(this,ms)||this.setEventListener(xe(this,Ln))}onUnsubscribe(){var t;this.hasListeners()||((t=xe(this,ms))==null||t.call(this),Me(this,ms,void 0))}setEventListener(t){var r;Me(this,Ln,t),(r=xe(this,ms))==null||r.call(this),Me(this,ms,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){xe(this,Hs)!==t&&(Me(this,Hs,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof xe(this,Hs)=="boolean"?xe(this,Hs):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Hs=new WeakMap,ms=new WeakMap,Ln=new WeakMap,k0),ax=new Q2;function J2(){let e,t;const r=new Promise((n,i)=>{e=n,t=i});r.status="pending",r.catch(()=>{});function s(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{s({status:"fulfilled",value:n}),e(n)},r.reject=n=>{s({status:"rejected",reason:n}),t(n)},r}var Z2=B2;function eN(){let e=[],t=0,r=c=>{c()},s=c=>{c()},n=Z2;const i=c=>{t?e.push(c):n(()=>{r(c)})},o=()=>{const c=e;e=[],c.length&&n(()=>{s(()=>{c.forEach(l=>{r(l)})})})};return{batch:c=>{let l;t++;try{l=c()}finally{t--,t||o()}return l},batchCalls:c=>(...l)=>{i(()=>{c(...l)})},schedule:i,setNotifyFunction:c=>{r=c},setBatchNotifyFunction:c=>{s=c},setScheduler:c=>{n=c}}}var mr=eN(),Fn,ps,Mn,R0,tN=(R0=class extends el{constructor(){super();Ye(this,Fn,!0);Ye(this,ps);Ye(this,Mn);Me(this,Mn,t=>{if(!tl&&window.addEventListener){const r=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",s)}}})}onSubscribe(){xe(this,ps)||this.setEventListener(xe(this,Mn))}onUnsubscribe(){var t;this.hasListeners()||((t=xe(this,ps))==null||t.call(this),Me(this,ps,void 0))}setEventListener(t){var r;Me(this,Mn,t),(r=xe(this,ps))==null||r.call(this),Me(this,ps,t(this.setOnline.bind(this)))}setOnline(t){xe(this,Fn)!==t&&(Me(this,Fn,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return xe(this,Fn)}},Fn=new WeakMap,ps=new WeakMap,Mn=new WeakMap,R0),hc=new tN;function rN(e){return Math.min(1e3*2**e,3e4)}function sx(e){return(e??"online")==="online"?hc.isOnline():!0}var jd=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function nx(e){let t=!1,r=0,s;const n=J2(),i=()=>n.status!=="pending",o=p=>{var x;if(!i()){const y=new jd(p);h(y),(x=e.onCancel)==null||x.call(e,y)}},c=()=>{t=!0},l=()=>{t=!1},d=()=>ax.isFocused()&&(e.networkMode==="always"||hc.isOnline())&&e.canRun(),u=()=>sx(e.networkMode)&&e.canRun(),f=p=>{i()||(s==null||s(),n.resolve(p))},h=p=>{i()||(s==null||s(),n.reject(p))},m=()=>new Promise(p=>{var x;s=y=>{(i()||d())&&p(y)},(x=e.onPause)==null||x.call(e)}).then(()=>{var p;s=void 0,i()||(p=e.onContinue)==null||p.call(e)}),g=()=>{if(i())return;let p;const x=r===0?e.initialPromise:void 0;try{p=x??e.fn()}catch(y){p=Promise.reject(y)}Promise.resolve(p).then(f).catch(y=>{var _;if(i())return;const w=e.retry??(tl?0:3),v=e.retryDelay??rN,j=typeof v=="function"?v(r,y):v,S=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,y);if(t||!S){h(y);return}r++,(_=e.onFail)==null||_.call(e,r,y),z2(j).then(()=>d()?void 0:m()).then(()=>{t?h(y):g()})})};return{promise:n,status:()=>n.status,cancel:o,continue:()=>(s==null||s(),n),cancelRetry:c,continueRetry:l,canStart:u,start:()=>(u()?g():m().then(g),n)}}var qs,I0,ix=(I0=class{constructor(){Ye(this,qs)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),V2(this.gcTime)&&Me(this,qs,_d.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(tl?1/0:5*60*1e3))}clearGcTimeout(){xe(this,qs)&&(_d.clearTimeout(xe(this,qs)),Me(this,qs,void 0))}},qs=new WeakMap,I0),Ws,Un,Wr,zs,qt,xo,Ys,aa,Ma,O0,aN=(O0=class extends ix{constructor(t){super();Ye(this,aa);Ye(this,Ws);Ye(this,Un);Ye(this,Wr);Ye(this,zs);Ye(this,qt);Ye(this,xo);Ye(this,Ys);Me(this,Ys,!1),Me(this,xo,t.defaultOptions),this.setOptions(t.options),this.observers=[],Me(this,zs,t.client),Me(this,Wr,xe(this,zs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Me(this,Ws,Ah(this.options)),this.state=t.state??xe(this,Ws),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=xe(this,qt))==null?void 0:t.promise}setOptions(t){if(this.options={...xe(this,xo),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Ah(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),Me(this,Ws,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&xe(this,Wr).remove(this)}setData(t,r){const s=Y2(this.state.data,t,this.options);return ar(this,aa,Ma).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(t,r){ar(this,aa,Ma).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var s,n;const r=(s=xe(this,qt))==null?void 0:s.promise;return(n=xe(this,qt))==null||n.cancel(t),r?r.then(ra).catch(ra):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(xe(this,Ws))}isActive(){return this.observers.some(t=>q2(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===mu||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>bd(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!H2(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=xe(this,qt))==null||r.continue()}onOnline(){var r;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=xe(this,qt))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),xe(this,Wr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(xe(this,qt)&&(xe(this,Ys)?xe(this,qt).cancel({revert:!0}):xe(this,qt).cancelRetry()),this.scheduleGc()),xe(this,Wr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ar(this,aa,Ma).call(this,{type:"invalidate"})}async fetch(t,r){var l,d,u,f,h,m,g,p,x,y,w,v;if(this.state.fetchStatus!=="idle"&&((l=xe(this,qt))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(xe(this,qt))return xe(this,qt).continueRetry(),xe(this,qt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(S=>S.options.queryFn);j&&this.setOptions(j.options)}const s=new AbortController,n=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(Me(this,Ys,!0),s.signal)})},i=()=>{const j=rx(this.options,r),_=(()=>{const T={client:xe(this,zs),queryKey:this.queryKey,meta:this.meta};return n(T),T})();return Me(this,Ys,!1),this.options.persister?this.options.persister(j,_,this):j(_)},c=(()=>{const j={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:xe(this,zs),state:this.state,fetchFn:i};return n(j),j})();(d=this.options.behavior)==null||d.onFetch(c,this),Me(this,Un,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=c.fetchOptions)==null?void 0:u.meta))&&ar(this,aa,Ma).call(this,{type:"fetch",meta:(f=c.fetchOptions)==null?void 0:f.meta}),Me(this,qt,nx({initialPromise:r==null?void 0:r.initialPromise,fn:c.fetchFn,onCancel:j=>{j instanceof jd&&j.revert&&this.setState({...xe(this,Un),fetchStatus:"idle"}),s.abort()},onFail:(j,S)=>{ar(this,aa,Ma).call(this,{type:"failed",failureCount:j,error:S})},onPause:()=>{ar(this,aa,Ma).call(this,{type:"pause"})},onContinue:()=>{ar(this,aa,Ma).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0}));try{const j=await xe(this,qt).start();if(j===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(j),(m=(h=xe(this,Wr).config).onSuccess)==null||m.call(h,j,this),(p=(g=xe(this,Wr).config).onSettled)==null||p.call(g,j,this.state.error,this),j}catch(j){if(j instanceof jd){if(j.silent)return xe(this,qt).promise;if(j.revert){if(this.state.data===void 0)throw j;return this.state.data}}throw ar(this,aa,Ma).call(this,{type:"error",error:j}),(y=(x=xe(this,Wr).config).onError)==null||y.call(x,j,this),(v=(w=xe(this,Wr).config).onSettled)==null||v.call(w,this.state.data,j,this),j}finally{this.scheduleGc()}}},Ws=new WeakMap,Un=new WeakMap,Wr=new WeakMap,zs=new WeakMap,qt=new WeakMap,xo=new WeakMap,Ys=new WeakMap,aa=new WeakSet,Ma=function(t){const r=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...sN(s.data,this.options),fetchMeta:t.meta??null};case"success":const n={...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Me(this,Un,t.manual?n:void 0),n;case"error":const i=t.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=r(this.state),mr.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),xe(this,Wr).notify({query:this,type:"updated",action:t})})},O0);function sN(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:sx(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Ah(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,s=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}function Ch(e){return{onFetch:(t,r)=>{var u,f,h,m,g;const s=t.options,n=(h=(f=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:f.fetchMore)==null?void 0:h.direction,i=((m=t.state.data)==null?void 0:m.pages)||[],o=((g=t.state.data)==null?void 0:g.pageParams)||[];let c={pages:[],pageParams:[]},l=0;const d=async()=>{let p=!1;const x=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?p=!0:t.signal.addEventListener("abort",()=>{p=!0}),t.signal)})},y=rx(t.options,t.fetchOptions),w=async(v,j,S)=>{if(p)return Promise.reject();if(j==null&&v.pages.length)return Promise.resolve(v);const T=(()=>{const A={client:t.client,queryKey:t.queryKey,pageParam:j,direction:S?"backward":"forward",meta:t.options.meta};return x(A),A})(),N=await y(T),{maxPages:b}=t.options,O=S?X2:K2;return{pages:O(v.pages,N,b),pageParams:O(v.pageParams,j,b)}};if(n&&i.length){const v=n==="backward",j=v?nN:kh,S={pages:i,pageParams:o},_=j(s,S);c=await w(S,_,v)}else{const v=e??i.length;do{const j=l===0?o[0]??s.initialPageParam:kh(s,c);if(l>0&&j==null)break;c=await w(c,j),l++}while(l<v)}return c};t.options.persister?t.fetchFn=()=>{var p,x;return(x=(p=t.options).persister)==null?void 0:x.call(p,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function kh(e,{pages:t,pageParams:r}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,r[s],r):void 0}function nN(e,{pages:t,pageParams:r}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,r[0],r):void 0}var vo,wa,fr,Ks,_a,ls,P0,iN=(P0=class extends ix{constructor(t){super();Ye(this,_a);Ye(this,vo);Ye(this,wa);Ye(this,fr);Ye(this,Ks);Me(this,vo,t.client),this.mutationId=t.mutationId,Me(this,fr,t.mutationCache),Me(this,wa,[]),this.state=t.state||oN(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){xe(this,wa).includes(t)||(xe(this,wa).push(t),this.clearGcTimeout(),xe(this,fr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Me(this,wa,xe(this,wa).filter(r=>r!==t)),this.scheduleGc(),xe(this,fr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){xe(this,wa).length||(this.state.status==="pending"?this.scheduleGc():xe(this,fr).remove(this))}continue(){var t;return((t=xe(this,Ks))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,c,l,d,u,f,h,m,g,p,x,y,w,v,j,S,_,T,N,b;const r=()=>{ar(this,_a,ls).call(this,{type:"continue"})},s={client:xe(this,vo),meta:this.options.meta,mutationKey:this.options.mutationKey};Me(this,Ks,nx({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:(O,A)=>{ar(this,_a,ls).call(this,{type:"failed",failureCount:O,error:A})},onPause:()=>{ar(this,_a,ls).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>xe(this,fr).canRun(this)}));const n=this.state.status==="pending",i=!xe(this,Ks).canStart();try{if(n)r();else{ar(this,_a,ls).call(this,{type:"pending",variables:t,isPaused:i}),await((c=(o=xe(this,fr).config).onMutate)==null?void 0:c.call(o,t,this,s));const A=await((d=(l=this.options).onMutate)==null?void 0:d.call(l,t,s));A!==this.state.context&&ar(this,_a,ls).call(this,{type:"pending",context:A,variables:t,isPaused:i})}const O=await xe(this,Ks).start();return await((f=(u=xe(this,fr).config).onSuccess)==null?void 0:f.call(u,O,t,this.state.context,this,s)),await((m=(h=this.options).onSuccess)==null?void 0:m.call(h,O,t,this.state.context,s)),await((p=(g=xe(this,fr).config).onSettled)==null?void 0:p.call(g,O,null,this.state.variables,this.state.context,this,s)),await((y=(x=this.options).onSettled)==null?void 0:y.call(x,O,null,t,this.state.context,s)),ar(this,_a,ls).call(this,{type:"success",data:O}),O}catch(O){try{throw await((v=(w=xe(this,fr).config).onError)==null?void 0:v.call(w,O,t,this.state.context,this,s)),await((S=(j=this.options).onError)==null?void 0:S.call(j,O,t,this.state.context,s)),await((T=(_=xe(this,fr).config).onSettled)==null?void 0:T.call(_,void 0,O,this.state.variables,this.state.context,this,s)),await((b=(N=this.options).onSettled)==null?void 0:b.call(N,void 0,O,t,this.state.context,s)),O}finally{ar(this,_a,ls).call(this,{type:"error",error:O})}}finally{xe(this,fr).runNext(this)}}},vo=new WeakMap,wa=new WeakMap,fr=new WeakMap,Ks=new WeakMap,_a=new WeakSet,ls=function(t){const r=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),mr.batch(()=>{xe(this,wa).forEach(s=>{s.onMutationUpdate(t)}),xe(this,fr).notify({mutation:this,type:"updated",action:t})})},P0);function oN(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var $a,sa,yo,D0,cN=(D0=class extends el{constructor(t={}){super();Ye(this,$a);Ye(this,sa);Ye(this,yo);this.config=t,Me(this,$a,new Set),Me(this,sa,new Map),Me(this,yo,0)}build(t,r,s){const n=new iN({client:t,mutationCache:this,mutationId:++Do(this,yo)._,options:t.defaultMutationOptions(r),state:s});return this.add(n),n}add(t){xe(this,$a).add(t);const r=Mo(t);if(typeof r=="string"){const s=xe(this,sa).get(r);s?s.push(t):xe(this,sa).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(xe(this,$a).delete(t)){const r=Mo(t);if(typeof r=="string"){const s=xe(this,sa).get(r);if(s)if(s.length>1){const n=s.indexOf(t);n!==-1&&s.splice(n,1)}else s[0]===t&&xe(this,sa).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Mo(t);if(typeof r=="string"){const s=xe(this,sa).get(r),n=s==null?void 0:s.find(i=>i.state.status==="pending");return!n||n===t}else return!0}runNext(t){var s;const r=Mo(t);if(typeof r=="string"){const n=(s=xe(this,sa).get(r))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){mr.batch(()=>{xe(this,$a).forEach(t=>{this.notify({type:"removed",mutation:t})}),xe(this,$a).clear(),xe(this,sa).clear()})}getAll(){return Array.from(xe(this,$a))}find(t){const r={exact:!0,...t};return this.getAll().find(s=>Th(r,s))}findAll(t={}){return this.getAll().filter(r=>Th(t,r))}notify(t){mr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return mr.batch(()=>Promise.all(t.map(r=>r.continue().catch(ra))))}},$a=new WeakMap,sa=new WeakMap,yo=new WeakMap,D0);function Mo(e){var t;return(t=e.options.scope)==null?void 0:t.id}var ba,L0,lN=(L0=class extends el{constructor(t={}){super();Ye(this,ba);this.config=t,Me(this,ba,new Map)}build(t,r,s){const n=r.queryKey,i=r.queryHash??hu(n,r);let o=this.get(i);return o||(o=new aN({client:t,queryKey:n,queryHash:i,options:t.defaultQueryOptions(r),state:s,defaultOptions:t.getQueryDefaults(n)}),this.add(o)),o}add(t){xe(this,ba).has(t.queryHash)||(xe(this,ba).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=xe(this,ba).get(t.queryHash);r&&(t.destroy(),r===t&&xe(this,ba).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){mr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return xe(this,ba).get(t)}getAll(){return[...xe(this,ba).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(s=>jh(r,s))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(s=>jh(t,s)):r}notify(t){mr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){mr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){mr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ba=new WeakMap,L0),Ct,gs,xs,$n,Bn,vs,Gn,Vn,F0,dN=(F0=class{constructor(e={}){Ye(this,Ct);Ye(this,gs);Ye(this,xs);Ye(this,$n);Ye(this,Bn);Ye(this,vs);Ye(this,Gn);Ye(this,Vn);Me(this,Ct,e.queryCache||new lN),Me(this,gs,e.mutationCache||new cN),Me(this,xs,e.defaultOptions||{}),Me(this,$n,new Map),Me(this,Bn,new Map),Me(this,vs,0)}mount(){Do(this,vs)._++,xe(this,vs)===1&&(Me(this,Gn,ax.subscribe(async e=>{e&&(await this.resumePausedMutations(),xe(this,Ct).onFocus())})),Me(this,Vn,hc.subscribe(async e=>{e&&(await this.resumePausedMutations(),xe(this,Ct).onOnline())})))}unmount(){var e,t;Do(this,vs)._--,xe(this,vs)===0&&((e=xe(this,Gn))==null||e.call(this),Me(this,Gn,void 0),(t=xe(this,Vn))==null||t.call(this),Me(this,Vn,void 0))}isFetching(e){return xe(this,Ct).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return xe(this,gs).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=xe(this,Ct).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=xe(this,Ct).build(this,t),s=r.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(bd(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return xe(this,Ct).findAll(e).map(({queryKey:t,state:r})=>{const s=r.data;return[t,s]})}setQueryData(e,t,r){const s=this.defaultQueryOptions({queryKey:e}),n=xe(this,Ct).get(s.queryHash),i=n==null?void 0:n.state.data,o=G2(t,i);if(o!==void 0)return xe(this,Ct).build(this,s).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return mr.batch(()=>xe(this,Ct).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=xe(this,Ct).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=xe(this,Ct);mr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=xe(this,Ct);return mr.batch(()=>(r.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},s=mr.batch(()=>xe(this,Ct).findAll(e).map(n=>n.cancel(r)));return Promise.all(s).then(ra).catch(ra)}invalidateQueries(e,t={}){return mr.batch(()=>(xe(this,Ct).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},s=mr.batch(()=>xe(this,Ct).findAll(e).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let i=n.fetch(void 0,r);return r.throwOnError||(i=i.catch(ra)),n.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(ra)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=xe(this,Ct).build(this,t);return r.isStaleByTime(bd(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ra).catch(ra)}fetchInfiniteQuery(e){return e.behavior=Ch(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ra).catch(ra)}ensureInfiniteQueryData(e){return e.behavior=Ch(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return hc.isOnline()?xe(this,gs).resumePausedMutations():Promise.resolve()}getQueryCache(){return xe(this,Ct)}getMutationCache(){return xe(this,gs)}getDefaultOptions(){return xe(this,xs)}setDefaultOptions(e){Me(this,xs,e)}setQueryDefaults(e,t){xe(this,$n).set(Zi(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...xe(this,$n).values()],r={};return t.forEach(s=>{eo(e,s.queryKey)&&Object.assign(r,s.defaultOptions)}),r}setMutationDefaults(e,t){xe(this,Bn).set(Zi(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...xe(this,Bn).values()],r={};return t.forEach(s=>{eo(e,s.mutationKey)&&Object.assign(r,s.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...xe(this,xs).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=hu(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===mu&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...xe(this,xs).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){xe(this,Ct).clear(),xe(this,gs).clear()}},Ct=new WeakMap,gs=new WeakMap,xs=new WeakMap,$n=new WeakMap,Bn=new WeakMap,vs=new WeakMap,Gn=new WeakMap,Vn=new WeakMap,F0);const uN=new dN({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,retry:2,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchInterval:2*60*1e3},mutations:{retry:1}}});/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function to(){return to=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},to.apply(this,arguments)}var An;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(An||(An={}));const Rh="popstate";function yq(e){e===void 0&&(e={});function t(s,n){let{pathname:i,search:o,hash:c}=s.location;return Td("",{pathname:i,search:o,hash:c},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(s,n){return typeof n=="string"?n:cx(n)}return hN(t,r,null,e)}function Rn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ox(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function fN(){return Math.random().toString(36).substr(2,8)}function Ih(e,t){return{usr:e.state,key:e.key,idx:t}}function Td(e,t,r,s){return r===void 0&&(r=null),to({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?rl(t):t,{state:r,key:t&&t.key||s||fN()})}function cx(e){let{pathname:t="/",search:r="",hash:s=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function rl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function hN(e,t,r,s){s===void 0&&(s={});let{window:n=document.defaultView,v5Compat:i=!1}=s,o=n.history,c=An.Pop,l=null,d=u();d==null&&(d=0,o.replaceState(to({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function f(){c=An.Pop;let x=u(),y=x==null?null:x-d;d=x,l&&l({action:c,location:p.location,delta:y})}function h(x,y){c=An.Push;let w=Td(p.location,x,y);d=u()+1;let v=Ih(w,d),j=p.createHref(w);try{o.pushState(v,"",j)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;n.location.assign(j)}i&&l&&l({action:c,location:p.location,delta:1})}function m(x,y){c=An.Replace;let w=Td(p.location,x,y);d=u();let v=Ih(w,d),j=p.createHref(w);o.replaceState(v,"",j),i&&l&&l({action:c,location:p.location,delta:0})}function g(x){let y=n.location.origin!=="null"?n.location.origin:n.location.href,w=typeof x=="string"?x:cx(x);return w=w.replace(/ $/,"%20"),Rn(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let p={get action(){return c},get location(){return e(n,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(Rh,f),l=x,()=>{n.removeEventListener(Rh,f),l=null}},createHref(x){return t(n,x)},createURL:g,encodeLocation(x){let y=g(x);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:m,go(x){return o.go(x)}};return p}var Oh;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Oh||(Oh={}));function wq(e,t,r){return r===void 0&&(r="/"),mN(e,t,r,!1)}function mN(e,t,r,s){let n=typeof t=="string"?rl(t):t,i=SN(n.pathname||"/",r);if(i==null)return null;let o=lx(e);pN(o);let c=null;for(let l=0;c==null&&l<o.length;++l){let d=EN(i);c=jN(o[l],d,s)}return c}function lx(e,t,r,s){t===void 0&&(t=[]),r===void 0&&(r=[]),s===void 0&&(s="");let n=(i,o,c)=>{let l={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Rn(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let d=ic([s,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(Rn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),lx(i.children,t,u,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:bN(d,i.index),routesMeta:u})};return e.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))n(i,o);else for(let l of dx(i.path))n(i,o,l)}),t}function dx(e){let t=e.split("/");if(t.length===0)return[];let[r,...s]=t,n=r.endsWith("?"),i=r.replace(/\?$/,"");if(s.length===0)return n?[i,""]:[i];let o=dx(s.join("/")),c=[];return c.push(...o.map(l=>l===""?i:[i,l].join("/"))),n&&c.push(...o),c.map(l=>e.startsWith("/")&&l===""?"/":l)}function pN(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:NN(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const gN=/^:[\w-]+$/,xN=3,vN=2,yN=1,wN=10,_N=-2,Ph=e=>e==="*";function bN(e,t){let r=e.split("/"),s=r.length;return r.some(Ph)&&(s+=_N),t&&(s+=vN),r.filter(n=>!Ph(n)).reduce((n,i)=>n+(gN.test(i)?xN:i===""?yN:wN),s)}function NN(e,t){return e.length===t.length&&e.slice(0,-1).every((s,n)=>s===t[n])?e[e.length-1]-t[t.length-1]:0}function jN(e,t,r){let{routesMeta:s}=e,n={},i="/",o=[];for(let c=0;c<s.length;++c){let l=s[c],d=c===s.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=Dh({path:l.relativePath,caseSensitive:l.caseSensitive,end:d},u),h=l.route;if(!f&&d&&r&&!s[s.length-1].route.index&&(f=Dh({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(n,f.params),o.push({params:n,pathname:ic([i,f.pathname]),pathnameBase:RN(ic([i,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(i=ic([i,f.pathnameBase]))}return o}function Dh(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=TN(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let i=n[0],o=i.replace(/(.)\/+$/,"$1"),c=n.slice(1);return{params:s.reduce((d,u,f)=>{let{paramName:h,isOptional:m}=u;if(h==="*"){let p=c[f]||"";o=i.slice(0,i.length-p.length).replace(/(.)\/+$/,"$1")}const g=c[f];return m&&!g?d[h]=void 0:d[h]=(g||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:e}}function TN(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ox(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,l)=>(s.push({paramName:c,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),s]}function EN(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ox(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function SN(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}function AN(e,t){t===void 0&&(t="/");let{pathname:r,search:s="",hash:n=""}=typeof e=="string"?rl(e):e;return{pathname:r?r.startsWith("/")?r:CN(r,t):t,search:IN(s),hash:ON(n)}}function CN(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function Ml(e,t,r,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function kN(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function _q(e,t){let r=kN(e);return t?r.map((s,n)=>n===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function bq(e,t,r,s){s===void 0&&(s=!1);let n;typeof e=="string"?n=rl(e):(n=to({},e),Rn(!n.pathname||!n.pathname.includes("?"),Ml("?","pathname","search",n)),Rn(!n.pathname||!n.pathname.includes("#"),Ml("#","pathname","hash",n)),Rn(!n.search||!n.search.includes("#"),Ml("#","search","hash",n)));let i=e===""||n.pathname==="",o=i?"/":n.pathname,c;if(o==null)c=r;else{let f=t.length-1;if(!s&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;n.pathname=h.join("/")}c=f>=0?t[f]:"/"}let l=AN(n,c),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(d||u)&&(l.pathname+="/"),l}const ic=e=>e.join("/").replace(/\/\/+/g,"/"),RN=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),IN=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ON=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Nq(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const ux=["post","put","patch","delete"];new Set(ux);const PN=["get",...ux];new Set(PN);var Ed=function(e,t){return Ed=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])},Ed(e,t)};function fx(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ed(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var zn=function(){return zn=Object.assign||function(t){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},zn.apply(this,arguments)};function pu(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}function hx(e,t,r,s){var n=arguments.length,i=n<3?t:s===null?s=Object.getOwnPropertyDescriptor(t,r):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,s);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i}function mx(e,t){return function(r,s){t(r,s,e)}}function px(e,t,r,s,n,i){function o(y){if(y!==void 0&&typeof y!="function")throw new TypeError("Function expected");return y}for(var c=s.kind,l=c==="getter"?"get":c==="setter"?"set":"value",d=!t&&e?s.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,s.name):{}),f,h=!1,m=r.length-1;m>=0;m--){var g={};for(var p in s)g[p]=p==="access"?{}:s[p];for(var p in s.access)g.access[p]=s.access[p];g.addInitializer=function(y){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(y||null))};var x=(0,r[m])(c==="accessor"?{get:u.get,set:u.set}:u[l],g);if(c==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(f=o(x.get))&&(u.get=f),(f=o(x.set))&&(u.set=f),(f=o(x.init))&&n.unshift(f)}else(f=o(x))&&(c==="field"?n.unshift(f):u[l]=f)}d&&Object.defineProperty(d,s.name,u),h=!0}function gx(e,t,r){for(var s=arguments.length>2,n=0;n<t.length;n++)r=s?t[n].call(e,r):t[n].call(e);return s?r:void 0}function xx(e){return typeof e=="symbol"?e:"".concat(e)}function vx(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function yx(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function wx(e,t,r,s){function n(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{d(s.next(u))}catch(f){o(f)}}function l(u){try{d(s.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):n(u.value).then(c,l)}d((s=s.apply(e,t||[])).next())})}function _x(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,n,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=c(0),o.throw=c(1),o.return=c(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(u){return l([d,u])}}function l(d){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(r=0)),r;)try{if(s=1,n&&(i=d[0]&2?n.return:d[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,d[1])).done)return i;switch(n=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){r.label=d[1];break}if(d[0]===6&&r.label<i[1]){r.label=i[1],i=d;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(d);break}i[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(u){d=[6,u],n=0}finally{s=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var al=Object.create?function(e,t,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(t,r);(!n||("get"in n?!t.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,s,n)}:function(e,t,r,s){s===void 0&&(s=r),e[s]=t[r]};function bx(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&al(t,e,r)}function mc(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function gu(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var s=r.call(e),n,i=[],o;try{for(;(t===void 0||t-- >0)&&!(n=s.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(o)throw o.error}}return i}function Nx(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(gu(arguments[t]));return e}function jx(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var s=Array(e),n=0,t=0;t<r;t++)for(var i=arguments[t],o=0,c=i.length;o<c;o++,n++)s[n]=i[o];return s}function Tx(e,t,r){if(r||arguments.length===2)for(var s=0,n=t.length,i;s<n;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}function Yn(e){return this instanceof Yn?(this.v=e,this):new Yn(e)}function Ex(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(e,t||[]),n,i=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",o),n[Symbol.asyncIterator]=function(){return this},n;function o(m){return function(g){return Promise.resolve(g).then(m,f)}}function c(m,g){s[m]&&(n[m]=function(p){return new Promise(function(x,y){i.push([m,p,x,y])>1||l(m,p)})},g&&(n[m]=g(n[m])))}function l(m,g){try{d(s[m](g))}catch(p){h(i[0][3],p)}}function d(m){m.value instanceof Yn?Promise.resolve(m.value.v).then(u,f):h(i[0][2],m)}function u(m){l("next",m)}function f(m){l("throw",m)}function h(m,g){m(g),i.shift(),i.length&&l(i[0][0],i[0][1])}}function Sx(e){var t,r;return t={},s("next"),s("throw",function(n){throw n}),s("return"),t[Symbol.iterator]=function(){return this},t;function s(n,i){t[n]=e[n]?function(o){return(r=!r)?{value:Yn(e[n](o)),done:!1}:i?i(o):o}:i}}function Ax(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof mc=="function"?mc(e):e[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(i){r[i]=e[i]&&function(o){return new Promise(function(c,l){o=e[i](o),n(c,l,o.done,o.value)})}}function n(i,o,c,l){Promise.resolve(l).then(function(d){i({value:d,done:c})},o)}}function Cx(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var DN=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},Sd=function(e){return Sd=Object.getOwnPropertyNames||function(t){var r=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[r.length]=s);return r},Sd(e)};function kx(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=Sd(e),s=0;s<r.length;s++)r[s]!=="default"&&al(t,e,r[s]);return DN(t,e),t}function Rx(e){return e&&e.__esModule?e:{default:e}}function Ix(e,t,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(e):s?s.value:t.get(e)}function Ox(e,t,r,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(e,r):n?n.value=r:t.set(e,r),r}function Px(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function Dx(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var s,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=t[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=t[Symbol.dispose],r&&(n=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:s,async:r})}else r&&e.stack.push({async:!0});return t}var LN=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var s=new Error(r);return s.name="SuppressedError",s.error=e,s.suppressed=t,s};function Lx(e){function t(i){e.error=e.hasError?new LN(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}var r,s=0;function n(){for(;r=e.stack.pop();)try{if(!r.async&&s===1)return s=0,e.stack.push(r),Promise.resolve().then(n);if(r.dispose){var i=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(i).then(n,function(o){return t(o),n()})}else s|=1}catch(o){t(o)}if(s===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return n()}function Fx(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,s,n,i,o){return s?t?".jsx":".js":n&&(!i||!o)?r:n+i+"."+o.toLowerCase()+"js"}):e}const FN={__extends:fx,__assign:zn,__rest:pu,__decorate:hx,__param:mx,__esDecorate:px,__runInitializers:gx,__propKey:xx,__setFunctionName:vx,__metadata:yx,__awaiter:wx,__generator:_x,__createBinding:al,__exportStar:bx,__values:mc,__read:gu,__spread:Nx,__spreadArrays:jx,__spreadArray:Tx,__await:Yn,__asyncGenerator:Ex,__asyncDelegator:Sx,__asyncValues:Ax,__makeTemplateObject:Cx,__importStar:kx,__importDefault:Rx,__classPrivateFieldGet:Ix,__classPrivateFieldSet:Ox,__classPrivateFieldIn:Px,__addDisposableResource:Dx,__disposeResources:Lx,__rewriteRelativeImportExtension:Fx},MN=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Dx,get __assign(){return zn},__asyncDelegator:Sx,__asyncGenerator:Ex,__asyncValues:Ax,__await:Yn,__awaiter:wx,__classPrivateFieldGet:Ix,__classPrivateFieldIn:Px,__classPrivateFieldSet:Ox,__createBinding:al,__decorate:hx,__disposeResources:Lx,__esDecorate:px,__exportStar:bx,__extends:fx,__generator:_x,__importDefault:Rx,__importStar:kx,__makeTemplateObject:Cx,__metadata:yx,__param:mx,__propKey:xx,__read:gu,__rest:pu,__rewriteRelativeImportExtension:Fx,__runInitializers:gx,__setFunctionName:vx,__spread:Nx,__spreadArray:Tx,__spreadArrays:jx,__values:mc,default:FN},Symbol.toStringTag,{value:"Module"})),jq=sb(MN),UN="https://yrvicwapjsevyilxdzsm.supabase.co",$N="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inlydmljd2FwanNldnlpbHhkenNtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjAwMDY2ODIsImV4cCI6MjA3NTU4MjY4Mn0.tRhpswJI2CccGdWX3fcJEowSA9IBh-KMYHfaiKVjN7c";let Mx;Mx=eb(UN,$N,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},realtime:{params:{eventsPerSecond:10}},global:{headers:{"X-Client-Info":"tourcompanion-1.0.0"}}});const he=Mx,Ux=L.createContext(void 0),xu=()=>{const e=L.useContext(Ux);if(e===void 0)throw new Error("useAgency must be used within an AgencyProvider");return e},$x=({children:e})=>{const[t,r]=L.useState({agency_name:"TourCompanion",agency_logo:"/tourcompanion-logo.png",current_user_email:"user@example.com"}),[s,n]=L.useState(!0);L.useEffect(()=>{i()},[]);const i=async()=>{try{if(window.location.pathname.startsWith("/client/")){console.log("[AgencyProvider] Skipping agency settings for public client portal"),r({agency_name:"TourCompanion",agency_logo:"/tourcompanion-logo.png",current_user_email:"contact@youragency.com"}),n(!1);return}const{data:{user:l},error:d}=await he.auth.getUser();if(d||!l){r({agency_name:"TourCompanion",agency_logo:"/tourcompanion-logo.png",current_user_email:"contact@youragency.com"});return}const{data:u,error:f}=await he.from("creators").select("agency_name, agency_logo, contact_email").eq("user_id",l.id).single();if(u&&!f){const h=u.agency_logo||"/tourcompanion-logo.png";console.log(" [AgencyProvider] Setting agency logo:",h),r({agency_name:u.agency_name||"Your Agency",agency_logo:h,current_user_email:u.contact_email||l.email||"contact@youragency.com"})}else console.log(" [AgencyProvider] Using default logo: /tourcompanion-logo.png"),r({agency_name:"TourCompanion",agency_logo:"/tourcompanion-logo.png",current_user_email:l.email||"contact@youragency.com"})}catch(l){console.error("Error loading agency settings:",l),r({agency_name:"Your Agency",agency_logo:"/placeholder-logo.png",current_user_email:"contact@youragency.com"})}finally{n(!1)}},c={agencySettings:t,loading:s,updateAgencySettings:async l=>{try{r(h=>({...h,...l}));const{data:{user:d},error:u}=await he.auth.getUser();if(u||!d){console.error("User not authenticated");return}const{error:f}=await he.from("creators").update({agency_name:l.agency_name,contact_email:l.current_user_email,updated_at:new Date().toISOString()}).eq("user_id",d.id);f&&console.error("Error saving agency settings:",f)}catch(d){console.error("Error updating agency settings:",d)}}};return a.jsx(Ux.Provider,{value:c,children:e})},Lh=()=>!1;const Mr=()=>{const[e,t]=L.useState({user:null,loading:!0,error:null});return L.useEffect(()=>{(async()=>{try{if(window.location.pathname.startsWith("/client/")){console.log(" [useAuth] Skipping auto-login for public client portal"),t({user:null,loading:!1,error:null});return}Lh();const{data:{session:c},error:l}=await he.auth.getSession();if(l){console.error("Error getting session:",l),t(d=>({...d,loading:!1,error:l.message}));return}t({user:(c==null?void 0:c.user)||null,loading:!1,error:null})}catch(c){console.error("Error in getInitialSession:",c),t(l=>({...l,loading:!1,error:c instanceof Error?c.message:"Unknown error"}))}})();const{data:{subscription:o}}=he.auth.onAuthStateChange(async(c,l)=>{var d;console.log("Auth state changed:",c,(d=l==null?void 0:l.user)==null?void 0:d.id),t({user:(l==null?void 0:l.user)||null,loading:!1,error:null})});return()=>{o.unsubscribe()}},[]),{...e,signUp:async(i,o,c)=>{try{t(u=>({...u,loading:!0,error:null}));const{data:l,error:d}=await he.auth.signUp({email:i,password:o,options:{data:c}});return d?(t(u=>({...u,loading:!1,error:d.message})),{data:null,error:d}):(t(u=>({...u,loading:!1})),{data:l,error:null})}catch(l){const d=l instanceof Error?l.message:"Unknown error";return t(u=>({...u,loading:!1,error:d})),{data:null,error:{message:d}}}},signIn:async(i,o)=>{try{t(d=>({...d,loading:!0,error:null})),Lh();const{data:c,error:l}=await he.auth.signInWithPassword({email:i,password:o});return l?(t(d=>({...d,loading:!1,error:l.message})),{data:null,error:l}):(t(d=>({...d,loading:!1})),{data:c,error:null})}catch(c){const l=c instanceof Error?c.message:"Unknown error";return t(d=>({...d,loading:!1,error:l})),{data:null,error:{message:l}}}},signOut:async()=>{try{t(o=>({...o,loading:!0,error:null}));const{error:i}=await he.auth.signOut();return i?(t(o=>({...o,loading:!1,error:i.message})),{error:i}):(t(o=>({...o,loading:!1})),{error:null})}catch(i){const o=i instanceof Error?i.message:"Unknown error";return t(c=>({...c,loading:!1,error:o})),{error:{message:o}}}}}},Bx=L.createContext(void 0),Gx=()=>{const e=L.useContext(Bx);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},BN=({children:e})=>{const[t,r]=L.useState([]),{user:s}=Mr(),{toast:n}=vt(),i=t.filter(h=>!h.read).length;L.useEffect(()=>{s!=null&&s.id&&(console.log("[NotificationProvider] Clearing all notifications for user:",s.id),Object.keys(localStorage).forEach(h=>{h.startsWith("notifications_")&&localStorage.removeItem(h)}),r([]),console.log("[NotificationProvider] All notifications cleared"))},[s==null?void 0:s.id]),L.useEffect(()=>{s!=null&&s.id&&t.length>0&&localStorage.setItem(`notifications_${s.id}`,JSON.stringify(t))},[t,s==null?void 0:s.id]);const o=L.useCallback(h=>{const m={...h,id:`notification_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,read:!1,created_at:new Date().toISOString()};r(g=>[m,...g]),n({title:m.title,description:m.message,variant:m.priority==="urgent"?"destructive":"default"}),"Notification"in window&&Notification.permission==="granted"&&new Notification(m.title,{body:m.message,icon:"/favicon.ico"})},[n]),c=L.useCallback(h=>{r(m=>m.map(g=>g.id===h?{...g,read:!0}:g))},[]),l=L.useCallback(()=>{r(h=>h.map(m=>({...m,read:!0})))},[]),d=L.useCallback(h=>{r(m=>m.filter(g=>g.id!==h))},[]),u=L.useCallback(()=>{console.log("[NotificationProvider] Manually clearing all notifications"),r([]),s!=null&&s.id&&localStorage.removeItem(`notifications_${s.id}`),Object.keys(localStorage).forEach(h=>{h.startsWith("notifications_")&&localStorage.removeItem(h)}),console.log("[NotificationProvider] All notifications cleared manually")},[s==null?void 0:s.id]);L.useEffect(()=>{if(!(s!=null&&s.id))return;if(window.location.pathname.startsWith("/client/")){console.log("[NotificationProvider] Skipping notification setup for public client portal");return}console.log("[NotificationProvider] Setting up notifications for user:",s.id);const h=he.channel("requests-channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"requests"},async m=>{var y,w;console.log("NEW REQUEST DETECTED:",m.new);const g=m.new,{data:p}=await he.from("projects").select(`
              id,
              end_clients!inner(
                creator_id,
                creators!inner(user_id)
              )
            `).eq("id",g.project_id).single();if(!p){console.log("Project not found for request");return}if(((w=(y=p.end_clients)==null?void 0:y.creators)==null?void 0:w.user_id)!==s.id){console.log("Request not for this creator");return}o({type:"request",title:"New Client Request",message:`${g.title} - ${g.description}`,data:{requestId:g.id,projectId:g.project_id,clientId:g.end_client_id},priority:"medium"}),console.log(" NOTIFICATION CREATED FOR REQUEST:",g.title)}).subscribe();return"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission(),()=>{console.log("[NotificationProvider] Cleaning up real-time subscriptions"),he.removeChannel(h)}},[s==null?void 0:s.id,o]),L.useEffect(()=>{typeof window<"u"&&(window.testNotification=()=>{console.log("[NotificationProvider] Manual test notification triggered"),o({type:"request",title:"Test Notification",message:"This is a test notification to verify the system works",data:{test:!0},priority:"medium"})})},[o]);const f={notifications:t,unreadCount:i,markAsRead:c,markAllAsRead:l,clearNotification:d,clearAllNotifications:u,addNotification:o};return a.jsx(Bx.Provider,{value:f,children:e})};class Ri extends L.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("ErrorBoundary caught error:",t,r)}render(){return this.state.hasError?this.props.fallback||a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Something went wrong"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"We're sorry for the inconvenience. Please refresh the page."}),a.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Refresh Page"})]})}):this.props.children}}const oe=L.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:Ie("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));oe.displayName="Card";const ye=L.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:Ie("flex flex-col space-y-1.5 p-6",e),...t}));ye.displayName="CardHeader";const we=L.forwardRef(({className:e,...t},r)=>a.jsx("h3",{ref:r,className:Ie("text-2xl font-semibold leading-none tracking-tight",e),...t}));we.displayName="CardTitle";const He=L.forwardRef(({className:e,...t},r)=>a.jsx("p",{ref:r,className:Ie("text-sm text-muted-foreground",e),...t}));He.displayName="CardDescription";const de=L.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:Ie("p-6 pt-0",e),...t}));de.displayName="CardContent";const Vx=L.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:Ie("flex items-center p-6 pt-0",e),...t}));Vx.displayName="CardFooter";const vu=wo("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),le=L.forwardRef(({className:e,variant:t,size:r,asChild:s=!1,...n},i)=>{const o=s?Zw:"button";return a.jsx(o,{className:Ie(vu({variant:t,size:r,className:e})),ref:i,...n})});le.displayName="Button";const Nn=({children:e,requiredRole:t})=>{const{user:r,loading:s}=Mr(),[n,i]=L.useState(!0),[o,c]=L.useState(null),[l,d]=L.useState(null);return L.useEffect(()=>{const u=async()=>{if(!r||!t){c(!0),i(!1);return}try{if(t==="admin"){const{data:h,error:m}=await he.rpc("check_user_admin_status",{user_id:r.id});m?(console.error("Error checking admin status:",m),d("Failed to verify admin status"),c(!1)):c(h===!0)}else if(t==="creator"){const{data:h,error:m}=await he.from("creators").select("id").eq("user_id",r.id).single();m&&m.code!=="PGRST116"?(console.error("Error checking creator status:",m),d("Failed to verify creator status"),c(!1)):c(!!h)}else c(!0)}catch(h){console.error("Error in role check:",h),d("Failed to verify user role"),c(!1)}finally{i(!1)}},f=setTimeout(()=>{u()},500);return()=>clearTimeout(f)},[r,t]),s||n?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center",children:[a.jsx(De,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})}):r?l?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:a.jsxs(oe,{className:"w-full max-w-md",children:[a.jsxs(ye,{className:"text-center",children:[a.jsx(Ki,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),a.jsx(we,{className:"text-destructive",children:"Access Verification Failed"})]}),a.jsxs(de,{className:"text-center space-y-4",children:[a.jsx("p",{className:"text-muted-foreground",children:"Unable to verify your access level. Please try again or contact support."}),a.jsx(le,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full",children:"Retry"})]})]})}):o===!1?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:a.jsxs(oe,{className:"w-full max-w-md",children:[a.jsxs(ye,{className:"text-center",children:[a.jsx(Ki,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),a.jsx(we,{className:"text-destructive",children:"Access Denied"})]}),a.jsxs(de,{className:"text-center space-y-4",children:[a.jsx("p",{className:"text-muted-foreground",children:"You don't have the required permissions to access this area."}),a.jsx(le,{onClick:()=>window.history.back(),variant:"outline",className:"w-full",children:"Go Back"})]})]})}):a.jsx(a.Fragment,{children:e}):a.jsx(q0,{to:"/auth",replace:!0})},GN=({children:e})=>{const{user:t,loading:r}=Mr(),[s,n]=L.useState(!0),[i,o]=L.useState(!1),[c,l]=L.useState(null);return L.useEffect(()=>{const d=async()=>{if(!t){n(!1);return}try{const{data:f,error:h}=await he.rpc("check_user_admin_status",{user_id:t.id});h?(console.error("Error checking admin status:",h),l("Failed to verify admin status"),o(!1)):o(f===!0)}catch(f){console.error("Error in admin check:",f),l("Failed to verify admin status"),o(!1)}finally{n(!1)}},u=setTimeout(()=>{d()},500);return()=>clearTimeout(u)},[t]),r||s?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center",children:[a.jsx(De,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Verifying admin access..."})]})}):t?c?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:a.jsxs(oe,{className:"w-full max-w-md",children:[a.jsxs(ye,{className:"text-center",children:[a.jsx(Ki,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),a.jsx(we,{className:"text-destructive",children:"Access Verification Failed"})]}),a.jsxs(de,{className:"text-center space-y-4",children:[a.jsx("p",{className:"text-muted-foreground",children:"Unable to verify your admin status. Please try again or contact support."}),a.jsx(le,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full",children:"Retry"})]})]})}):i?a.jsx(a.Fragment,{children:e}):a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:a.jsxs(oe,{className:"w-full max-w-md",children:[a.jsxs(ye,{className:"text-center",children:[a.jsx(Ki,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),a.jsx(we,{className:"text-destructive",children:"Access Denied"})]}),a.jsxs(de,{className:"text-center space-y-4",children:[a.jsx("p",{className:"text-muted-foreground",children:"You don't have permission to access the admin panel. Only administrators can view this area."}),a.jsx(le,{onClick:()=>window.history.back(),variant:"outline",className:"w-full",children:"Go Back"})]})]})}):a.jsx(q0,{to:"/auth",replace:!0})},VN=()=>(Te.useState(!0),null),Fh=L.lazy(()=>ma(()=>Promise.resolve().then(()=>OH),void 0)),HN=L.lazy(()=>ma(()=>Promise.resolve().then(()=>DH),void 0)),qN=L.lazy(()=>ma(()=>Promise.resolve().then(()=>FH),void 0)),WN=L.lazy(()=>ma(()=>Promise.resolve().then(()=>GH),void 0)),zN=L.lazy(()=>ma(()=>Promise.resolve().then(()=>HH),void 0)),YN=L.lazy(()=>ma(()=>Promise.resolve().then(()=>WH),void 0)),KN=L.lazy(()=>ma(()=>Promise.resolve().then(()=>KH),void 0)),XN=L.lazy(()=>ma(()=>Promise.resolve().then(()=>Vw),void 0)),QN=L.lazy(()=>ma(()=>Promise.resolve().then(()=>Vw),void 0)),Mh=L.lazy(()=>ma(()=>Promise.resolve().then(()=>ZH),void 0)),JN=()=>a.jsx(e_,{client:uN,children:a.jsxs(Zg,{children:[a.jsx(hb,{}),a.jsx(qb,{}),a.jsx(VN,{}),a.jsx(Ri,{children:a.jsx(t_,{children:a.jsx($x,{children:a.jsx(BN,{children:a.jsx(L.Suspense,{fallback:a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}),children:a.jsxs(r_,{children:[a.jsx(Ur,{path:"/auth",element:a.jsx(qN,{})}),a.jsx(Ur,{path:"/pricing",element:a.jsx(Nn,{requiredRole:"creator",children:a.jsx(zN,{})})}),a.jsx(Ur,{path:"/billing",element:a.jsx(Nn,{requiredRole:"creator",children:a.jsx(YN,{})})}),a.jsx(Ur,{path:"/",element:a.jsx(Ri,{fallback:a.jsx("div",{className:"p-4 text-center",children:"Dashboard Error - Please refresh the page"}),children:a.jsx(Nn,{children:a.jsx(Fh,{})})})}),a.jsx(Ur,{path:"/dashboard",element:a.jsx(Ri,{fallback:a.jsx("div",{className:"p-4 text-center",children:"Dashboard Error - Please refresh the page"}),children:a.jsx(Nn,{children:a.jsx(Fh,{})})})}),a.jsx(Ur,{path:"/client/:projectId",element:a.jsx(Mh,{})}),a.jsx(Ur,{path:"/client/:projectId/dashboard",element:a.jsx(Mh,{})}),a.jsx(Ur,{path:"/test-client/:projectId",element:a.jsx(QN,{})}),a.jsx(Ur,{path:"/test-portal",element:a.jsx(Nn,{children:a.jsx(XN,{})})}),a.jsx(Ur,{path:"/admin",element:a.jsx(Ri,{fallback:a.jsx("div",{className:"p-4 text-center",children:"Admin Panel Error - Please refresh the page"}),children:a.jsx(GN,{children:a.jsx(KN,{})})})}),a.jsx(Ur,{path:"/portal/:projectId",element:a.jsx(Nn,{children:a.jsx(WN,{})})}),a.jsx(Ur,{path:"*",element:a.jsx(HN,{})})]})})})})})})]})}),ZN=()=>{const e={environment:{isLocal:window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1",isProduction:!0,hostname:window.location.hostname,protocol:window.location.protocol,port:window.location.port,pathname:window.location.pathname},assets:{basePath:"/",viteEnv:"production"},supabase:{url:"Set",key:"Set"},errors:[],warnings:[]};return console.log(" Running deployment diagnostics..."),console.log("Environment:",e.environment),console.log("Assets:",e.assets),console.log("Supabase:",e.supabase),e.environment.pathname!=="/"&&!e.environment.isLocal&&e.warnings.push("App is running in a subdirectory - check base path configuration"),e.environment.protocol!=="https:"&&e.warnings.push("Production app is not using HTTPS"),Array.from(document.querySelectorAll('script[type="module"]')).some(i=>i.src.includes("/assets/"))?console.log(" Main application script detected"):e.errors.push("Unable to locate bundled application script tag"),Array.from(document.querySelectorAll('link[rel="stylesheet"]')).some(i=>i.href.includes("/assets/"))?console.log(" Main CSS file detected"):e.errors.push("Unable to locate bundled stylesheet link tag"),e.errors.length>0&&console.error(" Deployment errors found:",e.errors),e.warnings.length>0&&console.warn(" Deployment warnings:",e.warnings),e};console.log(" Main.tsx loaded successfully");const ej=()=>{const e=document.querySelector('link[rel="shortcut icon"]');e&&(e.href="/favicon.ico?v="+Date.now());const t=document.querySelector('link[rel="icon"][type="image/png"]');t&&(t.href="/favicon-96x96.png?v="+Date.now());const r=document.querySelector('link[rel="icon"][type="image/svg+xml"]');r&&(r.href="/favicon.svg?v="+Date.now())};ej();ma(async()=>{const{registerServiceWorker:e,setupOfflineDetection:t}=await Promise.resolve().then(()=>RH);return{registerServiceWorker:e,setupOfflineDetection:t}},void 0).then(({registerServiceWorker:e,setupOfflineDetection:t})=>{e(),t()}).catch(e=>{console.warn("PWA utils not available:",e)});ZN();try{console.log(" Attempting to render App component...");const e=document.getElementById("root");if(!e)throw new Error("Root element not found");a_(e).render(a.jsx(Ri,{children:a.jsx(JN,{})})),console.log(" App rendered successfully")}catch(e){console.error(" Failed to render app:",e);const t=document.getElementById("root");t&&(t.innerHTML=`
      <div style="padding: 20px; font-family: Arial, sans-serif;">
        <h1>App Loading Error</h1>
        <p>There was an error loading the application.</p>
        <p>Error: ${e.message}</p>
        <button onclick="window.location.reload()">Reload Page</button>
      </div>
    `)}const Z={NAVIGATION:{PROJECTS:"Projects",CLIENT_REQUESTS:"Client Requests",MEDIA_LIBRARY:"Media Library",ACADEMY:"Academy",ANALYTICS:"Analytics",PROMOTIONS:"Promotions",CHATBOTS:"Chatbots",SUPPORT:"Support",SETTINGS:"Settings"},REQUEST_TYPES:{HOTSPOT:"Add Hotspot",SCAN:"New Scan and Virtual Tour Creation",INTERACTIVE:"Interactive Point",MODIFY:"Modify Existing Content",OTHER:"Other"},REQUEST_TYPE_VALUES:{HOTSPOT:"hotspot",SCAN:"scan",INTERACTIVE:"interactive",MODIFY:"modify",OTHER:"other"},PRIORITY:{NORMAL:"Normal",URGENT:"Urgent"},STATUS:{IN_PROGRESS:"In Progress",COMPLETED:"Completed",SUSPENDED:"Suspended",OPEN:"Open",RESOLVED:"Resolved",CONFIRMED:"Confirmed",TO_CONFIRM:"To Confirm",CANCELLED:"Cancelled"},STATUS_VALUES:{IN_PROGRESS:"in_progress",COMPLETED:"completed",SUSPENDED:"suspended",OPEN:"open",RESOLVED:"resolved",CONFIRMED:"confirmed",TO_CONFIRM:"to_confirm",CANCELLED:"cancelled"},APPOINTMENT_TYPES:{SITE_VISIT:"Site Visit",DELIVERY:"Delivery",PRESENTATION:"Presentation",OTHER:"Other"},APPOINTMENT_TYPE_VALUES:{SITE_VISIT:"site_visit",DELIVERY:"delivery",PRESENTATION:"presentation",OTHER:"other"},SUPPORT_SUBJECTS:{TECHNICAL_SUPPORT:"Technical Support",PROJECT_CREATION:"Project Creation Help",CLIENT_PORTAL:"Client Portal Issues",CHATBOT_SETUP:"Chatbot Setup & Configuration",PAYMENT_BILLING:"Payment & Billing",ACCOUNT_MANAGEMENT:"Account Management",FEATURE_REQUEST:"Feature Request",OTHER:"Other"},SUPPORT_SUBJECT_VALUES:{TECHNICAL_SUPPORT:"technical_support",PROJECT_CREATION:"project_creation",CLIENT_PORTAL:"client_portal",CHATBOT_SETUP:"chatbot_setup",PAYMENT_BILLING:"payment_billing",ACCOUNT_MANAGEMENT:"account_management",FEATURE_REQUEST:"feature_request",OTHER:"other"},FORMS:{REQUEST_TITLE:"Request Title",DETAILED_DESCRIPTION:"Detailed Description",CLIENT_PROJECT_NAME:"Client/Project Name",REQUEST_TYPE:"Request Type",PRIORITY:"Priority",SUBJECT:"Subject",MESSAGE:"Message",SELECT_REQUEST_TYPE:"Select request type",DESCRIBE_REQUEST:"Describe your request here..."},PLACEHOLDERS:{REQUEST_TITLE_EXAMPLE:'E.g. "Showroom update - move sofa"',DESCRIPTION_EXAMPLE:"Explain exactly what you would like to change...",CLIENT_NAME_EXAMPLE:'E.g. "Smith-John" or "ShowroomMilan"',HOTSPOT_DESCRIPTION:"Hotspot {number} - describe the position"},BUTTONS:{NEW_REQUEST:"New Request",SEND_REQUEST:"Send Request",CANCEL:"Cancel",ADD_HOTSPOT:"Add Hotspot",SEND_MESSAGE:"Send Message",SENDING:"Sending...",SAVE:"Save",DELETE:"Delete",EDIT:"Edit",VIEW:"View",DOWNLOAD:"Download",UPLOAD:"Upload",CONNECT:"Connect",DISCONNECT:"Disconnect"},HEADERS:{REQUESTS_AND_UPDATES:"Requests and Updates",REQUEST_HISTORY:"Request History",SUPPORT_ASSISTANCE:"Support & Assistance",CONTACT_US_DIRECTLY:"Contact Us Directly",QUICK_ANSWERS_FAQ:"Quick Answers (FAQ)",YOUR_SUPPORT_REQUESTS:"Your Support Requests",GUIDES_ALTERNATIVE_CONTACTS:"Guides and Alternative Contacts",NEW_REQUEST:"New Request",SETTINGS:"Settings"},DESCRIPTIONS:{REQUESTS_SUBTITLE:"Send new requests or check the status of existing ones.",NEED_UPDATE:"Need an update?",REQUEST_DESCRIPTION:"Create a new request to add hotspots, modify content, or request a new scan.",SUPPORT_SUBTITLE:"Need help? Contact us or check our resources.",CONTACT_DESCRIPTION:"Fill out the form to send us a message. We'll respond as soon as possible.",SETTINGS_DESCRIPTION:"Manage your account software credentials."},FILE_UPLOAD:{ATTACH_FILES_DROPBOX:"Share files via cloud storage",UPLOAD_FILES_SECURELY:"Share your files securely via Google Drive, Dropbox, or WeTransfer",FILES_AUTO_ORGANIZED:"Files will be automatically organized for your request",OPEN_DROPBOX_REQUEST:"Share Files via Cloud Storage",FILE_NAMING_INSTRUCTIONS:"File sharing instructions:",FILL_CLIENT_TYPE_FIRST:'Fill in "Client/Project Name" and "Request Type" first to generate correct instructions',ALWAYS_START_FILENAME:"Always start the filename with:",EXAMPLE_FILENAME:'Example: "HOTSPOT_Smith-John_REQ-123_kitchen-photo.jpg"'},HOTSPOTS:{REQUESTED_HOTSPOTS:"Requested Hotspots (optional)"},FILTERS:{ALL_TYPES:"All types",ALL_STATUSES:"All statuses",TYPE:"Type",STATUS:"Status"},FAQ:{CREATE_FIRST_PROJECT_QUESTION:"How do I create my first virtual tour project?",CREATE_FIRST_PROJECT_ANSWER:'Go to the Projects section and click "Create New Project". Fill in the project details, select a client, choose the project type (Virtual Tour, 3D Showcase, or Interactive Map), and add a description. Your project will be created and ready for customization.',CLIENT_PORTAL_ACCESS_QUESTION:"How do my clients access their portal?",CLIENT_PORTAL_ACCESS_ANSWER:"After creating a project, you can share the client portal link with your clients. They can use this link to view their projects, submit requests, and interact with chatbots. The portal is automatically generated for each project.",CHATBOT_SETUP_QUESTION:"How do I set up a chatbot for my client?",CHATBOT_SETUP_ANSWER:`Go to the Chatbots section, click "Create Client Chatbot", and fill in the client information. Configure the chatbot's knowledge base, customize its appearance to match your client's brand, and activate it. The chatbot will automatically appear on your client's portal.`,REQUEST_TYPES_QUESTION:"What types of requests can clients submit?",REQUEST_TYPES_ANSWER:"Clients can submit various types of requests: Hotspot Updates (add interactive points), Content Changes (modify text/images), Design Modifications (change layout/styling), New Features (request additional functionality), and Bug Fixes (report issues).",NOTIFICATIONS_QUESTION:"How do I get notified about new client requests?",NOTIFICATIONS_ANSWER:`You'll receive real-time notifications through the notification bell in the top navigation. Click the bell to see recent requests, or click "See All Notifications" to view the full notification panel with search and filtering options.`,PROJECT_SHARING_QUESTION:"How do I share a project with my client?",PROJECT_SHARING_ANSWER:'Each project has a unique sharing link that you can send to your client. Go to the project details, click "Share Client Portal", and copy the generated link. Your client can use this link to access their dedicated portal.'},CONTACT:{DIRECT_EMAIL:"Direct Email",CALL_SUPPORT:"Call Support",PRIORITY:"Priority:"},TOAST:{SUCCESS:"Success",ERROR:"Error",REQUEST_CREATED:"Request Created",REQUEST_CREATED_DESCRIPTION:"Your request has been created successfully.",REQUEST_SENT:"Request Sent",REQUEST_SENT_DESCRIPTION:"Your support request has been sent successfully.",APPOINTMENT_CREATED:"Appointment Created",APPOINTMENT_CREATED_DESCRIPTION:"Appointment created successfully",APPOINTMENT_UPDATED:"Appointment Updated",APPOINTMENT_UPDATED_DESCRIPTION:"Appointment updated successfully",APPOINTMENT_DELETED:"Appointment Deleted",APPOINTMENT_DELETED_DESCRIPTION:"Appointment deleted successfully",ERROR_OCCURRED:"An error occurred while creating the request.",ERROR_LOADING_APPOINTMENTS:"Error loading appointments",ERROR_CREATING_APPOINTMENT:"Error creating appointment",ERROR_UPDATING_APPOINTMENT:"Error updating appointment",ERROR_DELETING_APPOINTMENT:"Error deleting appointment"},EMPTY_STATES:{NO_REQUESTS_FOUND:"No requests found",NO_REQUESTS_DESCRIPTION:"Your previous requests will appear here"},DATE_TIME:{CLIENT:"Client:",NOT_SPECIFIED:"Not specified"},THEME:{SWITCH_TO_DARK:"Switch to dark theme",SWITCH_TO_LIGHT:"Switch to light theme"},SETTINGS:{MANAGE_ACCOUNT:"Manage Account"},CHATBOT:{CHATBOT_MANAGEMENT:"Chatbot Management",CREATE_CHATBOT:"Create Chatbot",EDIT_CHATBOT:"Edit Chatbot",CHATBOT_DETAILS:"Chatbot Details",CHATBOT_STATISTICS:"Statistics",CHATBOT_CONFIGURATION:"Configuration",BASIC_INFO:"Basic Information",CHATBOT_NAME:"Chatbot Name",DESCRIPTION:"Description",LANGUAGE:"Language",WELCOME_MESSAGE:"Welcome Message",FALLBACK_MESSAGE:"Fallback Message",DESIGN_CUSTOMIZATION:"Design Customization",PRIMARY_COLOR:"Primary Color",WIDGET_STYLE:"Widget Style",POSITION:"Position",AVATAR:"Avatar",BRAND_LOGO:"Brand Logo",KNOWLEDGE_BASE:"Knowledge Base",PASTED_TEXT:"Pasted Text",FILE_UPLOADS:"File Sharing",UPLOAD_FILES:"Share Files",DRAG_DROP_FILES:"Share files via Google Drive, Dropbox, or WeTransfer",RESPONSE_SETTINGS:"Response Settings",RESPONSE_STYLE:"Response Style",MAX_QUESTIONS:"Max Questions",CONVERSATION_LIMIT:"Conversation Limit",TOTAL_CONVERSATIONS:"Total Conversations",ACTIVE_USERS:"Active Users",RESPONSE_TIME:"Response Time",SATISFACTION_RATE:"Satisfaction Rate",AVG_RESPONSE_TIME:"Avg Response Time",CREATE:"Create",UPDATE:"Update",DELETE:"Delete",DUPLICATE:"Duplicate",PREVIEW:"Preview",ACTIVATE:"Activate",DEACTIVATE:"Deactivate",ACTIVE:"Active",INACTIVE:"Inactive",DRAFT:"Draft",CHATBOT_LIMIT_REACHED:"You have reached the maximum limit of 5 chatbots",UPGRADE_TO_CREATE_MORE:"Upgrade your plan to create more chatbots",ENTER_CHATBOT_NAME:"Enter chatbot name",ENTER_DESCRIPTION:"Enter chatbot description",ENTER_WELCOME_MESSAGE:"Enter welcome message",ENTER_FALLBACK_MESSAGE:"Enter fallback message",PASTE_KNOWLEDGE_TEXT:"Paste your knowledge base text here",NAME_REQUIRED:"Chatbot name is required",DESCRIPTION_REQUIRED:"Description is required",WELCOME_MESSAGE_REQUIRED:"Welcome message is required",FALLBACK_MESSAGE_REQUIRED:"Fallback message is required",INVALID_COLOR:"Please enter a valid color code",MAX_QUESTIONS_INVALID:"Max questions must be between 1 and 50",CHATBOT_CREATED:"Chatbot Created",CHATBOT_CREATED_DESCRIPTION:"Chatbot has been created successfully",CHATBOT_UPDATED:"Chatbot Updated",CHATBOT_UPDATED_DESCRIPTION:"Chatbot has been updated successfully",CHATBOT_DELETED:"Chatbot Deleted",CHATBOT_DELETED_DESCRIPTION:"Chatbot has been deleted successfully",ERROR_CREATING_CHATBOT:"Error creating chatbot",ERROR_UPDATING_CHATBOT:"Error updating chatbot",ERROR_DELETING_CHATBOT:"Error deleting chatbot",ERROR_LOADING_CHATBOTS:"Error loading chatbots",LANGUAGES:{ENGLISH:"English",SPANISH:"Spanish",FRENCH:"French",GERMAN:"German",ITALIAN:"Italian",PORTUGUESE:"Portuguese",CHINESE:"Chinese",JAPANESE:"Japanese",KOREAN:"Korean",ARABIC:"Arabic"},WIDGET_STYLES:{MODERN:"Modern",CLASSIC:"Classic",MINIMAL:"Minimal",BUBBLE:"Bubble",CARD:"Card"},POSITIONS:{BOTTOM_RIGHT:"Bottom Right",BOTTOM_LEFT:"Bottom Left",TOP_RIGHT:"Top Right",TOP_LEFT:"Top Left",CENTER:"Center"},RESPONSE_STYLES:{FRIENDLY:"Friendly",PROFESSIONAL:"Professional",CASUAL:"Casual",FORMAL:"Formal",HELPFUL:"Helpful"}},ANALYTICS:{PERFORMANCE_ANALYTICS:"Performance Analytics",CONVERSATIONAL_INTELLIGENCE:"Conversational Intelligence",KEY_METRICS:"Key Metrics and Performance Indicators",CHATBOT_INSIGHTS:"Insights from chatbot interactions and lead generation",TOTAL_VIEWS:"Total Views",UNIQUE_VISITORS:"Unique Visitors",TOTAL_CLICKS:"Total Clicks",CONVERSION_RATE:"Conversion Rate",AVG_SESSION_DURATION:"Avg. Session Duration",BOUNCE_RATE:"Bounce Rate",PAGE_VIEWS_DESCRIPTION:"Page views across all projects",DISTINCT_USERS_DESCRIPTION:"Distinct users who visited",INTERACTIVE_CLICKS_DESCRIPTION:"Interactive element clicks",CLICKS_PER_VIEW_DESCRIPTION:"Clicks per view ratio",AVG_TIME_SESSION_DESCRIPTION:"Average time spent per session",SINGLE_PAGE_SESSIONS_DESCRIPTION:"Single-page sessions",LAST_7_DAYS:"Last 7 days",LAST_30_DAYS:"Last 30 days",LAST_90_DAYS:"Last 90 days",LAST_YEAR:"Last year",TOP_ASKED_QUESTIONS:"Top Asked Questions",UNANSWERED_QUESTIONS:"Unanswered Questions",LEADS_GENERATED:"Leads Generated",MOST_FREQUENT_QUESTIONS:"Most frequently asked questions by visitors",QUESTIONS_NEED_ATTENTION:"Questions that need attention",POTENTIAL_CUSTOMERS:"Potential customers from chatbot interactions",SEARCH_QUESTIONS:"Search questions...",ALL_CATEGORIES:"All Categories",CATEGORY:"Category",CATEGORIES:{PRICING:"Pricing",FEATURES:"Features",SUPPORT:"Support",TECHNICAL:"Technical",GENERAL:"General"},LEAD_STATUS:{NEW:"New",CONTACTED:"Contacted",QUALIFIED:"Qualified",CONVERTED:"Converted"},TOTAL_LEADS:"Total Leads",NEW_THIS_WEEK:"New This Week",ASKED_TIMES:"Asked {count} times",COMPANY:"Company",SOURCE:"Source",SCORE:"Score",ANSWER:"Answer",CONTACT:"Contact",NO_QUESTIONS_FOUND:"No questions found",NO_UNANSWERED_QUESTIONS:"No unanswered questions",NO_LEADS_GENERATED:"No leads generated yet",LOADING_ANALYTICS:"Loading analytics data...",LOADING_QUESTIONS:"Loading questions...",LOADING_LEADS:"Loading leads...",ERROR_LOADING_ANALYTICS:"Error loading analytics data",ERROR_LOADING_QUESTIONS:"Error loading questions",ERROR_LOADING_LEADS:"Error loading leads"},ACADEMY:{TRAINING_ACADEMY:"Training",IMPROVE_SKILLS:"Improve your skills with our specialized courses and tutorials",VIDEO_TUTORIALS:"Video Tutorials",PDF_GUIDES:"PDF Guides",TOTAL_CONTENT:"Total Content",VIDEO_TUTORIALS_SECTION:"Video Tutorials",VIDEO_TUTORIALS_DESCRIPTION:"Learn step-by-step with our professional video tutorials",PDF_GUIDES_SECTION:"PDF Guides",PDF_GUIDES_DESCRIPTION:"Download comprehensive guides for offline reference",LEVELS:{BEGINNER:"Beginner",INTERMEDIATE:"Intermediate",ADVANCED:"Advanced"},WATCH_VIDEO:"Watch Video",DOWNLOAD_GUIDE:"Download Guide",REQUEST_CONSULTATION:"Request Consultation",CONTACT_SUPPORT:"Contact Support",NEED_PERSONALIZED_SUPPORT:"Need personalized support?",CONTACT_FOR_TRAINING:"Contact us for one-to-one training sessions or specific business consultations",TUTORIALS:{PLATFORM_OVERVIEW:"Platform Overview & Getting Started",PROJECT_MANAGEMENT:"Project Management Best Practices",CLIENT_PORTAL_SETUP:"Setting Up Client Portals",CHATBOT_CONFIGURATION:"Chatbot Configuration & Customization",ANALYTICS_INSIGHTS:"Understanding Analytics & Insights",NOTIFICATION_SYSTEM:"Managing Notifications & Requests"},GUIDES:{QUICK_START_GUIDE:"Quick Start Guide for Tour Creators",CLIENT_MANAGEMENT:"Client Management & Communication",CHATBOT_BEST_PRACTICES:"Chatbot Best Practices & Optimization",ANALYTICS_GUIDE:"Analytics & Performance Tracking",PLATFORM_FEATURES:"Complete Platform Features Guide"}},PROJECTS:{PROJECTS:"Projects",YOUR_PROJECTS:"Your Projects",MANAGE_PROJECTS:"Manage and view all your virtual tour projects",CREATE_NEW_PROJECT:"Create New Project",EDIT_PROJECT:"Edit Project",PROJECT_TITLE:"Project Title",DESCRIPTION:"Description",CLIENT_NAME:"Client Name",PROJECT_TYPE:"Project Type",THUMBNAIL_URL:"Thumbnail URL",STATUS:"Status",VIEWS:"Views",TYPE:"Type",NO_THUMBNAIL:"No Thumbnail",PROJECT_TYPES:{VIRTUAL_TOUR:"Virtual Tour",SCAN_3D:"3D Scan",INTERACTIVE_MEDIA:"Interactive Media"},STATUS_LABELS:{ACTIVE:"Active",INACTIVE:"Inactive",DRAFT:"Draft"},NEW_PROJECT:"New Project",CREATE:"Create",UPDATE:"Update",CANCEL:"Cancel",VIEW:"View",EDIT:"Edit",DELETE:"Delete",REQUEST:"Request",FILTER_BY_STATUS:"Filter by status",ALL_PROJECTS:"All Projects",NO_PROJECTS_YET:"No projects yet",CREATE_FIRST_PROJECT:"Create your first virtual tour project to get started.",ENTER_PROJECT_TITLE:"Enter project title",ENTER_DESCRIPTION:"Enter project description",ENTER_CLIENT_NAME:"Enter client name",ENTER_THUMBNAIL_URL:"Enter thumbnail URL",SELECT_TYPE:"Select type",SELECT_STATUS:"Select status",PROJECT_CREATED:"Project created",PROJECT_CREATED_DESCRIPTION:"The project has been created successfully.",PROJECT_UPDATED:"Project updated",PROJECT_UPDATED_DESCRIPTION:"The project has been updated successfully.",PROJECT_DELETED:"Project deleted",PROJECT_DELETED_DESCRIPTION:"The project has been deleted successfully.",ERROR_SAVING_PROJECT:"An error occurred while saving the project.",ERROR_DELETING_PROJECT:"An error occurred while deleting the project.",ERROR_LOADING_PROJECTS:"Error loading projects"},SETTINGS_PAGE:{SETTINGS:"Settings",MANAGE_ACCOUNT:"Manage your account, integrations, and API access.",PROFILE:"Profile",BILLING:"Billing",INTEGRATIONS:"Integrations",SECURITY:"Security",AGENCY_PROFILE:"Agency Profile",MANAGE_AGENCY_INFO:"Manage your agency information and branding",AGENCY_NAME:"Agency Name",CONTACT_EMAIL:"Contact Email",PHONE:"Phone",WEBSITE:"Website",AGENCY_LOGO:"Agency Logo",ADDRESS:"Address",DESCRIPTION:"Description",SAVE_PROFILE:"Save Profile",ENTER_AGENCY_NAME:"Enter agency name",ENTER_CONTACT_EMAIL:"Enter contact email",ENTER_PHONE:"Enter phone number",ENTER_WEBSITE:"Enter website URL",ENTER_LOGO_URL:"Enter logo URL",ENTER_ADDRESS:"Enter agency address",ENTER_DESCRIPTION:"Enter agency description",BILLING_SUBSCRIPTION:"Billing & Subscription",MANAGE_SUBSCRIPTION:"Manage your subscription and billing information",CURRENT_PLAN:"Current Plan",PROFESSIONAL_PLAN:"Professional Plan - $99/month",ACTIVE:"Active",MANAGE_PAYMENT_METHODS:"Manage Payment Methods",VIEW_BILLING_HISTORY:"View Billing History",USAGE_THIS_MONTH:"Usage This Month",PROJECTS:"Projects",STORAGE:"Storage",API_CALLS:"API Calls",INTEGRATIONS_TITLE:"Integrations",CONNECT_SERVICES:"Connect external services to enhance your workflow",GOOGLE_CALENDAR:"Google Calendar",SYNC_APPOINTMENTS:"Sync appointments and events",REALSEE_OAUTH:"Realsee (OAuth)",SECURE_CONNECTION:"Secure connection to Realsee platform",STRIPE:"Stripe",PAYMENT_PROCESSING:"Payment processing and billing",CONNECTED:"Connected",CONNECT:"Connect",WEBHOOK_URL:"Webhook URL",ENTER_WEBHOOK_URL:"Enter webhook URL for notifications",SAVE_INTEGRATIONS:"Save Integrations",SECURITY_TITLE:"Security",MANAGE_SECURITY:"Manage your security settings and API access",API_KEYS:"API Keys",MANAGE_API_KEYS:"Manage API keys for programmatic access",ENTER_API_KEY_NAME:"Enter API key name",GENERATE_KEY:"Generate Key",GENERATING:"Generating...",NO_API_KEYS:"No API keys generated yet",CREATED:"Created",LAST_USED:"Last used",DELETE:"Delete",PROFILE_UPDATED:"Profile Updated",PROFILE_UPDATED_DESCRIPTION:"Your agency settings have been saved successfully.",INTEGRATIONS_UPDATED:"Integrations Updated",INTEGRATIONS_UPDATED_DESCRIPTION:"Your integration settings have been saved successfully.",GOOGLE_CALENDAR_CONNECTED:"Google Calendar Connected",GOOGLE_CALENDAR_CONNECTED_DESCRIPTION:"Your Google Calendar has been successfully connected.",REALSEE_CONNECTED:"Realsee Connected",REALSEE_CONNECTED_DESCRIPTION:"Your Realsee account has been successfully connected via OAuth.",STRIPE_CONNECTED:"Stripe Connected",STRIPE_CONNECTED_DESCRIPTION:"Your Stripe account has been successfully connected.",API_KEY_GENERATED:"API Key Generated",API_KEY_GENERATED_DESCRIPTION:"Your new API key has been generated successfully.",API_KEY_DELETED:"API Key Deleted",API_KEY_DELETED_DESCRIPTION:"The API key has been deleted successfully.",ERROR_SAVING_PROFILE:"Failed to save profile settings.",ERROR_SAVING_INTEGRATIONS:"Failed to save integration settings.",ERROR_CONNECTING_GOOGLE:"Failed to connect Google Calendar.",ERROR_CONNECTING_REALSEE:"Failed to connect Realsee account.",ERROR_CONNECTING_STRIPE:"Failed to connect Stripe account.",ERROR_GENERATING_KEY:"Failed to generate API key.",ERROR_DELETING_KEY:"Failed to delete API key.",ENTER_API_KEY_NAME_ERROR:"Please enter a name for the API key."},CHATBOT_MANAGEMENT:{CHATBOT_MANAGEMENT:"Client Chatbot Management",MANAGE_CHATBOTS:"Create and manage AI chatbots for your clients' websites",CREATE_NEW_CHATBOT:"Create Client Chatbot",EDIT_CHATBOT:"Edit Client Chatbot",OVERVIEW:"Overview",CONFIGURATION:"Configuration",KNOWLEDGE_BASE:"Knowledge Base",ANALYTICS:"Analytics",BASIC_INFO:"Client Information",CHATBOT_NAME:"Client Name",DESCRIPTION:"Client Description",LANGUAGE:"Language",WELCOME_MESSAGE:"Welcome Message",FALLBACK_MESSAGE:"Fallback Message",DESIGN_CUSTOMIZATION:"Client Branding",PRIMARY_COLOR:"Brand Color",WIDGET_STYLE:"Widget Style",POSITION:"Position",AVATAR:"Avatar",BRAND_LOGO:"Client Logo",KNOWLEDGE_BASE_TITLE:"Client Knowledge Base",PASTED_TEXT:"Pasted Text",FILE_UPLOADS:"File Sharing",ADD_TEXT:"Add Text",UPLOAD_FILES:"Share Files",RESPONSE_SETTINGS:"Response Settings",RESPONSE_STYLE:"Response Style",MAX_QUESTIONS:"Max Questions",CONVERSATION_LIMIT:"Conversation Limit",STATISTICS:"Statistics",TOTAL_CONVERSATIONS:"Total Conversations",ACTIVE_USERS:"Active Users",RESPONSE_TIME:"Response Time",SATISFACTION_RATE:"Satisfaction Rate",AVG_RESPONSE_TIME:"Avg Response Time",CREATE:"Create",UPDATE:"Update",DELETE:"Delete",SAVE:"Save",CANCEL:"Cancel",TEST:"Test",PREVIEW:"Preview",ACTIVATE:"Activate",DEACTIVATE:"Deactivate",ACTIVE:"Active",INACTIVE:"Inactive",DRAFT:"Draft",LANGUAGES:{ENGLISH:"English",SPANISH:"Spanish",FRENCH:"French",GERMAN:"German",ITALIAN:"Italian",PORTUGUESE:"Portuguese"},WIDGET_STYLES:{MODERN:"Modern",CLASSIC:"Classic",MINIMAL:"Minimal",BUBBLE:"Bubble"},POSITIONS:{BOTTOM_RIGHT:"Bottom Right",BOTTOM_LEFT:"Bottom Left",TOP_RIGHT:"Top Right",TOP_LEFT:"Top Left"},RESPONSE_STYLES:{PROFESSIONAL:"Professional",FRIENDLY:"Friendly",CASUAL:"Casual",FORMAL:"Formal"},ENTER_CHATBOT_NAME:"Enter client name",ENTER_DESCRIPTION:"Enter client description",ENTER_WELCOME_MESSAGE:"Enter welcome message",ENTER_FALLBACK_MESSAGE:"Enter fallback message",SELECT_LANGUAGE:"Select language",SELECT_WIDGET_STYLE:"Select widget style",SELECT_POSITION:"Select position",SELECT_RESPONSE_STYLE:"Select response style",ENTER_MAX_QUESTIONS:"Enter max questions",PASTE_KNOWLEDGE_TEXT:"Paste your knowledge base text here...",DRAG_DROP_FILES:"Drag and drop files here, or click to select",SUPPORTED_FORMATS:"Supported formats: PDF, TXT, DOC, DOCX",MAX_FILE_SIZE:"Max file size: 10MB",NO_CHATBOTS_YET:"No chatbots created yet",CREATE_FIRST_CHATBOT:"Create your first client chatbot to get started",CHATBOT_LIMIT_REACHED:"Chatbot Limit Reached",CHATBOT_LIMIT_WARNING:"chatbots created",CHATBOT_CREATED:"Chatbot Created",CHATBOT_CREATED_DESCRIPTION:"Your client chatbot has been created successfully",CHATBOT_UPDATED:"Chatbot Updated",CHATBOT_UPDATED_DESCRIPTION:"Your client chatbot has been updated successfully",CHATBOT_DELETED:"Chatbot Deleted",CHATBOT_DELETED_DESCRIPTION:"Your client chatbot has been deleted successfully",CHATBOT_ACTIVATED:"Chatbot Activated",CHATBOT_ACTIVATED_DESCRIPTION:"Your client chatbot is now active",CHATBOT_DEACTIVATED:"Chatbot Deactivated",CHATBOT_DEACTIVATED_DESCRIPTION:"Your client chatbot has been deactivated",FILES_UPLOADED:"Files Shared",ERROR_CREATING_CHATBOT:"Failed to create chatbot",ERROR_UPDATING_CHATBOT:"Failed to update chatbot",ERROR_DELETING_CHATBOT:"Failed to delete chatbot",ERROR_UPLOADING_FILES:"Failed to share files",CONVERSATION_ANALYTICS:"Conversation Analytics",USER_ENGAGEMENT:"User Engagement",RESPONSE_PERFORMANCE:"Response Performance",SATISFACTION_METRICS:"Satisfaction Metrics",LAST_7_DAYS:"Last 7 days",LAST_30_DAYS:"Last 30 days",LAST_90_DAYS:"Last 90 days"}},tj=wo("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Le({className:e,variant:t,...r}){return a.jsx("div",{className:Ie(tj({variant:t}),e),...r})}var rj=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},jn=new WeakMap,Uo=new WeakMap,$o={},Ul=0,Hx=function(e){return e&&(e.host||Hx(e.parentNode))},aj=function(e,t){return t.map(function(r){if(e.contains(r))return r;var s=Hx(r);return s&&e.contains(s)?s:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},sj=function(e,t,r,s){var n=aj(t,Array.isArray(e)?e:[e]);$o[r]||($o[r]=new WeakMap);var i=$o[r],o=[],c=new Set,l=new Set(n),d=function(f){!f||c.has(f)||(c.add(f),d(f.parentNode))};n.forEach(d);var u=function(f){!f||l.has(f)||Array.prototype.forEach.call(f.children,function(h){if(c.has(h))u(h);else try{var m=h.getAttribute(s),g=m!==null&&m!=="false",p=(jn.get(h)||0)+1,x=(i.get(h)||0)+1;jn.set(h,p),i.set(h,x),o.push(h),p===1&&g&&Uo.set(h,!0),x===1&&h.setAttribute(r,"true"),g||h.setAttribute(s,"true")}catch(y){console.error("aria-hidden: cannot operate on ",h,y)}})};return u(t),c.clear(),Ul++,function(){o.forEach(function(f){var h=jn.get(f)-1,m=i.get(f)-1;jn.set(f,h),i.set(f,m),h||(Uo.has(f)||f.removeAttribute(s),Uo.delete(f)),m||f.removeAttribute(r)}),Ul--,Ul||(jn=new WeakMap,jn=new WeakMap,Uo=new WeakMap,$o={})}},Tq=function(e,t,r){r===void 0&&(r="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),n=rj(e);return n?(s.push.apply(s,Array.from(n.querySelectorAll("[aria-live]"))),sj(s,n,r,"aria-hidden")):function(){return null}};function $l(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function nj(e,t){var r=L.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(s){var n=r.value;n!==s&&(r.value=s,r.callback(s,n))}}}})[0];return r.callback=t,r.facade}var ij=typeof window<"u"?L.useLayoutEffect:L.useEffect,Uh=new WeakMap;function Eq(e,t){var r=nj(null,function(s){return e.forEach(function(n){return $l(n,s)})});return ij(function(){var s=Uh.get(r);if(s){var n=new Set(s),i=new Set(e),o=r.current;n.forEach(function(c){i.has(c)||$l(c,null)}),i.forEach(function(c){n.has(c)||$l(c,o)})}Uh.set(r,e)},[e]),r}function oj(e){return e}function cj(e,t){t===void 0&&(t=oj);var r=[],s=!1,n={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var o=t(i,s);return r.push(o),function(){r=r.filter(function(c){return c!==o})}},assignSyncMedium:function(i){for(s=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(c){return i(c)},filter:function(){return r}}},assignMedium:function(i){s=!0;var o=[];if(r.length){var c=r;r=[],c.forEach(i),o=r}var l=function(){var u=o;o=[],u.forEach(i)},d=function(){return Promise.resolve().then(l)};d(),r={push:function(u){o.push(u),d()},filter:function(u){return o=o.filter(u),r}}}};return n}function Sq(e){e===void 0&&(e={});var t=cj(null);return t.options=zn({async:!0,ssr:!1},e),t}var qx=function(e){var t=e.sideCar,r=pu(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=t.read();if(!s)throw new Error("Sidecar medium not found");return L.createElement(s,zn({},r))};qx.isSideCarExport=!0;function Aq(e,t){return e.useMedium(t),qx}var Cq=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};const Wx=o_,zx=c_,lj=L.forwardRef(({className:e,inset:t,children:r,...s},n)=>a.jsxs(W0,{ref:n,className:Ie("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...s,children:[r,a.jsx(s_,{className:"ml-auto h-4 w-4"})]}));lj.displayName=W0.displayName;const dj=L.forwardRef(({className:e,...t},r)=>a.jsx(z0,{ref:r,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-background p-1 text-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));dj.displayName=z0.displayName;const yu=L.forwardRef(({className:e,sideOffset:t=4,...r},s)=>a.jsx(n_,{children:a.jsx(Y0,{ref:s,sideOffset:t,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-background p-1 text-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));yu.displayName=Y0.displayName;const Ii=L.forwardRef(({className:e,inset:t,...r},s)=>a.jsx(K0,{ref:s,className:Ie("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));Ii.displayName=K0.displayName;const uj=L.forwardRef(({className:e,children:t,checked:r,...s},n)=>a.jsxs(X0,{ref:n,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...s,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(Q0,{children:a.jsx(Ns,{className:"h-4 w-4"})})}),t]}));uj.displayName=X0.displayName;const fj=L.forwardRef(({className:e,children:t,...r},s)=>a.jsxs(J0,{ref:s,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(Q0,{children:a.jsx(i_,{className:"h-2 w-2 fill-current"})})}),t]}));fj.displayName=J0.displayName;const hj=L.forwardRef(({className:e,inset:t,...r},s)=>a.jsx(Z0,{ref:s,className:Ie("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));hj.displayName=Z0.displayName;const mj=L.forwardRef(({className:e,...t},r)=>a.jsx(eg,{ref:r,className:Ie("-mx-1 my-1 h-px bg-muted",e),...t}));mj.displayName=eg.displayName;const $h=()=>{const{notifications:e,unreadCount:t,markAsRead:r,markAllAsRead:s,clearNotification:n}=Gx(),[i,o]=L.useState(!1),c=u=>{switch(u){case"urgent":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-blue-500";case"low":return"bg-gray-500";default:return"bg-gray-500"}},l=u=>{switch(u){case"request":return"";case"chatbot_request":return"";case"lead":return"";case"system":return"";default:return""}},d=u=>{u.read||r(u.id),o(!1)};return a.jsx(Zg,{children:a.jsxs(Wx,{open:i,onOpenChange:o,children:[a.jsxs(F2,{children:[a.jsx(M2,{asChild:!0,children:a.jsx(zx,{asChild:!0,children:a.jsxs(le,{variant:"ghost",size:"sm",className:"relative",children:[t>0?a.jsx(tg,{className:"h-5 w-5 text-blue-600"}):a.jsx(au,{className:"h-5 w-5"}),t>0&&a.jsx(Le,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs",children:t>99?"99+":t})]})})}),a.jsx(ex,{children:a.jsx("p",{children:t>0?`${t} unread notification${t>1?"s":""}`:"No new notifications"})})]}),a.jsxs(yu,{align:"end",className:"w-80 max-h-96 overflow-y-auto",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border-b",children:[a.jsx("h3",{className:"font-semibold text-sm",children:"Notifications"}),a.jsx("div",{className:"flex items-center gap-1",children:t>0&&a.jsxs(le,{variant:"ghost",size:"sm",onClick:s,className:"h-6 px-2 text-xs",children:[a.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Mark all read"]})})]}),e.length===0?a.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No notifications yet"}):a.jsxs("div",{className:"max-h-80 overflow-y-auto",children:[e.slice(0,5).map(u=>a.jsx("div",{className:`p-3 border-b cursor-pointer hover:bg-gray-50 transition-colors ${u.read?"":"bg-blue-50"}`,onClick:()=>d(u),children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("span",{className:"text-lg",children:l(u.type)})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-900 truncate",children:u.title}),!u.read&&a.jsx("div",{className:`w-2 h-2 rounded-full ${c(u.priority)}`})]}),a.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-2",children:u.message}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs text-gray-400",children:Dg(new Date(u.created_at),{addSuffix:!0})}),a.jsx(le,{variant:"ghost",size:"sm",onClick:f=>{f.stopPropagation(),n(u.id)},className:"h-5 w-5 p-0 text-gray-400 hover:text-red-500",children:a.jsx(yr,{className:"h-3 w-3"})})]})]})]})},u.id)),e.length>5&&a.jsx("div",{className:"p-3 text-center text-xs text-gray-500 border-t",children:"Showing latest 5 notifications"})]})]})]})})},Ue=L.forwardRef(({className:e,type:t,...r},s)=>a.jsx("input",{type:t,className:Ie("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...r}));Ue.displayName="Input";const pt=m_,gt=p_,ct=L.forwardRef(({className:e,children:t,...r},s)=>a.jsxs(rg,{ref:s,className:Ie("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,a.jsx(l_,{asChild:!0,children:a.jsx(su,{className:"h-4 w-4 opacity-50"})})]}));ct.displayName=rg.displayName;const Yx=L.forwardRef(({className:e,...t},r)=>a.jsx(ag,{ref:r,className:Ie("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(sg,{className:"h-4 w-4"})}));Yx.displayName=ag.displayName;const Kx=L.forwardRef(({className:e,...t},r)=>a.jsx(ng,{ref:r,className:Ie("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(su,{className:"h-4 w-4"})}));Kx.displayName=ng.displayName;const lt=L.forwardRef(({className:e,children:t,position:r="popper",...s},n)=>a.jsx(d_,{children:a.jsxs(ig,{ref:n,className:Ie("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-background text-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...s,children:[a.jsx(Yx,{}),a.jsx(u_,{className:Ie("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),a.jsx(Kx,{})]})}));lt.displayName=ig.displayName;const pj=L.forwardRef(({className:e,...t},r)=>a.jsx(og,{ref:r,className:Ie("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));pj.displayName=og.displayName;const ve=L.forwardRef(({className:e,children:t,...r},s)=>a.jsxs(cg,{ref:s,className:Ie("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(f_,{children:a.jsx(Ns,{className:"h-4 w-4"})})}),a.jsx(h_,{children:t})]}));ve.displayName=cg.displayName;const gj=L.forwardRef(({className:e,...t},r)=>a.jsx(lg,{ref:r,className:Ie("-mx-1 my-1 h-px bg-muted",e),...t}));gj.displayName=lg.displayName;const xj=({isOpen:e,onClose:t})=>{const{notifications:r,unreadCount:s,markAsRead:n,markAllAsRead:i,clearNotification:o,clearAllNotifications:c}=Gx(),[l,d]=L.useState(""),[u,f]=L.useState("all"),[h,m]=L.useState("all"),g=v=>{switch(v){case"urgent":return"bg-red-500 text-white";case"high":return"bg-orange-500 text-white";case"medium":return"bg-blue-500 text-white";case"low":return"bg-gray-500 text-white";default:return"bg-gray-500 text-white"}},p=v=>{switch(v){case"request":return"";case"chatbot_request":return"";case"lead":return"";case"system":return"";default:return""}},x=v=>{switch(v){case"request":return"Client Request";case"chatbot_request":return"Chatbot Request";case"lead":return"New Lead";case"system":return"System";default:return"Notification"}},y=r.filter(v=>{const j=v.title.toLowerCase().includes(l.toLowerCase())||v.message.toLowerCase().includes(l.toLowerCase()),S=u==="all"||v.type===u,_=h==="all"||v.priority===h;return j&&S&&_}),w=v=>{v.read||n(v.id),console.log("Notification clicked:",v)};return e?a.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(tg,{className:"h-6 w-6 text-blue-600"}),a.jsx("h2",{className:"text-xl font-semibold",children:"Notifications"}),s>0&&a.jsxs(Le,{variant:"destructive",className:"ml-2",children:[s," unread"]})]}),a.jsx(le,{variant:"ghost",size:"sm",onClick:t,children:a.jsx(yr,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"p-4 border-b bg-gray-50",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(ei,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),a.jsx(Ue,{placeholder:"Search notifications...",value:l,onChange:v=>d(v.target.value),className:"pl-10"})]})}),a.jsxs(pt,{value:u,onValueChange:f,children:[a.jsx(ct,{className:"w-full sm:w-40",children:a.jsx(gt,{placeholder:"Type"})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All Types"}),a.jsx(ve,{value:"request",children:"Client Requests"}),a.jsx(ve,{value:"chatbot_request",children:"Chatbot Requests"}),a.jsx(ve,{value:"lead",children:"Leads"}),a.jsx(ve,{value:"system",children:"System"})]})]}),a.jsxs(pt,{value:h,onValueChange:m,children:[a.jsx(ct,{className:"w-full sm:w-40",children:a.jsx(gt,{placeholder:"Priority"})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All Priorities"}),a.jsx(ve,{value:"urgent",children:"Urgent"}),a.jsx(ve,{value:"high",children:"High"}),a.jsx(ve,{value:"medium",children:"Medium"}),a.jsx(ve,{value:"low",children:"Low"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[s>0&&a.jsxs(le,{variant:"outline",size:"sm",onClick:i,className:"whitespace-nowrap",children:[a.jsx(Ns,{className:"h-4 w-4 mr-1"}),"Mark all read"]}),r.length>0&&a.jsxs(le,{variant:"outline",size:"sm",onClick:()=>{c(),Object.keys(localStorage).forEach(v=>{v.startsWith("notifications_")&&localStorage.removeItem(v)})},className:"whitespace-nowrap text-red-600 hover:text-red-700",children:[a.jsx(js,{className:"h-4 w-4 mr-1"}),"Clear all"]})]})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:y.length===0?a.jsxs("div",{className:"p-8 text-center text-gray-500",children:[a.jsx(au,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No notifications"}),a.jsx("p",{className:"text-sm",children:l||u!=="all"||h!=="all"?"No notifications match your filters":"You're all caught up! New notifications will appear here."})]}):a.jsx("div",{className:"divide-y",children:y.map(v=>a.jsx("div",{className:`p-4 cursor-pointer hover:bg-gray-50 transition-colors ${v.read?"":"bg-blue-50 border-l-4 border-l-blue-500"}`,onClick:()=>w(v),children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("span",{className:"text-2xl",children:p(v.type)})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:v.title}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Le,{variant:"outline",className:"text-xs",children:x(v.type)}),a.jsx(Le,{className:`text-xs ${g(v.priority)}`,children:v.priority}),!v.read&&a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-3",children:v.message}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs text-gray-400",children:Dg(new Date(v.created_at),{addSuffix:!0})}),a.jsxs("div",{className:"flex items-center gap-2",children:[!v.read&&a.jsxs(le,{variant:"ghost",size:"sm",onClick:j=>{j.stopPropagation(),n(v.id)},className:"h-6 px-2 text-xs",children:[a.jsx(Ns,{className:"h-3 w-3 mr-1"}),"Mark read"]}),a.jsx(le,{variant:"ghost",size:"sm",onClick:j=>{j.stopPropagation(),o(v.id)},className:"h-6 px-2 text-xs text-red-600 hover:text-red-700",children:a.jsx(yr,{className:"h-3 w-3"})})]})]})]})]})},v.id))})}),a.jsx("div",{className:"p-4 border-t bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[a.jsxs("span",{children:["Showing ",y.length," of ",r.length," notifications"]}),a.jsx(le,{variant:"ghost",size:"sm",onClick:t,children:"Close"})]})})]})}):null},vj=({children:e,currentPage:t,onPageChange:r})=>{const{toast:s}=vt(),{agencySettings:n}=xu();console.log(" [Layout] Agency settings:",n);const{signOut:i,user:o}=Mr(),c=rs(),[l,d]=L.useState(!0),[u,f]=L.useState(!1),[h,m]=L.useState(!1);L.useState([]);const[g,p]=L.useState(0);L.useEffect(()=>{document.documentElement.classList.add("light"),document.documentElement.classList.remove("dark")},[]),L.useEffect(()=>{const S=_=>{_.ctrlKey&&_.shiftKey&&_.key==="A"&&(_.preventDefault(),c("/admin"),s({title:"Admin Access",description:"Accessing admin dashboard..."}))};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[c,s]);const x=[{id:"projects",label:Z.NAVIGATION.PROJECTS,icon:x_},{id:"client-requests",label:Z.NAVIGATION.CLIENT_REQUESTS,icon:Sa},{id:"media-library",label:Z.NAVIGATION.MEDIA_LIBRARY,icon:Ua},{id:"clients",label:"Clients",icon:tn},{id:"chatbots",label:"Chatbots",icon:da},{id:"support",label:Z.NAVIGATION.SUPPORT,icon:v_},{id:"settings",label:Z.NAVIGATION.SETTINGS,icon:Ka}],y=()=>{d(!l),l?(document.documentElement.classList.remove("light"),document.documentElement.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light"))},w=async()=>{const{error:S}=await i();S?s({title:"Error",description:"Failed to sign out. Please try again.",variant:"destructive"}):(s({title:"Signed Out",description:"You have been successfully signed out."}),c("/auth"))},v=S=>{r(S),f(!1)},j=()=>{p(S=>{const _=S+1;return _>=5?(c("/admin"),s({title:"Admin Access",description:"Accessing admin dashboard..."}),0):_})};return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("div",{className:"lg:hidden bg-sidebar border-b border-sidebar-border",children:[a.jsxs("div",{className:"p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:n.agency_logo,alt:`${n.agency_name} Logo`,className:"w-8 h-8 object-contain cursor-pointer",onClick:j,onError:S=>{S.currentTarget.src="/tourcompanion-logo.png"}}),a.jsx("h1",{className:"text-xl font-bold text-primary tracking-tight",children:n.agency_name})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($h,{}),a.jsx("button",{onClick:()=>f(!u),className:"p-2 text-foreground hover:bg-accent rounded-lg transition-colors",children:u?a.jsx(yr,{size:24}):a.jsx(g_,{size:24})})]})]}),a.jsx("div",{className:"px-4 pb-4",children:a.jsxs(le,{onClick:y,variant:"outline",className:"w-full justify-start",title:l?Z.THEME.SWITCH_TO_DARK:Z.THEME.SWITCH_TO_LIGHT,children:[l?a.jsx(zf,{size:18,className:"mr-2"}):a.jsx(Yf,{size:18,className:"mr-2"}),l?Z.THEME.SWITCH_TO_DARK:Z.THEME.SWITCH_TO_LIGHT]})})]}),u&&a.jsx("div",{className:"lg:hidden fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",children:a.jsxs("div",{className:"absolute right-0 top-0 w-64 h-full bg-sidebar border-l border-sidebar-border flex flex-col animate-slide-in-right",children:[a.jsxs("div",{className:"p-6 border-b border-sidebar-border flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:n.agency_logo,alt:`${n.agency_name} Logo`,className:"w-8 h-8 object-contain cursor-pointer",onClick:j,onError:S=>{S.currentTarget.src="/tourcompanion-logo.png"}}),a.jsx("h1",{className:"text-2xl font-bold text-primary tracking-tight",children:n.agency_name})]}),a.jsx("button",{onClick:()=>f(!1),className:"p-1 text-foreground-secondary hover:text-foreground",children:a.jsx(yr,{size:20})})]}),a.jsx("nav",{className:"flex-1 p-4 space-y-2",children:x.map(S=>{const _=S.icon;return a.jsxs("button",{onClick:()=>v(S.id),className:`nav-item w-full ${t===S.id?"active":""}`,children:[a.jsx(_,{size:20}),a.jsx("span",{className:"font-medium",children:S.label})]},S.id)})}),a.jsxs("div",{className:"p-4 border-t border-sidebar-border space-y-3",children:[o&&a.jsx("div",{className:"px-3 py-2 bg-accent/50 rounded-lg mb-3",children:a.jsx("p",{className:"text-xs font-medium text-foreground truncate",children:o.email})}),a.jsxs(le,{onClick:w,variant:"outline",className:"w-full justify-start text-red-600 hover:text-red-700",children:[a.jsx(md,{size:16,className:"mr-2"}),"Sign Out"]})]})]})}),a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"hidden lg:flex w-64 bg-sidebar border-r border-sidebar-border flex-col",children:[a.jsx("div",{className:"p-6 border-b border-sidebar-border",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:n.agency_logo,alt:`${n.agency_name} Logo`,className:"w-8 h-8 object-contain cursor-pointer",onClick:j,onError:S=>{S.currentTarget.src="/tourcompanion-logo.png"}}),a.jsx("h1",{className:"text-2xl font-bold text-primary tracking-tight",children:n.agency_name})]})}),a.jsx("nav",{className:"flex-1 p-4 space-y-2",children:x.map(S=>{const _=S.icon;return a.jsxs("button",{onClick:()=>r(S.id),className:`nav-item w-full ${t===S.id?"active":""}`,children:[a.jsx(_,{size:20}),a.jsx("span",{className:"font-medium",children:S.label})]},S.id)})}),a.jsxs("div",{className:"p-4 border-t border-sidebar-border space-y-3",children:[o&&a.jsx("div",{className:"px-3 py-2 bg-accent/50 rounded-lg",children:a.jsx("p",{className:"text-xs font-medium text-foreground truncate",children:o.email})}),a.jsxs(le,{onClick:y,variant:"outline",className:"w-full justify-start",title:l?Z.THEME.SWITCH_TO_DARK:Z.THEME.SWITCH_TO_LIGHT,children:[l?a.jsx(zf,{size:16,className:"mr-2"}):a.jsx(Yf,{size:16,className:"mr-2"}),l?Z.THEME.SWITCH_TO_DARK:Z.THEME.SWITCH_TO_LIGHT]}),a.jsxs(le,{onClick:w,variant:"outline",className:"w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",children:[a.jsx(md,{size:16,className:"mr-2"}),"Sign Out"]})]})]}),a.jsxs("div",{className:"flex-1 flex flex-col",children:[a.jsxs("div",{className:"hidden lg:flex items-center justify-between px-6 py-4 border-b border-sidebar-border bg-background",children:[a.jsx("div",{className:"flex items-center gap-4",children:a.jsx("h2",{className:"text-lg font-semibold text-foreground capitalize",children:t.replace("-"," ")})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yj,{}),a.jsx($h,{})]})]}),a.jsx("main",{className:"flex-1 p-4 sm:p-6 lg:p-8",children:e})]})]}),a.jsx(xj,{isOpen:h,onClose:()=>m(!1)})]})},yj=()=>{const e=rs(),[t,r]=Te.useState("unknown");return Te.useEffect(()=>{(async()=>{try{const n=localStorage.getItem("jwt_token");if(!n)return;const o=await(await fetch("/api/billing/subscription-status",{headers:{Authorization:`Bearer ${n}`}})).json();o!=null&&o.success&&r(o.data.plan==="pro"?"pro":"free")}catch{}})()},[]),t!=="free"?null:a.jsx(le,{onClick:()=>e("/pricing"),className:"bg-purple-600 hover:bg-purple-700 text-white",children:"Upgrade to Pro"})},kq=()=>a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute -top-4 -left-4 w-32 h-32 bg-primary/20 rounded-full blur-3xl animate-pulse-glow"}),a.jsx("div",{className:"absolute -top-2 -right-8 w-24 h-24 bg-metric-violet/20 rounded-full blur-2xl animate-pulse-glow",style:{animationDelay:"1s"}}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("h1",{className:"text-4xl font-bold mb-3",children:a.jsx("span",{className:"gradient-text-enhanced",children:"Dashboard"})}),a.jsx("p",{className:"text-foreground-secondary text-lg",children:"Panoramica completa delle performance dei tuoi tour virtuali"})]})]}),Rq=({onUpload:e,dataCount:t})=>{const r=L.useRef(null),s=n=>{var o;const i=(o=n.target.files)==null?void 0:o[0];i&&e(i)};return a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs(le,{variant:"outline",onClick:()=>{var n;return(n=r.current)==null?void 0:n.click()},className:"flex items-center gap-2 bg-glass-background border-glass-border hover:bg-accent",children:[a.jsx(y_,{size:18}),"Importa CSV"]}),a.jsx("input",{ref:r,type:"file",accept:".csv",onChange:s,className:"hidden"}),t>0&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-success/20 text-success rounded-lg text-sm",children:[a.jsx(Sa,{size:16}),t," righe elaborate"]})]})},Iq=()=>{const[e,t]=L.useState([]),[r,s]=L.useState({totalViews:0,uniqueVisitors:0,totalTime:"00:00:00",avgSessionTime:"00:00",conversionRate:0,performanceScore:0}),[n,i]=L.useState([]),{toast:o}=vt(),c=L.useCallback(u=>{const f=u.split(`
`).filter(m=>m.trim());if(f.length<2)return[];const h=f[0].split(",").map(m=>m.trim().toLowerCase());return f.slice(1).map(m=>{const g=m.split(","),p={};return h.forEach((x,y)=>{var w;p[x]=((w=g[y])==null?void 0:w.trim())||""}),p})},[]),l=L.useCallback(u=>{if(!u.length)return;const f=u.reduce((S,_)=>{const T=parseInt(_.views||_.visualizzazioni||_.pageviews||"0");return S+(isNaN(T)?0:T)},0),h=u.reduce((S,_)=>{const T=parseInt(_.visitors||_.visitatori||_.users||"0");return S+(isNaN(T)?0:T)},0),m=u.map(S=>{const _=parseFloat(S.sessiontime||S.tempo||S.duration||"0");return isNaN(_)?0:_}).filter(S=>S>0),g=m.reduce((S,_)=>S+_,0),p=m.length>0?g/m.length:0,x=u.reduce((S,_)=>{const T=parseInt(_.conversions||_.conversioni||_.leads||"0");return S+(isNaN(T)?0:T)},0),y=h>0?x/h*100:0,w=Math.min(100,Math.round(f*.3+h*.4+y*.3)),v=S=>{const _=Math.floor(S/3600),T=Math.floor(S%3600/60),N=Math.floor(S%60);return _>0?`${_.toString().padStart(2,"0")}:${T.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}`:`${T.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}`};s({totalViews:f,uniqueVisitors:h,totalTime:v(g),avgSessionTime:v(p),conversionRate:Math.round(y*10)/10,performanceScore:w});const j=new Map;u.forEach(S=>{const _=S.date||S.data||new Date().toISOString().split("T")[0],T=parseInt(S.visitors||S.visitatori||"0")||0,N=parseFloat(S.sessiontime||S.tempo||"0")||0,b=parseInt(S.conversions||S.conversioni||"0")||0;if(j.has(_)){const O=j.get(_);O.visitatori+=T,O.tempoMedio=(O.tempoMedio+N)/2,O.conversioni+=b}else j.set(_,{date:_,visitatori:T,tempoMedio:N,conversioni:b})}),i(Array.from(j.values()).sort((S,_)=>new Date(S.date).getTime()-new Date(_.date).getTime()))},[]),d=L.useCallback(u=>{if(!u.name.endsWith(".csv")){o({title:"Errore",description:"Per favore seleziona un file CSV valido.",variant:"destructive"});return}const f=new FileReader;f.onload=h=>{var p;const m=(p=h.target)==null?void 0:p.result,g=c(m);if(g.length===0){o({title:"Errore",description:"Il file CSV  vuoto o non valido.",variant:"destructive"});return}t(g),l(g),o({title:"Successo",description:`File CSV elaborato! ${g.length} righe importate.`})},f.readAsText(u)},[c,l,o]);return{csvData:e,metrics:r,chartData:n,handleCSVUpload:d,hasData:e.length>0}};function Hr({className:e,...t}){return a.jsx("div",{className:Ie("animate-pulse rounded-md bg-muted",e),...t})}const Oq=()=>a.jsxs(oe,{className:"animate-pulse",children:[a.jsxs(ye,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Hr,{className:"h-5 w-32"}),a.jsx(Hr,{className:"h-6 w-16"})]}),a.jsx(Hr,{className:"h-4 w-48"})]}),a.jsxs(de,{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Hr,{className:"h-4 w-4"}),a.jsx(Hr,{className:"h-4 w-20"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Hr,{className:"h-4 w-4"}),a.jsx(Hr,{className:"h-4 w-16"})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2",children:[a.jsx(Hr,{className:"h-8 w-20"}),a.jsx(Hr,{className:"h-8 w-8"})]})]})]}),Pq=()=>a.jsxs(oe,{className:"animate-pulse",children:[a.jsxs(ye,{children:[a.jsx(Hr,{className:"h-6 w-48"}),a.jsx(Hr,{className:"h-4 w-64"})]}),a.jsx(de,{children:a.jsx(Hr,{className:"h-80 w-full"})})]}),Dq=({children:e,isLoading:t,skeleton:r,delay:s=0})=>{const[n,i]=Te.useState(!t);return Te.useEffect(()=>{if(t)i(!1);else{const o=setTimeout(()=>{i(!0)},s);return()=>clearTimeout(o)}},[t,s]),t||!n?a.jsx(r,{}):a.jsx("div",{className:"animate-fade-in",children:e})},Bt=L.forwardRef(({className:e,...t},r)=>a.jsx("textarea",{className:Ie("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));Bt.displayName="Textarea";const ln=w_,ks=L.forwardRef(({className:e,...t},r)=>a.jsx(dg,{ref:r,className:Ie("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));ks.displayName=dg.displayName;const bt=L.forwardRef(({className:e,...t},r)=>a.jsx(ug,{ref:r,className:Ie("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));bt.displayName=ug.displayName;const Nt=L.forwardRef(({className:e,...t},r)=>a.jsx(fg,{ref:r,className:Ie("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));Nt.displayName=fg.displayName;const wj=()=>{const{toast:e}=vt(),[t,r]=L.useState(null),[s,n]=L.useState(""),[i,o]=L.useState(""),[c,l]=L.useState([]),[d,u]=L.useState(!1),[f,h]=L.useState(null),[m,g]=L.useState(!1),[p,x]=L.useState(null),y=[{id:1,title:Z.ACADEMY.TUTORIALS.PLATFORM_OVERVIEW,duration:"12 min",level:Z.ACADEMY.LEVELS.BEGINNER,thumbnail:"/api/placeholder/300/180",youtubeId:"dQw4w9WgXcQ",description:"Get started with the platform and understand the main features"}],w=E=>{window.open(`https://www.youtube.com/watch?v=${E}`,"_blank")},v=E=>{console.log("Opening video modal with YouTube ID:",E),h(E),g(!0)},j=()=>{h(null),g(!1)},S=E=>{x(E)},_=()=>{x(null)},T=[{question:Z.FAQ.CREATE_FIRST_PROJECT_QUESTION,answer:Z.FAQ.CREATE_FIRST_PROJECT_ANSWER},{question:Z.FAQ.CLIENT_PORTAL_ACCESS_QUESTION,answer:Z.FAQ.CLIENT_PORTAL_ACCESS_ANSWER},{question:Z.FAQ.CHATBOT_SETUP_QUESTION,answer:Z.FAQ.CHATBOT_SETUP_ANSWER},{question:Z.FAQ.REQUEST_TYPES_QUESTION,answer:Z.FAQ.REQUEST_TYPES_ANSWER},{question:Z.FAQ.NOTIFICATIONS_QUESTION,answer:Z.FAQ.NOTIFICATIONS_ANSWER},{question:Z.FAQ.PROJECT_SHARING_QUESTION,answer:Z.FAQ.PROJECT_SHARING_ANSWER}];L.useEffect(()=>{N()},[]);const N=async()=>{try{const{data:E,error:U}=await he.from("support_requests").select("*").order("created_at",{ascending:!1});if(U)throw U;l(E||[])}catch(E){console.error("Error loading support requests:",E)}},b=async E=>{if(E.preventDefault(),!(!s||!i)){u(!0);try{const{data:U,error:Y}=await he.rpc("create_support_request",{p_subject:s,p_message:i,p_request_type:s});if(Y)throw Y;e({title:"Message Sent",description:"Your support request has been submitted successfully. We'll respond as soon as possible."}),n(""),o(""),N()}catch(U){console.error("Error submitting support request:",U),e({title:"Error",description:U.message||"Failed to submit your request. Please try again.",variant:"destructive"})}finally{u(!1)}}},O=E=>{switch(E){case"aperto":return"default";case"in_corso":return"secondary";case"risolto":return"outline";default:return"default"}},A=E=>{switch(E){case"open":return"Open";case"in_progress":return"In Progress";case"resolved":return"Resolved";default:return E}};return a.jsxs("div",{className:"space-y-8 animate-fade-in",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:Z.HEADERS.SUPPORT_ASSISTANCE}),a.jsx("p",{className:"text-foreground-secondary text-sm sm:text-base",children:Z.DESCRIPTIONS.SUPPORT_SUBTITLE})]}),a.jsxs(ln,{defaultValue:"support",className:"w-full",children:[a.jsxs(ks,{className:"grid w-full grid-cols-2",children:[a.jsx(bt,{value:"support",children:"Support & Help"}),a.jsx(bt,{value:"academy",children:Z.ACADEMY.TRAINING_ACADEMY})]}),a.jsxs(Nt,{value:"support",className:"space-y-8",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs(oe,{className:"p-6 bg-background-secondary border-border",children:[a.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:Z.HEADERS.CONTACT_US_DIRECTLY}),a.jsx("p",{className:"text-foreground-secondary mb-6",children:Z.DESCRIPTIONS.CONTACT_DESCRIPTION}),a.jsxs("form",{onSubmit:b,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-foreground font-medium mb-2",children:Z.FORMS.SUBJECT}),a.jsxs(pt,{value:s,onValueChange:n,children:[a.jsx(ct,{className:"bg-input border-border",children:a.jsx(gt,{placeholder:Z.FORMS.SELECT_REQUEST_TYPE})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"technical_support",children:Z.SUPPORT_SUBJECTS.TECHNICAL_SUPPORT}),a.jsx(ve,{value:"project_creation",children:Z.SUPPORT_SUBJECTS.PROJECT_CREATION}),a.jsx(ve,{value:"client_portal",children:Z.SUPPORT_SUBJECTS.CLIENT_PORTAL}),a.jsx(ve,{value:"chatbot_setup",children:Z.SUPPORT_SUBJECTS.CHATBOT_SETUP}),a.jsx(ve,{value:"payment_billing",children:Z.SUPPORT_SUBJECTS.PAYMENT_BILLING}),a.jsx(ve,{value:"account_management",children:Z.SUPPORT_SUBJECTS.ACCOUNT_MANAGEMENT}),a.jsx(ve,{value:"feature_request",children:Z.SUPPORT_SUBJECTS.FEATURE_REQUEST}),a.jsx(ve,{value:"other",children:Z.SUPPORT_SUBJECTS.OTHER})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-foreground font-medium mb-2",children:"Message"}),a.jsx(Bt,{value:i,onChange:E=>o(E.target.value),placeholder:"Describe your request here...",className:"bg-input border-border min-h-[120px] resize-none",required:!0})]}),a.jsx(le,{type:"submit",className:"w-full bg-primary hover:bg-primary-hover",disabled:d||!s||!i,children:d?"Sending...":"Send Message"})]})]}),a.jsxs(oe,{className:"p-6 bg-background-secondary border-border",children:[a.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:"Quick Answers (FAQ)"}),a.jsx("div",{className:"space-y-3",children:T.map((E,U)=>a.jsxs("div",{className:"faq-item",children:[a.jsxs("button",{onClick:()=>r(t===U?null:U),className:"w-full p-4 text-left flex items-center justify-between hover:bg-background-tertiary transition-colors",children:[a.jsx("span",{className:"font-medium text-foreground",children:E.question}),t===U?a.jsx(sg,{className:"text-foreground-secondary",size:20}):a.jsx(su,{className:"text-foreground-secondary",size:20})]}),t===U&&a.jsx("div",{className:"px-4 pb-4 text-foreground-secondary animate-slide-up",children:E.answer})]},U))})]})]}),c.length>0&&a.jsxs(oe,{className:"p-6 bg-background-secondary border-border",children:[a.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:"Your Support Requests"}),a.jsx("div",{className:"space-y-4",children:c.map(E=>a.jsxs("div",{className:"p-4 border border-border rounded-lg bg-background-tertiary",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("h3",{className:"font-medium text-foreground",children:[E.subject==="technical_support"&&"Technical Support",E.subject==="project_creation"&&"Project Creation Help",E.subject==="client_portal"&&"Client Portal Issues",E.subject==="chatbot_setup"&&"Chatbot Setup & Configuration",E.subject==="payment_billing"&&"Payment & Billing",E.subject==="account_management"&&"Account Management",E.subject==="feature_request"&&"Feature Request",E.subject==="other"&&"Other"]}),a.jsx(Le,{variant:O(E.status),children:A(E.status)})]}),a.jsxs("div",{className:"flex items-center gap-1 text-foreground-secondary text-sm",children:[a.jsx(it,{size:14}),new Date(E.created_at).toLocaleDateString("it-IT")]})]}),a.jsx("p",{className:"text-foreground-secondary text-sm line-clamp-2 mb-3",children:E.message}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-foreground-secondary",children:[a.jsxs("span",{children:["Priority: ",E.priority]}),E.status==="resolved"&&a.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[a.jsx(pd,{size:12}),"Resolved"]})]})]},E.id))})]}),a.jsxs(oe,{className:"p-6 bg-background-secondary border-border",children:[a.jsx("h2",{className:"text-xl font-semibold text-foreground mb-4",children:"Guides and Alternative Contacts"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs(le,{variant:"outline",className:"flex items-center gap-2 h-12 bg-background-tertiary border-border hover:bg-accent",onClick:()=>window.open("mailto:prismatica360@gmail.com","_blank"),children:[a.jsx(Xs,{size:20}),"Direct Email"]}),a.jsxs(le,{className:"flex items-center gap-2 h-12 bg-green-500 hover:bg-green-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200",onClick:()=>{window.open("https://wa.me/393293763839","_blank")},children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"WhatsApp Chat"]})]})]})]}),a.jsxs(Nt,{value:"academy",className:"space-y-8",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:Z.ACADEMY.TRAINING_ACADEMY}),a.jsx("p",{className:"text-foreground-secondary",children:Z.ACADEMY.IMPROVE_SKILLS})]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx(__,{className:"h-8 w-8 text-primary"})})]}),a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(Kf,{className:"h-5 w-5"}),Z.ACADEMY.VIDEO_TUTORIALS_SECTION]}),a.jsx(He,{children:Z.ACADEMY.VIDEO_TUTORIALS_DESCRIPTION})]}),a.jsx(de,{children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map(E=>a.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-lg transition-all duration-200 group",children:[a.jsx("div",{className:"aspect-video rounded-lg mb-4 overflow-hidden bg-black",children:p===E.youtubeId?a.jsxs("div",{className:"relative w-full h-full",children:[a.jsx("iframe",{width:"100%",height:"100%",src:`https://www.youtube.com/embed/${E.youtubeId}?autoplay=1&rel=0&modestbranding=1&showinfo=0&controls=1`,title:E.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,className:"w-full h-full"}),a.jsx("button",{onClick:_,className:"absolute top-2 right-2 bg-black/60 text-white p-1 rounded hover:bg-black/80 transition-colors",children:a.jsx(yr,{className:"h-4 w-4"})})]}):a.jsxs("div",{className:"w-full h-full relative cursor-pointer group",onClick:()=>S(E.youtubeId),children:[a.jsx("img",{src:`https://img.youtube.com/vi/${E.youtubeId}/maxresdefault.jpg`,alt:E.title,className:"w-full h-full object-cover",onError:U=>{U.currentTarget.src=`https://img.youtube.com/vi/${E.youtubeId}/hqdefault.jpg`}}),a.jsx("div",{className:"absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-200"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"w-20 h-20 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center shadow-2xl group-hover:scale-110 transition-all duration-300 border-4 border-white/50",children:a.jsx("div",{className:"w-0 h-0 border-l-[12px] border-l-blue-600 border-t-[8px] border-t-transparent border-b-[8px] border-b-transparent ml-1"})})}),a.jsx("div",{className:"absolute bottom-2 right-2 bg-black/80 text-white text-xs px-2 py-1 rounded",children:E.duration}),a.jsx("div",{className:"absolute top-2 right-2 bg-black/60 text-white p-1 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:a.jsx(Xf,{className:"h-4 w-4"})}),a.jsx("div",{className:"absolute bottom-2 left-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:a.jsx("span",{className:"text-white text-xs font-medium bg-black/60 px-2 py-1 rounded",children:"Click to play"})})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Le,{variant:"outline",children:E.level}),a.jsx("span",{className:"text-sm text-muted-foreground",children:E.duration})]}),a.jsx("h3",{className:"font-semibold text-foreground group-hover:text-primary transition-colors duration-200",children:E.title}),a.jsx("p",{className:"text-sm text-muted-foreground",children:E.description}),a.jsxs("div",{className:"flex gap-2",children:[p===E.youtubeId?a.jsxs(le,{size:"sm",variant:"outline",className:"flex-1",onClick:U=>{U.stopPropagation(),_()},children:[a.jsx(yr,{className:"h-4 w-4 mr-2"}),"Stop Video"]}):a.jsxs(le,{size:"sm",className:"flex-1",onClick:U=>{U.stopPropagation(),S(E.youtubeId)},children:[a.jsx(Kf,{className:"h-4 w-4 mr-2"}),"Play Video"]}),a.jsxs(le,{size:"sm",variant:"outline",onClick:U=>{U.stopPropagation(),v(E.youtubeId)},children:[a.jsx(Xf,{className:"h-4 w-4 mr-2"}),"Fullscreen"]}),a.jsxs(le,{size:"sm",variant:"outline",onClick:U=>{U.stopPropagation(),w(E.youtubeId)},children:[a.jsx(hg,{className:"h-4 w-4 mr-2"}),"YouTube"]})]})]})]},E.id))})})]}),a.jsx(oe,{className:"bg-gradient-to-br from-indigo-600 via-purple-600 to-blue-700 border-indigo-500 shadow-xl",children:a.jsxs(de,{className:"p-6 text-center text-white",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h2",{className:"text-xl font-bold mb-2 text-white",children:Z.ACADEMY.NEED_PERSONALIZED_SUPPORT}),a.jsx("p",{className:"text-blue-100 text-sm max-w-lg mx-auto",children:Z.ACADEMY.CONTACT_FOR_TRAINING})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center items-center",children:[a.jsxs(le,{size:"sm",className:"bg-green-500 hover:bg-green-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-200 px-6 py-2 text-sm font-semibold rounded-lg",onClick:()=>{window.open("https://wa.me/393293763839","_blank")},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",className:"mr-2",children:a.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"WhatsApp"]}),a.jsxs(le,{size:"sm",className:"bg-white hover:bg-gray-100 text-indigo-700 border-0 shadow-lg hover:shadow-xl transition-all duration-200 px-6 py-2 text-sm font-semibold rounded-lg",onClick:()=>{const ee=`mailto:tourcompanion360@gmail.com?subject=${encodeURIComponent("Support Request - TourCompanion")}&body=${encodeURIComponent(`Hello,

I need assistance with:

`)}`;window.location.href=ee},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",className:"mr-2",children:a.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"})}),"Email Support"]})]})]})})]})]}),m&&f&&a.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden shadow-2xl",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Video Tutorial"}),a.jsx(le,{variant:"ghost",size:"sm",onClick:j,className:"h-8 w-8 p-0 hover:bg-gray-200",children:a.jsx(yr,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"aspect-video bg-black",children:a.jsx("iframe",{width:"100%",height:"100%",src:`https://www.youtube.com/embed/${f}?autoplay=1&rel=0&modestbranding=1&showinfo=0&controls=1`,title:"Video Tutorial",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,className:"w-full h-full",loading:"lazy",onError:()=>{console.error("Failed to load YouTube video:",f)}})}),a.jsx("div",{className:"p-4 bg-gray-50 border-t",children:a.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Having trouble viewing the video?",a.jsx("button",{onClick:()=>w(f),className:"text-blue-600 hover:text-blue-800 underline ml-1",children:"Open in YouTube"})]})})]})})]})},Xx=N_,_j=j_,bj=b_,Qx=L.forwardRef(({className:e,...t},r)=>a.jsx(mg,{className:Ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));Qx.displayName=mg.displayName;const wu=L.forwardRef(({className:e,...t},r)=>a.jsxs(bj,{children:[a.jsx(Qx,{}),a.jsx(pg,{ref:r,className:Ie("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));wu.displayName=pg.displayName;const _u=({className:e,...t})=>a.jsx("div",{className:Ie("flex flex-col space-y-2 text-center sm:text-left",e),...t});_u.displayName="AlertDialogHeader";const bu=({className:e,...t})=>a.jsx("div",{className:Ie("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});bu.displayName="AlertDialogFooter";const Nu=L.forwardRef(({className:e,...t},r)=>a.jsx(gg,{ref:r,className:Ie("text-lg font-semibold",e),...t}));Nu.displayName=gg.displayName;const ju=L.forwardRef(({className:e,...t},r)=>a.jsx(xg,{ref:r,className:Ie("text-sm text-muted-foreground",e),...t}));ju.displayName=xg.displayName;const Tu=L.forwardRef(({className:e,...t},r)=>a.jsx(vg,{ref:r,className:Ie(vu(),e),...t}));Tu.displayName=vg.displayName;const Eu=L.forwardRef(({className:e,...t},r)=>a.jsx(yg,{ref:r,className:Ie(vu({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Eu.displayName=yg.displayName;const qa=L.forwardRef(({className:e,value:t,...r},s)=>a.jsx(wg,{ref:s,className:Ie("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:a.jsx(T_,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));qa.displayName=wg.displayName;const Lq=({project:e,onViewDetails:t,onManageProject:r,onEditProject:s,onDeleteProject:n,onStatusChange:i,onSharePortal:o})=>{var u,f;const c=h=>{switch(h){case"active":return"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800";case"inactive":return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700";case"setup":return"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800";case"completed":return"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700"}},l=h=>{switch(h){case"active":return"Live";case"inactive":return"Inactive";case"setup":return"Setup";case"completed":return"Completed";default:return h}},d=h=>{switch(h){case"active":return a.jsx(Pt,{className:"h-3 w-3"});case"inactive":return a.jsx(Mt,{className:"h-3 w-3"});case"setup":return a.jsx(it,{className:"h-3 w-3"});case"completed":return a.jsx(oa,{className:"h-3 w-3"});default:return a.jsx(Ba,{className:"h-3 w-3"})}};return a.jsxs(oe,{className:"hover:shadow-lg transition-all duration-200 hover:scale-[1.02] cursor-pointer group",children:[a.jsx(ye,{className:"pb-3",children:a.jsxs("div",{className:"card-header-safe",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-primary flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-sm font-semibold text-primary-foreground",children:e.client.name.split(" ").map(h=>h[0]).join("").toUpperCase()})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx(we,{className:"text-lg name-display-safe group-hover:text-primary transition-colors",children:e.project.title}),a.jsxs(He,{className:"company-display-safe",children:[e.client.name,"  ",e.client.company]})]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(Le,{className:c(e.project.status),children:a.jsxs("div",{className:"flex items-center gap-1",children:[d(e.project.status),l(e.project.status)]})}),a.jsxs(Wx,{children:[a.jsx(zx,{asChild:!0,children:a.jsx(le,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(_g,{className:"h-4 w-4"})})}),a.jsxs(yu,{align:"end",children:[e.project.status!=="active"&&i&&a.jsxs(Ii,{onClick:()=>i(e.id,"active"),children:[a.jsx(lc,{className:"h-4 w-4 mr-2"}),"Activate"]}),e.project.status==="active"&&i&&a.jsxs(Ii,{onClick:()=>i(e.id,"inactive"),children:[a.jsx(E_,{className:"h-4 w-4 mr-2"}),"Deactivate"]}),e.project.status!=="completed"&&i&&a.jsxs(Ii,{onClick:()=>i(e.id,"completed"),children:[a.jsx(Pt,{className:"h-4 w-4 mr-2"}),"Mark Complete"]}),e.project.status!=="setup"&&i&&a.jsxs(Ii,{onClick:()=>i(e.id,"setup"),children:[a.jsx(Ka,{className:"h-4 w-4 mr-2"}),"Back to Setup"]})]})]})]})]})}),a.jsxs(de,{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.project.description||`A ${e.project.type.replace("_"," ")} project for ${e.client.company}`}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(Ot,{className:"h-3 w-3"}),a.jsx("span",{children:"Views"})]}),a.jsx("div",{className:"text-lg font-semibold",children:e.analytics.totalViews})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(gr,{className:"h-3 w-3"}),a.jsx("span",{children:"Visitors"})]}),a.jsx("div",{className:"text-lg font-semibold",children:e.analytics.uniqueVisitors})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsx("span",{className:"text-muted-foreground",children:"Conversion Rate"}),a.jsxs("span",{className:"font-medium",children:[e.analytics.conversionRate,"%"]})]}),a.jsx(qa,{value:e.analytics.conversionRate,className:"h-2"})]}),e.chatbots&&e.chatbots.length>0&&a.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(da,{className:"h-4 w-4 text-primary"}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:e.chatbots[0].name}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:[((u=e.chatbots[0].statistics)==null?void 0:u.total_conversations)||0," conversations"]})]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(oa,{className:"h-3 w-3 text-yellow-500"}),a.jsxs("span",{className:"text-xs font-medium",children:[((f=e.chatbots[0].statistics)==null?void 0:f.satisfaction_rate)||0,"/5"]})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yr,{className:"h-3 w-3"}),a.jsxs("span",{children:["Last activity: ",new Date(e.lastActivity).toLocaleDateString()]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(it,{className:"h-3 w-3"}),a.jsx("span",{children:e.analytics.avgSessionDuration})]})]}),a.jsx("div",{className:"space-y-2 pt-2",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(le,{variant:"outline",size:"sm",className:"flex-1",onClick:h=>{h.stopPropagation(),t(e)},children:[a.jsx(Lr,{className:"h-3 w-3 mr-1"}),"View Details"]}),o&&a.jsx(le,{variant:"default",size:"sm",onClick:h=>{h.stopPropagation(),o(e)},className:"bg-blue-600 hover:bg-blue-700",children:a.jsx(nu,{className:"h-3 w-3"})}),a.jsx(le,{variant:"outline",size:"sm",onClick:h=>{h.stopPropagation(),r(e)},children:a.jsx(Ka,{className:"h-3 w-3"})}),s&&a.jsx(le,{variant:"outline",size:"sm",onClick:h=>{h.stopPropagation(),s(e)},children:a.jsx(Yc,{className:"h-3 w-3"})}),n&&a.jsx(le,{variant:"outline",size:"sm",onClick:h=>{h.stopPropagation(),n(e)},children:a.jsx(js,{className:"h-3 w-3"})})]})})]})]})},ai=C_,Nj=A_,Jx=L.forwardRef(({className:e,...t},r)=>a.jsx(bg,{ref:r,className:Ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Jx.displayName=bg.displayName;const dn=L.forwardRef(({className:e,children:t,...r},s)=>a.jsxs(Nj,{children:[a.jsx(Jx,{}),a.jsxs(Ng,{ref:s,className:Ie("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,a.jsxs(S_,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(yr,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));dn.displayName=Ng.displayName;const un=({className:e,...t})=>a.jsx("div",{className:Ie("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});un.displayName="DialogHeader";const sl=({className:e,...t})=>a.jsx("div",{className:Ie("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});sl.displayName="DialogFooter";const fn=L.forwardRef(({className:e,...t},r)=>a.jsx(jg,{ref:r,className:Ie("text-lg font-semibold leading-none tracking-tight",e),...t}));fn.displayName=jg.displayName;const nl=L.forwardRef(({className:e,...t},r)=>a.jsx(Tg,{ref:r,className:Ie("text-sm text-muted-foreground",e),...t}));nl.displayName=Tg.displayName;const jj=wo("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Se=L.forwardRef(({className:e,...t},r)=>a.jsx(Eg,{ref:r,className:Ie(jj(),e),...t}));Se.displayName=Eg.displayName;const oc=e=>{if(!e)return"";const t=e.replace(/\s+/g," ").trim();return t.length>200?t.substring(0,200):t},Tj=e=>{if(!e)return"";const t=e.trim();return t&&!t.match(/^https?:\/\//)?`https://${t}`:t},Ej=e=>e?e.trim().toLowerCase():"",Sj=e=>{if(!e)return"";const t=e.replace(/\s+/g," ").trim();return t.length>100?t.substring(0,100):t},Aj=e=>{if(!e)return"";const t=e.replace(/[0-9]/g,"").replace(/\s+/g," ").trim();return t.length>50?t.substring(0,50):t},Zx=e=>{if(!e)return"";const t=e.replace(/\s+/g," ").trim();return t.length>80?t.substring(0,80):t},cc=e=>{if(!e)return"";const t=e.replace(/\s+/g," ").replace(/\n+/g," ").trim();return t.length>500?t.substring(0,500):t},Fq=({isOpen:e,onClose:t,onProjectCreated:r})=>{const{toast:s}=vt(),{user:n}=Mr(),[i,o]=L.useState(1),[c,l]=L.useState(!1),[d,u]=L.useState({clientName:"",clientEmail:"",clientPhone:"",clientCompany:"",clientWebsite:"",projectTitle:"",projectDescription:"",projectType:"virtual_tour",projectCategory:"real_estate",enableAnalytics:!0,enableNotifications:!0,customDomain:"",branding:{primaryColor:"#3B82F6",logo:"",companyName:""}}),f=[{value:"virtual_tour",label:"Virtual Tour"},{value:"3d_showcase",label:"3D Showcase"},{value:"interactive_map",label:"Interactive Map"}],h=[{value:"real_estate",label:"Real Estate"},{value:"hospitality",label:"Hospitality"},{value:"retail",label:"Retail"},{value:"corporate",label:"Corporate"},{value:"education",label:"Education"},{value:"healthcare",label:"Healthcare"},{value:"other",label:"Other"}],m=(v,j)=>{u(S=>({...S,[v]:j}))},g=async()=>{try{if(l(!0),!d.clientName||!d.clientEmail||!d.projectTitle){s({title:"Missing Information",description:"Please fill in all required fields.",variant:"destructive"});return}const v={clientName:Aj(d.clientName),clientEmail:Ej(d.clientEmail),clientCompany:Sj(d.clientCompany||"Individual Client"),clientPhone:oc(d.clientPhone||""),projectTitle:Zx(d.projectTitle),projectDescription:cc(d.projectDescription||""),projectType:d.projectType,enableChatbot:d.enableChatbot};if(!n){console.error("No user found in authentication context"),s({title:"Authentication Required",description:"Please sign in to create a project.",variant:"destructive"});return}console.log("Creating project for user:",n.id);const{data:j,error:S}=await he.from("creators").select("id").eq("user_id",n.id).single();if(S||!j){console.error("Error finding creator:",S),s({title:"Error Creating Project",description:"Creator profile not found. Please contact support.",variant:"destructive"});return}const{data:_,error:T}=await he.from("end_clients").insert({creator_id:j.id,name:v.clientName,email:v.clientEmail,company:v.clientCompany,phone:v.clientPhone||null,website:d.clientWebsite||null}).select("id, name, email").single();if(T){console.error("Error creating client:",T),s({title:"Error Creating Client",description:T.message,variant:"destructive"});return}const{data:N,error:b}=await he.from("projects").insert({end_client_id:_.id,title:v.projectTitle,description:v.projectDescription||null,project_type:v.projectType,status:"active"}).select("id, title, description, project_type, status, created_at").single();if(b){console.error("Error creating project:",b),s({title:"Error Creating Project",description:b.message,variant:"destructive"});return}console.log("Project created successfully:",{project:N,endClient:_}),s({title:"Project Created Successfully",description:`New project "${N.title}" has been created for ${_.name}. Go to "Chatbots" section to create your AI assistant.`}),r({id:N.id,title:N.title,description:N.description,project_type:N.project_type,status:N.status,created_at:N.created_at,end_client:_}),p()}catch(v){console.error("Error in handleSubmit:",v),s({title:"Error Creating Project",description:"There was an unexpected error. Please try again.",variant:"destructive"})}finally{l(!1)}},p=()=>{o(1),u({clientName:"",clientEmail:"",clientPhone:"",clientCompany:"",clientWebsite:"",projectTitle:"",projectDescription:"",projectType:"virtual_tour",projectCategory:"real_estate",enableAnalytics:!0,enableNotifications:!0,customDomain:"",branding:{primaryColor:"#3B82F6",logo:"",companyName:""}}),t()},x=()=>{i<3&&o(i+1)},y=()=>{i>1&&o(i-1)},w=()=>{switch(i){case 1:return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center py-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Tell us about your client"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"We'll use this information to personalize their experience"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"clientName",children:"Client Name *"}),a.jsx(Ue,{id:"clientName",placeholder:"Enter client name",value:d.clientName,onChange:v=>m("clientName",v.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"clientEmail",children:"Email *"}),a.jsx(Ue,{id:"clientEmail",type:"email",placeholder:"client@company.com",value:d.clientEmail,onChange:v=>m("clientEmail",v.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"clientPhone",children:"Phone"}),a.jsx(Ue,{id:"clientPhone",placeholder:"+1 (555) 123-4567",value:d.clientPhone,onChange:v=>m("clientPhone",v.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"clientCompany",children:"Company"}),a.jsx(Ue,{id:"clientCompany",placeholder:"Company Name",value:d.clientCompany,onChange:v=>m("clientCompany",v.target.value)})]}),a.jsxs("div",{className:"space-y-2 md:col-span-2",children:[a.jsx(Se,{htmlFor:"clientWebsite",children:"Website"}),a.jsx(Ue,{id:"clientWebsite",placeholder:"https://company.com",value:d.clientWebsite,onChange:v=>m("clientWebsite",v.target.value)})]})]})]});case 2:return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center py-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Configure your project"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Set up the details for your virtual tour or interactive experience"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"projectTitle",children:"Project Title *"}),a.jsx(Ue,{id:"projectTitle",placeholder:"Enter project title",value:d.projectTitle,onChange:v=>m("projectTitle",v.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"projectDescription",children:"Description"}),a.jsx(Bt,{id:"projectDescription",placeholder:"Describe the project...",value:d.projectDescription,onChange:v=>m("projectDescription",v.target.value),rows:3})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{children:"Project Type"}),a.jsxs(pt,{value:d.projectType,onValueChange:v=>m("projectType",v),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsx(lt,{children:f.map(v=>a.jsx(ve,{value:v.value,children:v.label},v.value))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{children:"Category"}),a.jsxs(pt,{value:d.projectCategory,onValueChange:v=>m("projectCategory",v),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsx(lt,{children:h.map(v=>a.jsx(ve,{value:v.value,children:v.label},v.value))})]})]})]})]})]});case 3:return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center py-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Project Ready!"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Your project has been set up successfully"})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[a.jsxs(oe,{className:"border-green-200 bg-green-50/50",children:[a.jsx(ye,{children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:a.jsx(Pt,{className:"h-5 w-5 text-green-600"})}),a.jsxs("div",{children:[a.jsx(we,{className:"text-base text-green-900",children:"Project Created Successfully"}),a.jsx(He,{className:"text-green-700",children:"Your project is ready and your client can access their portal"})]})]})}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-800",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{children:"Client portal is active and accessible"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-800",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{children:"Analytics tracking is enabled"})]}),a.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-800",children:[a.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),a.jsx("span",{children:"Ready to share media and manage requests"})]})]})})]}),a.jsxs(oe,{className:"border-blue-200 bg-blue-50/50",children:[a.jsx(ye,{children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:a.jsx(da,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx(we,{className:"text-base text-blue-900",children:"Need an AI Assistant?"}),a.jsx(He,{className:"text-blue-700",children:"Create a custom chatbot for your project"})]})]})}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-700 mt-0.5",children:"1"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-blue-900",children:'Go to "Chatbots" section'}),a.jsx("p",{className:"text-xs text-blue-700",children:"Located in your main dashboard navigation"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-700 mt-0.5",children:"2"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Submit a chatbot request"}),a.jsx("p",{className:"text-xs text-blue-700",children:"Share files via cloud storage, specify requirements, and get a custom AI assistant"})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center text-xs font-semibold text-blue-700 mt-0.5",children:"3"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-blue-900",children:"We'll create your custom chatbot"}),a.jsx("p",{className:"text-xs text-blue-700",children:"Our team will build a specialized assistant for your needs"})]})]})]})})]})]})]});default:return null}};return a.jsx(ai,{open:e,onOpenChange:p,children:a.jsxs(dn,{className:"max-w-6xl max-h-[95vh] overflow-hidden",children:[a.jsx(un,{children:a.jsxs(fn,{className:"flex items-center gap-2",children:[a.jsx(Ts,{className:"h-5 w-5"}),"New Client Project Setup"]})}),a.jsxs("div",{className:"space-y-6 overflow-y-auto max-h-[calc(95vh-200px)]",children:[a.jsx("div",{className:"w-full",children:a.jsx("div",{className:"flex items-center justify-center space-x-8",children:[{step:1,label:"Client Info",icon:tn},{step:2,label:"Project Setup",icon:Ka},{step:3,label:"Complete",icon:Pt}].map(({step:v,label:j,icon:S},_)=>a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:`relative w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 ${v<i?"bg-green-500 text-white shadow-lg":v===i?"bg-primary text-primary-foreground shadow-lg ring-4 ring-primary/20":"bg-muted text-muted-foreground border-2 border-muted-foreground/30"}`,children:v<i?a.jsx(Pt,{className:"h-5 w-5"}):a.jsx(S,{className:"h-4 w-4"})}),a.jsx("div",{className:"mt-2 text-center",children:a.jsx("div",{className:`text-xs font-medium transition-colors ${v<=i?"text-primary":"text-muted-foreground"}`,children:j})})]}),_<2&&a.jsx("div",{className:"flex-1 mx-4",children:a.jsx("div",{className:"h-0.5 bg-muted relative",children:a.jsx("div",{className:`h-full bg-primary transition-all duration-500 ease-out ${v<i?"w-full":"w-0"}`})})})]},v))})}),w(),a.jsxs("div",{className:"flex justify-between items-center pt-6 border-t",children:[a.jsx(le,{variant:"ghost",onClick:y,disabled:i===1,className:"text-muted-foreground hover:text-foreground",children:" Previous"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(le,{variant:"outline",onClick:p,className:"text-muted-foreground",children:"Cancel"}),i<3?a.jsx(le,{onClick:x,className:"min-w-24",children:"Next "}):a.jsx(le,{onClick:g,disabled:c,className:"min-w-32",children:c?a.jsxs(a.Fragment,{children:[a.jsx(Hn,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Create Project"]})})]})]})]})]})})},Cj=e=>e;console.log(" Mock data system is DISABLED - Using real data only");let ji={data:null,timestamp:0,userId:null};const kj=3e4,Mq=e=>{const[t,r]=L.useState({creator:null,clients:[],projects:[],chatbots:[],analytics:[],isLoading:!0,error:null,refreshData:()=>{}}),s=L.useRef(null),n=L.useRef(null),i=L.useCallback(async(d=!1)=>{if(!e){console.error(" [Fast Dashboard] No userId provided"),console.log(" [Fast Dashboard] userId value:",e),r(f=>({...f,isLoading:!1,error:"Authentication required. Please log in."}));return}console.log(" [Fast Dashboard] Starting fetch for userId:",e);const u=Date.now();if(!d&&ji.data&&ji.userId===e&&u-ji.timestamp<kj){console.log(" [Fast Dashboard] Using cached data"),r(ji.data);return}try{console.log(" [Fast Dashboard] Fetching fresh data..."),r(A=>({...A,isLoading:!0,error:null})),console.log(" [Fast Dashboard] Using reliable simple queries..."),console.log(" [Fast Dashboard] Querying creators with userId:",e),console.log(" [Fast Dashboard] userId type:",typeof e),console.log(" [Fast Dashboard] userId length:",e.length);const f=!1;console.log(" [Fast Dashboard] Dev mode:",f);const{data:{user:h},error:m}=await he.auth.getUser();if(console.log(" [Fast Dashboard] Current auth user:",h==null?void 0:h.id),console.log(" [Fast Dashboard] Auth error:",m),console.log(" [Fast Dashboard] Querying for userId:",e),console.log(" [Fast Dashboard] Auth match:",(h==null?void 0:h.id)===e),m)throw console.error(" [Fast Dashboard] Auth error:",m),new Error(`Authentication error: ${m.message}`);if(!h)throw console.error(" [Fast Dashboard] No authenticated user found"),new Error("No authenticated user found. Please log in again.");if(h.id!==e)throw console.error(" [Fast Dashboard] User ID mismatch:",{current:h.id,requested:e}),new Error("User ID mismatch. Please log in again.");let g,p;if(!f){const A=await he.from("creators").select("id, agency_name, contact_email, user_id").eq("user_id",e).limit(1);g=A.data,p=A.error}if(p)throw console.error(" [Fast Dashboard] Creator fetch error:",p),console.error(" [Fast Dashboard] Error details:",{message:p.message,details:p.details,hint:p.hint,code:p.code,queriedUserId:e,currentUser:h==null?void 0:h.id,authMatch:(h==null?void 0:h.id)===e}),p.code==="PGRST116"?new Error("Creator profile not found. Please contact support to set up your account."):p.message.includes("permission denied")?new Error("Permission denied. Please log in again."):new Error(`Failed to fetch creator: ${p.message}`);console.log(" [Fast Dashboard] Query result:",g);const{data:x}=await he.from("creators").select("id, user_id, agency_name").limit(5);if(console.log(" [Fast Dashboard] All creators in DB (first 5):",x),!g||g.length===0)throw console.error(" [Fast Dashboard] No creator found for userId:",e),console.error(" [Fast Dashboard] Available creators:",x),new Error(`Creator profile not found for user ID: ${e.substring(0,8)}...`);const y=g[0];console.log(" [Fast Dashboard] Creator fetched:",y.agency_name);const{data:w,error:v}=await he.from("end_clients").select("*").eq("creator_id",y.id);if(v)throw console.error(" [Fast Dashboard] Clients fetch error:",v),new Error(`Failed to fetch clients: ${v.message}`);const j=w||[];console.log(" [Fast Dashboard] Clients fetched:",j.length);let S=[];if(j.length>0){const A=j.map(Y=>Y.id),{data:E,error:U}=await he.from("projects").select("*").in("end_client_id",A);if(U)throw console.error(" [Fast Dashboard] Projects fetch error:",U),new Error(`Failed to fetch projects: ${U.message}`);S=E||[],console.log(" [Fast Dashboard] Projects fetched:",S.length)}const _=y;let T=[],N=[];if(S.length>0){const A=S.map(se=>se.id),[E,U,Y]=await Promise.allSettled([he.from("chatbots").select("*").in("project_id",A),he.from("analytics").select("*").in("project_id",A),he.from("imported_analytics").select("*").in("project_id",A)]);E.status==="fulfilled"&&!E.value.error?T=E.value.data||[]:console.warn(" [Fast Dashboard] Chatbots fetch failed:",E.status==="rejected"?E.reason:E.value.error);const ee=[];U.status==="fulfilled"&&!U.value.error?ee.push(...U.value.data||[]):console.warn(" [Fast Dashboard] Analytics fetch failed:",U.status==="rejected"?U.reason:U.value.error),Y.status==="fulfilled"&&!Y.value.error?(Y.value.data||[]).forEach(W=>{W.page_views>0&&ee.push({id:`${W.id}_pv`,metric_type:"view",metric_value:W.page_views,date:W.date,project_id:W.project_id,end_client_id:W.end_client_id}),W.visitors>0&&ee.push({id:`${W.id}_uv`,metric_type:"unique_visitor",metric_value:W.visitors,date:W.date,project_id:W.project_id,end_client_id:W.end_client_id}),W.avg_time>0&&ee.push({id:`${W.id}_time`,metric_type:"time_spent",metric_value:W.avg_time,date:W.date,project_id:W.project_id,end_client_id:W.end_client_id})}):console.warn(" [Fast Dashboard] Imported analytics fetch failed:",Y.status==="rejected"?Y.reason:Y.value.error),N=ee}const b=j.map(A=>Cj({...A,projects:(A.projects||[]).map(U=>({...U,chatbots:T.filter(Y=>Y.project_id===U.id)}))})),O={creator:{id:_.id,agency_name:_.agency_name,contact_email:_.contact_email,user_id:_.user_id},clients:b,projects:S,chatbots:T,analytics:N,isLoading:!1,error:null,refreshData:()=>{}};console.log(" [Fast Dashboard] Data fetch complete:",{creator:O.creator.agency_name,clientsCount:O.clients.length,projectsCount:O.projects.length,chatbotsCount:O.chatbots.length,analyticsCount:O.analytics.length}),ji={data:O,timestamp:u,userId:e},r(O)}catch(f){console.error(" [Fast Dashboard] Error:",f);let h="Unknown error occurred";f instanceof Error&&(h=f.message,f.message.includes("Cannot coerce the result to a single JSON object")?h="Database query returned multiple results. Please contact support.":f.message.includes("Failed to fetch creator")?h="Unable to load your profile. Please try refreshing the page.":f.message.includes("Creator profile not found")&&(h="Your profile was not found. Please contact support.")),r(m=>({...m,isLoading:!1,error:h}))}},[e]),o=L.useCallback(()=>{n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{console.log("[Fast Dashboard] Real-time update triggered"),i(!0)},1e3)},[i]),c=L.useCallback(()=>{console.log(" [Fast Dashboard] Manual refresh triggered"),i(!0)},[i]);return L.useEffect(()=>{console.log(" [Fast Dashboard] Hook initialized with userId:",e),e?i():console.log(" [Fast Dashboard] No userId, skipping fetch")},[i,e]),L.useEffect(()=>{if(!e||!t.creator)return;console.log("[Fast Dashboard] Setting up real-time subscriptions");const d=he.channel("fast-dashboard-updates").on("postgres_changes",{event:"*",schema:"public",table:"analytics"},u=>{console.log("[Fast Dashboard] Analytics change detected:",u),o()}).on("postgres_changes",{event:"*",schema:"public",table:"imported_analytics"},u=>{console.log("[Fast Dashboard] Imported analytics change detected:",u),o()}).on("postgres_changes",{event:"*",schema:"public",table:"projects"},u=>{console.log("[Fast Dashboard] Project change detected:",u),o()}).on("postgres_changes",{event:"*",schema:"public",table:"end_clients"},u=>{console.log("[Fast Dashboard] Client change detected:",u),o()}).subscribe(u=>{console.log("[Fast Dashboard] Subscription status:",u)});return s.current=d,()=>{console.log("[Fast Dashboard] Cleaning up real-time subscriptions"),s.current&&he.removeChannel(s.current),n.current&&clearTimeout(n.current)}},[e,t.creator,o]),{...t,refreshData:c}},Uq=({projectId:e,projectTitle:t,clientName:r,clientEmail:s})=>{const{toast:n}=vt(),[i,o]=L.useState(""),[c,l]=L.useState(!1);L.useEffect(()=>{const m=`${window.location.origin}/client/${e}`;o(m)},[e]);const d=async()=>{try{await navigator.clipboard.writeText(i),l(!0),n({title:"URL Copied!",description:"Client portal URL has been copied to clipboard."}),setTimeout(()=>l(!1),2e3)}catch{n({title:"Copy Failed",description:"Could not copy URL. Please copy manually.",variant:"destructive"})}},u=()=>{window.open(i,"_blank")},f=()=>{const h=`Your Virtual Tour Portal - ${t}`,m=`Hi ${r},

Your virtual tour portal is ready! Click the link below to access your project dashboard:

${i}

In your portal, you can:
 View your project details and analytics
 Download shared media files
 Submit requests for changes
 Chat with your AI assistant

If you have any questions, please don't hesitate to contact us.

Best regards,
Your Tour Creator Team`,g=`mailto:${s}?subject=${encodeURIComponent(h)}&body=${encodeURIComponent(m)}`;window.open(g)};return a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(nu,{className:"h-5 w-5"}),"Share Client Portal"]}),a.jsxs(He,{children:["Share the client portal with ",r," so they can access their project dashboard"]})]}),a.jsxs(de,{className:"space-y-6",children:[a.jsxs("div",{className:"bg-muted/50 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"font-semibold",children:t}),a.jsx(Le,{variant:"outline",children:"Active"})]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Client: ",r," (",s,")"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{children:"Client Portal URL"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ue,{value:i,readOnly:!0,className:"flex-1"}),a.jsx(le,{variant:"outline",size:"sm",onClick:d,className:"shrink-0",children:c?"Copied!":a.jsxs(a.Fragment,{children:[a.jsx(Qf,{className:"h-4 w-4 mr-1"}),"Copy"]})})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Share this URL with your client. They can access their portal directly."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs(le,{variant:"outline",onClick:u,className:"flex items-center gap-2",children:[a.jsx(Ot,{className:"h-4 w-4"}),"Preview Portal"]}),a.jsxs(le,{variant:"outline",onClick:f,className:"flex items-center gap-2",children:[a.jsx(Xs,{className:"h-4 w-4"}),"Send Email"]}),a.jsxs(le,{onClick:d,className:"flex items-center gap-2",children:[a.jsx(Qf,{className:"h-4 w-4"}),"Copy URL"]})]}),a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"How to Share:"}),a.jsxs("ol",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-decimal list-inside",children:[a.jsx("li",{children:"Copy the URL above"}),a.jsx("li",{children:"Send it to your client via email, WhatsApp, or any messaging app"}),a.jsx("li",{children:"Your client clicks the link to access their portal"}),a.jsx("li",{children:"They can view their project, analytics, and submit requests"})]})]}),a.jsxs("div",{className:"bg-green-50 dark:bg-green-950/20 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-green-900 dark:text-green-100 mb-2",children:"What Your Client Will See:"}),a.jsxs("ul",{className:"text-sm text-green-800 dark:text-green-200 space-y-1 list-disc list-inside",children:[a.jsx("li",{children:"Project overview with details and stats"}),a.jsx("li",{children:"Analytics dashboard with performance metrics"}),a.jsx("li",{children:"Media library to download shared files"}),a.jsx("li",{children:"Request form to ask for changes"}),a.jsx("li",{children:"Chatbot interface for questions"})]})]})]})]})},$q=({isOpen:e,onClose:t,client:r,onClientUpdated:s})=>{const{toast:n}=vt(),[i,o]=L.useState(!1),[c,l]=L.useState(!1),[d,u]=L.useState({name:"",email:"",company:"",phone:"",website:""});L.useEffect(()=>{r&&u({name:r.name||"",email:r.email||"",company:r.company||"",phone:r.phone||"",website:r.website||""})},[r]);const f=(p,x)=>{u(y=>({...y,[p]:x}))},h=async p=>{if(p.preventDefault(),console.log("EditClientModal: handleSubmit called"),console.log("Client data:",r),console.log("Form data:",d),!r){console.error("No client data provided"),n({title:"Error",description:"Client information not found.",variant:"destructive"});return}if(!r.id){console.error("Client ID is missing:",r),n({title:"Error",description:"Client ID is missing. Cannot update.",variant:"destructive"});return}if(!d.name.trim()||!d.email.trim()||!d.company.trim()){n({title:"Required fields missing",description:"Name, email, and company are required.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)){n({title:"Invalid email",description:"Please enter a valid email address.",variant:"destructive"});return}try{o(!0);const y={name:d.name.trim(),email:d.email.trim().toLowerCase(),company:d.company.trim(),phone:d.phone.trim()||null,website:d.website.trim()||null,updated_at:new Date().toISOString()};console.log("Updating client with ID:",r.id),console.log("Sanitized data:",y);const{data:w,error:v}=await he.from("end_clients").update(y).eq("id",r.id).select();if(console.log("Update result:",{data:w,error:v}),v){console.error("Error updating client:",v),console.error("Error details:",{message:v.message,details:v.details,hint:v.hint,code:v.code});let j="Unable to update client data. Please try again.";throw v.message.includes("permission denied")?j="Permission denied. You can only update your own clients.":v.message.includes("duplicate key")?j="Email already exists. Please use a different email address.":v.message.includes("violates check constraint")?j="Invalid data format. Please check your input.":v.message.includes("JWT")&&(j="Authentication error. Please refresh the page and try again."),new Error(j)}if(!w||w.length===0)throw new Error("No client was updated. The client may not exist or you may not have permission to update it.");console.log("Client updated successfully:",w[0]),n({title:"Client updated",description:`${y.name}'s data has been updated successfully.`}),s(),t()}catch(y){console.error("Error updating client:",y),n({title:"Error",description:y.message||"Unable to update client data. Please try again.",variant:"destructive"})}finally{o(!1)}},m=()=>{i||t()},g=async()=>{if(r)try{l(!0);const{error:p}=await he.from("projects").delete().eq("end_client_id",r.id);p&&console.error("Error deleting client projects:",p);const{error:x}=await he.from("end_clients").delete().eq("id",r.id);if(x)throw x;n({title:"Client deleted",description:"The client and all associated projects have been permanently removed.",variant:"default"}),s(),t()}catch(p){console.error("Error deleting client:",p),n({title:"Delete failed",description:"We could not delete this client. Please try again.",variant:"destructive"})}finally{l(!1)}};return a.jsx(ai,{open:e,onOpenChange:m,children:a.jsxs(dn,{className:"sm:max-w-[500px]",children:[a.jsxs(un,{children:[a.jsx(fn,{children:"Edit Client"}),a.jsx(nl,{children:"Modify client information. Changes will be reflected across all sections of the app."})]}),a.jsxs("form",{onSubmit:h,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"name",children:"Name *"}),a.jsx(Ue,{id:"name",value:d.name,onChange:p=>f("name",p.target.value),placeholder:"Client name",required:!0,disabled:i,className:"input-safe"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"email",children:"Email *"}),a.jsx(Ue,{id:"email",type:"email",value:d.email,onChange:p=>f("email",p.target.value),placeholder:"email@example.com",required:!0,disabled:i,className:"input-safe"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"company",children:"Company *"}),a.jsx(Ue,{id:"company",value:d.company,onChange:p=>f("company",p.target.value),placeholder:"Company name",required:!0,disabled:i,className:"input-safe"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"phone",children:"Phone"}),a.jsx(Ue,{id:"phone",value:d.phone,onChange:p=>f("phone",p.target.value),placeholder:"+1 123 456 7890",disabled:i,className:"input-safe"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"website",children:"Website"}),a.jsx(Ue,{id:"website",value:d.website,onChange:p=>f("website",p.target.value),placeholder:"https://www.example.com",disabled:i,className:"input-long-text"})]}),a.jsxs(sl,{className:"flex justify-between",children:[a.jsxs(Xx,{children:[a.jsx(_j,{asChild:!0,children:a.jsxs(le,{type:"button",variant:"destructive",disabled:i||c,children:[c&&a.jsx(De,{className:"mr-2 h-4 w-4 animate-spin"}),a.jsx(js,{className:"mr-2 h-4 w-4"}),"Delete Client"]})}),a.jsxs(wu,{children:[a.jsxs(_u,{children:[a.jsx(Nu,{children:"Delete Client"}),a.jsxs(ju,{children:['Are you sure you want to delete "',r==null?void 0:r.name,'"?',a.jsx("br",{}),a.jsx("br",{}),a.jsx("strong",{children:"This action cannot be undone."})," This will permanently remove:",a.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[a.jsx("li",{children:"The client and all their information"}),a.jsx("li",{children:"All associated projects"}),a.jsx("li",{children:"Associated chatbots and analytics"}),a.jsx("li",{children:"All related data and files"})]})]})]}),a.jsxs(bu,{children:[a.jsx(Eu,{children:"Cancel"}),a.jsx(Tu,{onClick:g,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Client"})]})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(le,{type:"button",variant:"outline",onClick:m,disabled:i||c,children:"Cancel"}),a.jsx(le,{type:"submit",disabled:i||c,className:"bg-blue-600 hover:bg-blue-700",children:i?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Updating..."]}):"Update Client"})]})]})]})]})})},e1=e=>e?e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()).trim():"",Su=e=>({virtual_tour:"Virtual Tour","3d_showcase":"3D Showcase",interactive_map:"Interactive Map",real_estate:"Real Estate",hospitality:"Hospitality",retail:"Retail",corporate:"Corporate",education:"Education",healthcare:"Healthcare",other:"Other"})[e]||e1(e),Rj=e=>({active:"Active",inactive:"Inactive",draft:"Draft",archived:"Archived",setup:"Setup",pending:"Pending",completed:"Completed"})[e]||e1(e),Ij=({prefilledData:e,onDataUsed:t})=>{const{toast:r}=vt(),{user:s}=Mr(),[n,i]=L.useState([]),o=L.useRef(null),c=L.useRef(null),[l,d]=L.useState(!0),[u,f]=L.useState(""),[h,m]=L.useState("all"),[g,p]=L.useState("all"),[x,y]=L.useState("all"),[w,v]=L.useState(null),[j,S]=L.useState(!1);L.useEffect(()=>{s!=null&&s.id&&_()},[s==null?void 0:s.id]);const _=async()=>{try{d(!0);const{data:W,error:J}=await he.from("requests").select(`
          *,
          projects!inner(
            id,
            title,
            end_clients!inner(
              id,
              name,
              email,
              company,
              creators!inner(
                id,
                user_id
              )
            )
          )
        `).eq("projects.end_clients.creators.user_id",s==null?void 0:s.id).order("created_at",{ascending:!1});if(J)throw J;const F=(W||[]).map(te=>{var fe,R,G,P,C,K;return{id:te.id,title:te.title,description:te.description,client:{name:((R=(fe=te.projects)==null?void 0:fe.end_clients)==null?void 0:R.name)||"Unknown Client",email:((P=(G=te.projects)==null?void 0:G.end_clients)==null?void 0:P.email)||"",company:((K=(C=te.projects)==null?void 0:C.end_clients)==null?void 0:K.company)||"Unknown Company"},request_type:te.request_type,priority:te.priority,status:te.status,hotspots:[],files:[],created_at:te.created_at,updated_at:te.updated_at,assigned_to:void 0,estimated_completion:void 0,actual_completion:void 0}});i(F)}catch(W){console.error("Error loading requests:",W),r({title:"Error",description:"Failed to load client requests",variant:"destructive"})}finally{d(!1)}};L.useEffect(()=>{if(!(s!=null&&s.id))return;console.log("[ClientRequestsHub] Setting up real-time subscriptions");const W=he.channel(`client-requests-${s.id}`).on("postgres_changes",{event:"*",schema:"public",table:"requests"},J=>{console.log("[ClientRequestsHub] Request change detected:",J),T()}).subscribe(J=>{console.log("[ClientRequestsHub] Subscription status:",J)});return o.current=W,()=>{console.log("[ClientRequestsHub] Cleaning up real-time subscriptions"),o.current&&he.removeChannel(o.current),c.current&&clearTimeout(c.current)}},[s==null?void 0:s.id]);const T=()=>{c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{console.log("[ClientRequestsHub] Triggering debounced refresh"),_()},1e3)},N=W=>{switch(W){case"open":return"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800";case"in_progress":return"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800";case"completed":return"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800";case"cancelled":return"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700"}},b=W=>{switch(W){case"open":return a.jsx(it,{className:"h-3 w-3"});case"in_progress":return a.jsx(lc,{className:"h-3 w-3"});case"completed":return a.jsx(Pt,{className:"h-3 w-3"});case"cancelled":return a.jsx(yr,{className:"h-3 w-3"});default:return a.jsx(Mt,{className:"h-3 w-3"})}},O=W=>{switch(W){case"urgent":return"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800";case"high":return"bg-orange-100 text-orange-800 border-orange-200 dark:bg-orange-900/20 dark:text-orange-400 dark:border-orange-800";case"normal":return"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800";case"low":return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700"}},A=W=>{switch(W){case"urgent":return a.jsx(Mt,{className:"h-3 w-3"});case"high":return a.jsx(Pr,{className:"h-3 w-3"});case"normal":return a.jsx(Ba,{className:"h-3 w-3"});case"low":return a.jsx(it,{className:"h-3 w-3"});default:return a.jsx(Ba,{className:"h-3 w-3"})}},E=n.filter(W=>{const J=W.title.toLowerCase().includes(u.toLowerCase())||W.description.toLowerCase().includes(u.toLowerCase())||W.client.name.toLowerCase().includes(u.toLowerCase())||W.client.company.toLowerCase().includes(u.toLowerCase()),F=h==="all"||W.client.name===h,te=g==="all"||W.status===g,fe=x==="all"||W.priority===x;return J&&F&&te&&fe}),U=Array.from(new Set(n.map(W=>W.client.name))),Y=W=>{v(W),S(!0)},ee=(W,J)=>{i(F=>F.map(te=>te.id===W?{...te,status:J,updated_at:new Date().toISOString()}:te)),r({title:"Status Updated",description:`Request status updated to ${J.replace("_"," ")}.`})},se={total:n.length,pending:n.filter(W=>W.status==="open").length,inProgress:n.filter(W=>W.status==="in_progress").length,completed:n.filter(W=>W.status==="completed").length,urgent:n.filter(W=>W.priority==="urgent").length};return a.jsxs("div",{className:"space-y-8 animate-fade-in",children:[a.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:"Client Requests Hub"}),a.jsx("p",{className:"text-foreground-secondary text-sm sm:text-base",children:"Manage all requests from all your clients in one centralized location"})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Total Requests"}),a.jsx(Jt,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:se.total}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["From ",U.length," clients"]})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Pending"}),a.jsx(it,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:se.pending}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting action"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"In Progress"}),a.jsx(lc,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:se.inProgress}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently working"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Completed"}),a.jsx(Pt,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:se.completed}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully delivered"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Urgent"}),a.jsx(Mt,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:se.urgent}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"High priority"})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ei,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{placeholder:"Search requests, clients, or descriptions...",value:u,onChange:W=>f(W.target.value),className:"pl-10"})]}),a.jsxs(pt,{value:h,onValueChange:m,children:[a.jsx(ct,{className:"w-full sm:w-48",children:a.jsx(gt,{placeholder:"Filter by client"})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All Clients"}),U.map(W=>a.jsx(ve,{value:W,children:W},W))]})]}),a.jsxs(pt,{value:g,onValueChange:p,children:[a.jsx(ct,{className:"w-full sm:w-48",children:a.jsx(gt,{placeholder:"Filter by status"})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All Status"}),a.jsx(ve,{value:"open",children:"Open"}),a.jsx(ve,{value:"in_progress",children:"In Progress"}),a.jsx(ve,{value:"completed",children:"Completed"}),a.jsx(ve,{value:"cancelled",children:"Cancelled"})]})]}),a.jsxs(pt,{value:x,onValueChange:y,children:[a.jsx(ct,{className:"w-full sm:w-48",children:a.jsx(gt,{placeholder:"Filter by priority"})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All Priority"}),a.jsx(ve,{value:"urgent",children:"Urgent"}),a.jsx(ve,{value:"high",children:"High"}),a.jsx(ve,{value:"normal",children:"Normal"}),a.jsx(ve,{value:"low",children:"Low"})]})]})]}),l?a.jsx("div",{className:"space-y-4",children:Array.from({length:3}).map((W,J)=>a.jsx(oe,{className:"animate-pulse",children:a.jsx(de,{className:"p-6",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-10 h-10 bg-muted rounded-full"}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),a.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-6 bg-muted rounded w-20"}),a.jsx("div",{className:"h-4 bg-muted rounded w-16"})]})]})})},J))}):a.jsx("div",{className:"space-y-4",children:E.map(W=>a.jsx(oe,{className:"hover:shadow-md transition-shadow",children:a.jsx(de,{className:"p-6",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-start gap-4 flex-1 min-w-0",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-primary flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-sm font-semibold text-primary-foreground",children:W.client.name.split(" ").map(J=>J[0]).join("").toUpperCase()})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground line-clamp-1 flex-1 min-w-0",children:W.title}),a.jsx(Le,{className:O(W.priority),children:a.jsxs("div",{className:"flex items-center gap-1",children:[A(W.priority),W.priority]})})]}),a.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:W.description}),a.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(tn,{className:"h-3 w-3"}),a.jsx("span",{children:W.client.name})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(qn,{className:"h-3 w-3"}),a.jsx("span",{children:W.client.company})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yr,{className:"h-3 w-3"}),a.jsx("span",{children:new Date(W.created_at).toLocaleDateString()})]}),W.assigned_to&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(oa,{className:"h-3 w-3"}),a.jsxs("span",{children:["Assigned to ",W.assigned_to]})]})]})]})]}),a.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[a.jsx(Le,{className:N(W.status),children:a.jsxs("div",{className:"flex items-center gap-1",children:[b(W.status),W.status.replace("_"," ")]})}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsxs(le,{variant:"outline",size:"sm",onClick:()=>Y(W),children:[a.jsx(Ot,{className:"h-3 w-3 mr-1"}),"View"]}),a.jsx(le,{variant:"ghost",size:"sm",children:a.jsx(_g,{className:"h-4 w-4"})})]})]})]})})},W.id))}),!l&&E.length===0&&a.jsx(oe,{children:a.jsx(de,{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Jt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No requests found"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:u||h!=="all"||g!=="all"||x!=="all"?"Try adjusting your search or filters":"No client requests have been submitted yet"})]})})}),a.jsx(ai,{open:j,onOpenChange:S,children:a.jsxs(dn,{className:"max-w-2xl",children:[a.jsx(un,{children:a.jsx(fn,{children:"Request Details"})}),w&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-primary flex items-center justify-center",children:a.jsx("span",{className:"text-lg font-semibold text-primary-foreground",children:w.client.name.split(" ").map(W=>W[0]).join("").toUpperCase()})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-xl font-semibold mb-2",children:w.title}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Le,{className:N(w.status),children:a.jsxs("div",{className:"flex items-center gap-1",children:[b(w.status),w.status.replace("_"," ")]})}),a.jsx(Le,{className:O(w.priority),children:a.jsxs("div",{className:"flex items-center gap-1",children:[A(w.priority),w.priority]})})]}),a.jsx("p",{className:"text-muted-foreground",children:w.description})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Client"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:w.client.name}),a.jsx("p",{className:"text-sm text-muted-foreground",children:w.client.company})]}),a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Request Type"}),a.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:w.request_type})]}),a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Created"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(w.created_at).toLocaleString()})]}),a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Last Updated"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(w.updated_at).toLocaleString()})]})]}),w.assigned_to&&a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Assigned To"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:w.assigned_to})]}),w.estimated_completion&&a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Estimated Completion"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(w.estimated_completion).toLocaleString()})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(le,{variant:"outline",onClick:()=>ee(w.id,"in_progress"),disabled:w.status==="in_progress",children:"Start Work"}),a.jsx(le,{variant:"outline",onClick:()=>ee(w.id,"completed"),disabled:w.status==="completed",children:"Mark Complete"}),a.jsxs(le,{variant:"outline",children:[a.jsx(Yc,{className:"h-4 w-4 mr-2"}),"Edit"]})]})]})]})})]})},Oj=({prefilledData:e,onDataUsed:t})=>a.jsx(Ij,{prefilledData:e,onDataUsed:t}),t1=L.forwardRef(({className:e,...t},r)=>a.jsx(Sg,{ref:r,className:Ie("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:a.jsx(k_,{className:Ie("flex items-center justify-center text-current"),children:a.jsx(Ns,{className:"h-4 w-4"})})}));t1.displayName=Sg.displayName;const pc=({name:e,size:t="md",className:r})=>{const n=(o=>{if(!o)return"?";const c=o.trim().split(" ").filter(l=>l.length>0);return c.length===0?"?":c.slice(0,2).map(l=>l[0].toUpperCase()).join("")})(e),i={sm:"w-8 h-8 text-xs",md:"w-12 h-12 text-sm",lg:"w-16 h-16 text-lg"};return a.jsx("div",{className:Ie("relative flex items-center justify-center rounded-full bg-primary",i[t],r),children:a.jsx("span",{className:"font-bold text-primary-foreground",children:n})})},r1=e=>{const[t,r]=L.useState({creator:null,clients:[],projects:[],chatbots:[],leads:[],analytics:[],requests:[],assets:[],stats:{totalClients:0,totalProjects:0,totalChatbots:0,totalLeads:0,totalViews:0,activeProjects:0},isLoading:!0,error:null}),s=L.useRef(null),n=L.useRef(null);L.useEffect(()=>{if(!e){r(m=>({...m,isLoading:!1}));return}(async()=>{try{r(Y=>({...Y,isLoading:!0,error:null}));const{data:m,error:g}=await he.from("creators").select(`
            *,
            end_clients(
              *,
              projects(
                *,
                chatbots(*),
                requests(*)
              )
            )
          `).eq("user_id",e).limit(1).single();if(g)throw new Error(`Failed to fetch creator: ${g.message}`);if(!m)throw new Error("Creator profile not found");const p=m.end_clients||[],x=p.flatMap(Y=>Y.projects||[]),y=x.flatMap(Y=>Y.chatbots||[]),w=x.flatMap(Y=>Y.requests||[]),v=x.map(Y=>Y.id),[j,S]=await Promise.all([he.from("analytics").select("*").in("project_id",v),he.from("imported_analytics").select("*").in("project_id",v)]),_=[];j.data&&_.push(...j.data),S.data&&S.data.forEach(Y=>{Y.page_views>0&&_.push({id:`${Y.id}_pv`,metric_type:"view",metric_value:Y.page_views,date:Y.date,project_id:Y.project_id,end_client_id:Y.end_client_id}),Y.visitors>0&&_.push({id:`${Y.id}_uv`,metric_type:"unique_visitor",metric_value:Y.visitors,date:Y.date,project_id:Y.project_id,end_client_id:Y.end_client_id}),Y.avg_time>0&&_.push({id:`${Y.id}_time`,metric_type:"time_spent",metric_value:Y.avg_time,date:Y.date,project_id:Y.project_id,end_client_id:Y.end_client_id})});const T=_,[{data:N,error:b},{data:O,error:A}]=await Promise.all([v.length>0?he.from("leads").select(`
                *,
                chatbots(
                  projects(
                    end_clients(creator_id)
                  )
                )
              `).eq("chatbots.projects.end_clients.creator_id",m.id).order("created_at",{ascending:!1}):Promise.resolve({data:[],error:null}),he.from("assets").select("*").eq("creator_id",m.id).order("created_at",{ascending:!1})]);if(b)throw new Error(`Failed to fetch leads: ${b.message}`);if(A)throw new Error(`Failed to fetch assets: ${A.message}`);const E=(T==null?void 0:T.filter(Y=>Y.metric_type==="view").reduce((Y,ee)=>Y+ee.metric_value,0))||0,U=(x==null?void 0:x.filter(Y=>Y.status==="active").length)||0;r({creator:m,clients:p||[],projects:x||[],chatbots:y||[],leads:N||[],analytics:T||[],requests:w||[],assets:O||[],stats:{totalClients:(p==null?void 0:p.length)||0,totalProjects:(x==null?void 0:x.length)||0,totalChatbots:(y==null?void 0:y.length)||0,totalLeads:(N==null?void 0:N.length)||0,totalViews:E,activeProjects:U},isLoading:!1,error:null})}catch(m){console.error("Error fetching creator dashboard data:",m),r(g=>({...g,isLoading:!1,error:m instanceof Error?m.message:"An unknown error occurred"}))}})()},[e]),L.useEffect(()=>{if(!e||!t.creator)return;console.log("[CreatorDashboard] Setting up real-time subscriptions");const h=he.channel(`creator-dashboard-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"requests"},m=>{console.log("[CreatorDashboard] Request change detected:",m),i()}).on("postgres_changes",{event:"*",schema:"public",table:"projects"},m=>{console.log("[CreatorDashboard] Project change detected:",m),i()}).on("postgres_changes",{event:"*",schema:"public",table:"assets"},m=>{console.log("[CreatorDashboard] Asset change detected:",m),i()}).on("postgres_changes",{event:"*",schema:"public",table:"analytics"},m=>{console.log("[CreatorDashboard] Analytics change detected:",m),i()}).on("postgres_changes",{event:"*",schema:"public",table:"imported_analytics"},m=>{console.log("[CreatorDashboard] Imported analytics change detected:",m),i()}).on("postgres_changes",{event:"*",schema:"public",table:"end_clients"},m=>{console.log("[CreatorDashboard] Client change detected:",m),i()}).on("postgres_changes",{event:"*",schema:"public",table:"chatbots"},m=>{console.log("[CreatorDashboard] Chatbot change detected:",m),i()}).on("postgres_changes",{event:"*",schema:"public",table:"analytics"},m=>{console.log("[CreatorDashboard] Analytics change detected:",m),i()}).on("postgres_changes",{event:"*",schema:"public",table:"imported_analytics"},m=>{console.log("[CreatorDashboard] Imported analytics change detected:",m),i()}).subscribe(m=>{console.log("[CreatorDashboard] Subscription status:",m)});return s.current=h,()=>{console.log("[CreatorDashboard] Cleaning up real-time subscriptions"),s.current&&he.removeChannel(s.current),n.current&&clearTimeout(n.current)}},[e,t.creator]);const i=()=>{n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{console.log("[CreatorDashboard] Triggering debounced refresh"),fetchCreatorData()},1e3)};return{...t,getProjectsForClient:h=>t.projects.filter(m=>m.end_client_id===h),getChatbotsForProject:h=>t.chatbots.filter(m=>m.project_id===h),getLeadsForChatbot:h=>t.leads.filter(m=>m.chatbot_id===h),getRecentLeads:(h=10)=>t.leads.slice(0,h),getPendingRequests:()=>t.requests.filter(h=>h.status==="open"||h.status==="in_progress"),refreshData:async()=>{if(e)try{r(O=>({...O,isLoading:!0,error:null}));const{data:h,error:m}=await he.from("creators").select("*").eq("user_id",e).single();if(m||!h)throw new Error("Failed to fetch creator");const{data:g,error:p}=await he.from("end_clients").select("*").eq("creator_id",h.id).order("created_at",{ascending:!1}),x=(g==null?void 0:g.map(O=>O.id))||[],{data:y,error:w}=x.length>0?await he.from("projects").select("*").in("end_client_id",x).order("created_at",{ascending:!1}):{data:[],error:null},v=(y==null?void 0:y.map(O=>O.id))||[],[{data:j},{data:S},{data:_},{data:T}]=await Promise.all([v.length>0?he.from("chatbots").select("*").in("project_id",v).order("created_at",{ascending:!1}):Promise.resolve({data:[],error:null}),v.length>0?he.from("analytics").select("*").in("project_id",v).order("date",{ascending:!1}):Promise.resolve({data:[],error:null}),v.length>0?he.from("requests").select("*").in("project_id",v).order("created_at",{ascending:!1}):Promise.resolve({data:[],error:null}),he.from("assets").select("*").eq("creator_id",h.id).order("created_at",{ascending:!1})]),N=(S==null?void 0:S.filter(O=>O.metric_type==="view").reduce((O,A)=>O+A.metric_value,0))||0,b=(y==null?void 0:y.filter(O=>O.status==="active").length)||0;r({creator:h,clients:g||[],projects:y||[],chatbots:j||[],leads:[],analytics:S||[],requests:_||[],assets:T||[],stats:{totalClients:(g==null?void 0:g.length)||0,totalProjects:(y==null?void 0:y.length)||0,totalChatbots:(j==null?void 0:j.length)||0,totalLeads:0,totalViews:N,activeProjects:b},isLoading:!1,error:null})}catch(h){console.error("Error refreshing data:",h),r(m=>({...m,isLoading:!1,error:h instanceof Error?h.message:"Failed to refresh data"}))}}}};function Pj(){const[e,t]=L.useState(!1),[r,s]=L.useState([]),[n,i]=L.useState(!1),[o,c]=L.useState("media"),[l,d]=L.useState(null),[u,f]=L.useState({title:"",description:"",type:"link",url:"",file:null}),{user:h}=Mr(),{clients:m,projects:g,assets:p,isLoading:x,refreshData:y,error:w}=r1((h==null?void 0:h.id)||""),{toast:v}=vt(),j=L.useRef(null),S=L.useRef(null),_=(P,C)=>P==="audio"||C.toLowerCase().includes("audio")?"Audio":P==="video"||C.toLowerCase().includes("video")?"Video":P==="image"||C.toLowerCase().includes("image")||C.toLowerCase().includes("photo")?"Image":P==="document"||C.toLowerCase().includes("document")||C.toLowerCase().includes("pdf")?"Document":P==="link"?"Link":"File";L.useEffect(()=>{if(!(h!=null&&h.id))return;console.log("[MediaLibrary] Setting up real-time subscriptions");const P=he.channel(`media-library-${h.id}`).on("postgres_changes",{event:"*",schema:"public",table:"assets"},C=>{console.log("[MediaLibrary] Asset change detected:",C),T()}).on("postgres_changes",{event:"*",schema:"public",table:"projects"},C=>{console.log("[MediaLibrary] Project change detected:",C),T()}).on("postgres_changes",{event:"*",schema:"public",table:"end_clients"},C=>{console.log("[MediaLibrary] Client change detected:",C),T()}).subscribe(C=>{console.log("[MediaLibrary] Subscription status:",C)});return j.current=P,()=>{console.log("[MediaLibrary] Cleaning up real-time subscriptions"),j.current&&he.removeChannel(j.current),S.current&&clearTimeout(S.current)}},[h==null?void 0:h.id]);const T=()=>{S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{console.log("[MediaLibrary] Triggering debounced refresh"),y()},1e3)},[N,b]=L.useState(null),[O,A]=L.useState(!1),E=P=>{b(P),A(!0)},U=async()=>{if(N)try{const{error:P}=await he.from("assets").delete().eq("id",N);if(P)throw P;v({title:"Media deleted",description:"The item was removed from your library."}),await y()}catch(P){console.error("Error deleting asset:",P),v({title:"Delete failed",description:"Could not delete the media.",variant:"destructive"})}finally{b(null),A(!1)}},Y=()=>{b(null),A(!1)};if(w)return a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-red-500 mb-4",children:" Error loading data"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:w}),a.jsx(le,{onClick:()=>window.location.reload(),children:"Try Again"})]})});if(x)return a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(De,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading media library..."})]})});const ee=p||[],W=(m||[]).filter(P=>g&&g.some(C=>C.end_client_id===P.id)),J=P=>{if(!g||!ee)return[];const C=g.find(K=>K.end_client_id===P);return C?ee.filter(K=>K.project_id===C.id):[]},F=P=>J(P).length,te=P=>{s(C=>C.includes(P)?C.filter(K=>K!==P):[...C,P])},fe=async()=>{if(!u.title.trim()||!u.url.trim()){v({title:"Error",description:"Title and Link URL are required fields",variant:"destructive"});return}try{new URL(u.url)}catch{v({title:"Error",description:"Please enter a valid URL (e.g., https://example.com)",variant:"destructive"});return}if(r.length===0){v({title:"Error",description:"Please select at least one client",variant:"destructive"});return}i(!0);try{const{data:P,error:C}=await he.from("creators").select("id").eq("user_id",h==null?void 0:h.id).single();if(C||!P)throw new Error("Creator profile not found");const{data:K,error:D}=await he.from("projects").select("id, title, end_client_id").in("end_client_id",r);if(D)throw new Error("Failed to fetch client projects");if(!K||K.length===0)throw new Error("No projects found for selected clients");const Q=K.map(X=>({creator_id:P.id,project_id:X.id,filename:u.title,original_filename:u.title,file_type:u.type==="link"?"text/url":`application/${u.type}`,file_size:0,file_url:u.url,thumbnail_url:u.type==="image"?u.url:null,tags:[],metadata:{description:u.description,type:u.type,sent_to_clients:r.length}})),{error:z}=await he.from("assets").insert(Q);if(z)throw new Error(`Failed to save media: ${z.message}`);v({title:"Success",description:`Media sent to ${r.length} client(s) successfully!`}),t(!1),f({title:"",description:"",type:"link",url:"",file:null}),s([]),await y()}catch(P){console.error("Error sending media:",P);const C=P instanceof Error?P.message:"Failed to send media";v({title:"Error",description:C,variant:"destructive"})}finally{i(!1)}},R=P=>{d(P),c("clients")},G=()=>{d(null),c("media")};return a.jsxs("div",{className:"space-y-8 animate-fade-in",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[o==="clients"&&l&&a.jsx(le,{variant:"outline",onClick:G,className:"flex items-center gap-2",children:" Back to Media Library"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:o==="clients"&&l?`${l.name} - Media Dashboard`:"Media Library"}),a.jsx("p",{className:"text-foreground-secondary text-sm sm:text-base",children:o==="clients"&&l?`View all media shared with ${l.name} and their end user dashboard`:"Manage and distribute media content to your clients"})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[!l&&a.jsxs(a.Fragment,{children:[a.jsx(le,{variant:o==="media"?"default":"outline",onClick:()=>c("media"),size:"sm",children:"Media View"}),a.jsx(le,{variant:o==="clients"?"default":"outline",onClick:()=>c("clients"),size:"sm",children:"Clients View"})]}),a.jsxs(le,{className:"bg-primary hover:bg-primary-hover",onClick:()=>t(!0),children:[a.jsx(rc,{className:"h-4 w-4 mr-2"}),"Share Link"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Total Media Items"}),a.jsx(Sa,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:ee.length}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Media items in library"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Total Clients"}),a.jsx(gr,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:W.length}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Active clients"})]})]})]}),o==="media"?ee.length===0?a.jsx(oe,{className:"p-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(R_,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground opacity-50"}),a.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Media Yet"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:"Start by adding your first media item to share with clients"}),a.jsxs(le,{onClick:()=>t(!0),children:[a.jsx(rc,{className:"h-4 w-4 mr-2"}),"Share Your First Link"]})]})}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ee.map(P=>a.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[a.jsx(ye,{className:"pb-3",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:(()=>{const C=P.file_type||"",D=(P.title||P.original_filename||P.filename||"").toLowerCase(),Q=C.toLowerCase();return Q==="audio"||D.includes("audio")||D.includes("music")||D.includes("sound")?a.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})}):Q==="video"||D.includes("video")||D.includes("movie")||D.includes("clip")?a.jsx("div",{className:"w-8 h-8 bg-red-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})}):Q==="image"||D.includes("image")||D.includes("photo")||D.includes("picture")?a.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})}):Q==="document"||D.includes("document")||D.includes("pdf")||D.includes("file")?a.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})}):a.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})})})()}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx(we,{className:"text-sm font-medium truncate",children:P.original_filename||P.filename}),a.jsx(He,{className:"text-xs",children:_(P.file_type||"",P.title||P.original_filename||P.filename||"")})]})]}),a.jsxs(Le,{variant:"secondary",className:"text-xs",children:[Math.round((P.file_size||0)/1024),"KB"]})]})}),a.jsx(de,{className:"pt-0",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[a.jsxs("span",{children:["Uploaded ",new Date(P.created_at).toLocaleDateString()]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ot,{className:"h-3 w-3"}),a.jsx("span",{children:"0 views"})]})]}),P.tags&&P.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1",children:P.tags.slice(0,3).map((C,K)=>a.jsx(Le,{variant:"outline",className:"text-xs",children:C},K))}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(le,{size:"sm",variant:"outline",className:"flex-1",children:[a.jsx(Kc,{className:"h-3 w-3 mr-1"}),"Send"]}),a.jsx(le,{size:"sm",variant:"outline",children:a.jsx(Yc,{className:"h-3 w-3"})}),a.jsx(le,{size:"sm",variant:"outline",onClick:()=>E(P.id),children:a.jsx(js,{className:"h-3 w-3"})})]})]})})]},P.id))}):o==="clients"&&l?a.jsxs("div",{className:"space-y-6",children:[a.jsx(oe,{children:a.jsx(ye,{children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center text-2xl font-bold",children:l.name.charAt(0)}),a.jsxs("div",{children:[a.jsx(we,{className:"text-2xl",children:l.name}),a.jsx(He,{className:"text-lg",children:l.company}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx(Le,{variant:l.status==="active"?"default":"secondary",children:l.status}),a.jsx("span",{className:"text-sm text-muted-foreground",children:l.email})]})]})]})})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-semibold mb-4",children:["Media Shared with ",l.name,a.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",F(l.id)," items)"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:J(l.id).map(P=>a.jsxs(oe,{className:"hover:shadow-lg transition-shadow",children:[a.jsx(ye,{className:"pb-3",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:(()=>{const C=P.file_type||"",D=(P.title||P.original_filename||P.filename||"").toLowerCase(),Q=C.toLowerCase();return Q==="audio"||D.includes("audio")||D.includes("music")||D.includes("sound")?a.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})}):Q==="video"||D.includes("video")||D.includes("movie")||D.includes("clip")?a.jsx("div",{className:"w-8 h-8 bg-red-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})}):Q==="image"||D.includes("image")||D.includes("photo")||D.includes("picture")?a.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})}):Q==="document"||D.includes("document")||D.includes("pdf")||D.includes("file")?a.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})}):a.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-lg font-bold",children:""})})})()}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx(we,{className:"text-sm font-medium truncate",children:P.original_filename||P.filename}),a.jsx(He,{className:"text-xs",children:_(P.file_type||"",P.title||P.original_filename||P.filename||"")})]})]})})}),a.jsx(de,{className:"pt-0",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[a.jsxs("span",{children:["Shared ",new Date(P.created_at).toLocaleDateString()]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ot,{className:"h-3 w-3"}),a.jsx("span",{children:"0 views"})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(le,{size:"sm",variant:"outline",className:"flex-1",asChild:!0,children:a.jsxs("a",{href:P.file_url||P.url,target:"_blank",rel:"noopener noreferrer",children:[a.jsx(Lr,{className:"h-3 w-3 mr-1"}),"View Media"]})})})]})})]},P.id))})]})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:W.map(P=>a.jsxs(oe,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>R(P),children:[a.jsx(ye,{children:a.jsxs("div",{className:"card-header-safe",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[a.jsx(pc,{name:P.name,size:"md",className:"flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx(we,{className:"text-lg name-display-safe",children:P.name}),a.jsx(He,{className:"company-display-safe",children:P.company})]})]}),a.jsx(Le,{variant:P.status==="active"?"default":"secondary",className:"flex-shrink-0",children:P.status})]})}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[a.jsx(Xs,{className:"h-4 w-4"}),a.jsx("span",{className:"email-display-safe",children:P.email})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-muted-foreground",children:"Media shared:"}),a.jsxs("span",{className:"font-medium",children:[F(P.id)," items"]})]})]})})]},P.id))}),a.jsx(ai,{open:e,onOpenChange:t,children:a.jsxs(dn,{className:"sm:max-w-[500px]",children:[a.jsx(un,{children:a.jsx(fn,{children:"Share Media Link"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Se,{htmlFor:"title",children:"Title *"}),a.jsx(Ue,{id:"title",value:u.title,onChange:P=>f(C=>({...C,title:P.target.value})),placeholder:"Enter media title",required:!0})]}),a.jsxs("div",{children:[a.jsx(Se,{htmlFor:"description",children:"Description"}),a.jsx(Bt,{id:"description",value:u.description,onChange:P=>f(C=>({...C,description:P.target.value})),placeholder:"Enter media description",rows:3})]}),a.jsxs("div",{children:[a.jsx(Se,{htmlFor:"url",children:"Link URL *"}),a.jsx(Ue,{id:"url",value:u.url,onChange:P=>f(C=>({...C,url:P.target.value})),placeholder:"https://example.com/media-file",required:!0,type:"url"})]}),a.jsxs("div",{children:[a.jsx(Se,{children:"Send to Clients"}),a.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto border rounded-md p-3",children:W.map(P=>a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(t1,{id:P.id,checked:r.includes(P.id),onCheckedChange:()=>te(P.id)}),a.jsxs(Se,{htmlFor:P.id,className:"text-sm",children:[P.name," (",P.company,")"]})]},P.id))})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(le,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),a.jsx(le,{onClick:fe,disabled:n,children:n?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(rc,{className:"h-4 w-4 mr-2"}),"Share Link"]})})]})]})]})}),a.jsx(Xx,{open:O,onOpenChange:A,children:a.jsxs(wu,{children:[a.jsxs(_u,{children:[a.jsx(Nu,{children:"Delete Media"}),a.jsxs(ju,{children:["Are you sure you want to delete this media from your library?",a.jsx("br",{}),a.jsx("br",{}),a.jsx("strong",{children:"This action cannot be undone."})," The media file will be permanently removed."]})]}),a.jsxs(bu,{children:[a.jsx(Eu,{onClick:Y,children:"Cancel"}),a.jsx(Tu,{onClick:U,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Media"})]})]})})]})}const Dj=()=>{const{toast:e}=vt(),{agencySettings:t,updateAgencySettings:r}=xu(),s=rs(),[n,i]=L.useState({agency_name:t.agency_name,agency_logo:"/tourcompanion-logo.png",contact_email:t.current_user_email,phone:"",website:"",address:"",description:""}),[o,c]=L.useState({google_calendar:!1,realsee_oauth:!1,stripe_connected:!1,webhook_url:""}),[l,d]=L.useState(!1),[u,f]=L.useState(!0),[h,m]=L.useState(null),[g,p]=L.useState({plan:null,status:null,isTester:!1}),x=L.useCallback(async()=>{try{f(!0),m(null);const{data:{user:_},error:T}=await he.auth.getUser();if(T||!_)throw new Error("User not authenticated");const{data:N,error:b}=await he.from("creators").select("*").eq("user_id",_.id).single();N&&!b?i({agency_name:N.agency_name||"",agency_logo:"/tourcompanion-logo.png",contact_email:N.contact_email||_.email||"",phone:N.phone||"",website:N.website||"",address:N.address||"",description:N.description||""}):(console.error("Profile error:",b),i({agency_name:"",agency_logo:"/tourcompanion-logo.png",contact_email:_.email||"",phone:"",website:"",address:"",description:""}));try{const E=localStorage.getItem("jwt_token");if(E){const Y=await(await fetch("/api/billing/subscription-status",{headers:{Authorization:`Bearer ${E}`}})).json();Y!=null&&Y.success&&p({plan:Y.data.plan,status:Y.data.status,isTester:Y.data.isTester})}}catch{console.warn("Unable to load subscription status in settings")}const{data:O,error:A}=await he.from("integration_settings").select("*").eq("user_id","anonymous").single();O&&!A&&c(E=>({...E,...O}))}catch(_){console.error("Error loading settings:",_),m(Z.SETTINGS_PAGE.ERROR_SAVING_PROFILE),e({title:Z.TOAST.ERROR,description:Z.SETTINGS_PAGE.ERROR_SAVING_PROFILE,variant:"destructive"})}finally{f(!1)}},[]);L.useEffect(()=>{x()},[x]);const y=async()=>{try{if(d(!0),!n.agency_name.trim()){e({title:Z.TOAST.ERROR,description:"Agency name is required",variant:"destructive"});return}if(!n.contact_email.trim()){e({title:Z.TOAST.ERROR,description:"Contact email is required",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.contact_email)){e({title:Z.TOAST.ERROR,description:"Please enter a valid email address",variant:"destructive"});return}await r({agency_name:n.agency_name,agency_logo:"/tourcompanion-logo.png",current_user_email:n.contact_email});const{data:{user:T},error:N}=await he.auth.getUser();if(N||!T)throw new Error("User not authenticated");const{error:b}=await he.from("creators").update({agency_name:n.agency_name,agency_logo:"/tourcompanion-logo.png",contact_email:n.contact_email,phone:n.phone,website:n.website,address:n.address,description:n.description,updated_at:new Date().toISOString()}).eq("user_id",T.id);if(b)throw b;e({title:Z.SETTINGS_PAGE.PROFILE_UPDATED,description:Z.SETTINGS_PAGE.PROFILE_UPDATED_DESCRIPTION})}catch(_){console.error("Error saving profile:",_),e({title:Z.TOAST.ERROR,description:Z.SETTINGS_PAGE.ERROR_SAVING_PROFILE,variant:"destructive"})}finally{d(!1)}},w=async()=>{try{d(!0);const{error:_}=await he.from("integration_settings").upsert({...o,user_id:"anonymous",updated_at:new Date().toISOString()});if(_)throw _;e({title:Z.SETTINGS_PAGE.INTEGRATIONS_UPDATED,description:Z.SETTINGS_PAGE.INTEGRATIONS_UPDATED_DESCRIPTION})}catch(_){console.error("Error saving integrations:",_),e({title:Z.TOAST.ERROR,description:Z.SETTINGS_PAGE.ERROR_SAVING_INTEGRATIONS,variant:"destructive"})}finally{d(!1)}},v=async()=>{try{d(!0),await new Promise(_=>setTimeout(_,2e3)),c(_=>({..._,google_calendar:!0})),e({title:Z.SETTINGS_PAGE.GOOGLE_CALENDAR_CONNECTED,description:Z.SETTINGS_PAGE.GOOGLE_CALENDAR_CONNECTED_DESCRIPTION})}catch(_){console.error("Error connecting Google Calendar:",_),e({title:Z.TOAST.ERROR,description:Z.SETTINGS_PAGE.ERROR_CONNECTING_GOOGLE,variant:"destructive"})}finally{d(!1)}},j=async()=>{try{d(!0),await new Promise(_=>setTimeout(_,2e3)),c(_=>({..._,realsee_oauth:!0})),e({title:Z.SETTINGS_PAGE.REALSEE_CONNECTED,description:Z.SETTINGS_PAGE.REALSEE_CONNECTED_DESCRIPTION})}catch(_){console.error("Error connecting Realsee:",_),e({title:Z.TOAST.ERROR,description:Z.SETTINGS_PAGE.ERROR_CONNECTING_REALSEE,variant:"destructive"})}finally{d(!1)}},S=async()=>{try{d(!0),await new Promise(_=>setTimeout(_,2e3)),c(_=>({..._,stripe_connected:!0})),e({title:Z.SETTINGS_PAGE.STRIPE_CONNECTED,description:Z.SETTINGS_PAGE.STRIPE_CONNECTED_DESCRIPTION})}catch(_){console.error("Error connecting Stripe:",_),e({title:Z.TOAST.ERROR,description:Z.SETTINGS_PAGE.ERROR_CONNECTING_STRIPE,variant:"destructive"})}finally{d(!1)}};return u?a.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:Z.SETTINGS_PAGE.SETTINGS}),a.jsx("p",{className:"text-foreground-secondary text-sm sm:text-base",children:Z.SETTINGS_PAGE.MANAGE_ACCOUNT})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((_,T)=>a.jsxs(oe,{className:"animate-pulse",children:[a.jsxs(ye,{children:[a.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),a.jsx("div",{className:"h-3 bg-muted rounded w-full"})]}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-3 bg-muted rounded w-1/2"}),a.jsx("div",{className:"h-3 bg-muted rounded w-2/3"})]})})]},T))})]}):h?a.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:Z.SETTINGS_PAGE.SETTINGS}),a.jsx("p",{className:"text-foreground-secondary text-sm sm:text-base",children:Z.SETTINGS_PAGE.MANAGE_ACCOUNT})]}),a.jsx(oe,{children:a.jsx(de,{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-destructive mb-2",children:h}),a.jsx(le,{onClick:x,variant:"outline",children:"Try Again"})]})})})]}):a.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:Z.SETTINGS_PAGE.SETTINGS}),a.jsx("p",{className:"text-foreground-secondary text-sm sm:text-base",children:Z.SETTINGS_PAGE.MANAGE_ACCOUNT})]}),a.jsxs(ln,{defaultValue:"profile",className:"space-y-6",children:[a.jsxs(ks,{className:"grid w-full grid-cols-3",children:[a.jsx(bt,{value:"profile",className:"text-xs sm:text-sm",children:Z.SETTINGS_PAGE.PROFILE}),a.jsx(bt,{value:"billing",className:"text-xs sm:text-sm",children:Z.SETTINGS_PAGE.BILLING}),a.jsx(bt,{value:"integrations",className:"text-xs sm:text-sm",children:Z.SETTINGS_PAGE.INTEGRATIONS})]}),a.jsxs(Nt,{value:"profile",className:"space-y-6",children:[!n.contact_email.trim()&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Mt,{className:"h-5 w-5 text-red-600"}),a.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Required Information Missing"})]}),a.jsx("p",{className:"text-sm text-red-700 mt-1",children:"Please provide your contact email address. This is required for support requests and account management."})]}),a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(tn,{className:"h-5 w-5"}),Z.SETTINGS_PAGE.AGENCY_PROFILE]}),a.jsx(He,{children:Z.SETTINGS_PAGE.MANAGE_AGENCY_INFO})]}),a.jsxs(de,{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Se,{htmlFor:"agency_name",children:[Z.SETTINGS_PAGE.AGENCY_NAME," *"]}),a.jsx(Ue,{id:"agency_name",value:n.agency_name,onChange:_=>i(T=>({...T,agency_name:_.target.value})),placeholder:Z.SETTINGS_PAGE.ENTER_AGENCY_NAME})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Se,{htmlFor:"contact_email",className:"text-red-600 font-medium",children:[Z.SETTINGS_PAGE.CONTACT_EMAIL," *"]}),a.jsx(Ue,{id:"contact_email",type:"email",value:n.contact_email,onChange:_=>i(T=>({...T,contact_email:_.target.value})),placeholder:Z.SETTINGS_PAGE.ENTER_CONTACT_EMAIL,className:n.contact_email.trim()?"":"border-red-300 focus:border-red-500",required:!0}),!n.contact_email.trim()&&a.jsx("p",{className:"text-sm text-red-600",children:"Contact email is required"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"phone",children:Z.SETTINGS_PAGE.PHONE}),a.jsx(Ue,{id:"phone",value:n.phone,onChange:_=>i(T=>({...T,phone:_.target.value})),placeholder:Z.SETTINGS_PAGE.ENTER_PHONE})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"website",children:Z.SETTINGS_PAGE.WEBSITE}),a.jsx(Ue,{id:"website",value:n.website,onChange:_=>i(T=>({...T,website:_.target.value})),placeholder:Z.SETTINGS_PAGE.ENTER_WEBSITE,className:"input-safe"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{children:"Logo"}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[a.jsx("img",{src:"/tourcompanion-logo.png",alt:"TourCompanion Logo",className:"w-12 h-12 object-contain"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"TourCompanion Logo"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"This logo cannot be changed"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"address",children:Z.SETTINGS_PAGE.ADDRESS}),a.jsx(Bt,{id:"address",value:n.address,onChange:_=>i(T=>({...T,address:_.target.value})),placeholder:Z.SETTINGS_PAGE.ENTER_ADDRESS,rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"description",children:Z.SETTINGS_PAGE.DESCRIPTION}),a.jsx(Bt,{id:"description",value:n.description,onChange:_=>i(T=>({...T,description:_.target.value})),placeholder:Z.SETTINGS_PAGE.ENTER_DESCRIPTION,rows:4})]}),a.jsx(le,{onClick:y,disabled:l||!n.agency_name.trim()||!n.contact_email.trim(),children:l?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ka,{className:"h-4 w-4 mr-2"}),Z.SETTINGS_PAGE.SAVE_PROFILE]})}),(!n.agency_name.trim()||!n.contact_email.trim())&&a.jsx("p",{className:"text-sm text-muted-foreground",children:"Please fill in all required fields (marked with *) to save your profile."})]})]})]}),a.jsx(Nt,{value:"billing",className:"space-y-6",children:a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(Fi,{className:"h-5 w-5"}),Z.SETTINGS_PAGE.BILLING_SUBSCRIPTION]}),a.jsx(He,{children:Z.SETTINGS_PAGE.MANAGE_SUBSCRIPTION})]}),a.jsxs(de,{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:Z.SETTINGS_PAGE.CURRENT_PLAN}),a.jsx("p",{className:"text-sm text-muted-foreground",children:g.plan==="pro"?"Pro":"Free"})]}),a.jsx(Le,{variant:g.plan!=="pro"||g.status==="active"?"default":"outline",children:g.plan==="pro"?g.status?g.status:"Inactive":"Active"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs(le,{variant:"outline",className:"h-20",onClick:async()=>{var _;try{const T=localStorage.getItem("jwt_token");if(!T){e({title:"Sign in required",description:"Please sign in to manage billing",variant:"destructive"});return}const b=await(await fetch("/api/billing/customer-portal",{method:"POST",headers:{Authorization:`Bearer ${T}`}})).json();b!=null&&b.success&&((_=b.data)!=null&&_.url)?window.open(b.data.url,"_blank"):e({title:"Billing portal unavailable",description:(b==null?void 0:b.error)||"Try again later",variant:"destructive"})}catch{e({title:"Billing portal error",description:"Unable to open billing portal",variant:"destructive"})}},disabled:!g.plan,children:[a.jsx(Fi,{className:"h-5 w-5 mr-2"}),Z.SETTINGS_PAGE.MANAGE_PAYMENT_METHODS]}),a.jsxs(le,{variant:"outline",className:"h-20",onClick:()=>s("/billing"),children:[a.jsx(Lr,{className:"h-5 w-5 mr-2"}),Z.SETTINGS_PAGE.VIEW_BILLING_HISTORY]})]}),a.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[a.jsx("h4",{className:"font-medium mb-2",children:Z.SETTINGS_PAGE.USAGE_THIS_MONTH}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:Z.SETTINGS_PAGE.PROJECTS}),a.jsx("span",{className:"text-muted-foreground",children:"Plan limit applies"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:Z.SETTINGS_PAGE.STORAGE}),a.jsx("span",{className:"text-muted-foreground",children:"Real-time data"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{children:Z.SETTINGS_PAGE.API_CALLS}),a.jsx("span",{className:"text-muted-foreground",children:"Real-time data"})]})]})]}),g.plan==="basic"&&a.jsx("div",{className:"flex justify-end",children:a.jsx(le,{onClick:()=>s("/pricing"),children:"Upgrade to Pro"})})]})]})}),a.jsx(Nt,{value:"integrations",className:"space-y-6",children:a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(rc,{className:"h-5 w-5"}),Z.SETTINGS_PAGE.INTEGRATIONS_TITLE]}),a.jsx(He,{children:Z.SETTINGS_PAGE.CONNECT_SERVICES})]}),a.jsxs(de,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Yr,{className:"h-8 w-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:Z.SETTINGS_PAGE.GOOGLE_CALENDAR}),a.jsx("p",{className:"text-sm text-muted-foreground",children:Z.SETTINGS_PAGE.SYNC_APPOINTMENTS})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:o.google_calendar?a.jsxs(Le,{variant:"default",className:"flex items-center gap-1",children:[a.jsx(Pt,{className:"h-3 w-3"}),Z.SETTINGS_PAGE.CONNECTED]}):a.jsx(le,{size:"sm",onClick:v,disabled:l,children:l?a.jsx(De,{className:"h-4 w-4 animate-spin"}):Z.SETTINGS_PAGE.CONNECT})})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ag,{className:"h-8 w-8 text-green-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:Z.SETTINGS_PAGE.REALSEE_OAUTH}),a.jsx("p",{className:"text-sm text-muted-foreground",children:Z.SETTINGS_PAGE.SECURE_CONNECTION})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:o.realsee_oauth?a.jsxs(Le,{variant:"default",className:"flex items-center gap-1",children:[a.jsx(Pt,{className:"h-3 w-3"}),Z.SETTINGS_PAGE.CONNECTED]}):a.jsx(le,{size:"sm",onClick:j,disabled:l,children:l?a.jsx(De,{className:"h-4 w-4 animate-spin"}):Z.SETTINGS_PAGE.CONNECT})})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Fi,{className:"h-8 w-8 text-purple-600"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:Z.SETTINGS_PAGE.STRIPE}),a.jsx("p",{className:"text-sm text-muted-foreground",children:Z.SETTINGS_PAGE.PAYMENT_PROCESSING})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:o.stripe_connected?a.jsxs(Le,{variant:"default",className:"flex items-center gap-1",children:[a.jsx(Pt,{className:"h-3 w-3"}),Z.SETTINGS_PAGE.CONNECTED]}):a.jsx(le,{size:"sm",onClick:S,disabled:l,children:l?a.jsx(De,{className:"h-4 w-4 animate-spin"}):Z.SETTINGS_PAGE.CONNECT})})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"webhook_url",children:Z.SETTINGS_PAGE.WEBHOOK_URL}),a.jsx(Ue,{id:"webhook_url",value:o.webhook_url,onChange:_=>c(T=>({...T,webhook_url:_.target.value})),placeholder:Z.SETTINGS_PAGE.ENTER_WEBHOOK_URL})]}),a.jsx(le,{onClick:w,disabled:l,children:l?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ka,{className:"h-4 w-4 mr-2"}),Z.SETTINGS_PAGE.SAVE_INTEGRATIONS]})})]})]})})]})]})},Lj={CheckCircle:Pt,Eye:Ot,AlertCircle:Mt,Award:I_,Plus:Ts,Edit:Yc,Bot:da,Settings:Ka,UserPlus:O_,MessageSquare:Jt,BarChart3:Or,Users:gr,Clock:it},Fj=e=>{switch(e){case"high":return"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800";case"low":return"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700"}},Mj=e=>{const t=new Date,r=new Date(e),s=Math.floor((t.getTime()-r.getTime())/1e3);if(s<60)return"Just now";if(s<3600){const n=Math.floor(s/60);return`${n} minute${n>1?"s":""} ago`}else if(s<86400){const n=Math.floor(s/3600);return`${n} hour${n>1?"s":""} ago`}else if(s<604800){const n=Math.floor(s/86400);return`${n} day${n>1?"s":""} ago`}else return r.toLocaleDateString()},Au=({activities:e,loading:t=!1,error:r=null,onRefresh:s,title:n="Recent Activity",description:i="Latest updates and interactions",showStats:o=!1,maxItems:c=10})=>{const l=e.slice(0,c);return t?a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(Ba,{className:"h-5 w-5"}),n]}),a.jsx(He,{children:i})]}),a.jsx(de,{children:a.jsxs("div",{className:"flex items-center justify-center py-8",children:[a.jsx(De,{className:"h-6 w-6 animate-spin text-muted-foreground"}),a.jsx("span",{className:"ml-2 text-muted-foreground",children:"Loading activities..."})]})})]}):r?a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(Ba,{className:"h-5 w-5"}),n]}),a.jsx(He,{children:i})]}),a.jsx(de,{children:a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Mt,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),a.jsx("p",{className:"text-red-600 dark:text-red-400 mb-2",children:"Failed to load activities"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:r}),s&&a.jsxs(le,{variant:"outline",size:"sm",onClick:s,children:[a.jsx(Jf,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})})})]}):l.length===0?a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(Ba,{className:"h-5 w-5"}),n]}),a.jsx(He,{children:i})]}),a.jsx(de,{children:a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx(it,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),a.jsx("p",{className:"text-muted-foreground font-medium",children:"No recent activity"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Only showing activity from the last 48 hours"}),a.jsx("p",{className:"text-xs text-muted-foreground/70 mt-2",children:"Create projects, share media, or generate leads to see activity here"})]})})})]}):a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(Ba,{className:"h-5 w-5"}),n]}),a.jsx(He,{children:i})]}),s&&a.jsx(le,{variant:"ghost",size:"sm",onClick:s,children:a.jsx(Jf,{className:"h-4 w-4"})})]}),o&&a.jsxs("div",{className:"flex gap-2 mt-2",children:[a.jsxs(Le,{variant:"secondary",children:[e.length," total"]}),a.jsxs(Le,{variant:"outline",children:[e.filter(d=>{const u=new Date;return u.setDate(u.getDate()-1),new Date(d.timestamp)>u}).length," today"]})]})]}),a.jsxs(de,{children:[a.jsx("div",{className:"space-y-4",children:l.map(d=>{var f;const u=Lj[d.icon.component]||it;return a.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-lg hover:bg-muted/50 transition-colors",children:[a.jsx("div",{className:`p-2 rounded-full ${d.icon.bgColor}`,children:a.jsx(u,{className:`h-4 w-4 ${d.icon.color}`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-foreground line-clamp-1",children:d.title}),a.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mt-1",children:d.description})]}),a.jsx("div",{className:"flex items-center gap-2 flex-shrink-0 ml-2",children:a.jsx(Le,{variant:"outline",className:`text-xs ${Fj(d.priority)}`,children:d.priority})})]}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx(it,{className:"h-3 w-3 text-muted-foreground"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:Mj(d.timestamp)}),((f=d.metadata)==null?void 0:f.projectTitle)&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:""}),a.jsx("span",{className:"text-xs text-muted-foreground",children:d.metadata.projectTitle})]})]})]})]},d.id)})}),e.length>c&&a.jsx("div",{className:"mt-4 pt-4 border-t",children:a.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Showing ",c," of ",e.length," activities"]})})]})]})},Cu=e=>{const[t,r]=L.useState({totalViews:0,totalVisitors:0,avgEngagementTime:0,totalLeads:0,conversionRate:0,avgSatisfaction:0,lastActivity:null,loading:!0,error:null}),[s,n]=L.useState(null),i=L.useCallback(async()=>{try{r(j=>({...j,loading:!0,error:null})),console.log(" [useUnifiedAnalytics] Fetching data for:",e);const o={};e.projectId&&(o.project_id=e.projectId),e.endClientId&&(o.end_client_id=e.endClientId),e.creatorId&&(o.creator_id=e.creatorId);const[c,l]=await Promise.all([he.from("analytics").select("*").match(o),he.from("imported_analytics").select("*").match(o)]);if(c.error)throw console.error(" [useUnifiedAnalytics] Analytics error:",c.error),c.error;if(l.error)throw console.error(" [useUnifiedAnalytics] Imported analytics error:",l.error),l.error;const d=[];c.data&&d.push(...c.data),l.data&&l.data.forEach(j=>{j.page_views>0&&d.push({id:`${j.id}_pv`,metric_type:"view",metric_value:j.page_views,date:j.date,project_id:j.project_id,end_client_id:j.end_client_id,created_at:j.created_at}),j.visitors>0&&d.push({id:`${j.id}_uv`,metric_type:"unique_visitor",metric_value:j.visitors,date:j.date,project_id:j.project_id,end_client_id:j.end_client_id,created_at:j.created_at}),j.avg_time>0&&d.push({id:`${j.id}_time`,metric_type:"time_spent",metric_value:j.avg_time,date:j.date,project_id:j.project_id,end_client_id:j.end_client_id,created_at:j.created_at})});const u=d.filter(j=>j.metric_type==="view").reduce((j,S)=>j+S.metric_value,0),f=d.filter(j=>j.metric_type==="unique_visitor").reduce((j,S)=>j+S.metric_value,0),h=d.filter(j=>j.metric_type==="time_spent"),m=h.length>0?h.reduce((j,S)=>j+S.metric_value,0)/h.length:0,g=d.filter(j=>j.metric_type==="lead_generated").reduce((j,S)=>j+S.metric_value,0),p=u>0?g/u*100:0,x=d.filter(j=>j.metric_type==="satisfaction"),y=x.length>0?x.reduce((j,S)=>j+S.metric_value,0)/x.length:0,w=d.length>0?d.reduce((j,S)=>new Date(S.created_at)>new Date(j.created_at)?S:j).created_at:null,v={totalViews:u,totalVisitors:f,avgEngagementTime:Math.round(m),totalLeads:g,conversionRate:Math.round(p*100)/100,avgSatisfaction:Math.round(y*100)/100,lastActivity:w,loading:!1,error:null};console.log(" [useUnifiedAnalytics] Calculated unified metrics:",v),r(v)}catch(o){console.error(" [useUnifiedAnalytics] Error:",o),r(c=>({...c,loading:!1,error:o instanceof Error?o.message:"Unknown error"}))}},[e.projectId,e.endClientId,e.creatorId]);return L.useEffect(()=>{if(!e.projectId&&!e.endClientId&&!e.creatorId)return;s&&he.removeChannel(s);const o=he.channel("unified-analytics").on("postgres_changes",{event:"*",schema:"public",table:"analytics"},c=>{console.log(" [useUnifiedAnalytics] Analytics change detected:",c),i()}).on("postgres_changes",{event:"*",schema:"public",table:"imported_analytics"},c=>{console.log(" [useUnifiedAnalytics] Imported analytics change detected:",c),i()}).subscribe();return n(o),i(),()=>{o&&he.removeChannel(o)}},[i]),t},Uj={page_views:"Views",visitors:"Visitors",total_time:"Total Time Spent",avg_time:"Avg. Session Duration",resource_code:"Tour ID",view:"Views",unique_visitor:"Visitors",time_spent:"Time Spent",chatbot_interaction:"Chat Interactions",hotspot_click:"Hotspot Clicks",lead_generated:"Leads Generated",active:"Active",inactive:"Inactive",pending:"Pending",completed:"Completed",in_progress:"In Progress",cancelled:"Cancelled",low:"Low",medium:"Medium",high:"High",urgent:"Urgent"};function gc(e){if(!e||e===0)return"0s";const t=Math.round(e),r=Math.floor(t/3600),s=Math.floor(t%3600/60),n=t%60,i=[];return r>0&&i.push(`${r}h`),s>0&&i.push(`${s}m`),n>0&&r===0&&i.push(`${n}s`),i.join(" ")||"0s"}function Bh(e){return e===0?"0":e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString()}function Bo(e){return Uj[e]||e}const $j=wo("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),xc=L.forwardRef(({className:e,variant:t,...r},s)=>a.jsx("div",{ref:s,role:"alert",className:Ie($j({variant:t}),e),...r}));xc.displayName="Alert";const Bj=L.forwardRef(({className:e,...t},r)=>a.jsx("h5",{ref:r,className:Ie("mb-1 font-medium leading-none tracking-tight",e),...t}));Bj.displayName="AlertTitle";const vc=L.forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:Ie("text-sm [&_p]:leading-relaxed",e),...t}));vc.displayName="AlertDescription";var a1={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(e,t){((r,s)=>{e.exports=s()})(ab,function r(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},n,i=!s.document&&!!s.postMessage,o=s.IS_PAPA_WORKER||!1,c={},l=0,d={};function u(N){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(b){var O=S(b);O.chunkSize=parseInt(O.chunkSize),b.step||b.chunk||(O.chunkSize=null),this._handle=new p(O),(this._handle.streamer=this)._config=O}).call(this,N),this.parseChunk=function(b,O){var A=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<A){let U=this._config.newline;U||(E=this._config.quoteChar||'"',U=this._handle.guessLineEndings(b,E)),b=[...b.split(U).slice(A)].join(U)}this.isFirstChunk&&T(this._config.beforeFirstChunk)&&(E=this._config.beforeFirstChunk(b))!==void 0&&(b=E),this.isFirstChunk=!1,this._halted=!1;var A=this._partialLine+b,E=(this._partialLine="",this._handle.parse(A,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(b=E.meta.cursor,A=(this._finished||(this._partialLine=A.substring(b-this._baseIndex),this._baseIndex=b),E&&E.data&&(this._rowCount+=E.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)s.postMessage({results:E,workerId:d.WORKER_ID,finished:A});else if(T(this._config.chunk)&&!O){if(this._config.chunk(E,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=E=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(E.data),this._completeResults.errors=this._completeResults.errors.concat(E.errors),this._completeResults.meta=E.meta),this._completed||!A||!T(this._config.complete)||E&&E.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),A||E&&E.meta.paused||this._nextChunk(),E}this._halted=!0},this._sendError=function(b){T(this._config.error)?this._config.error(b):o&&this._config.error&&s.postMessage({workerId:d.WORKER_ID,error:b,finished:!1})}}function f(N){var b;(N=N||{}).chunkSize||(N.chunkSize=d.RemoteChunkSize),u.call(this,N),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(O){this._input=O,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(b=new XMLHttpRequest,this._config.withCredentials&&(b.withCredentials=this._config.withCredentials),i||(b.onload=_(this._chunkLoaded,this),b.onerror=_(this._chunkError,this)),b.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var O,A=this._config.downloadRequestHeaders;for(O in A)b.setRequestHeader(O,A[O])}var E;this._config.chunkSize&&(E=this._start+this._config.chunkSize-1,b.setRequestHeader("Range","bytes="+this._start+"-"+E));try{b.send(this._config.downloadRequestBody)}catch(U){this._chunkError(U.message)}i&&b.status===0&&this._chunkError()}},this._chunkLoaded=function(){b.readyState===4&&(b.status<200||400<=b.status?this._chunkError():(this._start+=this._config.chunkSize||b.responseText.length,this._finished=!this._config.chunkSize||this._start>=(O=>(O=O.getResponseHeader("Content-Range"))!==null?parseInt(O.substring(O.lastIndexOf("/")+1)):-1)(b),this.parseChunk(b.responseText)))},this._chunkError=function(O){O=b.statusText||O,this._sendError(new Error(O))}}function h(N){(N=N||{}).chunkSize||(N.chunkSize=d.LocalChunkSize),u.call(this,N);var b,O,A=typeof FileReader<"u";this.stream=function(E){this._input=E,O=E.slice||E.webkitSlice||E.mozSlice,A?((b=new FileReader).onload=_(this._chunkLoaded,this),b.onerror=_(this._chunkError,this)):b=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var E=this._input,U=(this._config.chunkSize&&(U=Math.min(this._start+this._config.chunkSize,this._input.size),E=O.call(E,this._start,U)),b.readAsText(E,this._config.encoding));A||this._chunkLoaded({target:{result:U}})},this._chunkLoaded=function(E){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(E.target.result)},this._chunkError=function(){this._sendError(b.error)}}function m(N){var b;u.call(this,N=N||{}),this.stream=function(O){return b=O,this._nextChunk()},this._nextChunk=function(){var O,A;if(!this._finished)return O=this._config.chunkSize,b=O?(A=b.substring(0,O),b.substring(O)):(A=b,""),this._finished=!b,this.parseChunk(A)}}function g(N){u.call(this,N=N||{});var b=[],O=!0,A=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(E){this._input=E,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){A&&b.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),b.length?this.parseChunk(b.shift()):O=!0},this._streamData=_(function(E){try{b.push(typeof E=="string"?E:E.toString(this._config.encoding)),O&&(O=!1,this._checkIsFinished(),this.parseChunk(b.shift()))}catch(U){this._streamError(U)}},this),this._streamError=_(function(E){this._streamCleanUp(),this._sendError(E)},this),this._streamEnd=_(function(){this._streamCleanUp(),A=!0,this._streamData("")},this),this._streamCleanUp=_(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(N){var b,O,A,E,U=Math.pow(2,53),Y=-U,ee=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,se=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,W=this,J=0,F=0,te=!1,fe=!1,R=[],G={data:[],errors:[],meta:{}};function P(Q){return N.skipEmptyLines==="greedy"?Q.join("").trim()==="":Q.length===1&&Q[0].length===0}function C(){if(G&&A&&(D("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),A=!1),N.skipEmptyLines&&(G.data=G.data.filter(function(ne){return!P(ne)})),K()){let ne=function(k,Ce){T(N.transformHeader)&&(k=N.transformHeader(k,Ce)),R.push(k)};if(G)if(Array.isArray(G.data[0])){for(var Q=0;K()&&Q<G.data.length;Q++)G.data[Q].forEach(ne);G.data.splice(0,1)}else G.data.forEach(ne)}function z(ne,k){for(var Ce=N.header?{}:[],_e=0;_e<ne.length;_e++){var me=_e,pe=ne[_e],pe=((ue,je)=>($e=>(N.dynamicTypingFunction&&N.dynamicTyping[$e]===void 0&&(N.dynamicTyping[$e]=N.dynamicTypingFunction($e)),(N.dynamicTyping[$e]||N.dynamicTyping)===!0))(ue)?je==="true"||je==="TRUE"||je!=="false"&&je!=="FALSE"&&(($e=>{if(ee.test($e)&&($e=parseFloat($e),Y<$e&&$e<U))return 1})(je)?parseFloat(je):se.test(je)?new Date(je):je===""?null:je):je)(me=N.header?_e>=R.length?"__parsed_extra":R[_e]:me,pe=N.transform?N.transform(pe,me):pe);me==="__parsed_extra"?(Ce[me]=Ce[me]||[],Ce[me].push(pe)):Ce[me]=pe}return N.header&&(_e>R.length?D("FieldMismatch","TooManyFields","Too many fields: expected "+R.length+" fields but parsed "+_e,F+k):_e<R.length&&D("FieldMismatch","TooFewFields","Too few fields: expected "+R.length+" fields but parsed "+_e,F+k)),Ce}var X;G&&(N.header||N.dynamicTyping||N.transform)&&(X=1,!G.data.length||Array.isArray(G.data[0])?(G.data=G.data.map(z),X=G.data.length):G.data=z(G.data,0),N.header&&G.meta&&(G.meta.fields=R),F+=X)}function K(){return N.header&&R.length===0}function D(Q,z,X,ne){Q={type:Q,code:z,message:X},ne!==void 0&&(Q.row=ne),G.errors.push(Q)}T(N.step)&&(E=N.step,N.step=function(Q){G=Q,K()?C():(C(),G.data.length!==0&&(J+=Q.data.length,N.preview&&J>N.preview?O.abort():(G.data=G.data[0],E(G,W))))}),this.parse=function(Q,z,X){var ne=N.quoteChar||'"',ne=(N.newline||(N.newline=this.guessLineEndings(Q,ne)),A=!1,N.delimiter?T(N.delimiter)&&(N.delimiter=N.delimiter(Q),G.meta.delimiter=N.delimiter):((ne=((k,Ce,_e,me,pe)=>{var ue,je,$e,ot;pe=pe||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var tt=0;tt<pe.length;tt++){for(var jt,yt=pe[tt],Xe=0,ut=0,qe=0,Oe=($e=void 0,new y({comments:me,delimiter:yt,newline:Ce,preview:10}).parse(k)),ze=0;ze<Oe.data.length;ze++)_e&&P(Oe.data[ze])?qe++:(jt=Oe.data[ze].length,ut+=jt,$e===void 0?$e=jt:0<jt&&(Xe+=Math.abs(jt-$e),$e=jt));0<Oe.data.length&&(ut/=Oe.data.length-qe),(je===void 0||Xe<=je)&&(ot===void 0||ot<ut)&&1.99<ut&&(je=Xe,ue=yt,ot=ut)}return{successful:!!(N.delimiter=ue),bestDelimiter:ue}})(Q,N.newline,N.skipEmptyLines,N.comments,N.delimitersToGuess)).successful?N.delimiter=ne.bestDelimiter:(A=!0,N.delimiter=d.DefaultDelimiter),G.meta.delimiter=N.delimiter),S(N));return N.preview&&N.header&&ne.preview++,b=Q,O=new y(ne),G=O.parse(b,z,X),C(),te?{meta:{paused:!0}}:G||{meta:{paused:!1}}},this.paused=function(){return te},this.pause=function(){te=!0,O.abort(),b=T(N.chunk)?"":b.substring(O.getCharIndex())},this.resume=function(){W.streamer._halted?(te=!1,W.streamer.parseChunk(b,!0)):setTimeout(W.resume,3)},this.aborted=function(){return fe},this.abort=function(){fe=!0,O.abort(),G.meta.aborted=!0,T(N.complete)&&N.complete(G),b=""},this.guessLineEndings=function(k,ne){k=k.substring(0,1048576);var ne=new RegExp(x(ne)+"([^]*?)"+x(ne),"gm"),X=(k=k.replace(ne,"")).split("\r"),ne=k.split(`
`),k=1<ne.length&&ne[0].length<X[0].length;if(X.length===1||k)return`
`;for(var Ce=0,_e=0;_e<X.length;_e++)X[_e][0]===`
`&&Ce++;return Ce>=X.length/2?`\r
`:"\r"}}function x(N){return N.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(N){var b=(N=N||{}).delimiter,O=N.newline,A=N.comments,E=N.step,U=N.preview,Y=N.fastMode,ee=null,se=!1,W=N.quoteChar==null?'"':N.quoteChar,J=W;if(N.escapeChar!==void 0&&(J=N.escapeChar),(typeof b!="string"||-1<d.BAD_DELIMITERS.indexOf(b))&&(b=","),A===b)throw new Error("Comment character same as delimiter");A===!0?A="#":(typeof A!="string"||-1<d.BAD_DELIMITERS.indexOf(A))&&(A=!1),O!==`
`&&O!=="\r"&&O!==`\r
`&&(O=`
`);var F=0,te=!1;this.parse=function(fe,R,G){if(typeof fe!="string")throw new Error("Input must be a string");var P=fe.length,C=b.length,K=O.length,D=A.length,Q=T(E),z=[],X=[],ne=[],k=F=0;if(!fe)return Xe();if(Y||Y!==!1&&fe.indexOf(W)===-1){for(var Ce=fe.split(O),_e=0;_e<Ce.length;_e++){if(ne=Ce[_e],F+=ne.length,_e!==Ce.length-1)F+=O.length;else if(G)return Xe();if(!A||ne.substring(0,D)!==A){if(Q){if(z=[],ot(ne.split(b)),ut(),te)return Xe()}else ot(ne.split(b));if(U&&U<=_e)return z=z.slice(0,U),Xe(!0)}}return Xe()}for(var me=fe.indexOf(b,F),pe=fe.indexOf(O,F),ue=new RegExp(x(J)+x(W),"g"),je=fe.indexOf(W,F);;)if(fe[F]===W)for(je=F,F++;;){if((je=fe.indexOf(W,je+1))===-1)return G||X.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:z.length,index:F}),jt();if(je===P-1)return jt(fe.substring(F,je).replace(ue,W));if(W===J&&fe[je+1]===J)je++;else if(W===J||je===0||fe[je-1]!==J){me!==-1&&me<je+1&&(me=fe.indexOf(b,je+1));var $e=tt((pe=pe!==-1&&pe<je+1?fe.indexOf(O,je+1):pe)===-1?me:Math.min(me,pe));if(fe.substr(je+1+$e,C)===b){ne.push(fe.substring(F,je).replace(ue,W)),fe[F=je+1+$e+C]!==W&&(je=fe.indexOf(W,F)),me=fe.indexOf(b,F),pe=fe.indexOf(O,F);break}if($e=tt(pe),fe.substring(je+1+$e,je+1+$e+K)===O){if(ne.push(fe.substring(F,je).replace(ue,W)),yt(je+1+$e+K),me=fe.indexOf(b,F),je=fe.indexOf(W,F),Q&&(ut(),te))return Xe();if(U&&z.length>=U)return Xe(!0);break}X.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:z.length,index:F}),je++}}else if(A&&ne.length===0&&fe.substring(F,F+D)===A){if(pe===-1)return Xe();F=pe+K,pe=fe.indexOf(O,F),me=fe.indexOf(b,F)}else if(me!==-1&&(me<pe||pe===-1))ne.push(fe.substring(F,me)),F=me+C,me=fe.indexOf(b,F);else{if(pe===-1)break;if(ne.push(fe.substring(F,pe)),yt(pe+K),Q&&(ut(),te))return Xe();if(U&&z.length>=U)return Xe(!0)}return jt();function ot(qe){z.push(qe),k=F}function tt(qe){var Oe=0;return Oe=qe!==-1&&(qe=fe.substring(je+1,qe))&&qe.trim()===""?qe.length:Oe}function jt(qe){return G||(qe===void 0&&(qe=fe.substring(F)),ne.push(qe),F=P,ot(ne),Q&&ut()),Xe()}function yt(qe){F=qe,ot(ne),ne=[],pe=fe.indexOf(O,F)}function Xe(qe){if(N.header&&!R&&z.length&&!se){var Oe=z[0],ze=Object.create(null),tr=new Set(Oe);let Fe=!1;for(let rt=0;rt<Oe.length;rt++){let ft=Oe[rt];if(ze[ft=T(N.transformHeader)?N.transformHeader(ft,rt):ft]){let st,Xt=ze[ft];for(;st=ft+"_"+Xt,Xt++,tr.has(st););tr.add(st),Oe[rt]=st,ze[ft]++,Fe=!0,(ee=ee===null?{}:ee)[st]=ft}else ze[ft]=1,Oe[rt]=ft;tr.add(ft)}Fe&&console.warn("Duplicate headers found and renamed."),se=!0}return{data:z,errors:X,meta:{delimiter:b,linebreak:O,aborted:te,truncated:!!qe,cursor:k+(R||0),renamedHeaders:ee}}}function ut(){E(Xe()),z=[],X=[]}},this.abort=function(){te=!0},this.getCharIndex=function(){return F}}function w(N){var b=N.data,O=c[b.workerId],A=!1;if(b.error)O.userError(b.error,b.file);else if(b.results&&b.results.data){var E={abort:function(){A=!0,v(b.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:j,resume:j};if(T(O.userStep)){for(var U=0;U<b.results.data.length&&(O.userStep({data:b.results.data[U],errors:b.results.errors,meta:b.results.meta},E),!A);U++);delete b.results}else T(O.userChunk)&&(O.userChunk(b.results,E,b.file),delete b.results)}b.finished&&!A&&v(b.workerId,b.results)}function v(N,b){var O=c[N];T(O.userComplete)&&O.userComplete(b),O.terminate(),delete c[N]}function j(){throw new Error("Not implemented.")}function S(N){if(typeof N!="object"||N===null)return N;var b,O=Array.isArray(N)?[]:{};for(b in N)O[b]=S(N[b]);return O}function _(N,b){return function(){N.apply(b,arguments)}}function T(N){return typeof N=="function"}return d.parse=function(N,b){var O=(b=b||{}).dynamicTyping||!1;if(T(O)&&(b.dynamicTypingFunction=O,O={}),b.dynamicTyping=O,b.transform=!!T(b.transform)&&b.transform,!b.worker||!d.WORKERS_SUPPORTED)return O=null,d.NODE_STREAM_INPUT,typeof N=="string"?(N=(A=>A.charCodeAt(0)!==65279?A:A.slice(1))(N),O=new(b.download?f:m)(b)):N.readable===!0&&T(N.read)&&T(N.on)?O=new g(b):(s.File&&N instanceof File||N instanceof Object)&&(O=new h(b)),O.stream(N);(O=(()=>{var A;return!!d.WORKERS_SUPPORTED&&(A=(()=>{var E=s.URL||s.webkitURL||null,U=r.toString();return d.BLOB_URL||(d.BLOB_URL=E.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",U,")();"],{type:"text/javascript"})))})(),(A=new s.Worker(A)).onmessage=w,A.id=l++,c[A.id]=A)})()).userStep=b.step,O.userChunk=b.chunk,O.userComplete=b.complete,O.userError=b.error,b.step=T(b.step),b.chunk=T(b.chunk),b.complete=T(b.complete),b.error=T(b.error),delete b.worker,O.postMessage({input:N,config:b,workerId:O.id})},d.unparse=function(N,b){var O=!1,A=!0,E=",",U=`\r
`,Y='"',ee=Y+Y,se=!1,W=null,J=!1,F=((()=>{if(typeof b=="object"){if(typeof b.delimiter!="string"||d.BAD_DELIMITERS.filter(function(R){return b.delimiter.indexOf(R)!==-1}).length||(E=b.delimiter),typeof b.quotes!="boolean"&&typeof b.quotes!="function"&&!Array.isArray(b.quotes)||(O=b.quotes),typeof b.skipEmptyLines!="boolean"&&typeof b.skipEmptyLines!="string"||(se=b.skipEmptyLines),typeof b.newline=="string"&&(U=b.newline),typeof b.quoteChar=="string"&&(Y=b.quoteChar),typeof b.header=="boolean"&&(A=b.header),Array.isArray(b.columns)){if(b.columns.length===0)throw new Error("Option columns is empty");W=b.columns}b.escapeChar!==void 0&&(ee=b.escapeChar+Y),b.escapeFormulae instanceof RegExp?J=b.escapeFormulae:typeof b.escapeFormulae=="boolean"&&b.escapeFormulae&&(J=/^[=+\-@\t\r].*$/)}})(),new RegExp(x(Y),"g"));if(typeof N=="string"&&(N=JSON.parse(N)),Array.isArray(N)){if(!N.length||Array.isArray(N[0]))return te(null,N,se);if(typeof N[0]=="object")return te(W||Object.keys(N[0]),N,se)}else if(typeof N=="object")return typeof N.data=="string"&&(N.data=JSON.parse(N.data)),Array.isArray(N.data)&&(N.fields||(N.fields=N.meta&&N.meta.fields||W),N.fields||(N.fields=Array.isArray(N.data[0])?N.fields:typeof N.data[0]=="object"?Object.keys(N.data[0]):[]),Array.isArray(N.data[0])||typeof N.data[0]=="object"||(N.data=[N.data])),te(N.fields||[],N.data||[],se);throw new Error("Unable to serialize unrecognized input");function te(R,G,P){var C="",K=(typeof R=="string"&&(R=JSON.parse(R)),typeof G=="string"&&(G=JSON.parse(G)),Array.isArray(R)&&0<R.length),D=!Array.isArray(G[0]);if(K&&A){for(var Q=0;Q<R.length;Q++)0<Q&&(C+=E),C+=fe(R[Q],Q);0<G.length&&(C+=U)}for(var z=0;z<G.length;z++){var X=(K?R:G[z]).length,ne=!1,k=K?Object.keys(G[z]).length===0:G[z].length===0;if(P&&!K&&(ne=P==="greedy"?G[z].join("").trim()==="":G[z].length===1&&G[z][0].length===0),P==="greedy"&&K){for(var Ce=[],_e=0;_e<X;_e++){var me=D?R[_e]:_e;Ce.push(G[z][me])}ne=Ce.join("").trim()===""}if(!ne){for(var pe=0;pe<X;pe++){0<pe&&!k&&(C+=E);var ue=K&&D?R[pe]:pe;C+=fe(G[z][ue],pe)}z<G.length-1&&(!P||0<X&&!k)&&(C+=U)}}return C}function fe(R,G){var P,C;return R==null?"":R.constructor===Date?JSON.stringify(R).slice(1,25):(C=!1,J&&typeof R=="string"&&J.test(R)&&(R="'"+R,C=!0),P=R.toString().replace(F,ee),(C=C||O===!0||typeof O=="function"&&O(R,G)||Array.isArray(O)&&O[G]||((K,D)=>{for(var Q=0;Q<D.length;Q++)if(-1<K.indexOf(D[Q]))return!0;return!1})(P,d.BAD_DELIMITERS)||-1<P.indexOf(E)||P.charAt(0)===" "||P.charAt(P.length-1)===" ")?Y+P+Y:P)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!i&&!!s.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=y,d.ParserHandle=p,d.NetworkStreamer=f,d.FileStreamer=h,d.StringStreamer=m,d.ReadableStreamStreamer=g,s.jQuery&&((n=s.jQuery).fn.parse=function(N){var b=N.config||{},O=[];return this.each(function(U){if(!(n(this).prop("tagName").toUpperCase()==="INPUT"&&n(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var Y=0;Y<this.files.length;Y++)O.push({file:this.files[Y],inputElem:this,instanceConfig:n.extend({},b)})}),A(),this;function A(){if(O.length===0)T(N.complete)&&N.complete();else{var U,Y,ee,se,W=O[0];if(T(N.before)){var J=N.before(W.file,W.inputElem);if(typeof J=="object"){if(J.action==="abort")return U="AbortError",Y=W.file,ee=W.inputElem,se=J.reason,void(T(N.error)&&N.error({name:U},Y,ee,se));if(J.action==="skip")return void E();typeof J.config=="object"&&(W.instanceConfig=n.extend(W.instanceConfig,J.config))}else if(J==="skip")return void E()}var F=W.instanceConfig.complete;W.instanceConfig.complete=function(te){T(F)&&F(te,W.file,W.inputElem),E()},d.parse(W.file,W.instanceConfig)}}function E(){O.splice(0,1),A()}}),o&&(s.onmessage=function(N){N=N.data,d.WORKER_ID===void 0&&N&&(d.WORKER_ID=N.workerId),typeof N.input=="string"?s.postMessage({workerId:d.WORKER_ID,results:d.parse(N.input,N.config),finished:!0}):(s.File&&N.input instanceof File||N.input instanceof Object)&&(N=d.parse(N.input,N.config))&&s.postMessage({workerId:d.WORKER_ID,results:N,finished:!0})}),(f.prototype=Object.create(u.prototype)).constructor=f,(h.prototype=Object.create(u.prototype)).constructor=h,(m.prototype=Object.create(m.prototype)).constructor=m,(g.prototype=Object.create(u.prototype)).constructor=g,d})})(a1);var Gj=a1.exports;const Vj=nt(Gj);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var s1=1252,Hj=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ku={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ru=function(e){Hj.indexOf(e)!=-1&&(s1=ku[0]=e)};function qj(){Ru(1252)}var ca=function(e){Ru(e)};function n1(){ca(1200),qj()}function Gh(e){for(var t=[],r=0,s=e.length;r<s;++r)t[r]=e.charCodeAt(r);return t}function Wj(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function i1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Oi=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Wj(e.slice(2)):t==254&&r==255?i1(e.slice(2)):t==65279?e.slice(1):e},Go=function(t){return String.fromCharCode(t)},Vh=function(t){return String.fromCharCode(t)},us,ys="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Hh(e){for(var t="",r=0,s=0,n=0,i=0,o=0,c=0,l=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,s=e.charCodeAt(d++),o=(r&3)<<4|s>>4,n=e.charCodeAt(d++),c=(s&15)<<2|n>>6,l=n&63,isNaN(s)?c=l=64:isNaN(n)&&(l=64),t+=ys.charAt(i)+ys.charAt(o)+ys.charAt(c)+ys.charAt(l);return t}function Fr(e){var t="",r=0,s=0,n=0,i=0,o=0,c=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=ys.indexOf(e.charAt(d++)),o=ys.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),c=ys.indexOf(e.charAt(d++)),s=(o&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(s)),l=ys.indexOf(e.charAt(d++)),n=(c&3)<<6|l,l!==64&&(t+=String.fromCharCode(n));return t}var Ke=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),hn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function As(e){return Ke?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function qh(e){return Ke?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var na=function(t){return Ke?hn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function mn(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Iu(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Iu(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var fs=Ke?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:hn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var s=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)s.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";s.set(new Uint8Array(e[t]),r)}return s}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function zj(e){for(var t=[],r=0,s=e.length+250,n=As(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=e.charCodeAt(++i)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|c>>6&15|(o&3)<<4,n[r++]=128|c&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>s&&(t.push(n.slice(0,r)),r=0,n=As(65535),s=65530)}return t.push(n.slice(0,r)),fs(t)}var wr=/\u0000/g,Pi=/[\u0001-\u0006]/g;function In(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function la(e,t){var r=""+e;return r.length>=t?r:kt("0",t-r.length)+r}function Ou(e,t){var r=""+e;return r.length>=t?r:kt(" ",t-r.length)+r}function yc(e,t){var r=""+e;return r.length>=t?r:r+kt(" ",t-r.length)}function Yj(e,t){var r=""+Math.round(e);return r.length>=t?r:kt("0",t-r.length)+r}function Kj(e,t){var r=""+e;return r.length>=t?r:kt("0",t-r.length)+r}var Wh=Math.pow(2,32);function Tn(e,t){if(e>Wh||e<-Wh)return Yj(e,t);var r=Math.round(e);return Kj(r,t)}function wc(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var zh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Bl=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Xj(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var We={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Yh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Qj={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _c(e,t,r){for(var s=e<0?-1:1,n=e*s,i=0,o=1,c=0,l=1,d=0,u=0,f=Math.floor(n);d<t&&(f=Math.floor(n),c=f*o+i,u=f*d+l,!(n-f<5e-8));)n=1/(n-f),i=o,o=c,l=d,d=u;if(u>t&&(d>t?(u=l,c=i):(u=d,c=o)),!r)return[0,s*c,u];var h=Math.floor(s*c/u);return[h,s*c-h*u,u]}function Bs(e,t,r){if(e>2958465||e<0)return null;var s=e|0,n=Math.floor(86400*(e-s)),i=0,o=[],c={D:s,T:n,u:86400*(e-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(s+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++s,++c.D)),s===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var l=new Date(1900,0,1);l.setDate(l.getDate()+s-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),s<60&&(i=(i+6)%7),r&&(i=aT(l,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=i,c}var o1=new Date(1899,11,31,0,0,0),Jj=o1.getTime(),Zj=new Date(1900,2,1,0,0,0);function c1(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Zj&&(r+=24*60*60*1e3),(r-(Jj+(e.getTimezoneOffset()-o1.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Pu(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function eT(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function tT(e){var t=e<0?12:11,r=Pu(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function rT(e){var t=Pu(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ro(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=tT(e):t===10?r=e.toFixed(10).substr(0,12):r=rT(e),Pu(eT(r.toUpperCase()))}function sn(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ro(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Kr(14,c1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function aT(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function sT(e,t,r,s){var n="",i=0,o=0,c=r.y,l,d=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:l=c%100,d=2;break;default:l=c%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,d=t.length;break;case 3:return Bl[r.m-1][1];case 5:return Bl[r.m-1][0];default:return Bl[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,d=t.length;break;case 3:return zh[r.q][0];default:return zh[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?la(r.S,t.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(n=la(i,2+s),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:l=c,d=1;break}var u=d>0?la(l,d):"";return u}function ws(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,s=e.substr(0,r);r!=e.length;r+=t)s+=(s.length>0?",":"")+e.substr(r,t);return s}var l1=/%/g;function nT(e,t,r){var s=t.replace(l1,""),n=t.length-s.length;return Wa(e,s,r*Math.pow(10,2*n))+kt("%",n)}function iT(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Wa(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function d1(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+d1(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,d,u){return l+d+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var u1=/# (\?+)( ?)\/( ?)(\d+)/;function oT(e,t,r){var s=parseInt(e[4],10),n=Math.round(t*s),i=Math.floor(n/s),o=n-i*s,c=s;return r+(i===0?"":""+i)+" "+(o===0?kt(" ",e[1].length+1+e[4].length):Ou(o,e[1].length)+e[2]+"/"+e[3]+la(c,e[4].length))}function cT(e,t,r){return r+(t===0?"":""+t)+kt(" ",e[1].length+2+e[4].length)}var f1=/^#*0*\.([0#]+)/,h1=/\).*[0#]/,m1=/\(###\) ###\\?-####/;function hr(e){for(var t="",r,s=0;s!=e.length;++s)switch(r=e.charCodeAt(s)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Kh(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Xh(e,t){var r=e-Math.floor(e),s=Math.pow(10,t);return t<(""+Math.round(r*s)).length?0:Math.round(r*s)}function lT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function dT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Vr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(h1)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Vr("n",s,r):"("+Vr("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return iT(e,t,r);if(t.indexOf("%")!==-1)return nT(e,t,r);if(t.indexOf("E")!==-1)return d1(t,r);if(t.charCodeAt(0)===36)return"$"+Vr(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,c,l=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Tn(l,t.length);if(t.match(/^[#?]+$/))return n=Tn(r,0),n==="0"&&(n=""),n.length>t.length?n:hr(t.substr(0,t.length-n.length))+n;if(i=t.match(u1))return oT(i,l,d);if(t.match(/^#+0+$/))return d+Tn(l,t.length-t.indexOf("0"));if(i=t.match(f1))return n=Kh(r,i[1].length).replace(/^([^\.]+)$/,"$1."+hr(i[1])).replace(/\.$/,"."+hr(i[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+kt("0",hr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+Kh(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ws(Tn(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Vr(e,t,-r):ws(""+(Math.floor(r)+lT(r,i[1].length)))+"."+la(Xh(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Vr(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=In(Vr(e,t.replace(/[\\-]/g,""),r)),o=0,In(In(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<n.length?n.charAt(o++):g==="0"?"0":""}));if(t.match(m1))return n=Vr(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=_c(l,Math.pow(10,o)-1,!1),n=""+d,u=Wa("n",i[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=yc(c[2],o),u.length<i[4].length&&(u=hr(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=_c(l,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ou(c[1],o)+i[2]+"/"+i[3]+yc(c[2],o):kt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=Tn(r,0),t.length<=n.length?n:hr(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var f=t.indexOf(".")-o,h=t.length-n.length-f;return hr(t.substr(0,f)+n+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=Xh(r,i[1].length),r<0?"-"+Vr(e,t,-r):ws(dT(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?la(0,3-g.length):"")+g})+"."+la(o,i[1].length);switch(t){case"###,##0.00":return Vr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=ws(Tn(l,0));return m!=="0"?d+m:"";case"###,###.00":return Vr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Vr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function uT(e,t,r){for(var s=t.length-1;t.charCodeAt(s-1)===44;)--s;return Wa(e,t.substr(0,s),r/Math.pow(10,3*(t.length-s)))}function fT(e,t,r){var s=t.replace(l1,""),n=t.length-s.length;return Wa(e,s,r*Math.pow(10,2*n))+kt("%",n)}function p1(e,t){var r,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+p1(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,d,u){return l+d+u.substr(0,(n+i)%n)+"."+u.substr(i)+"E"})}else r=t.toExponential(s);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ya(e,t,r){if(e.charCodeAt(0)===40&&!t.match(h1)){var s=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ya("n",s,r):"("+ya("n",s,-r)+")"}if(t.charCodeAt(t.length-1)===44)return uT(e,t,r);if(t.indexOf("%")!==-1)return fT(e,t,r);if(t.indexOf("E")!==-1)return p1(t,r);if(t.charCodeAt(0)===36)return"$"+ya(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,o,c,l=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+la(l,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:hr(t.substr(0,t.length-n.length))+n;if(i=t.match(u1))return cT(i,l,d);if(t.match(/^#+0+$/))return d+la(l,t.length-t.indexOf("0"));if(i=t.match(f1))return n=(""+r).replace(/^([^\.]+)$/,"$1."+hr(i[1])).replace(/\.$/,"."+hr(i[1])),n=n.replace(/\.(\d*)$/,function(g,p){return"."+p+kt("0",hr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ws(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ya(e,t,-r):ws(""+r)+"."+kt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ya(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=In(ya(e,t.replace(/[\\-]/g,""),r)),o=0,In(In(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<n.length?n.charAt(o++):g==="0"?"0":""}));if(t.match(m1))return n=ya(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=_c(l,Math.pow(10,o)-1,!1),n=""+d,u=Wa("n",i[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),n+=u+i[2]+"/"+i[3],u=yc(c[2],o),u.length<i[4].length&&(u=hr(i[4].substr(i[4].length-u.length))+u),n+=u,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=_c(l,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ou(c[1],o)+i[2]+"/"+i[3]+yc(c[2],o):kt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:hr(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var f=t.indexOf(".")-o,h=t.length-n.length-f;return hr(t.substr(0,f)+n+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ya(e,t,-r):ws(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?la(0,3-g.length):"")+g})+"."+la(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=ws(""+l);return m!=="0"?d+m:"";default:if(t.match(/\.[0#?]*$/))return ya(e,t.slice(0,t.lastIndexOf(".")),r)+hr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Wa(e,t,r){return(r|0)===r?ya(e,t,r):Vr(e,t,r)}function hT(e){for(var t=[],r=!1,s=0,n=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:r=!r;break;case 95:case 42:case 92:++s;break;case 59:t[t.length]=e.substr(n,s-n),n=s+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var g1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function si(e){for(var t=0,r="",s="";t<e.length;)switch(r=e.charAt(t)){case"G":wc(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(s=r;e.charAt(t++)!=="]"&&t<e.length;)s+=e.charAt(t);if(s.match(g1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function mT(e,t,r,s){for(var n=[],i="",o=0,c="",l="t",d,u,f,h="H";o<e.length;)switch(c=e.charAt(o)){case"G":if(!wc(e,o))throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);n[n.length]={t:"t",v:i},++o;break;case"\\":var m=e.charAt(++o),g=m==="("||m===")"?m:"t";n[n.length]={t:g,v:m},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=Bs(t,r,e.charAt(o+1)==="2"),d==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},l=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Bs(t,r),d==null))return"";for(i=c;++o<e.length&&e.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&l.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=h),n[n.length]={t:c,v:i},l=c;break;case"A":case"a":case"":var p={t:c,v:c};if(d==null&&(d=Bs(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(p.v=d.H>=12?"":""),p.t="T",o+=5,h="h"):(p.t="t",++o),d==null&&p.t==="T")return"";n[n.length]=p,l=c;break;case"[":for(i=c;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(g1)){if(d==null&&(d=Bs(t,r),d==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",si(e)||(n[n.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=c;++o<e.length&&(c=e.charAt(o))==="0";)i+=c;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(o))>-1;)i+=c;n[n.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++o)===c;)i+=c;n[n.length]={t:c,v:i},l=c;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:s===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:c,v:c},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"t",v:c},++o;break}var x=0,y=0,w;for(o=n.length-1,l="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=h,l="h",x<1&&(x=1);break;case"s":(w=n[o].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":l=n[o].t;break;case"m":l==="s"&&(n[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&n[o].v.match(/[Hh]/)&&(x=1),x<2&&n[o].v.match(/[Mm]/)&&(x=2),x<3&&n[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var v="",j;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=sT(n[o].t.charCodeAt(0),n[o].v,d,y),n[o].t="t";break;case"n":case"?":for(j=o+1;n[j]!=null&&((c=n[j].t)==="?"||c==="D"||(c===" "||c==="t")&&n[j+1]!=null&&(n[j+1].t==="?"||n[j+1].t==="t"&&n[j+1].v==="/")||n[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[j].v==="/"||n[j].v===" "&&n[j+1]!=null&&n[j+1].t=="?"));)n[o].v+=n[j].v,n[j]={v:"",t:";"},++j;v+=n[o].v,o=j-1;break;case"G":n[o].t="t",n[o].v=sn(t,r);break}var S="",_,T;if(v.length>0){v.charCodeAt(0)==40?(_=t<0&&v.charCodeAt(0)===45?-t:t,T=Wa("n",v,_)):(_=t<0&&s>1?-t:t,T=Wa("n",v,_),_<0&&n[0]&&n[0].t=="t"&&(T=T.substr(1),n[0].v="-"+n[0].v)),j=T.length-1;var N=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){N=o;break}var b=n.length;if(N===n.length&&T.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(j>=n[o].v.length-1?(j-=n[o].v.length,n[o].v=T.substr(j+1,n[o].v.length)):j<0?n[o].v="":(n[o].v=T.substr(0,j+1),j=-1),n[o].t="t",b=o);j>=0&&b<n.length&&(n[b].v=T.substr(0,j+1)+n[b].v)}else if(N!==n.length&&T.indexOf("E")===-1){for(j=T.indexOf(".")-1,o=N;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(u=n[o].v.indexOf(".")>-1&&o===N?n[o].v.indexOf(".")-1:n[o].v.length-1,S=n[o].v.substr(u+1);u>=0;--u)j>=0&&(n[o].v.charAt(u)==="0"||n[o].v.charAt(u)==="#")&&(S=T.charAt(j--)+S);n[o].v=S,n[o].t="t",b=o}for(j>=0&&b<n.length&&(n[b].v=T.substr(0,j+1)+n[b].v),j=T.indexOf(".")+1,o=N;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==N)){for(u=n[o].v.indexOf(".")>-1&&o===N?n[o].v.indexOf(".")+1:0,S=n[o].v.substr(0,u);u<n[o].v.length;++u)j<T.length&&(S+=T.charAt(j++));n[o].v=S,n[o].t="t",b=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(_=s>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Wa(n[o].t,n[o].v,_),n[o].t="t");var O="";for(o=0;o!==n.length;++o)n[o]!=null&&(O+=n[o].v);return O}var Qh=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Jh(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function pT(e,t){var r=hT(e),s=r.length,n=r[s-1].indexOf("@");if(s<4&&n>-1&&--s,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[s,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Qh),c=r[1].match(Qh);return Jh(t,o)?[s,r[0]]:Jh(t,c)?[s,r[1]]:[s,r[o!=null&&c!=null?2:1]]}return[s,i]}function Kr(e,t,r){r==null&&(r={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?s=r.dateNF:s=e;break;case"number":e==14&&r.dateNF?s=r.dateNF:s=(r.table!=null?r.table:We)[e],s==null&&(s=r.table&&r.table[Yh[e]]||We[Yh[e]]),s==null&&(s=Qj[e]||"General");break}if(wc(s,0))return sn(t,r);t instanceof Date&&(t=c1(t,r.date1904));var n=pT(s,t);if(wc(n[1]))return sn(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return mT(n[1],t,r,n[0])}function Qs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(We[r]==null){t<0&&(t=r);continue}if(We[r]==e){t=r;break}}t<0&&(t=391)}return We[t]=e,t}function x1(){We=Xj()}var gT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},v1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function xT(e){var t=typeof e=="number"?We[e]:e;return t=t.replace(v1,"(\\d+)"),new RegExp("^"+t+"$")}function vT(e,t,r){var s=-1,n=-1,i=-1,o=-1,c=-1,l=-1;(t.match(v1)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=m;break;case"d":i=m;break;case"h":o=m;break;case"s":l=m;break;case"m":o>=0?c=m:n=m;break}}),l>=0&&c==-1&&n>=0&&(c=n,n=-1);var d=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&c==-1&&l==-1?d:s==-1&&n==-1&&i==-1?u:d+"T"+u}var yT=function(){var e={};e.version="1.2.0";function t(){for(var T=0,N=new Array(256),b=0;b!=256;++b)T=b,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,N[b]=T;return typeof Int32Array<"u"?new Int32Array(N):N}var r=t();function s(T){var N=0,b=0,O=0,A=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)A[O]=T[O];for(O=0;O!=256;++O)for(b=T[O],N=256+O;N<4096;N+=256)b=A[N]=b>>>8^T[b&255];var E=[];for(O=1;O!=16;++O)E[O-1]=typeof Int32Array<"u"?A.subarray(O*256,O*256+256):A.slice(O*256,O*256+256);return E}var n=s(r),i=n[0],o=n[1],c=n[2],l=n[3],d=n[4],u=n[5],f=n[6],h=n[7],m=n[8],g=n[9],p=n[10],x=n[11],y=n[12],w=n[13],v=n[14];function j(T,N){for(var b=N^-1,O=0,A=T.length;O<A;)b=b>>>8^r[(b^T.charCodeAt(O++))&255];return~b}function S(T,N){for(var b=N^-1,O=T.length-15,A=0;A<O;)b=v[T[A++]^b&255]^w[T[A++]^b>>8&255]^y[T[A++]^b>>16&255]^x[T[A++]^b>>>24]^p[T[A++]]^g[T[A++]]^m[T[A++]]^h[T[A++]]^f[T[A++]]^u[T[A++]]^d[T[A++]]^l[T[A++]]^c[T[A++]]^o[T[A++]]^i[T[A++]]^r[T[A++]];for(O+=15;A<O;)b=b>>>8^r[(b^T[A++])&255];return~b}function _(T,N){for(var b=N^-1,O=0,A=T.length,E=0,U=0;O<A;)E=T.charCodeAt(O++),E<128?b=b>>>8^r[(b^E)&255]:E<2048?(b=b>>>8^r[(b^(192|E>>6&31))&255],b=b>>>8^r[(b^(128|E&63))&255]):E>=55296&&E<57344?(E=(E&1023)+64,U=T.charCodeAt(O++)&1023,b=b>>>8^r[(b^(240|E>>8&7))&255],b=b>>>8^r[(b^(128|E>>2&63))&255],b=b>>>8^r[(b^(128|U>>6&15|(E&3)<<4))&255],b=b>>>8^r[(b^(128|U&63))&255]):(b=b>>>8^r[(b^(224|E>>12&15))&255],b=b>>>8^r[(b^(128|E>>6&63))&255],b=b>>>8^r[(b^(128|E&63))&255]);return~b}return e.table=r,e.bstr=j,e.buf=S,e.str=_,e}(),Qe=function(){var t={};t.version="1.2.1";function r(I,V){for(var M=I.split("/"),B=V.split("/"),H=0,q=0,ae=Math.min(M.length,B.length);H<ae;++H){if(q=M[H].length-B[H].length)return q;if(M[H]!=B[H])return M[H]<B[H]?-1:1}return M.length-B.length}function s(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:s(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(0,V+1)}function n(I){if(I.charAt(I.length-1)=="/")return n(I.slice(0,-1));var V=I.lastIndexOf("/");return V===-1?I:I.slice(V+1)}function i(I,V){typeof V=="string"&&(V=new Date(V));var M=V.getHours();M=M<<6|V.getMinutes(),M=M<<5|V.getSeconds()>>>1,I.write_shift(2,M);var B=V.getFullYear()-1980;B=B<<4|V.getMonth()+1,B=B<<5|V.getDate(),I.write_shift(2,B)}function o(I){var V=I.read_shift(2)&65535,M=I.read_shift(2)&65535,B=new Date,H=M&31;M>>>=5;var q=M&15;M>>>=4,B.setMilliseconds(0),B.setFullYear(M+1980),B.setMonth(q-1),B.setDate(H);var ae=V&31;V>>>=5;var ge=V&63;return V>>>=6,B.setHours(V),B.setMinutes(ge),B.setSeconds(ae<<1),B}function c(I){Qt(I,0);for(var V={},M=0;I.l<=I.length-4;){var B=I.read_shift(2),H=I.read_shift(2),q=I.l+H,ae={};switch(B){case 21589:M=I.read_shift(1),M&1&&(ae.mtime=I.read_shift(4)),H>5&&(M&2&&(ae.atime=I.read_shift(4)),M&4&&(ae.ctime=I.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}I.l=q,V[B]=ae}return V}var l;function d(){return l||(l={})}function u(I,V){if(I[0]==80&&I[1]==75)return yi(I,V);if((I[0]|32)==109&&(I[1]|32)==105)return Ar(I,V);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var M=3,B=512,H=0,q=0,ae=0,ge=0,re=0,ie=[],ce=I.slice(0,512);Qt(ce,0);var be=f(ce);switch(M=be[0],M){case 3:B=512;break;case 4:B=4096;break;case 0:if(be[1]==0)return yi(I,V);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}B!==512&&(ce=I.slice(0,B),Qt(ce,28));var Ee=I.slice(0,B);h(ce,M);var ke=ce.read_shift(4,"i");if(M===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);ce.l+=4,ae=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),ge=ce.read_shift(4,"i"),H=ce.read_shift(4,"i"),re=ce.read_shift(4,"i"),q=ce.read_shift(4,"i");for(var Ne=-1,Ae=0;Ae<109&&(Ne=ce.read_shift(4,"i"),!(Ne<0));++Ae)ie[Ae]=Ne;var Ve=m(I,B);x(re,q,Ve,B,ie);var St=w(Ve,ae,ie,B);St[ae].name="!Directory",H>0&&ge!==U&&(St[ge].name="!MiniFAT"),St[ie[0]].name="!FAT",St.fat_addrs=ie,St.ssz=B;var At={},rr=[],_i=[],bi=[];v(ae,St,Ve,rr,H,At,_i,ge),g(_i,bi,rr),rr.shift();var Ni={FileIndex:_i,FullPaths:bi};return V&&V.raw&&(Ni.raw={header:Ee,sectors:Ve}),Ni}function f(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(Y,"Header Signature: "),I.l+=16;var V=I.read_shift(2,"u");return[I.read_shift(2,"u"),V]}function h(I,V){var M=9;switch(I.l+=2,M=I.read_shift(2)){case 9:if(V!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(V!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,V){for(var M=Math.ceil(I.length/V)-1,B=[],H=1;H<M;++H)B[H-1]=I.slice(H*V,(H+1)*V);return B[M-1]=I.slice(M*V),B}function g(I,V,M){for(var B=0,H=0,q=0,ae=0,ge=0,re=M.length,ie=[],ce=[];B<re;++B)ie[B]=ce[B]=B,V[B]=M[B];for(;ge<ce.length;++ge)B=ce[ge],H=I[B].L,q=I[B].R,ae=I[B].C,ie[B]===B&&(H!==-1&&ie[H]!==H&&(ie[B]=ie[H]),q!==-1&&ie[q]!==q&&(ie[B]=ie[q])),ae!==-1&&(ie[ae]=B),H!==-1&&B!=ie[B]&&(ie[H]=ie[B],ce.lastIndexOf(H)<ge&&ce.push(H)),q!==-1&&B!=ie[B]&&(ie[q]=ie[B],ce.lastIndexOf(q)<ge&&ce.push(q));for(B=1;B<re;++B)ie[B]===B&&(q!==-1&&ie[q]!==q?ie[B]=ie[q]:H!==-1&&ie[H]!==H&&(ie[B]=ie[H]));for(B=1;B<re;++B)if(I[B].type!==0){if(ge=B,ge!=ie[ge])do ge=ie[ge],V[B]=V[ge]+"/"+V[B];while(ge!==0&&ie[ge]!==-1&&ge!=ie[ge]);ie[B]=-1}for(V[0]+="/",B=1;B<re;++B)I[B].type!==2&&(V[B]+="/")}function p(I,V,M){for(var B=I.start,H=I.size,q=[],ae=B;M&&H>0&&ae>=0;)q.push(V.slice(ae*E,ae*E+E)),H-=E,ae=$s(M,ae*4);return q.length===0?$t(0):fs(q).slice(0,I.size)}function x(I,V,M,B,H){var q=U;if(I===U){if(V!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var ae=M[I],ge=(B>>>2)-1;if(!ae)return;for(var re=0;re<ge&&(q=$s(ae,re*4))!==U;++re)H.push(q);x($s(ae,B-4),V-1,M,B,H)}}function y(I,V,M,B,H){var q=[],ae=[];H||(H=[]);var ge=B-1,re=0,ie=0;for(re=V;re>=0;){H[re]=!0,q[q.length]=re,ae.push(I[re]);var ce=M[Math.floor(re*4/B)];if(ie=re*4&ge,B<4+ie)throw new Error("FAT boundary crossed: "+re+" 4 "+B);if(!I[ce])break;re=$s(I[ce],ie)}return{nodes:q,data:cm([ae])}}function w(I,V,M,B){var H=I.length,q=[],ae=[],ge=[],re=[],ie=B-1,ce=0,be=0,Ee=0,ke=0;for(ce=0;ce<H;++ce)if(ge=[],Ee=ce+V,Ee>=H&&(Ee-=H),!ae[Ee]){re=[];var Ne=[];for(be=Ee;be>=0;){Ne[be]=!0,ae[be]=!0,ge[ge.length]=be,re.push(I[be]);var Ae=M[Math.floor(be*4/B)];if(ke=be*4&ie,B<4+ke)throw new Error("FAT boundary crossed: "+be+" 4 "+B);if(!I[Ae]||(be=$s(I[Ae],ke),Ne[be]))break}q[Ee]={nodes:ge,data:cm([re])}}return q}function v(I,V,M,B,H,q,ae,ge){for(var re=0,ie=B.length?2:0,ce=V[I].data,be=0,Ee=0,ke;be<ce.length;be+=128){var Ne=ce.slice(be,be+128);Qt(Ne,64),Ee=Ne.read_shift(2),ke=Uu(Ne,0,Ee-ie),B.push(ke);var Ae={name:ke,type:Ne.read_shift(1),color:Ne.read_shift(1),L:Ne.read_shift(4,"i"),R:Ne.read_shift(4,"i"),C:Ne.read_shift(4,"i"),clsid:Ne.read_shift(16),state:Ne.read_shift(4,"i"),start:0,size:0},Ve=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Ve!==0&&(Ae.ct=j(Ne,Ne.l-8));var St=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);St!==0&&(Ae.mt=j(Ne,Ne.l-8)),Ae.start=Ne.read_shift(4,"i"),Ae.size=Ne.read_shift(4,"i"),Ae.size<0&&Ae.start<0&&(Ae.size=Ae.type=0,Ae.start=U,Ae.name=""),Ae.type===5?(re=Ae.start,H>0&&re!==U&&(V[re].name="!StreamData")):Ae.size>=4096?(Ae.storage="fat",V[Ae.start]===void 0&&(V[Ae.start]=y(M,Ae.start,V.fat_addrs,V.ssz)),V[Ae.start].name=Ae.name,Ae.content=V[Ae.start].data.slice(0,Ae.size)):(Ae.storage="minifat",Ae.size<0?Ae.size=0:re!==U&&Ae.start!==U&&V[re]&&(Ae.content=p(Ae,V[re].data,(V[ge]||{}).data))),Ae.content&&Qt(Ae.content,0),q[ke]=Ae,ae.push(Ae)}}function j(I,V){return new Date((kr(I,V+4)/1e7*Math.pow(2,32)+kr(I,V)/1e7-11644473600)*1e3)}function S(I,V){return d(),u(l.readFileSync(I),V)}function _(I,V){var M=V&&V.type;switch(M||Ke&&Buffer.isBuffer(I)&&(M="buffer"),M||"base64"){case"file":return S(I,V);case"base64":return u(na(Fr(I)),V);case"binary":return u(na(I),V)}return u(I,V)}function T(I,V){var M=V||{},B=M.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=B+"/",I.FileIndex[0]={name:B,type:5}),M.CLSID&&(I.FileIndex[0].clsid=M.CLSID),N(I)}function N(I){var V="Sh33tJ5";if(!Qe.find(I,"/"+V)){var M=$t(4);M[0]=55,M[1]=M[3]=50,M[2]=54,I.FileIndex.push({name:V,type:2,content:M,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+V),b(I)}}function b(I,V){T(I);for(var M=!1,B=!1,H=I.FullPaths.length-1;H>=0;--H){var q=I.FileIndex[H];switch(q.type){case 0:B?M=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(q.R*q.L*q.C)&&(M=!0),q.R>-1&&q.L>-1&&q.R==q.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!V)){var ae=new Date(1987,1,19),ge=0,re=Object.create?Object.create(null):{},ie=[];for(H=0;H<I.FullPaths.length;++H)re[I.FullPaths[H]]=!0,I.FileIndex[H].type!==0&&ie.push([I.FullPaths[H],I.FileIndex[H]]);for(H=0;H<ie.length;++H){var ce=s(ie[H][0]);B=re[ce],B||(ie.push([ce,{name:n(ce).replace("/",""),type:1,clsid:se,ct:ae,mt:ae,content:null}]),re[ce]=!0)}for(ie.sort(function(ke,Ne){return r(ke[0],Ne[0])}),I.FullPaths=[],I.FileIndex=[],H=0;H<ie.length;++H)I.FullPaths[H]=ie[H][0],I.FileIndex[H]=ie[H][1];for(H=0;H<ie.length;++H){var be=I.FileIndex[H],Ee=I.FullPaths[H];if(be.name=n(Ee).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||se,H===0)be.C=ie.length>1?1:-1,be.size=0,be.type=5;else if(Ee.slice(-1)=="/"){for(ge=H+1;ge<ie.length&&s(I.FullPaths[ge])!=Ee;++ge);for(be.C=ge>=ie.length?-1:ge,ge=H+1;ge<ie.length&&s(I.FullPaths[ge])!=s(Ee);++ge);be.R=ge>=ie.length?-1:ge,be.type=1}else s(I.FullPaths[H+1]||"")==s(Ee)&&(be.R=H+1),be.type=2}}}function O(I,V){var M=V||{};if(M.fileType=="mad")return ga(I,M);switch(b(I),M.fileType){case"zip":return wi(I,M)}var B=function(ke){for(var Ne=0,Ae=0,Ve=0;Ve<ke.FileIndex.length;++Ve){var St=ke.FileIndex[Ve];if(St.content){var At=St.content.length;At>0&&(At<4096?Ne+=At+63>>6:Ae+=At+511>>9)}}for(var rr=ke.FullPaths.length+3>>2,_i=Ne+7>>3,bi=Ne+127>>7,Ni=_i+Ae+rr+bi,Ls=Ni+127>>7,Cl=Ls<=109?0:Math.ceil((Ls-109)/127);Ni+Ls+Cl+127>>7>Ls;)Cl=++Ls<=109?0:Math.ceil((Ls-109)/127);var Fa=[1,Cl,Ls,bi,rr,Ae,Ne,0];return ke.FileIndex[0].size=Ne<<6,Fa[7]=(ke.FileIndex[0].start=Fa[0]+Fa[1]+Fa[2]+Fa[3]+Fa[4]+Fa[5])+(Fa[6]+7>>3),Fa}(I),H=$t(B[7]<<9),q=0,ae=0;{for(q=0;q<8;++q)H.write_shift(1,ee[q]);for(q=0;q<8;++q)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),q=0;q<3;++q)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,B[2]),H.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:U),H.write_shift(4,B[3]),H.write_shift(-4,B[1]?B[0]-1:U),H.write_shift(4,B[1]),q=0;q<109;++q)H.write_shift(-4,q<B[2]?B[1]+q:-1)}if(B[1])for(ae=0;ae<B[1];++ae){for(;q<236+ae*127;++q)H.write_shift(-4,q<B[2]?B[1]+q:-1);H.write_shift(-4,ae===B[1]-1?U:ae+1)}var ge=function(ke){for(ae+=ke;q<ae-1;++q)H.write_shift(-4,q+1);ke&&(++q,H.write_shift(-4,U))};for(ae=q=0,ae+=B[1];q<ae;++q)H.write_shift(-4,W.DIFSECT);for(ae+=B[2];q<ae;++q)H.write_shift(-4,W.FATSECT);ge(B[3]),ge(B[4]);for(var re=0,ie=0,ce=I.FileIndex[0];re<I.FileIndex.length;++re)ce=I.FileIndex[re],ce.content&&(ie=ce.content.length,!(ie<4096)&&(ce.start=ae,ge(ie+511>>9)));for(ge(B[6]+7>>3);H.l&511;)H.write_shift(-4,W.ENDOFCHAIN);for(ae=q=0,re=0;re<I.FileIndex.length;++re)ce=I.FileIndex[re],ce.content&&(ie=ce.content.length,!(!ie||ie>=4096)&&(ce.start=ae,ge(ie+63>>6)));for(;H.l&511;)H.write_shift(-4,W.ENDOFCHAIN);for(q=0;q<B[4]<<2;++q){var be=I.FullPaths[q];if(!be||be.length===0){for(re=0;re<17;++re)H.write_shift(4,0);for(re=0;re<3;++re)H.write_shift(4,-1);for(re=0;re<12;++re)H.write_shift(4,0);continue}ce=I.FileIndex[q],q===0&&(ce.start=ce.size?ce.start-1:U);var Ee=q===0&&M.root||ce.name;if(ie=2*(Ee.length+1),H.write_shift(64,Ee,"utf16le"),H.write_shift(2,ie),H.write_shift(1,ce.type),H.write_shift(1,ce.color),H.write_shift(-4,ce.L),H.write_shift(-4,ce.R),H.write_shift(-4,ce.C),ce.clsid)H.write_shift(16,ce.clsid,"hex");else for(re=0;re<4;++re)H.write_shift(4,0);H.write_shift(4,ce.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,ce.start),H.write_shift(4,ce.size),H.write_shift(4,0)}for(q=1;q<I.FileIndex.length;++q)if(ce=I.FileIndex[q],ce.size>=4096)if(H.l=ce.start+1<<9,Ke&&Buffer.isBuffer(ce.content))ce.content.copy(H,H.l,0,ce.size),H.l+=ce.size+511&-512;else{for(re=0;re<ce.size;++re)H.write_shift(1,ce.content[re]);for(;re&511;++re)H.write_shift(1,0)}for(q=1;q<I.FileIndex.length;++q)if(ce=I.FileIndex[q],ce.size>0&&ce.size<4096)if(Ke&&Buffer.isBuffer(ce.content))ce.content.copy(H,H.l,0,ce.size),H.l+=ce.size+63&-64;else{for(re=0;re<ce.size;++re)H.write_shift(1,ce.content[re]);for(;re&63;++re)H.write_shift(1,0)}if(Ke)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function A(I,V){var M=I.FullPaths.map(function(re){return re.toUpperCase()}),B=M.map(function(re){var ie=re.split("/");return ie[ie.length-(re.slice(-1)=="/"?2:1)]}),H=!1;V.charCodeAt(0)===47?(H=!0,V=M[0].slice(0,-1)+V):H=V.indexOf("/")!==-1;var q=V.toUpperCase(),ae=H===!0?M.indexOf(q):B.indexOf(q);if(ae!==-1)return I.FileIndex[ae];var ge=!q.match(Pi);for(q=q.replace(wr,""),ge&&(q=q.replace(Pi,"!")),ae=0;ae<M.length;++ae)if((ge?M[ae].replace(Pi,"!"):M[ae]).replace(wr,"")==q||(ge?B[ae].replace(Pi,"!"):B[ae]).replace(wr,"")==q)return I.FileIndex[ae];return null}var E=64,U=-2,Y="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",W={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(I,V,M){d();var B=O(I,M);l.writeFileSync(V,B)}function F(I){for(var V=new Array(I.length),M=0;M<I.length;++M)V[M]=String.fromCharCode(I[M]);return V.join("")}function te(I,V){var M=O(I,V);switch(V&&V.type||"buffer"){case"file":return d(),l.writeFileSync(V.filename,M),M;case"binary":return typeof M=="string"?M:F(M);case"base64":return Hh(typeof M=="string"?M:F(M));case"buffer":if(Ke)return Buffer.isBuffer(M)?M:hn(M);case"array":return typeof M=="string"?na(M):M}return M}var fe;function R(I){try{var V=I.InflateRaw,M=new V;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)fe=I;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function G(I,V){if(!fe)return Po(I,V);var M=fe.InflateRaw,B=new M,H=B._processChunk(I.slice(I.l),B._finishFlushFlag);return I.l+=B.bytesRead,H}function P(I){return fe?fe.deflateRawSync(I):Fe(I)}var C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],D=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(I){var V=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(V>>16|V>>8|V)&255}for(var z=typeof Uint8Array<"u",X=z?new Uint8Array(256):[],ne=0;ne<256;++ne)X[ne]=Q(ne);function k(I,V){var M=X[I&255];return V<=8?M>>>8-V:(M=M<<8|X[I>>8&255],V<=16?M>>>16-V:(M=M<<8|X[I>>16&255],M>>>24-V))}function Ce(I,V){var M=V&7,B=V>>>3;return(I[B]|(M<=6?0:I[B+1]<<8))>>>M&3}function _e(I,V){var M=V&7,B=V>>>3;return(I[B]|(M<=5?0:I[B+1]<<8))>>>M&7}function me(I,V){var M=V&7,B=V>>>3;return(I[B]|(M<=4?0:I[B+1]<<8))>>>M&15}function pe(I,V){var M=V&7,B=V>>>3;return(I[B]|(M<=3?0:I[B+1]<<8))>>>M&31}function ue(I,V){var M=V&7,B=V>>>3;return(I[B]|(M<=1?0:I[B+1]<<8))>>>M&127}function je(I,V,M){var B=V&7,H=V>>>3,q=(1<<M)-1,ae=I[H]>>>B;return M<8-B||(ae|=I[H+1]<<8-B,M<16-B)||(ae|=I[H+2]<<16-B,M<24-B)||(ae|=I[H+3]<<24-B),ae&q}function $e(I,V,M){var B=V&7,H=V>>>3;return B<=5?I[H]|=(M&7)<<B:(I[H]|=M<<B&255,I[H+1]=(M&7)>>8-B),V+3}function ot(I,V,M){var B=V&7,H=V>>>3;return M=(M&1)<<B,I[H]|=M,V+1}function tt(I,V,M){var B=V&7,H=V>>>3;return M<<=B,I[H]|=M&255,M>>>=8,I[H+1]=M,V+8}function jt(I,V,M){var B=V&7,H=V>>>3;return M<<=B,I[H]|=M&255,M>>>=8,I[H+1]=M&255,I[H+2]=M>>>8,V+16}function yt(I,V){var M=I.length,B=2*M>V?2*M:V+5,H=0;if(M>=V)return I;if(Ke){var q=qh(B);if(I.copy)I.copy(q);else for(;H<I.length;++H)q[H]=I[H];return q}else if(z){var ae=new Uint8Array(B);if(ae.set)ae.set(I);else for(;H<M;++H)ae[H]=I[H];return ae}return I.length=B,I}function Xe(I){for(var V=new Array(I),M=0;M<I;++M)V[M]=0;return V}function ut(I,V,M){var B=1,H=0,q=0,ae=0,ge=0,re=I.length,ie=z?new Uint16Array(32):Xe(32);for(q=0;q<32;++q)ie[q]=0;for(q=re;q<M;++q)I[q]=0;re=I.length;var ce=z?new Uint16Array(re):Xe(re);for(q=0;q<re;++q)ie[H=I[q]]++,B<H&&(B=H),ce[q]=0;for(ie[0]=0,q=1;q<=B;++q)ie[q+16]=ge=ge+ie[q-1]<<1;for(q=0;q<re;++q)ge=I[q],ge!=0&&(ce[q]=ie[ge+16]++);var be=0;for(q=0;q<re;++q)if(be=I[q],be!=0)for(ge=k(ce[q],B)>>B-be,ae=(1<<B+4-be)-1;ae>=0;--ae)V[ge|ae<<be]=be&15|q<<4;return B}var qe=z?new Uint16Array(512):Xe(512),Oe=z?new Uint16Array(32):Xe(32);if(!z){for(var ze=0;ze<512;++ze)qe[ze]=0;for(ze=0;ze<32;++ze)Oe[ze]=0}(function(){for(var I=[],V=0;V<32;V++)I.push(5);ut(I,Oe,32);var M=[];for(V=0;V<=143;V++)M.push(8);for(;V<=255;V++)M.push(9);for(;V<=279;V++)M.push(7);for(;V<=287;V++)M.push(8);ut(M,qe,288)})();var tr=function(){for(var V=z?new Uint8Array(32768):[],M=0,B=0;M<D.length-1;++M)for(;B<D[M+1];++B)V[B]=M;for(;B<32768;++B)V[B]=29;var H=z?new Uint8Array(259):[];for(M=0,B=0;M<K.length-1;++M)for(;B<K[M+1];++B)H[B]=M;function q(ge,re){for(var ie=0;ie<ge.length;){var ce=Math.min(65535,ge.length-ie),be=ie+ce==ge.length;for(re.write_shift(1,+be),re.write_shift(2,ce),re.write_shift(2,~ce&65535);ce-- >0;)re[re.l++]=ge[ie++]}return re.l}function ae(ge,re){for(var ie=0,ce=0,be=z?new Uint16Array(32768):[];ce<ge.length;){var Ee=Math.min(65535,ge.length-ce);if(Ee<10){for(ie=$e(re,ie,+(ce+Ee==ge.length)),ie&7&&(ie+=8-(ie&7)),re.l=ie/8|0,re.write_shift(2,Ee),re.write_shift(2,~Ee&65535);Ee-- >0;)re[re.l++]=ge[ce++];ie=re.l*8;continue}ie=$e(re,ie,+(ce+Ee==ge.length)+2);for(var ke=0;Ee-- >0;){var Ne=ge[ce];ke=(ke<<5^Ne)&32767;var Ae=-1,Ve=0;if((Ae=be[ke])&&(Ae|=ce&-32768,Ae>ce&&(Ae-=32768),Ae<ce))for(;ge[Ae+Ve]==ge[ce+Ve]&&Ve<250;)++Ve;if(Ve>2){Ne=H[Ve],Ne<=22?ie=tt(re,ie,X[Ne+1]>>1)-1:(tt(re,ie,3),ie+=5,tt(re,ie,X[Ne-23]>>5),ie+=3);var St=Ne<8?0:Ne-4>>2;St>0&&(jt(re,ie,Ve-K[Ne]),ie+=St),Ne=V[ce-Ae],ie=tt(re,ie,X[Ne]>>3),ie-=3;var At=Ne<4?0:Ne-2>>1;At>0&&(jt(re,ie,ce-Ae-D[Ne]),ie+=At);for(var rr=0;rr<Ve;++rr)be[ke]=ce&32767,ke=(ke<<5^ge[ce])&32767,++ce;Ee-=Ve-1}else Ne<=143?Ne=Ne+48:ie=ot(re,ie,1),ie=tt(re,ie,X[Ne]),be[ke]=ce&32767,++ce}ie=tt(re,ie,0)-1}return re.l=(ie+7)/8|0,re.l}return function(re,ie){return re.length<8?q(re,ie):ae(re,ie)}}();function Fe(I){var V=$t(50+Math.floor(I.length*1.1)),M=tr(I,V);return V.slice(0,M)}var rt=z?new Uint16Array(32768):Xe(32768),ft=z?new Uint16Array(32768):Xe(32768),st=z?new Uint16Array(128):Xe(128),Xt=1,xi=1;function os(I,V){var M=pe(I,V)+257;V+=5;var B=pe(I,V)+1;V+=5;var H=me(I,V)+4;V+=4;for(var q=0,ae=z?new Uint8Array(19):Xe(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],re=1,ie=z?new Uint8Array(8):Xe(8),ce=z?new Uint8Array(8):Xe(8),be=ae.length,Ee=0;Ee<H;++Ee)ae[C[Ee]]=q=_e(I,V),re<q&&(re=q),ie[q]++,V+=3;var ke=0;for(ie[0]=0,Ee=1;Ee<=re;++Ee)ce[Ee]=ke=ke+ie[Ee-1]<<1;for(Ee=0;Ee<be;++Ee)(ke=ae[Ee])!=0&&(ge[Ee]=ce[ke]++);var Ne=0;for(Ee=0;Ee<be;++Ee)if(Ne=ae[Ee],Ne!=0){ke=X[ge[Ee]]>>8-Ne;for(var Ae=(1<<7-Ne)-1;Ae>=0;--Ae)st[ke|Ae<<Ne]=Ne&7|Ee<<3}var Ve=[];for(re=1;Ve.length<M+B;)switch(ke=st[ue(I,V)],V+=ke&7,ke>>>=3){case 16:for(q=3+Ce(I,V),V+=2,ke=Ve[Ve.length-1];q-- >0;)Ve.push(ke);break;case 17:for(q=3+_e(I,V),V+=3;q-- >0;)Ve.push(0);break;case 18:for(q=11+ue(I,V),V+=7;q-- >0;)Ve.push(0);break;default:Ve.push(ke),re<ke&&(re=ke);break}var St=Ve.slice(0,M),At=Ve.slice(M);for(Ee=M;Ee<286;++Ee)St[Ee]=0;for(Ee=B;Ee<30;++Ee)At[Ee]=0;return Xt=ut(St,rt,286),xi=ut(At,ft,30),V}function El(I,V){if(I[0]==3&&!(I[1]&3))return[As(V),2];for(var M=0,B=0,H=qh(V||1<<18),q=0,ae=H.length>>>0,ge=0,re=0;!(B&1);){if(B=_e(I,M),M+=3,B>>>1)B>>1==1?(ge=9,re=5):(M=os(I,M),ge=Xt,re=xi);else{M&7&&(M+=8-(M&7));var ie=I[M>>>3]|I[(M>>>3)+1]<<8;if(M+=32,ie>0)for(!V&&ae<q+ie&&(H=yt(H,q+ie),ae=H.length);ie-- >0;)H[q++]=I[M>>>3],M+=8;continue}for(;;){!V&&ae<q+32767&&(H=yt(H,q+32767),ae=H.length);var ce=je(I,M,ge),be=B>>>1==1?qe[ce]:rt[ce];if(M+=be&15,be>>>=4,!(be>>>8&255))H[q++]=be;else{if(be==256)break;be-=257;var Ee=be<8?0:be-4>>2;Ee>5&&(Ee=0);var ke=q+K[be];Ee>0&&(ke+=je(I,M,Ee),M+=Ee),ce=je(I,M,re),be=B>>>1==1?Oe[ce]:ft[ce],M+=be&15,be>>>=4;var Ne=be<4?0:be-2>>1,Ae=D[be];for(Ne>0&&(Ae+=je(I,M,Ne),M+=Ne),!V&&ae<ke&&(H=yt(H,ke+100),ae=H.length);q<ke;)H[q]=H[q-Ae],++q}}}return V?[H,M+7>>>3]:[H.slice(0,q),M+7>>>3]}function Po(I,V){var M=I.slice(I.l||0),B=El(M,V);return I.l+=B[1],B[0]}function vi(I,V){if(I)typeof console<"u"&&console.error(V);else throw new Error(V)}function yi(I,V){var M=I;Qt(M,0);var B=[],H=[],q={FileIndex:B,FullPaths:H};T(q,{root:V.root});for(var ae=M.length-4;(M[ae]!=80||M[ae+1]!=75||M[ae+2]!=5||M[ae+3]!=6)&&ae>=0;)--ae;M.l=ae+4,M.l+=4;var ge=M.read_shift(2);M.l+=6;var re=M.read_shift(4);for(M.l=re,ae=0;ae<ge;++ae){M.l+=20;var ie=M.read_shift(4),ce=M.read_shift(4),be=M.read_shift(2),Ee=M.read_shift(2),ke=M.read_shift(2);M.l+=8;var Ne=M.read_shift(4),Ae=c(M.slice(M.l+be,M.l+be+Ee));M.l+=be+Ee+ke;var Ve=M.l;M.l=Ne+4,Sl(M,ie,ce,q,Ae),M.l=Ve}return q}function Sl(I,V,M,B,H){I.l+=2;var q=I.read_shift(2),ae=I.read_shift(2),ge=o(I);if(q&8257)throw new Error("Unsupported ZIP encryption");for(var re=I.read_shift(4),ie=I.read_shift(4),ce=I.read_shift(4),be=I.read_shift(2),Ee=I.read_shift(2),ke="",Ne=0;Ne<be;++Ne)ke+=String.fromCharCode(I[I.l++]);if(Ee){var Ae=c(I.slice(I.l,I.l+Ee));(Ae[21589]||{}).mt&&(ge=Ae[21589].mt),((H||{})[21589]||{}).mt&&(ge=H[21589].mt)}I.l+=Ee;var Ve=I.slice(I.l,I.l+ie);switch(ae){case 8:Ve=G(I,ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var St=!1;q&8&&(re=I.read_shift(4),re==134695760&&(re=I.read_shift(4),St=!0),ie=I.read_shift(4),ce=I.read_shift(4)),ie!=V&&vi(St,"Bad compressed size: "+V+" != "+ie),ce!=M&&vi(St,"Bad uncompressed size: "+M+" != "+ce),ur(B,ke,Ve,{unsafe:!0,mt:ge})}function wi(I,V){var M=V||{},B=[],H=[],q=$t(1),ae=M.compression?8:0,ge=0,re=0,ie=0,ce=0,be=0,Ee=I.FullPaths[0],ke=Ee,Ne=I.FileIndex[0],Ae=[],Ve=0;for(re=1;re<I.FullPaths.length;++re)if(ke=I.FullPaths[re].slice(Ee.length),Ne=I.FileIndex[re],!(!Ne.size||!Ne.content||ke=="Sh33tJ5")){var St=ce,At=$t(ke.length);for(ie=0;ie<ke.length;++ie)At.write_shift(1,ke.charCodeAt(ie)&127);At=At.slice(0,At.l),Ae[be]=yT.buf(Ne.content,0);var rr=Ne.content;ae==8&&(rr=P(rr)),q=$t(30),q.write_shift(4,67324752),q.write_shift(2,20),q.write_shift(2,ge),q.write_shift(2,ae),Ne.mt?i(q,Ne.mt):q.write_shift(4,0),q.write_shift(-4,Ae[be]),q.write_shift(4,rr.length),q.write_shift(4,Ne.content.length),q.write_shift(2,At.length),q.write_shift(2,0),ce+=q.length,B.push(q),ce+=At.length,B.push(At),ce+=rr.length,B.push(rr),q=$t(46),q.write_shift(4,33639248),q.write_shift(2,0),q.write_shift(2,20),q.write_shift(2,ge),q.write_shift(2,ae),q.write_shift(4,0),q.write_shift(-4,Ae[be]),q.write_shift(4,rr.length),q.write_shift(4,Ne.content.length),q.write_shift(2,At.length),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(4,0),q.write_shift(4,St),Ve+=q.l,H.push(q),Ve+=At.length,H.push(At),++be}return q=$t(22),q.write_shift(4,101010256),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(2,be),q.write_shift(2,be),q.write_shift(4,Ve),q.write_shift(4,ce),q.write_shift(2,0),fs([fs(B),fs(H),q])}var Er={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Al(I,V){if(I.ctype)return I.ctype;var M=I.name||"",B=M.match(/\.([^\.]+)$/);return B&&Er[B[1]]||V&&(B=(M=V).match(/[\.\\]([^\.\\])+$/),B&&Er[B[1]])?Er[B[1]]:"application/octet-stream"}function Be(I){for(var V=Hh(I),M=[],B=0;B<V.length;B+=76)M.push(V.slice(B,B+76));return M.join(`\r
`)+`\r
`}function at(I){var V=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ie){var ce=ie.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});V=V.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),V.charAt(0)==`
`&&(V="=0D"+V.slice(1)),V=V.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],B=V.split(`\r
`),H=0;H<B.length;++H){var q=B[H];if(q.length==0){M.push("");continue}for(var ae=0;ae<q.length;){var ge=76,re=q.slice(ae,ae+ge);re.charAt(ge-1)=="="?ge--:re.charAt(ge-2)=="="?ge-=2:re.charAt(ge-3)=="="&&(ge-=3),re=q.slice(ae,ae+ge),ae+=ge,ae<q.length&&(re+="="),M.push(re)}}return M.join(`\r
`)}function ht(I){for(var V=[],M=0;M<I.length;++M){for(var B=I[M];M<=I.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+I[++M];V.push(B)}for(var H=0;H<V.length;++H)V[H]=V[H].replace(/[=][0-9A-Fa-f]{2}/g,function(q){return String.fromCharCode(parseInt(q.slice(1),16))});return na(V.join(`\r
`))}function Sr(I,V,M){for(var B="",H="",q="",ae,ge=0;ge<10;++ge){var re=V[ge];if(!re||re.match(/^\s*$/))break;var ie=re.match(/^(.*?):\s*([^\s].*)$/);if(ie)switch(ie[1].toLowerCase()){case"content-location":B=ie[2].trim();break;case"content-type":q=ie[2].trim();break;case"content-transfer-encoding":H=ie[2].trim();break}}switch(++ge,H.toLowerCase()){case"base64":ae=na(Fr(V.slice(ge).join("")));break;case"quoted-printable":ae=ht(V.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var ce=ur(I,B.slice(M.length),ae,{unsafe:!0});q&&(ce.ctype=q)}function Ar(I,V){if(F(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=V&&V.root||"",B=(Ke&&Buffer.isBuffer(I)?I.toString("binary"):F(I)).split(`\r
`),H=0,q="";for(H=0;H<B.length;++H)if(q=B[H],!!/^Content-Location:/i.test(q)&&(q=q.slice(q.indexOf("file")),M||(M=q.slice(0,q.lastIndexOf("/")+1)),q.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),q.slice(0,M.length)!=M););var ae=(B[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var ge="--"+(ae[1]||""),re=[],ie=[],ce={FileIndex:re,FullPaths:ie};T(ce);var be,Ee=0;for(H=0;H<B.length;++H){var ke=B[H];ke!==ge&&ke!==ge+"--"||(Ee++&&Sr(ce,B.slice(be,H),M),be=H)}return ce}function ga(I,V){var M=V||{},B=M.boundary||"SheetJS";B="------="+B;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],q=I.FullPaths[0],ae=q,ge=I.FileIndex[0],re=1;re<I.FullPaths.length;++re)if(ae=I.FullPaths[re].slice(q.length),ge=I.FileIndex[re],!(!ge.size||!ge.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ve){return"_x"+Ve.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ve){return"_u"+Ve.charCodeAt(0).toString(16)+"_"});for(var ie=ge.content,ce=Ke&&Buffer.isBuffer(ie)?ie.toString("binary"):F(ie),be=0,Ee=Math.min(1024,ce.length),ke=0,Ne=0;Ne<=Ee;++Ne)(ke=ce.charCodeAt(Ne))>=32&&ke<128&&++be;var Ae=be>=Ee*4/5;H.push(B),H.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+ae),H.push("Content-Transfer-Encoding: "+(Ae?"quoted-printable":"base64")),H.push("Content-Type: "+Al(ge,ae)),H.push(""),H.push(Ae?at(ce):Be(ce))}return H.push(B+`--\r
`),H.join(`\r
`)}function La(I){var V={};return T(V,I),V}function ur(I,V,M,B){var H=B&&B.unsafe;H||T(I);var q=!H&&Qe.find(I,V);if(!q){var ae=I.FullPaths[0];V.slice(0,ae.length)==ae?ae=V:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+V).replace("//","/")),q={name:n(V),type:2},I.FileIndex.push(q),I.FullPaths.push(ae),H||Qe.utils.cfb_gc(I)}return q.content=M,q.size=M?M.length:0,B&&(B.CLSID&&(q.clsid=B.CLSID),B.mt&&(q.mt=B.mt),B.ct&&(q.ct=B.ct)),q}function xa(I,V){T(I);var M=Qe.find(I,V);if(M){for(var B=0;B<I.FileIndex.length;++B)if(I.FileIndex[B]==M)return I.FileIndex.splice(B,1),I.FullPaths.splice(B,1),!0}return!1}function Hw(I,V,M){T(I);var B=Qe.find(I,V);if(B){for(var H=0;H<I.FileIndex.length;++H)if(I.FileIndex[H]==B)return I.FileIndex[H].name=n(M),I.FullPaths[H]=M,!0}return!1}function qw(I){b(I,!0)}return t.find=A,t.read=_,t.parse=u,t.write=te,t.writeFile=J,t.utils={cfb_new:La,cfb_add:ur,cfb_del:xa,cfb_mov:Hw,cfb_gc:qw,ReadShift:$i,CheckField:$1,prep_blob:Qt,bconcat:fs,use_zlib:R,_deflateRaw:Fe,_inflateRaw:Po,consts:W},t}();function wT(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(s){if(!s.message||!s.message.match(/onstruct/))throw s}throw new Error("Cannot access file "+e)}function Ca(e){for(var t=Object.keys(e),r=[],s=0;s<t.length;++s)Object.prototype.hasOwnProperty.call(e,t[s])&&r.push(t[s]);return r}function Du(e){for(var t=[],r=Ca(e),s=0;s!==r.length;++s)t[e[r[s]]]=r[s];return t}var bc=new Date(1899,11,30,0,0,0);function _r(e,t){var r=e.getTime(),s=bc.getTime()+(e.getTimezoneOffset()-bc.getTimezoneOffset())*6e4;return(r-s)/(24*60*60*1e3)}var y1=new Date,_T=bc.getTime()+(y1.getTimezoneOffset()-bc.getTimezoneOffset())*6e4,Zh=y1.getTimezoneOffset();function il(e){var t=new Date;return t.setTime(e*24*60*60*1e3+_T),t.getTimezoneOffset()!==Zh&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Zh)*6e4),t}function bT(e){var t=0,r=0,s=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(s=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(s)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var em=new Date("2017-02-19T19:06:09.000Z"),w1=isNaN(em.getFullYear())?new Date("2/19/17"):em,NT=w1.getFullYear()==2017;function Yt(e,t){var r=new Date(e);if(NT)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(w1.getFullYear()==1917&&!isNaN(r.getFullYear())){var s=r.getFullYear();return e.indexOf(""+s)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function nn(e,t){if(Ke&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Li(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Li(i1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Li(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Li(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var s=[],n=0;n!=e.length;++n)s.push(String.fromCharCode(e[n]));return s.join("")}function Zt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Zt(e[r]));return t}function kt(e,t){for(var r="";r.length<t;)r+=e;return r}function ua(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(s)))?t/r:t}var jT=["january","february","march","april","may","june","july","august","september","october","november","december"];function Kn(e){var t=new Date(e),r=new Date(NaN),s=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&jT.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return s<0||s>8099?r:(n>0||i>1)&&s!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var TT=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,s,n){if(e||typeof s=="string")return r.split(s);for(var i=r.split(s),o=[i[0]],c=1;c<i.length;++c)o.push(n),o.push(i[c]);return o}}();function _1(e){return e?e.content&&e.type?nn(e.content,!0):e.data?Oi(e.data):e.asNodeBuffer&&Ke?Oi(e.asNodeBuffer().toString("binary")):e.asBinary?Oi(e.asBinary()):e._data&&e._data.getContent?Oi(nn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function b1(e){if(!e)return null;if(e.data)return Gh(e.data);if(e.asNodeBuffer&&Ke)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Gh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ET(e){return e&&e.name.slice(-4)===".bin"?b1(e):_1(e)}function qr(e,t){for(var r=e.FullPaths||Ca(e.files),s=t.toLowerCase().replace(/[\/]/g,"\\"),n=s.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(s==o||n==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Lu(e,t){var r=qr(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Lt(e,t,r){if(!r)return ET(Lu(e,t));if(!t)return null;try{return Lt(e,t)}catch{return null}}function Rr(e,t,r){if(!r)return _1(Lu(e,t));if(!t)return null;try{return Rr(e,t)}catch{return null}}function ST(e,t,r){return b1(Lu(e,t))}function tm(e){for(var t=e.FullPaths||Ca(e.files),r=[],s=0;s<t.length;++s)t[s].slice(-1)!="/"&&r.push(t[s].replace(/^Root Entry[\/]/,""));return r.sort()}function AT(e,t,r){if(e.FullPaths){if(typeof r=="string"){var s;return Ke?s=hn(r):s=zj(r),Qe.utils.cfb_add(e,t,s)}Qe.utils.cfb_add(e,t,r)}else e.file(t,r)}function N1(e,t){switch(t.type){case"base64":return Qe.read(e,{type:"base64"});case"binary":return Qe.read(e,{type:"binary"});case"buffer":case"array":return Qe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Di(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var s=e.split("/");s.length!==0;){var n=s.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var j1=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,CT=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,rm=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,kT=/<[^>]*>/g,dr=j1.match(rm)?rm:kT,RT=/<\w*:/,IT=/<(\/?)\w+:/;function Pe(e,t,r){for(var s={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(s[0]=e.slice(0,n)),n===e.length)return s;var o=e.match(CT),c=0,l="",d=0,u="",f="",h=1;if(o)for(d=0;d!=o.length;++d){for(f=o[d],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(n=f.charCodeAt(i+1))==34||n==39?1:0,l=f.slice(i+1+h,f.length-h),c=0;c!=u.length&&u.charCodeAt(c)!==58;++c);if(c===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),s[u]=l,s[u.toLowerCase()]=l;else{var m=(c===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(c+1);if(s[m]&&u.slice(c-3,c)=="ext")continue;s[m]=l,s[m.toLowerCase()]=l}}return s}function Ia(e){return e.replace(IT,"<$1")}var T1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},OT=Du(T1),Ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(s){var n=s+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(c,l){return T1[c]||String.fromCharCode(parseInt(l,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,l){return String.fromCharCode(parseInt(l,16))});var o=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,o)+r(n.slice(o+3))}}(),PT=/[&<>'"]/g,DT=/[\u0000-\u001f]/g;function Fu(e){var t=e+"";return t.replace(PT,function(r){return OT[r]}).replace(/\n/g,"<br/>").replace(DT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var am=function(){var e=/&#(\d+);/g;function t(r,s){return String.fromCharCode(parseInt(s,10))}return function(s){return s.replace(e,t)}}();function Tt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gl(e){for(var t="",r=0,s=0,n=0,i=0,o=0,c=0;r<e.length;){if(s=e.charCodeAt(r++),s<128){t+=String.fromCharCode(s);continue}if(n=e.charCodeAt(r++),s>191&&s<224){o=(s&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),s<240){t+=String.fromCharCode((s&15)<<12|(n&63)<<6|i&63);continue}o=e.charCodeAt(r++),c=((s&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function sm(e){var t=As(2*e.length),r,s,n=1,i=0,o=0,c;for(s=0;s<e.length;s+=n)n=1,(c=e.charCodeAt(s))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(s+1)&63),n=2):c<240?(r=(c&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),n=3):(n=4,r=(c&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function nm(e){return hn(e,"binary").toString("utf8")}var Vo="foo bar baz",xt=Ke&&(nm(Vo)==Gl(Vo)&&nm||sm(Vo)==Gl(Vo)&&sm)||Gl,Li=Ke?function(e){return hn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,s=0,n=0;r<e.length;)switch(s=e.charCodeAt(r++),!0){case s<128:t.push(String.fromCharCode(s));break;case s<2048:t.push(String.fromCharCode(192+(s>>6))),t.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=e.charCodeAt(r++)-56320+(s<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(s>>12))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)))}return t.join("")},ao=function(){var e={};return function(r,s){var n=r+"|"+(s||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",s||"")}}(),E1=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var s=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)s=s.replace(e[n][0],e[n][1]);return s}}(),LT=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),FT=/<\/?(?:vt:)?variant>/g,MT=/<(?:vt:)([^>]*)>([\s\S]*)</;function im(e,t){var r=Pe(e),s=e.match(LT(r.baseType))||[],n=[];if(s.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+s.length+" != "+r.size);return n}return s.forEach(function(i){var o=i.replace(FT,"").match(MT);o&&n.push({v:xt(o[2]),t:o[1]})}),n}var UT=/(^\s|\s$|\n)/;function $T(e){return Ca(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function BT(e,t,r){return"<"+e+(r!=null?$T(r):"")+(t!=null?(t.match(UT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Mu(e){if(Ke&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return xt(mn(Iu(e)));throw new Error("Bad input format: expected Buffer or string")}var so=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,GT={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},VT=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function HT(e,t){for(var r=1-2*(e[t+7]>>>7),s=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return s==2047?n==0?r*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),r*Math.pow(2,s-52)*n)}function qT(e,t,r){var s=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,o=s?-t:t;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|s}var om=function(e){for(var t=[],r=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var n=0,i=e[0][s].length;n<i;n+=r)t.push.apply(t,e[0][s].slice(n,n+r));return t},cm=Ke?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:hn(t)})):om(e)}:om,lm=function(e,t,r){for(var s=[],n=t;n<r;n+=2)s.push(String.fromCharCode(Ga(e,n)));return s.join("").replace(wr,"")},Uu=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(wr,""):lm(e,t,r)}:lm,dm=function(e,t,r){for(var s=[],n=t;n<t+r;++n)s.push(("0"+e[n].toString(16)).slice(-2));return s.join("")},S1=Ke?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):dm(e,t,r)}:dm,um=function(e,t,r){for(var s=[],n=t;n<r;n++)s.push(String.fromCharCode(Sn(e,n)));return s.join("")},bo=Ke?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf8",r,s):um(t,r,s)}:um,A1=function(e,t){var r=kr(e,t);return r>0?bo(e,t+4,t+4+r-1):""},C1=A1,k1=function(e,t){var r=kr(e,t);return r>0?bo(e,t+4,t+4+r-1):""},R1=k1,I1=function(e,t){var r=2*kr(e,t);return r>0?bo(e,t+4,t+4+r-1):""},O1=I1,P1=function(t,r){var s=kr(t,r);return s>0?Uu(t,r+4,r+4+s):""},D1=P1,L1=function(e,t){var r=kr(e,t);return r>0?bo(e,t+4,t+4+r):""},F1=L1,M1=function(e,t){return HT(e,t)},Nc=M1,U1=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ke&&(C1=function(t,r){if(!Buffer.isBuffer(t))return A1(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},R1=function(t,r){if(!Buffer.isBuffer(t))return k1(t,r);var s=t.readUInt32LE(r);return s>0?t.toString("utf8",r+4,r+4+s-1):""},O1=function(t,r){if(!Buffer.isBuffer(t))return I1(t,r);var s=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s-1)},D1=function(t,r){if(!Buffer.isBuffer(t))return P1(t,r);var s=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+s)},F1=function(t,r){if(!Buffer.isBuffer(t))return L1(t,r);var s=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+s)},Nc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):M1(t,r)},U1=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Sn=function(e,t){return e[t]},Ga=function(e,t){return e[t+1]*256+e[t]},WT=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},kr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},$s=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},zT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function $i(e,t){var r="",s,n,i=[],o,c,l,d;switch(t){case"dbcs":if(d=this.l,Ke&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Ga(this,d)),d+=2;e*=2;break;case"utf8":r=bo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Uu(this,this.l,this.l+e);break;case"wstr":return $i.call(this,e,"dbcs");case"lpstr-ansi":r=C1(this,this.l),e=4+kr(this,this.l);break;case"lpstr-cp":r=R1(this,this.l),e=4+kr(this,this.l);break;case"lpwstr":r=O1(this,this.l),e=4+2*kr(this,this.l);break;case"lpp4":e=4+kr(this,this.l),r=D1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+kr(this,this.l),r=F1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Sn(this,this.l+e++))!==0;)i.push(Go(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Ga(this,this.l+e))!==0;)i.push(Go(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Sn(this,d),this.l=d+1,c=$i.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(Go(Ga(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(d)!==-1)return o=Sn(this,d),this.l=d+1,c=$i.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(Go(Sn(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return s=Sn(this,this.l),this.l++,s;case 2:return s=(t==="i"?WT:Ga)(this,this.l),this.l+=2,s;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(s=(e>0?$s:zT)(this,this.l),this.l+=4,s):(n=kr(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=Nc(this,this.l):n=Nc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=S1(this,this.l,e);break}}return this.l+=e,r}var YT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},KT=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},XT=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function QT(e,t,r){var s=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)XT(this,t.charCodeAt(n),this.l+2*n);s=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;s=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=t&255;break;case 2:s=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:s=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:s=4,YT(this,t,this.l);break;case 8:if(s=8,r==="f"){qT(this,t,this.l);break}case 16:break;case-4:s=4,KT(this,t,this.l);break}return this.l+=s,this}function $1(e,t){var r=S1(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Qt(e,t){e.l=t,e.read_shift=$i,e.chk=$1,e.write_shift=QT}function lr(e,t){e.l+=t}function $t(e){var t=As(e);return Qt(t,0),t}function as(e,t,r){if(e){var s,n,i;Qt(e,e.l||0);for(var o=e.length,c=0,l=0;e.l<o;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var d=Cc[c]||Cc[65535];for(s=e.read_shift(1),i=s&127,n=1;n<4&&s&128;++n)i+=((s=e.read_shift(1))&127)<<7*n;l=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=l,t(u,d,c))return}}}function Ad(){var e=[],t=Ke?256:2048,r=function(d){var u=$t(d);return Qt(u,0),u},s=r(t),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},i=function(d){return s&&d<s.length-s.l?s:(n(),s=r(Math.max(d+1,t)))},o=function(){return n(),fs(e)},c=function(d){n(),s=d,s.l==null&&(s.l=s.length),i(t)};return{next:i,push:c,end:o,_bufs:e}}function Bi(e,t,r){var s=Zt(e);if(t.s?(s.cRel&&(s.c+=t.s.c),s.rRel&&(s.r+=t.s.r)):(s.cRel&&(s.c+=t.c),s.rRel&&(s.r+=t.r)),!r||r.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function fm(e,t,r){var s=Zt(e);return s.s=Bi(s.s,t.s,r),s.e=Bi(s.e,t.s,r),s}function Gi(e,t){if(e.cRel&&e.c<0)for(e=Zt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Zt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ge(e);return!e.cRel&&e.cRel!=null&&(r=eE(r)),!e.rRel&&e.rRel!=null&&(r=JT(r)),r}function Vl(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Gt(e.s.c)+":"+(e.e.cRel?"":"$")+Gt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+er(e.s.r)+":"+(e.e.rRel?"":"$")+er(e.e.r):Gi(e.s,t.biff)+":"+Gi(e.e,t.biff)}function $u(e){return parseInt(ZT(e),10)-1}function er(e){return""+(e+1)}function JT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ZT(e){return e.replace(/\$(\d+)$/,"$1")}function Bu(e){for(var t=tE(e),r=0,s=0;s!==t.length;++s)r=26*r+t.charCodeAt(s)-64;return r-1}function Gt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function eE(e){return e.replace(/^([A-Z])/,"$$$1")}function tE(e){return e.replace(/^\$([A-Z])/,"$1")}function rE(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function xr(e){for(var t=0,r=0,s=0;s<e.length;++s){var n=e.charCodeAt(s);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function Ge(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ni(e){var t=e.indexOf(":");return t==-1?{s:xr(e),e:xr(e)}:{s:xr(e.slice(0,t)),e:xr(e.slice(t+1))}}function Je(e,t){return typeof t>"u"||typeof t=="number"?Je(e.s,e.e):(typeof e!="string"&&(e=Ge(e)),typeof t!="string"&&(t=Ge(t)),e==t?e:e+":"+t)}function Rt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,s=0,n=0,i=e.length;for(r=0;s<i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.s.c=--r,r=0;s<i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;if(t.s.r=--r,s===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++s,r=0;s!=i&&!((n=e.charCodeAt(s)-64)<1||n>26);++s)r=26*r+n;for(t.e.c=--r,r=0;s!=i&&!((n=e.charCodeAt(s)-48)<0||n>9);++s)r=10*r+n;return t.e.r=--r,t}function hm(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Kr(e.z,r?_r(t):t)}catch{}try{return e.w=Kr((e.XF||{}).numFmtId||(r?14:0),r?_r(t):t)}catch{return""+t}}function Ja(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?xn[e.v]||e.v:t==null?hm(e,e.v):hm(e,t))}function Rs(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",s={};return s[r]=e,{SheetNames:[r],Sheets:s}}function B1(e,t,r){var s=r||{},n=e?Array.isArray(e):s.dense,i=e||(n?[]:{}),o=0,c=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var l=typeof s.origin=="string"?xr(s.origin):s.origin;o=l.r,c=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Rt(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},g=o+f,p=c+h;if(d.s.r>g&&(d.s.r=g),d.s.c>p&&(d.s.c=p),d.e.r<g&&(d.e.r=g),d.e.c<p&&(d.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(s.nullError)m.t="e",m.v=0;else if(s.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=s.dateNF||We[14],s.cellDates?(m.t="d",m.w=Kr(m.z,_r(m.v))):(m.t="n",m.v=_r(m.v),m.w=Kr(m.z,m.v))):m.t="s";if(n)i[g]||(i[g]=[]),i[g][p]&&i[g][p].z&&(m.z=i[g][p].z),i[g][p]=m;else{var x=Ge({c:p,r:g});i[x]&&i[x].z&&(m.z=i[x].z),i[x]=m}}}return d.s.c<1e7&&(i["!ref"]=Je(d)),i}function ii(e,t){return B1(null,e,t)}function aE(e){return e.read_shift(4,"i")}function cr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function sE(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Gu(e,t){var r=e.l,s=e.read_shift(1),n=cr(e),i=[],o={t:n,h:n};if(s&1){for(var c=e.read_shift(4),l=0;l!=c;++l)i.push(sE(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}var nE=Gu;function Qr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function pn(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var iE=cr;function Vu(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var oE=cr,Cd=Vu;function Hu(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,s=t[0]&2;e.l+=4;var n=s===0?Nc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):$s(t,0)>>2;return r?n/100:n}function G1(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var gn=G1;function ir(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function cE(e){var t={},r=e.read_shift(1),s=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),c=e.read_shift(1),l=e.read_shift(1);switch(e.l++,s){case 0:t.auto=1;break;case 1:t.index=n;var d=Js[n];d&&(t.rgb=io(d));break;case 2:t.rgb=io([o,c,l]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function lE(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function V1(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},s=e.read_shift(4);switch(s){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(s>400)throw new Error("Unsupported Clipboard: "+s.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function dE(e){return V1(e,1)}function uE(e){return V1(e,2)}var qu=2,Nr=3,Ho=11,mm=12,jc=19,qo=64,fE=65,hE=71,mE=4108,pE=4126,Wt=80,H1=81,gE=[Wt,H1],xE={1:{n:"CodePage",t:qu},2:{n:"Category",t:Wt},3:{n:"PresentationFormat",t:Wt},4:{n:"ByteCount",t:Nr},5:{n:"LineCount",t:Nr},6:{n:"ParagraphCount",t:Nr},7:{n:"SlideCount",t:Nr},8:{n:"NoteCount",t:Nr},9:{n:"HiddenCount",t:Nr},10:{n:"MultimediaClipCount",t:Nr},11:{n:"ScaleCrop",t:Ho},12:{n:"HeadingPairs",t:mE},13:{n:"TitlesOfParts",t:pE},14:{n:"Manager",t:Wt},15:{n:"Company",t:Wt},16:{n:"LinksUpToDate",t:Ho},17:{n:"CharacterCount",t:Nr},19:{n:"SharedDoc",t:Ho},22:{n:"HyperlinksChanged",t:Ho},23:{n:"AppVersion",t:Nr,p:"version"},24:{n:"DigSig",t:fE},26:{n:"ContentType",t:Wt},27:{n:"ContentStatus",t:Wt},28:{n:"Language",t:Wt},29:{n:"Version",t:Wt},255:{},2147483648:{n:"Locale",t:jc},2147483651:{n:"Behavior",t:jc},1919054434:{}},vE={1:{n:"CodePage",t:qu},2:{n:"Title",t:Wt},3:{n:"Subject",t:Wt},4:{n:"Author",t:Wt},5:{n:"Keywords",t:Wt},6:{n:"Comments",t:Wt},7:{n:"Template",t:Wt},8:{n:"LastAuthor",t:Wt},9:{n:"RevNumber",t:Wt},10:{n:"EditTime",t:qo},11:{n:"LastPrinted",t:qo},12:{n:"CreatedDate",t:qo},13:{n:"ModifiedDate",t:qo},14:{n:"PageCount",t:Nr},15:{n:"WordCount",t:Nr},16:{n:"CharCount",t:Nr},17:{n:"Thumbnail",t:hE},18:{n:"Application",t:Wt},19:{n:"DocSecurity",t:Nr},255:{},2147483648:{n:"Locale",t:jc},2147483651:{n:"Behavior",t:jc},1919054434:{}},pm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},yE=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function wE(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var _E=wE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Js=Zt(_E),xn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},q1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},gm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function bE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function NE(e){var t=bE();if(!e||!e.match)return t;var r={};if((e.match(dr)||[]).forEach(function(s){var n=Pe(s);switch(n[0].replace(RT,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[gm[n.ContentType]]!==void 0&&t[gm[n.ContentType]].push(n.PartName);break}}),t.xmlns!==GT.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Cn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function kd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Vi(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var s={};return(e.match(dr)||[]).forEach(function(n){var i=Pe(n);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Di(i.Target,t);r[c]=o,s[i.Id]=o}}),r["!id"]=s,r}var jE="application/vnd.oasis.opendocument.spreadsheet";function TE(e,t){for(var r=Mu(e),s,n;s=so.exec(r);)switch(s[3]){case"manifest":break;case"file-entry":if(n=Pe(s[0],!1),n.path=="/"&&n.type!==jE)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw s}}var Hi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],EE=function(){for(var e=new Array(Hi.length),t=0;t<Hi.length;++t){var r=Hi[t],s="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+s+"[^>]*>([\\s\\S]*?)</"+s+">")}return e}();function W1(e){var t={};e=xt(e);for(var r=0;r<Hi.length;++r){var s=Hi[r],n=e.match(EE[r]);n!=null&&n.length>0&&(t[s[1]]=Ze(n[1])),s[2]==="date"&&t[s[1]]&&(t[s[1]]=Yt(t[s[1]]))}return t}var SE=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function z1(e,t,r,s){var n=[];if(typeof e=="string")n=im(e,s);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?im(t,s).map(function(u){return u.v}):t,c=0,l=0;if(o.length>0)for(var d=0;d!==n.length;d+=2){switch(l=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(c,c+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=o.slice(c,c+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(c,c+l);break}c+=l}}function AE(e,t,r){var s={};return t||(t={}),e=xt(e),SE.forEach(function(n){var i=(e.match(ao(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Ze(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(s[n[1]]=o[1]);break}}),s.HeadingPairs&&s.TitlesOfParts&&z1(s.HeadingPairs,s.TitlesOfParts,t,r),t}var CE=/<[^>]+>[^<]*/g;function kE(e,t){var r={},s="",n=e.match(CE);if(n)for(var i=0;i!=n.length;++i){var o=n[i],c=Pe(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":s=Ze(c.name);break;case"</property>":s=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),d=l[0].slice(4),u=l[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[s]=Ze(u);break;case"bool":r[s]=Tt(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[s]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[s]=parseFloat(u);break;case"filetime":case"date":r[s]=Yt(u);break;case"cy":case"error":r[s]=Ze(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}var RE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hl;function IE(e,t,r){Hl||(Hl=Du(RE)),t=Hl[t]||t,e[t]=r}function Wu(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Y1(e,t,r){var s=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-s&3;)++e.l;return n}function K1(e,t,r){var s=e.read_shift(0,"lpwstr");return s}function X1(e,t,r){return t===31?K1(e):Y1(e,t,r)}function Rd(e,t,r){return X1(e,t,r===!1?0:4)}function OE(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return X1(e,t,0)}function PE(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s){var n=e.l;r[s]=e.read_shift(0,"lpwstr").replace(wr,""),e.l-n&2&&(e.l+=2)}return r}function DE(e){for(var t=e.read_shift(4),r=[],s=0;s!=t;++s)r[s]=e.read_shift(0,"lpstr-cp").replace(wr,"");return r}function LE(e){var t=e.l,r=Tc(e,H1);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var s=Tc(e,Nr);return[r,s]}function FE(e){for(var t=e.read_shift(4),r=[],s=0;s<t/2;++s)r.push(LE(e));return r}function xm(e,t){for(var r=e.read_shift(4),s={},n=0;n!=r;++n){var i=e.read_shift(4),o=e.read_shift(4);s[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(wr,"").replace(Pi,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),s}function Q1(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function ME(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Tc(e,t,r){var s=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==mm&&s!==t&&gE.indexOf(t)===-1&&!((t&65534)==4126&&(s&65534)==4126))throw new Error("Expected type "+t+" saw "+s);switch(t===mm?s:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return Y1(e,s,4).replace(wr,"");case 31:return K1(e);case 64:return Wu(e);case 65:return Q1(e);case 71:return ME(e);case 80:return Rd(e,s,!i.raw).replace(wr,"");case 81:return OE(e,s).replace(wr,"");case 4108:return FE(e);case 4126:case 4127:return s==4127?PE(e):DE(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}}function vm(e,t){var r=e.l,s=e.read_shift(4),n=e.read_shift(4),i=[],o=0,c=0,l=-1,d={};for(o=0;o!=n;++o){var u=e.read_shift(4),f=e.read_shift(4);i[o]=[u,f+r]}i.sort(function(w,v){return w[1]-v[1]});var h={};for(o=0;o!=n;++o){if(e.l!==i[o][1]){var m=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,m=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(m=!1,e.l=i[o][1]),m)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[i[o][0]];if(h[g.n]=Tc(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ca(c=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(i[o][0]===1){if(c=h.CodePage=Tc(e,qu),ca(c),l!==-1){var p=e.l;e.l=i[l][1],d=xm(e,c),e.l=p}}else if(i[o][0]===0){if(c===0){l=o,e.l=i[o+1][1];continue}d=xm(e,c)}else{var x=d[i[o][0]],y;switch(e[e.l]){case 65:e.l+=4,y=Q1(e);break;case 30:e.l+=4,y=Rd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Rd(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=It(e,4);break;case 64:e.l+=4,y=Yt(Wu(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=y}}return e.l=r+s,h}function ym(e,t,r){var s=e.content;if(!s)return{};Qt(s,0);var n,i,o,c,l=0;s.chk("feff","Byte Order: "),s.read_shift(2);var d=s.read_shift(4),u=s.read_shift(16);if(u!==Qe.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(n=s.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=s.read_shift(16),c=s.read_shift(4),n===1&&c!==s.l)throw new Error("Length mismatch: "+c+" !== "+s.l);n===2&&(o=s.read_shift(16),l=s.read_shift(4));var f=vm(s,t),h={SystemIdentifier:d};for(var m in f)h[m]=f[m];if(h.FMTID=i,n===1)return h;if(l-s.l==2&&(s.l+=2),s.l!==l)throw new Error("Length mismatch 2: "+s.l+" !== "+l);var g;try{g=vm(s,null)}catch{}for(m in g)h[m]=g[m];return h.FMTID=[i,o],h}function cs(e,t){return e.read_shift(t),null}function UE(e,t,r){for(var s=[],n=e.l+t;e.l<n;)s.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return s}function It(e,t){return e.read_shift(t)===1}function Ft(e){return e.read_shift(2,"u")}function J1(e,t){return UE(e,t,Ft)}function $E(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function No(e,t,r){var s=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=s?e.read_shift(s,n):"";return o}function BE(e){var t=e.read_shift(2),r=e.read_shift(1),s=r&4,n=r&8,i=1+(r&1),o=0,c,l={};n&&(o=e.read_shift(2)),s&&(c=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return n&&(e.l+=4*o),s&&(e.l+=c),l.t=u,n||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function on(e,t,r){var s;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?s=e.read_shift(t,"sbcs-cont"):s=e.read_shift(t,"dbcs-cont"),s}function jo(e,t,r){var s=e.read_shift(r&&r.biff==2?1:2);return s===0?(e.l++,""):on(e,s,r)}function vn(e,t,r){if(r.biff>5)return jo(e,t,r);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function GE(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function VE(e){var t=e.read_shift(4),r=e.l,s=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(s=!0),e.l=r);var n=e.read_shift((s?t-24:t)>>1,"utf16le").replace(wr,"");return s&&(e.l+=24),n}function HE(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var s=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+s.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(wr,"");return r+o}function qE(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return VE(e);case"0303000000000000c000000000000046":return HE(e);default:throw new Error("Unsupported Moniker "+r)}}function Wo(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(wr,""):"";return r}function WE(e,t){var r=e.l+t,s=e.read_shift(4);if(s!==2)throw new Error("Unrecognized streamVersion: "+s);var n=e.read_shift(2);e.l+=2;var i,o,c,l,d="",u,f;n&16&&(i=Wo(e,r-e.l)),n&128&&(o=Wo(e,r-e.l)),(n&257)===257&&(c=Wo(e,r-e.l)),(n&257)===1&&(l=qE(e,r-e.l)),n&8&&(d=Wo(e,r-e.l)),n&32&&(u=e.read_shift(16)),n&64&&(f=Wu(e)),e.l=r;var h=o||c||l||"";h&&d&&(h+="#"+d),h||(h="#"+d),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return u&&(m.guid=u),f&&(m.time=f),i&&(m.Tooltip=i),m}function Z1(e){var t=e.read_shift(1),r=e.read_shift(1),s=e.read_shift(1),n=e.read_shift(1);return[t,r,s,n]}function ev(e,t){var r=Z1(e);return r[3]=0,r}function Oa(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return{r:t,c:r,ixfe:s}}function zE(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function YE(e,t,r){return t===0?"":vn(e,t,r)}function KE(e,t,r){var s=r.biff>8?4:2,n=e.read_shift(s),i=e.read_shift(s,"i"),o=e.read_shift(s,"i");return[n,i,o]}function tv(e){var t=e.read_shift(2),r=Hu(e);return[t,r]}function XE(e,t,r){e.l+=4,t-=4;var s=e.l+t,n=No(e,t,r),i=e.read_shift(2);if(s-=e.l,i!==s)throw new Error("Malformed AddinUdf: padding = "+s+" != "+i);return e.l+=i,n}function ol(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);return{s:{c:s,r:t},e:{c:n,r}}}function rv(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(1),n=e.read_shift(1);return{s:{c:s,r:t},e:{c:n,r}}}var QE=rv;function av(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2);return e.l+=12,[r,t,s]}function JE(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function ZE(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function sr(e){e.l+=2,e.l+=e.read_shift(2)}var eS={0:sr,4:sr,5:sr,6:sr,7:ZE,8:sr,9:sr,10:sr,11:sr,12:sr,13:JE,14:sr,15:sr,16:sr,17:sr,18:sr,19:sr,20:sr,21:av};function tS(e,t){for(var r=e.l+t,s=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{s.push(eS[n](e,r-e.l))}catch{return e.l=r,s}}return e.l!=r&&(e.l=r),s}function zo(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function rS(e,t){return t===0||e.read_shift(2),1200}function aS(e,t,r){if(r.enc)return e.l+=t,"";var s=e.l,n=vn(e,0,r);return e.read_shift(t+s-e.l),n}function sS(e,t,r){var s=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:s&16,fBelow:s&64,fRight:s&128}}function nS(e,t,r){var s=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=No(e,0,r);return o.length===0&&(o="Sheet1"),{pos:s,hs:n,dt:i,name:o}}function iS(e,t){for(var r=e.l+t,s=e.read_shift(4),n=e.read_shift(4),i=[],o=0;o!=n&&e.l<r;++o)i.push(BE(e));return i.Count=s,i.Unique=n,i}function oS(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function cS(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var s=e.read_shift(1);return e.l+=3,s&7&&(t.level=s&7),s&32&&(t.hidden=!0),s&64&&(t.hpt=r/20),t}function lS(e){var t=zE(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function dS(e){return e.read_shift(2),e.read_shift(4)}function wm(e,t,r){var s=0;r&&r.biff==2||(s=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(s=1-(n>>15),n&=32767);var i={Unsynced:s&1,DyZero:(s&2)>>1,ExAsc:(s&4)>>2,ExDsc:(s&8)>>3};return[i,n]}function uS(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[s,n],Flags:i,CurTab:o,FirstTab:c,Selected:l,TabRatio:d}}function fS(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var s=e.read_shift(2);return{RTL:s&64}}function hS(){}function mS(e,t,r){var s={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return s.name=No(e,0,r),s}function pS(e){var t=Oa(e);return t.isst=e.read_shift(4),t}function gS(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=e.l+t,n=Oa(e);r.biff==2&&e.l++;var i=jo(e,s-e.l,r);return n.val=i,n}function xS(e,t,r){var s=e.read_shift(2),n=vn(e,0,r);return[s,n]}var vS=vn;function _m(e,t,r){var s=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2),l=e.read_shift(2);return e.l=s,{s:{r:i,c},e:{r:o,c:l}}}function yS(e){var t=e.read_shift(2),r=e.read_shift(2),s=tv(e);return{r:t,c:r,ixfe:s[0],rknum:s[1]}}function wS(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(tv(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:s,c:n,C:o,rkrec:i}}function _S(e,t){for(var r=e.l+t-2,s=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:s,c:n,C:o,ixfe:i}}function bS(e,t,r,s){var n={},i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(4),l=e.read_shift(2);return n.patternType=yE[c>>26],s.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=c&127,n.icvBottom=c>>7&127,n.icvDiag=c>>14&127,n.dgDiag=c>>21&15,n.icvFore=l&127,n.icvBack=l>>7&127,n.fsxButton=l>>14&1),n}function NS(e,t,r){var s={};return s.ifnt=e.read_shift(2),s.numFmtId=e.read_shift(2),s.flags=e.read_shift(2),s.fStyle=s.flags>>2&1,t-=6,s.data=bS(e,t,s.fStyle,r),s}function jS(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function bm(e,t,r){var s=Oa(e);(r.biff==2||t==9)&&++e.l;var n=$E(e);return s.val=n,s.t=n===!0||n===!1?"b":"e",s}function TS(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var s=Oa(e),n=ir(e);return s.val=n,s}var Nm=YE;function ES(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=on(e,i),c=[];s>e.l;)c.push(jo(e));return[i,n,o,c]}function jm(e,t,r){var s=e.read_shift(2),n,i={fBuiltIn:s&1,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return r.sbcch===14849&&(n=XE(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var SS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Tm(e,t,r){var s=e.l+t,n=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=on(e,o,r);n&32&&(d=SS[d.charCodeAt(0)]);var u=s-e.l;r&&r.biff==2&&--u;var f=s==e.l||c===0||!(u>0)?[]:c3(e,u,r,c);return{chKey:i,Name:d,itab:l,rgce:f}}function sv(e,t,r){if(r.biff<8)return AS(e,t,r);for(var s=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)s.push(KE(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return s}function AS(e,t,r){e[e.l+1]==3&&e[e.l]++;var s=No(e,t,r);return s.charCodeAt(0)==3?s.slice(1):s}function CS(e,t,r){if(r.biff<8){e.l+=t;return}var s=e.read_shift(2),n=e.read_shift(2),i=on(e,s,r),o=on(e,n,r);return[i,o]}function kS(e,t,r){var s=rv(e);e.l++;var n=e.read_shift(1);return t-=8,[l3(e,t,r),n,s]}function Em(e,t,r){var s=QE(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[s,i3(e,t,r)]}function RS(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,s=e.read_shift(4);return[t,r,s]}function IS(e,t,r){if(!(r.biff<8)){var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=vn(e,0,r);return r.biff<8&&e.read_shift(1),[{r:s,c:n},c,o,i]}}function OS(e,t,r){return IS(e,t,r)}function PS(e,t){for(var r=[],s=e.read_shift(2);s--;)r.push(ol(e));return r}function DS(e,t,r){if(r&&r.biff<8)return FS(e,t,r);var s=av(e),n=tS(e,t-22,s[1]);return{cmo:s,ft:n}}var LS={8:function(e,t){var r=e.l+t;e.l+=10;var s=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:s}}};function FS(e,t,r){e.l+=4;var s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((LS[s]||lr)(e,t,r)),{cmo:[n,s,i],ft:o}}function MS(e,t,r){var s=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=GE(e,6,r);var c=e.read_shift(2);e.read_shift(2),Ft(e,2);var l=e.read_shift(2);e.l+=l;for(var d=1;d<e.lens.length-1;++d){if(e.l-s!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],f=on(e,e.lens[d+1]-e.lens[d]-1);if(n+=f,n.length>=(u?c:2*c))break}if(n.length!==c&&n.length!==c*2)throw new Error("cchText: "+c+" != "+n.length);return e.l=s+t,{t:n}}catch{return e.l=s+t,{t:n}}}function US(e,t){var r=ol(e);e.l+=16;var s=WE(e,t-24);return[r,s]}function $S(e,t){e.read_shift(2);var r=ol(e),s=e.read_shift((t-10)/2,"dbcs-cont");return s=s.replace(wr,""),[r,s]}function BS(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=pm[r]||r,r=e.read_shift(2),t[1]=pm[r]||r,t}function GS(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ev(e));return r}function VS(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ev(e));return r}function HS(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function nv(e,t,r){if(!r.cellStyles)return lr(e,t);var s=r&&r.biff>=12?4:2,n=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(s),c=e.read_shift(s),l=e.read_shift(2);s==2&&(e.l+=2);var d={s:n,e:i,w:o,ixfe:c,flags:l};return(r.biff>=5||!r.biff)&&(d.level=l>>8&7),d}function qS(e,t){var r={};return t<32||(e.l+=16,r.header=ir(e),r.footer=ir(e),e.l+=2),r}function WS(e,t,r){var s={area:!1};if(r.biff!=5)return e.l+=t,s;var n=e.read_shift(1);return e.l+=3,n&16&&(s.area=!0),s}var zS=Oa,YS=J1,KS=jo;function XS(e){var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n={fmt:t,env:r,len:s,data:e.slice(e.l,e.l+s)};return e.l+=s,n}function QS(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var s=Oa(e);++e.l;var n=vn(e,t-7,r);return s.t="str",s.val=n,s}function JS(e){var t=Oa(e);++e.l;var r=ir(e);return t.t="n",t.val=r,t}function ZS(e){var t=Oa(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function e4(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function t4(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function r4(e,t,r){var s=e.l+t,n=Oa(e),i=e.read_shift(2),o=on(e,i,r);return e.l=s,n.t="str",n.val=o,n}var a4=[2,3,48,49,131,139,140,245],Sm=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Du({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,l){var d=[],u=As(1);switch(l.type){case"base64":u=na(Fr(c));break;case"binary":u=na(c);break;case"buffer":case"array":u=c;break}Qt(u,0);var f=u.read_shift(1),h=!!(f&136),m=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=u.read_shift(2));var y=u.read_shift(2),w=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var v=[],j={},S=Math.min(u.length,f==2?521:x-10-(m?264:0)),_=g?32:11;u.l<S&&u[u.l]!=13;)switch(j={},j.name=us.utils.decode(w,u.slice(u.l,u.l+_)).replace(/[\u0000\r\n].*$/g,""),u.l+=_,j.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(j.offset=u.read_shift(4)),j.len=u.read_shift(1),f==2&&(j.offset=u.read_shift(2)),j.dec=u.read_shift(1),j.name.length&&v.push(j),f!=2&&(u.l+=g?13:14),j.type){case"B":(!m||j.len!=8)&&l.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var T=0,N=0;for(d[0]=[],N=0;N!=v.length;++N)d[0][N]=v[N].name;for(;p-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,d[++T]=[],N=0,N=0;N!=v.length;++N){var b=u.slice(u.l,u.l+v[N].len);u.l+=v[N].len,Qt(b,0);var O=us.utils.decode(w,b);switch(v[N].type){case"C":O.trim().length&&(d[T][N]=O.replace(/\s+$/,""));break;case"D":O.length===8?d[T][N]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):d[T][N]=O;break;case"F":d[T][N]=parseFloat(O.trim());break;case"+":case"I":d[T][N]=g?b.read_shift(-4,"i")^2147483648:b.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":d[T][N]=!0;break;case"N":case"F":d[T][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[T][N]="##MEMO##"+(g?parseInt(O.trim(),10):b.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(d[T][N]=+O||0);break;case"@":d[T][N]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":d[T][N]=new Date((b.read_shift(4)-2440588)*864e5+b.read_shift(4));break;case"Y":d[T][N]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[T][N]=-b.read_shift(-8,"f");break;case"B":if(m&&v[N].len==8){d[T][N]=b.read_shift(8,"f");break}case"G":case"P":b.l+=v[N].len;break;case"0":if(v[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[N].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(d=d.slice(0,l.sheetRows)),l.DBF=v,d}function s(c,l){var d=l||{};d.dateNF||(d.dateNF="yyyymmdd");var u=ii(r(c,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function n(c,l){try{return Rs(s(c,l),l)}catch(d){if(l&&l.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,l){var d=l||{};if(+d.codepage>=0&&ca(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=Ad(),f=Md(c,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),g=c["!cols"]||[],p=0,x=0,y=0,w=1;for(p=0;p<h.length;++p){if(((g[p]||{}).DBF||{}).name){h[p]=g[p].DBF.name,++y;continue}if(h[p]!=null){if(++y,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(x=0;x<1024;++x)if(h.indexOf(h[p]+"_"+x)==-1){h[p]+="_"+x;break}}}}var v=Rt(c["!ref"]),j=[],S=[],_=[];for(p=0;p<=v.e.c-v.s.c;++p){var T="",N="",b=0,O=[];for(x=0;x<m.length;++x)m[x][p]!=null&&O.push(m[x][p]);if(O.length==0||h[p]==null){j[p]="?";continue}for(x=0;x<O.length;++x){switch(typeof O[x]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=O[x]instanceof Date?"D":"C";break;default:N="C"}b=Math.max(b,String(O[x]).length),T=T&&T!=N?"C":N}b>250&&(b=250),N=((g[p]||{}).DBF||{}).type,N=="C"&&g[p].DBF.len>b&&(b=g[p].DBF.len),T=="B"&&N=="N"&&(T="N",_[p]=g[p].DBF.dec,b=g[p].DBF.len),S[p]=T=="C"||N=="N"?b:i[T]||0,w+=S[p],j[p]=T}var A=u.next(32);for(A.write_shift(4,318902576),A.write_shift(4,m.length),A.write_shift(2,296+32*y),A.write_shift(2,w),p=0;p<4;++p)A.write_shift(4,0);for(A.write_shift(4,0|(+t[s1]||3)<<8),p=0,x=0;p<h.length;++p)if(h[p]!=null){var E=u.next(32),U=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);E.write_shift(1,U,"sbcs"),E.write_shift(1,j[p]=="?"?"C":j[p],"sbcs"),E.write_shift(4,x),E.write_shift(1,S[p]||i[j[p]]||0),E.write_shift(1,_[p]||0),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(1,0),E.write_shift(4,0),E.write_shift(4,0),x+=S[p]||i[j[p]]||0}var Y=u.next(264);for(Y.write_shift(4,13),p=0;p<65;++p)Y.write_shift(4,0);for(p=0;p<m.length;++p){var ee=u.next(w);for(ee.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(j[x]){case"L":ee.write_shift(1,m[p][x]==null?63:m[p][x]?84:70);break;case"B":ee.write_shift(8,m[p][x]||0,"f");break;case"N":var se="0";for(typeof m[p][x]=="number"&&(se=m[p][x].toFixed(_[x]||0)),y=0;y<S[x]-se.length;++y)ee.write_shift(1,32);ee.write_shift(1,se,"sbcs");break;case"D":m[p][x]?(ee.write_shift(4,("0000"+m[p][x].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(m[p][x].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+m[p][x].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var W=String(m[p][x]!=null?m[p][x]:"").slice(0,S[x]);for(ee.write_shift(1,W,"sbcs"),y=0;y<S[x]-W.length;++y)ee.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:n,to_sheet:s,from_sheet:o}}(),s4=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ca(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var g=e[m];return typeof g=="number"?Vh(g):g},s=function(h,m,g){var p=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?h:Vh(p)};e["|"]=254;function n(h,m){switch(m.type){case"base64":return i(Fr(h),m);case"binary":return i(h,m);case"buffer":return i(Ke&&Buffer.isBuffer(h)?h.toString("binary"):mn(h),m);case"array":return i(nn(h),m)}throw new Error("Unrecognized type "+m.type)}function i(h,m){var g=h.split(/[\n\r]+/),p=-1,x=-1,y=0,w=0,v=[],j=[],S=null,_={},T=[],N=[],b=[],O=0,A;for(+m.codepage>=0&&ca(+m.codepage);y!==g.length;++y){O=0;var E=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(t,r),U=E.replace(/;;/g,"\0").split(";").map(function(C){return C.replace(/\u0000/g,";")}),Y=U[0],ee;if(E.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&j.push(E.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,W=!1,J=!1,F=!1,te=-1,fe=-1;for(w=1;w<U.length;++w)switch(U[w].charAt(0)){case"A":break;case"X":x=parseInt(U[w].slice(1))-1,W=!0;break;case"Y":for(p=parseInt(U[w].slice(1))-1,W||(x=0),A=v.length;A<=p;++A)v[A]=[];break;case"K":ee=U[w].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(ua(ee))?isNaN(Kn(ee).getDate())||(ee=Yt(ee)):(ee=ua(ee),S!==null&&si(S)&&(ee=il(ee))),se=!0;break;case"E":F=!0;var R=On(U[w].slice(1),{r:p,c:x});v[p][x]=[v[p][x],R];break;case"S":J=!0,v[p][x]=[v[p][x],"S5S"];break;case"G":break;case"R":te=parseInt(U[w].slice(1))-1;break;case"C":fe=parseInt(U[w].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+E)}if(se&&(v[p][x]&&v[p][x].length==2?v[p][x][0]=ee:v[p][x]=ee,S=null),J){if(F)throw new Error("SYLK shared formula cannot have own formula");var G=te>-1&&v[te][fe];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");v[p][x][1]=pv(G[1],{r:p-te,c:x-fe})}break;case"F":var P=0;for(w=1;w<U.length;++w)switch(U[w].charAt(0)){case"X":x=parseInt(U[w].slice(1))-1,++P;break;case"Y":for(p=parseInt(U[w].slice(1))-1,A=v.length;A<=p;++A)v[A]=[];break;case"M":O=parseInt(U[w].slice(1))/20;break;case"F":break;case"G":break;case"P":S=j[parseInt(U[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(b=U[w].slice(1).split(" "),A=parseInt(b[0],10);A<=parseInt(b[1],10);++A)O=parseInt(b[2],10),N[A-1]=O===0?{hidden:!0}:{wch:O},Xn(N[A-1]);break;case"C":x=parseInt(U[w].slice(1))-1,N[x]||(N[x]={});break;case"R":p=parseInt(U[w].slice(1))-1,T[p]||(T[p]={}),O>0?(T[p].hpt=O,T[p].hpx=oo(O)):O===0&&(T[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+E)}P<1&&(S=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+E)}}return T.length>0&&(_["!rows"]=T),N.length>0&&(_["!cols"]=N),m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),[v,_]}function o(h,m){var g=n(h,m),p=g[0],x=g[1],y=ii(p,m);return Ca(x).forEach(function(w){y[w]=x[w]}),y}function c(h,m){return Rs(o(h,m),m)}function l(h,m,g,p){var x="C;Y"+(g+1)+";X"+(p+1)+";K";switch(h.t){case"n":x+=h.v||0,h.f&&!h.F&&(x+=";E"+HA(h.f,{r:g,c:p}));break;case"b":x+=h.v?"TRUE":"FALSE";break;case"e":x+=h.w||h.v;break;case"d":x+='"'+(h.w||h.v)+'"';break;case"s":x+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function d(h,m){m.forEach(function(g,p){var x="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Sc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Ac(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&h.push(x)})}function u(h,m){m.forEach(function(g,p){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*fv(g.hpx)+";"),x.length>2&&h.push(x+"R"+(p+1))})}function f(h,m){var g=["ID;PWXL;N;E"],p=[],x=Rt(h["!ref"]),y,w=Array.isArray(h),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&d(g,h["!cols"]),h["!rows"]&&u(g,h["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var j=x.s.r;j<=x.e.r;++j)for(var S=x.s.c;S<=x.e.c;++S){var _=Ge({r:j,c:S});y=w?(h[j]||[])[S]:h[_],!(!y||y.v==null&&(!y.f||y.F))&&p.push(l(y,h,j,S))}return g.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:c,to_sheet:o,from_sheet:f}}(),n4=function(){function e(i,o){switch(o.type){case"base64":return t(Fr(i),o);case"binary":return t(i,o);case"buffer":return t(Ke&&Buffer.isBuffer(i)?i.toString("binary"):mn(i),o);case"array":return t(nn(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var c=i.split(`
`),l=-1,d=-1,u=0,f=[];u!==c.length;++u){if(c[u].trim()==="BOT"){f[++l]=[],d=0;continue}if(!(l<0)){var h=c[u].trim().split(","),m=h[0],g=h[1];++u;for(var p=c[u]||"";(p.match(/["]/g)||[]).length&1&&u<c.length-1;)p+=`
`+c[++u];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++l]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][d]=!0:p==="FALSE"?f[l][d]=!1:isNaN(ua(g))?isNaN(Kn(g).getDate())?f[l][d]=g:f[l][d]=Yt(g):f[l][d]=ua(g),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][d++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return ii(e(i,o),o)}function s(i,o){return Rs(r(i,o),o)}var n=function(){var i=function(l,d,u,f,h){l.push(d),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},o=function(l,d,u,f){l.push(d+","+u),l.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var d=[],u=Rt(l["!ref"]),f,h=Array.isArray(l);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){o(d,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var p=Ge({r:m,c:g});if(f=h?(l[m]||[])[g]:l[p],!f){o(d,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,x,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Kr(f.z||We[14],_r(Yt(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var y=`\r
`,w=d.join(y);return w}}();return{to_workbook:s,to_sheet:r,from_sheet:n}}(),i4=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),g=-1,p=-1,x=0,y=[];x!==m.length;++x){var w=m[x].trim().split(":");if(w[0]==="cell"){var v=xr(w[1]);if(y.length<=v.r)for(g=y.length;g<=v.r;++g)y[g]||(y[g]=[]);switch(g=v.r,p=v.c,w[2]){case"t":y[g][p]=e(w[3]);break;case"v":y[g][p]=+w[3];break;case"vtf":var j=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[g][p]=!!+w[4];break;default:y[g][p]=+w[4];break}w[2]=="vtf"&&(y[g][p]=[y[g][p],j])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function s(f,h){return ii(r(f,h),h)}function n(f,h){return Rs(s(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],g,p="",x=ni(f["!ref"]),y=Array.isArray(f),w=x.s.r;w<=x.e.r;++w)for(var v=x.s.c;v<=x.e.c;++v)if(p=Ge({r:w,c:v}),g=y?(f[w]||[])[v]:f[p],!(!g||g.v==null||g.t==="z")){switch(m=["cell",p,"t"],g.t){case"s":case"str":m.push(t(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=t(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var j=_r(Yt(g.v));m[2]="vtc",m[3]="nd",m[4]=""+j,m[5]=g.w||Kr(g.z||We[14],j);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,o,c,o,d(f),l].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:u}}(),no=function(){function e(u,f,h,m,g){g.raw?f[h][m]=u:u===""||(u==="TRUE"?f[h][m]=!0:u==="FALSE"?f[h][m]=!1:isNaN(ua(u))?isNaN(Kn(u).getDate())?f[h][m]=u:f[h][m]=Yt(u):f[h][m]=ua(u))}function t(u,f){var h=f||{},m=[];if(!u||u.length===0)return m;for(var g=u.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var x=10,y=0,w=0;w<=p;++w)y=g[w].indexOf(" "),y==-1?y=g[w].length:y++,x=Math.max(x,y);for(w=0;w<=p;++w){m[w]=[];var v=0;for(e(g[w].slice(0,x).trim(),m,w,v,h),v=1;v<=(g[w].length-x)/10+1;++v)e(g[w].slice(x+(v-1)*10,x+v*10).trim(),m,w,v,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(u){for(var f={},h=!1,m=0,g=0;m<u.length;++m)(g=u.charCodeAt(m))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&g.push([f[m],m]);if(!g.length){f=s;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&g.push([f[m],m])}return g.sort(function(p,x){return p[0]-x[0]||s[p[1]]-s[x[1]]}),r[g.pop()[1]]||44}function i(u,f){var h=f||{},m="",g=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=n(u.slice(0,1024)):h&&h.FS?m=h.FS:m=n(u.slice(0,1024));var x=0,y=0,w=0,v=0,j=0,S=m.charCodeAt(0),_=!1,T=0,N=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var b=h.dateNF!=null?xT(h.dateNF):null;function O(){var A=u.slice(v,j),E={};if(A.charAt(0)=='"'&&A.charAt(A.length-1)=='"'&&(A=A.slice(1,-1).replace(/""/g,'"')),A.length===0)E.t="z";else if(h.raw)E.t="s",E.v=A;else if(A.trim().length===0)E.t="s",E.v=A;else if(A.charCodeAt(0)==61)A.charCodeAt(1)==34&&A.charCodeAt(A.length-1)==34?(E.t="s",E.v=A.slice(2,-1).replace(/""/g,'"')):WA(A)?(E.t="n",E.f=A.slice(1)):(E.t="s",E.v=A);else if(A=="TRUE")E.t="b",E.v=!0;else if(A=="FALSE")E.t="b",E.v=!1;else if(!isNaN(w=ua(A)))E.t="n",h.cellText!==!1&&(E.w=A),E.v=w;else if(!isNaN(Kn(A).getDate())||b&&A.match(b)){E.z=h.dateNF||We[14];var U=0;b&&A.match(b)&&(A=vT(A,h.dateNF,A.match(b)||[]),U=1),h.cellDates?(E.t="d",E.v=Yt(A,U)):(E.t="n",E.v=_r(Yt(A,U))),h.cellText!==!1&&(E.w=Kr(E.z,E.v instanceof Date?_r(E.v):E.v)),h.cellNF||delete E.z}else E.t="s",E.v=A;if(E.t=="z"||(h.dense?(g[x]||(g[x]=[]),g[x][y]=E):g[Ge({c:y,r:x})]=E),v=j+1,N=u.charCodeAt(v),p.e.c<y&&(p.e.c=y),p.e.r<x&&(p.e.r=x),T==S)++y;else if(y=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;j<u.length;++j)switch(T=u.charCodeAt(j)){case 34:N===34&&(_=!_);break;case S:case 10:case 13:if(!_&&O())break e;break}return j-v>0&&O(),g["!ref"]=Je(p),g}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):ii(t(u,f),f)}function c(u,f){var h="",m=f.type=="string"?[0,0,0,0]:ef(u,f);switch(f.type){case"base64":h=Fr(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof us<"u"?h=us.utils.decode(f.codepage,u):h=Ke&&Buffer.isBuffer(u)?u.toString("binary"):mn(u);break;case"array":h=nn(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=xt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=xt(h):f.type=="binary"&&typeof us<"u"&&f.codepage&&(h=us.utils.decode(f.codepage,us.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?i4.to_sheet(f.type=="string"?h:xt(h),f):o(h,f)}function l(u,f){return Rs(c(u,f),f)}function d(u){for(var f=[],h=Rt(u["!ref"]),m,g=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var x=[],y=h.s.c;y<=h.e.c;++y){var w=Ge({r:p,c:y});if(m=g?(u[p]||[])[y]:u[w],!m||m.v==null){x.push("          ");continue}for(var v=(m.w||(Ja(m),m.w)||"").slice(0,10);v.length<10;)v+=" ";x.push(v+(y===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:c,from_sheet:d}}();function o4(e,t){var r=t||{},s=!!r.WTF;r.WTF=!0;try{var n=s4.to_workbook(e,r);return r.WTF=s,n}catch(i){if(r.WTF=s,!i.message.match(/SYLK bad record ID/)&&s)throw i;return no.to_workbook(e,t)}}var qi=function(){function e(R,G,P){if(R){Qt(R,R.l||0);for(var C=P.Enum||te;R.l<R.length;){var K=R.read_shift(2),D=C[K]||C[65535],Q=R.read_shift(2),z=R.l+Q,X=D.f&&D.f(R,Q,P);if(R.l=z,G(X,D,K))return}}}function t(R,G){switch(G.type){case"base64":return r(na(Fr(R)),G);case"binary":return r(na(R),G);case"buffer":case"array":return r(R,G)}throw"Unsupported type "+G.type}function r(R,G){if(!R)return R;var P=G||{},C=P.dense?[]:{},K="Sheet1",D="",Q=0,z={},X=[],ne=[],k={s:{r:0,c:0},e:{r:0,c:0}},Ce=P.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)P.Enum=te,e(R,function(ue,je,$e){switch($e){case 0:P.vers=ue,ue>=4096&&(P.qpro=!0);break;case 6:k=ue;break;case 204:ue&&(D=ue);break;case 222:D=ue;break;case 15:case 51:P.qpro||(ue[1].v=ue[1].v.slice(1));case 13:case 14:case 16:$e==14&&(ue[2]&112)==112&&(ue[2]&15)>1&&(ue[2]&15)<15&&(ue[1].z=P.dateNF||We[14],P.cellDates&&(ue[1].t="d",ue[1].v=il(ue[1].v))),P.qpro&&ue[3]>Q&&(C["!ref"]=Je(k),z[K]=C,X.push(K),C=P.dense?[]:{},k={s:{r:0,c:0},e:{r:0,c:0}},Q=ue[3],K=D||"Sheet"+(Q+1),D="");var ot=P.dense?(C[ue[0].r]||[])[ue[0].c]:C[Ge(ue[0])];if(ot){ot.t=ue[1].t,ot.v=ue[1].v,ue[1].z!=null&&(ot.z=ue[1].z),ue[1].f!=null&&(ot.f=ue[1].f);break}P.dense?(C[ue[0].r]||(C[ue[0].r]=[]),C[ue[0].r][ue[0].c]=ue[1]):C[Ge(ue[0])]=ue[1];break}},P);else if(R[2]==26||R[2]==14)P.Enum=fe,R[2]==14&&(P.qpro=!0,R.l=0),e(R,function(ue,je,$e){switch($e){case 204:K=ue;break;case 22:ue[1].v=ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ue[3]>Q&&(C["!ref"]=Je(k),z[K]=C,X.push(K),C=P.dense?[]:{},k={s:{r:0,c:0},e:{r:0,c:0}},Q=ue[3],K="Sheet"+(Q+1)),Ce>0&&ue[0].r>=Ce)break;P.dense?(C[ue[0].r]||(C[ue[0].r]=[]),C[ue[0].r][ue[0].c]=ue[1]):C[Ge(ue[0])]=ue[1],k.e.c<ue[0].c&&(k.e.c=ue[0].c),k.e.r<ue[0].r&&(k.e.r=ue[0].r);break;case 27:ue[14e3]&&(ne[ue[14e3][0]]=ue[14e3][1]);break;case 1537:ne[ue[0]]=ue[1],ue[0]==Q&&(K=ue[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(C["!ref"]=Je(k),z[D||K]=C,X.push(D||K),!ne.length)return{SheetNames:X,Sheets:z};for(var _e={},me=[],pe=0;pe<ne.length;++pe)z[X[pe]]?(me.push(ne[pe]||X[pe]),_e[ne[pe]]=z[ne[pe]]||z[X[pe]]):(me.push(ne[pe]),_e[ne[pe]]={"!ref":"A1"});return{SheetNames:me,Sheets:_e}}function s(R,G){var P=G||{};if(+P.codepage>=0&&ca(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var C=Ad(),K=Rt(R["!ref"]),D=Array.isArray(R),Q=[];ta(C,0,i(1030)),ta(C,6,l(K));for(var z=Math.min(K.e.r,8191),X=K.s.r;X<=z;++X)for(var ne=er(X),k=K.s.c;k<=K.e.c;++k){X===K.s.r&&(Q[k]=Gt(k));var Ce=Q[k]+ne,_e=D?(R[X]||[])[k]:R[Ce];if(!(!_e||_e.t=="z"))if(_e.t=="n")(_e.v|0)==_e.v&&_e.v>=-32768&&_e.v<=32767?ta(C,13,m(X,k,_e.v)):ta(C,14,p(X,k,_e.v));else{var me=Ja(_e);ta(C,15,f(X,k,me.slice(0,239)))}}return ta(C,1),C.end()}function n(R,G){var P=G||{};if(+P.codepage>=0&&ca(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var C=Ad();ta(C,0,o(R));for(var K=0,D=0;K<R.SheetNames.length;++K)(R.Sheets[R.SheetNames[K]]||{})["!ref"]&&ta(C,27,F(R.SheetNames[K],D++));var Q=0;for(K=0;K<R.SheetNames.length;++K){var z=R.Sheets[R.SheetNames[K]];if(!(!z||!z["!ref"])){for(var X=Rt(z["!ref"]),ne=Array.isArray(z),k=[],Ce=Math.min(X.e.r,8191),_e=X.s.r;_e<=Ce;++_e)for(var me=er(_e),pe=X.s.c;pe<=X.e.c;++pe){_e===X.s.r&&(k[pe]=Gt(pe));var ue=k[pe]+me,je=ne?(z[_e]||[])[pe]:z[ue];if(!(!je||je.t=="z"))if(je.t=="n")ta(C,23,O(_e,pe,Q,je.v));else{var $e=Ja(je);ta(C,22,T(_e,pe,Q,$e.slice(0,239)))}}++Q}}return ta(C,1),C.end()}function i(R){var G=$t(2);return G.write_shift(2,R),G}function o(R){var G=$t(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var P=0,C=0,K=0,D=0;D<R.SheetNames.length;++D){var Q=R.SheetNames[D],z=R.Sheets[Q];if(!(!z||!z["!ref"])){++K;var X=ni(z["!ref"]);P<X.e.r&&(P=X.e.r),C<X.e.c&&(C=X.e.c)}}return P>8191&&(P=8191),G.write_shift(2,P),G.write_shift(1,K),G.write_shift(1,C),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function c(R,G,P){var C={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&P.qpro?(C.s.c=R.read_shift(1),R.l++,C.s.r=R.read_shift(2),C.e.c=R.read_shift(1),R.l++,C.e.r=R.read_shift(2),C):(C.s.c=R.read_shift(2),C.s.r=R.read_shift(2),G==12&&P.qpro&&(R.l+=2),C.e.c=R.read_shift(2),C.e.r=R.read_shift(2),G==12&&P.qpro&&(R.l+=2),C.s.c==65535&&(C.s.c=C.e.c=C.s.r=C.e.r=0),C)}function l(R){var G=$t(8);return G.write_shift(2,R.s.c),G.write_shift(2,R.s.r),G.write_shift(2,R.e.c),G.write_shift(2,R.e.r),G}function d(R,G,P){var C=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(C[0].c=R.read_shift(1),C[3]=R.read_shift(1),C[0].r=R.read_shift(2),R.l+=2):(C[2]=R.read_shift(1),C[0].c=R.read_shift(2),C[0].r=R.read_shift(2)),C}function u(R,G,P){var C=R.l+G,K=d(R,G,P);if(K[1].t="s",P.vers==20768){R.l++;var D=R.read_shift(1);return K[1].v=R.read_shift(D,"utf8"),K}return P.qpro&&R.l++,K[1].v=R.read_shift(C-R.l,"cstr"),K}function f(R,G,P){var C=$t(7+P.length);C.write_shift(1,255),C.write_shift(2,G),C.write_shift(2,R),C.write_shift(1,39);for(var K=0;K<C.length;++K){var D=P.charCodeAt(K);C.write_shift(1,D>=128?95:D)}return C.write_shift(1,0),C}function h(R,G,P){var C=d(R,G,P);return C[1].v=R.read_shift(2,"i"),C}function m(R,G,P){var C=$t(7);return C.write_shift(1,255),C.write_shift(2,G),C.write_shift(2,R),C.write_shift(2,P,"i"),C}function g(R,G,P){var C=d(R,G,P);return C[1].v=R.read_shift(8,"f"),C}function p(R,G,P){var C=$t(13);return C.write_shift(1,255),C.write_shift(2,G),C.write_shift(2,R),C.write_shift(8,P,"f"),C}function x(R,G,P){var C=R.l+G,K=d(R,G,P);if(K[1].v=R.read_shift(8,"f"),P.qpro)R.l=C;else{var D=R.read_shift(2);j(R.slice(R.l,R.l+D),K),R.l+=D}return K}function y(R,G,P){var C=G&32768;return G&=-32769,G=(C?R:0)+(G>=8192?G-16384:G),(C?"":"$")+(P?Gt(G):er(G))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(R,G){Qt(R,0);for(var P=[],C=0,K="",D="",Q="",z="";R.l<R.length;){var X=R[R.l++];switch(X){case 0:P.push(R.read_shift(8,"f"));break;case 1:D=y(G[0].c,R.read_shift(2),!0),K=y(G[0].r,R.read_shift(2),!1),P.push(D+K);break;case 2:{var ne=y(G[0].c,R.read_shift(2),!0),k=y(G[0].r,R.read_shift(2),!1);D=y(G[0].c,R.read_shift(2),!0),K=y(G[0].r,R.read_shift(2),!1),P.push(ne+k+":"+D+K)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(R.read_shift(2));break;case 6:{for(var Ce="";X=R[R.l++];)Ce+=String.fromCharCode(X);P.push('"'+Ce.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:z=P.pop(),Q=P.pop(),P.push(["AND","OR"][X-20]+"("+Q+","+z+")");break;default:if(X<32&&v[X])z=P.pop(),Q=P.pop(),P.push(Q+v[X]+z);else if(w[X]){if(C=w[X][1],C==69&&(C=R[R.l++]),C>P.length){console.error("WK1 bad formula parse 0x"+X.toString(16)+":|"+P.join("|")+"|");return}var _e=P.slice(-C);P.length-=C,P.push(w[X][0]+"("+_e.join(",")+")")}else return X<=7?console.error("WK1 invalid opcode "+X.toString(16)):X<=24?console.error("WK1 unsupported op "+X.toString(16)):X<=30?console.error("WK1 invalid opcode "+X.toString(16)):X<=115?console.error("WK1 unsupported function opcode "+X.toString(16)):console.error("WK1 unrecognized opcode "+X.toString(16))}}P.length==1?G[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function S(R){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=R.read_shift(2),G[3]=R[R.l++],G[0].c=R[R.l++],G}function _(R,G){var P=S(R);return P[1].t="s",P[1].v=R.read_shift(G-4,"cstr"),P}function T(R,G,P,C){var K=$t(6+C.length);K.write_shift(2,R),K.write_shift(1,P),K.write_shift(1,G),K.write_shift(1,39);for(var D=0;D<C.length;++D){var Q=C.charCodeAt(D);K.write_shift(1,Q>=128?95:Q)}return K.write_shift(1,0),K}function N(R,G){var P=S(R);P[1].v=R.read_shift(2);var C=P[1].v>>1;if(P[1].v&1)switch(C&7){case 0:C=(C>>3)*5e3;break;case 1:C=(C>>3)*500;break;case 2:C=(C>>3)/20;break;case 3:C=(C>>3)/200;break;case 4:C=(C>>3)/2e3;break;case 5:C=(C>>3)/2e4;break;case 6:C=(C>>3)/16;break;case 7:C=(C>>3)/64;break}return P[1].v=C,P}function b(R,G){var P=S(R),C=R.read_shift(4),K=R.read_shift(4),D=R.read_shift(2);if(D==65535)return C===0&&K===3221225472?(P[1].t="e",P[1].v=15):C===0&&K===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var Q=D&32768;return D=(D&32767)-16446,P[1].v=(1-Q*2)*(K*Math.pow(2,D+32)+C*Math.pow(2,D)),P}function O(R,G,P,C){var K=$t(14);if(K.write_shift(2,R),K.write_shift(1,P),K.write_shift(1,G),C==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var D=0,Q=0,z=0,X=0;return C<0&&(D=1,C=-C),Q=Math.log2(C)|0,C/=Math.pow(2,Q-31),X=C>>>0,X&2147483648||(C/=2,++Q,X=C>>>0),C-=X,X|=2147483648,X>>>=0,C*=Math.pow(2,32),z=C>>>0,K.write_shift(4,z),K.write_shift(4,X),Q+=16383+(D?32768:0),K.write_shift(2,Q),K}function A(R,G){var P=b(R);return R.l+=G-14,P}function E(R,G){var P=S(R),C=R.read_shift(4);return P[1].v=C>>6,P}function U(R,G){var P=S(R),C=R.read_shift(8,"f");return P[1].v=C,P}function Y(R,G){var P=U(R);return R.l+=G-10,P}function ee(R,G){return R[R.l+G-1]==0?R.read_shift(G,"cstr"):""}function se(R,G){var P=R[R.l++];P>G-1&&(P=G-1);for(var C="";C.length<P;)C+=String.fromCharCode(R[R.l++]);return C}function W(R,G,P){if(!(!P.qpro||G<21)){var C=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var K=R.read_shift(G-21,"cstr");return[C,K]}}function J(R,G){for(var P={},C=R.l+G;R.l<C;){var K=R.read_shift(2);if(K==14e3){for(P[K]=[0,""],P[K][0]=R.read_shift(2);R[R.l];)P[K][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return P}function F(R,G){var P=$t(5+R.length);P.write_shift(2,14e3),P.write_shift(2,G);for(var C=0;C<R.length;++C){var K=R.charCodeAt(C);P[P.l++]=K>127?95:K}return P[P.l++]=0,P}var te={0:{n:"BOF",f:Ft},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:_},23:{n:"NUMBER17",f:b},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:A},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:E},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:W},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:t}}();function c4(e){var t={},r=e.match(dr),s=0,n=!1;if(r)for(;s!=r.length;++s){var i=Pe(r[s]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=ku[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var l4=function(){var e=ao("t"),t=ao("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var c={t:"s",v:Ze(o[1])},l=i.match(t);return l&&(c.s=c4(l[1])),c}var s=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(s,"").split(n).map(r).filter(function(c){return c.v})}}(),d4=function(){var t=/(\r\n|\n)/g;function r(n,i,o){var c=[];n.u&&c.push("text-decoration: underline;"),n.uval&&c.push("text-underline-style:"+n.uval+";"),n.sz&&c.push("font-size:"+n.sz+"pt;"),n.outline&&c.push("text-effect: outline;"),n.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),n.b&&(i.push("<b>"),o.push("</b>")),n.i&&(i.push("<i>"),o.push("</i>")),n.strike&&(i.push("<s>"),o.push("</s>"));var l=n.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),n}function s(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(s).join("")}}(),u4=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,f4=/<(?:\w+:)?r>/,h4=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function zu(e,t){var r=t?t.cellHTML:!0,s={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(s.t=Ze(xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),s.r=xt(e),r&&(s.h=Fu(s.t))):e.match(f4)&&(s.r=xt(e),s.t=Ze(xt((e.replace(h4,"").match(u4)||[]).join("").replace(dr,""))),r&&(s.h=d4(l4(s.r)))),s):{t:""}}var m4=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,p4=/<(?:\w+:)?(?:si|sstItem)>/g,g4=/<\/(?:\w+:)?(?:si|sstItem)>/;function x4(e,t){var r=[],s="";if(!e)return r;var n=e.match(m4);if(n){s=n[2].replace(p4,"").split(g4);for(var i=0;i!=s.length;++i){var o=zu(s[i].trim(),t);o!=null&&(r[r.length]=o)}n=Pe(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}function v4(e){return[e.read_shift(4),e.read_shift(4)]}function y4(e,t){var r=[],s=!1;return as(e,function(i,o,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:s=!0;break;case 36:s=!1;break;default:if(o.T,!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function iv(e){for(var t=[],r=e.split(""),s=0;s<r.length;++s)t[s]=r[s].charCodeAt(0);return t}function za(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function w4(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=za(e,4),t.U=za(e,4),t.W=za(e,4),t}function _4(e){for(var t=e.read_shift(4),r=e.l+t-4,s={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(s.name=e.read_shift(0,"lpp4"),s.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return s}function b4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(_4(e));return t}function N4(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function j4(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=za(e,4),t.U=za(e,4),t.W=za(e,4),t}function T4(e){var t=j4(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function ov(e,t){var r=e.l+t,s={};s.Flags=e.read_shift(4)&63,e.l+=4,s.AlgID=e.read_shift(4);var n=!1;switch(s.AlgID){case 26126:case 26127:case 26128:n=s.Flags==36;break;case 26625:n=s.Flags==4;break;case 0:n=s.Flags==16||s.Flags==4||s.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+s.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return s.AlgIDHash=e.read_shift(4),s.KeySize=e.read_shift(4),s.ProviderType=e.read_shift(4),e.l+=8,s.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,s}function cv(e,t){var r={},s=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,s),e.l=s,r}function E4(e){var t=za(e);switch(t.Minor){case 2:return[t.Minor,S4(e)];case 3:return[t.Minor,A4()];case 4:return[t.Minor,C4(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function S4(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),s=ov(e,r),n=cv(e,e.length-e.l);return{t:"Std",h:s,v:n}}function A4(){throw new Error("File is password-protected: ECMA-376 Extensible")}function C4(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),s={};return r.replace(dr,function(i){var o=Pe(i);switch(Ia(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){s[c]=o[c]});break;case"<dataIntegrity":s.encryptedHmacKey=o.encryptedHmacKey,s.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":s.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":s.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":s.encs.push(o);break;default:throw o[0]}}),s}function k4(e,t){var r={},s=r.EncryptionVersionInfo=za(e,4);if(t-=4,s.Minor!=2)throw new Error("unrecognized minor version code: "+s.Minor);if(s.Major>4||s.Major<2)throw new Error("unrecognized major version code: "+s.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=ov(e,n),t-=n,r.EncryptionVerifier=cv(e,t),r}function R4(e){var t={},r=t.EncryptionVersionInfo=za(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function I4(e){var t=0,r,s=iv(e),n=s.length+1,i,o,c,l,d;for(r=As(n),r[0]=s.length,i=1;i!=n;++i)r[i]=s[i-1];for(i=n-1;i>=0;--i)o=r[i],c=t&16384?1:0,l=t<<1&32767,d=c|l,t=d^o;return t^52811}var lv=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],s=function(o){return(o/2|o*128)&255},n=function(o,c){return s(o^c)},i=function(o){for(var c=t[o.length-1],l=104,d=o.length-1;d>=0;--d)for(var u=o[d],f=0;f!=7;++f)u&64&&(c^=r[l]),u*=2,--l;return c};return function(o){for(var c=iv(o),l=i(c),d=c.length,u=As(16),f=0;f!=16;++f)u[f]=0;var h,m,g;for((d&1)===1&&(h=l>>8,u[d]=n(e[0],h),--d,h=l&255,m=c[c.length-1],u[d]=n(m,h));d>0;)--d,h=l>>8,u[d]=n(c[d],h),--d,h=l&255,u[d]=n(c[d],h);for(d=15,g=15-c.length;g>0;)h=l>>8,u[d]=n(e[g],h),--d,--g,h=l&255,u[d]=n(c[d],h),--d,--g;return u}}(),O4=function(e,t,r,s,n){n||(n=t),s||(s=lv(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=s[r],o=(o>>5|o<<3)&255,n[i]=o,++r;return[n,r,s]},P4=function(e){var t=0,r=lv(e);return function(s){var n=O4("",s,t,r);return t=n[1],n[0]}};function D4(e,t,r,s){var n={key:Ft(e),verificationBytes:Ft(e)};return r.password&&(n.verifier=I4(r.password)),s.valid=n.verificationBytes===n.verifier,s.valid&&(s.insitu=P4(r.password)),n}function L4(e,t,r){var s=r||{};return s.Info=e.read_shift(2),e.l-=2,s.Info===1?s.Data=R4(e):s.Data=k4(e,t),s}function F4(e,t,r){var s={Type:r.biff>=8?e.read_shift(2):0};return s.Type?L4(e,t-2,s):D4(e,r.biff>=8?t:t-2,r,s),s}var M4=function(){function e(n,i){switch(i.type){case"base64":return t(Fr(n),i);case"binary":return t(n,i);case"buffer":return t(Ke&&Buffer.isBuffer(n)?n.toString("binary"):mn(n),i);case"array":return t(nn(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var o=i||{},c=o.dense?[]:{},l=n.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(c)&&(c[f]=[]);for(var h=/\\\w+\b/g,m=0,g,p=-1;g=h.exec(u);){switch(g[0]){case"\\cell":var x=u.slice(m,h.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var y={v:x,t:"s"};Array.isArray(c)?c[f][p]=y:c[Ge({r:f,c:p})]=y}break}m=h.lastIndex}p>d.e.c&&(d.e.c=p)}),c["!ref"]=Je(d),c}function r(n,i){return Rs(e(n,i),i)}function s(n){for(var i=["{\\rtf1\\ansi"],o=Rt(n["!ref"]),c,l=Array.isArray(n),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Ge({r:d,c:u});c=l?(n[d]||[])[u]:n[f],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Ja(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:s}}();function U4(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function io(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function $4(e){var t=e[0]/255,r=e[1]/255,s=e[2]/255,n=Math.max(t,r,s),i=Math.min(t,r,s),o=n-i;if(o===0)return[0,0,t];var c=0,l=0,d=n+i;switch(l=o/(d>1?2-d:d),n){case t:c=((r-s)/o+6)%6;break;case r:c=(s-t)/o+2;break;case s:c=(t-r)/o+4;break}return[c/6,l,d/2]}function B4(e){var t=e[0],r=e[1],s=e[2],n=r*2*(s<.5?s:1-s),i=s-n/2,o=[i,i,i],c=6*t,l;if(r!==0)switch(c|0){case 0:case 6:l=n*c,o[0]+=n,o[1]+=l;break;case 1:l=n*(2-c),o[0]+=l,o[1]+=n;break;case 2:l=n*(c-2),o[1]+=n,o[2]+=l;break;case 3:l=n*(4-c),o[1]+=l,o[2]+=n;break;case 4:l=n*(c-4),o[2]+=n,o[0]+=l;break;case 5:l=n*(6-c),o[2]+=l,o[0]+=n;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Ec(e,t){if(t===0)return e;var r=$4(U4(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),io(B4(r))}var dv=6,G4=15,V4=1,pr=dv;function Sc(e){return Math.floor((e+Math.round(128/pr)/256)*pr)}function Ac(e){return Math.floor((e-5)/pr*100+.5)/100}function Id(e){return Math.round((e*pr+5)/pr*256)/256}function ql(e){return Id(Ac(Sc(e)))}function Yu(e){var t=Math.abs(e-ql(e)),r=pr;if(t>.005)for(pr=V4;pr<G4;++pr)Math.abs(e-ql(e))<=t&&(t=Math.abs(e-ql(e)),r=pr);pr=r}function Xn(e){e.width?(e.wpx=Sc(e.width),e.wch=Ac(e.wpx),e.MDW=pr):e.wpx?(e.wch=Ac(e.wpx),e.width=Id(e.wch),e.MDW=pr):typeof e.wch=="number"&&(e.width=Id(e.wch),e.wpx=Sc(e.width),e.MDW=pr),e.customWidth&&delete e.customWidth}var H4=96,uv=H4;function fv(e){return e*96/uv}function oo(e){return e*uv/96}var q4={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function W4(e,t,r,s){t.Borders=[];var n={},i=!1;(e[0].match(dr)||[]).forEach(function(o){var c=Pe(o);switch(Ia(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},c.diagonalUp&&(n.diagonalUp=Tt(c.diagonalUp)),c.diagonalDown&&(n.diagonalDown=Tt(c.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function z4(e,t,r,s){t.Fills=[];var n={},i=!1;(e[0].match(dr)||[]).forEach(function(o){var c=Pe(o);switch(Ia(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":c.patternType&&(n.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),c.indexed&&(n.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(n.bgColor.theme=parseInt(c.theme,10)),c.tint&&(n.bgColor.tint=parseFloat(c.tint)),c.rgb&&(n.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),c.theme&&(n.fgColor.theme=parseInt(c.theme,10)),c.tint&&(n.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(n.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function Y4(e,t,r,s){t.Fonts=[];var n={},i=!1;(e[0].match(dr)||[]).forEach(function(o){var c=Pe(o);switch(Ia(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":c.val&&(n.name=xt(c.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=c.val?Tt(c.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=c.val?Tt(c.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(c.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=c.val?Tt(c.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=c.val?Tt(c.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=c.val?Tt(c.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=c.val?Tt(c.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=c.val?Tt(c.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":c.val&&(n.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(n.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(n.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(n.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=ku[parseInt(c.val,10)];break;case"<color":if(n.color||(n.color={}),c.auto&&(n.color.auto=Tt(c.auto)),c.rgb)n.color.rgb=c.rgb.slice(-6);else if(c.indexed){n.color.index=parseInt(c.indexed,10);var l=Js[n.color.index];n.color.index==81&&(l=Js[1]),l||(l=Js[1]),n.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else c.theme&&(n.color.theme=parseInt(c.theme,10),c.tint&&(n.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=Ec(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s&&s.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function K4(e,t,r){t.NumberFmt=[];for(var s=Ca(We),n=0;n<s.length;++n)t.NumberFmt[s[n]]=We[s[n]];var i=e[0].match(dr);if(i)for(n=0;n<i.length;++n){var o=Pe(i[n]);switch(Ia(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Ze(xt(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=c,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=c}Qs(c,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}var Yo=["numFmtId","fillId","fontId","borderId","xfId"],Ko=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function X4(e,t,r){t.CellXf=[];var s,n=!1;(e[0].match(dr)||[]).forEach(function(i){var o=Pe(i),c=0;switch(Ia(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(s=o,delete s[0],c=0;c<Yo.length;++c)s[Yo[c]]&&(s[Yo[c]]=parseInt(s[Yo[c]],10));for(c=0;c<Ko.length;++c)s[Ko[c]]&&(s[Ko[c]]=Tt(s[Ko[c]]));if(t.NumberFmt&&s.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[s.numFmtId]==t.NumberFmt[c]){s.numFmtId=c;break}}t.CellXf.push(s);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=Tt(o.wrapText)),s.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}var Q4=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,s=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,l,d){var u={};if(!c)return u;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=c.match(t))&&K4(f,u,d),(f=c.match(n))&&Y4(f,u,l,d),(f=c.match(s))&&z4(f,u,l,d),(f=c.match(i))&&W4(f,u,l,d),(f=c.match(r))&&X4(f,u,d),u}}();function J4(e,t){var r=e.read_shift(2),s=cr(e);return[r,s]}function Z4(e,t,r){var s={};s.sz=e.read_shift(2)/20;var n=lE(e);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var i=e.read_shift(2);switch(i===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(s.underline=o);var c=e.read_shift(1);c>0&&(s.family=c);var l=e.read_shift(1);switch(l>0&&(s.charset=l),e.l++,s.color=cE(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=cr(e),s}var eA=lr;function tA(e,t){var r=e.l+t,s=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:s,numFmtId:n}}var rA=lr;function aA(e,t,r){var s={};s.NumberFmt=[];for(var n in We)s.NumberFmt[n]=We[n];s.CellXf=[],s.Fonts=[];var i=[],o=!1;return as(e,function(l,d,u){switch(u){case 44:s.NumberFmt[l[0]]=l[1],Qs(l[1],l[0]);break;case 43:s.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Ec(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&s.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),s}var sA=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function nA(e,t,r){t.themeElements.clrScheme=[];var s={};(e[0].match(dr)||[]).forEach(function(n){var i=Pe(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":s.rgb=i.val;break;case"<a:sysClr":s.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[sA.indexOf(i[0])]=s,s={}):s.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function iA(){}function oA(){}var cA=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,lA=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,dA=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function uA(e,t,r){t.themeElements={};var s;[["clrScheme",cA,nA],["fontScheme",lA,iA],["fmtScheme",dA,oA]].forEach(function(n){if(!(s=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](s,t,r)})}var fA=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function hv(e,t){(!e||e.length===0)&&(e=hA());var r,s={};if(!(r=e.match(fA)))throw new Error("themeElements not found in theme");return uA(r[0],s,t),s.raw=e,s}function hA(e,t){var r=[j1];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function mA(e,t,r){var s=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=s;return}var i=e.slice(e.l);e.l=s;var o;try{o=N1(i,{type:"array"})}catch{return}var c=Rr(o,"theme/theme/theme1.xml",!0);if(c)return hv(c,r)}}function pA(e){return e.read_shift(4)}function gA(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=xA(e,4);break;case 2:t.xclrValue=Z1(e);break;case 3:t.xclrValue=pA(e);break;case 4:e.l+=4;break}return e.l+=8,t}function xA(e,t){return lr(e,t)}function vA(e,t){return lr(e,t)}function yA(e){var t=e.read_shift(2),r=e.read_shift(2)-4,s=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:s[1]=gA(e);break;case 6:s[1]=vA(e,r);break;case 14:case 15:s[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return s}function wA(e,t){var r=e.l+t;e.l+=2;var s=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(yA(e,r-e.l));return{ixfe:s,ext:i}}function _A(e,t){t.forEach(function(r){switch(r[0]){}})}function bA(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:cr(e)}}function NA(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function jA(e){return e.l+=4,e.read_shift(4)!=0}function TA(e,t,r){var s={Types:[],Cell:[],Value:[]},n=r||{},i=[],o=!1,c=2;return as(e,function(l,d,u){switch(u){case 335:s.Types.push({name:l.name});break;case 51:l.forEach(function(f){c==1?s.Cell.push({type:s.Types[f[0]-1].name,index:f[1]}):c==0&&s.Value.push({type:s.Types[f[0]-1].name,index:f[1]})});break;case 337:c=l?1:0;break;case 338:c=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),s}function EA(e,t,r){var s={Types:[],Cell:[],Value:[]};if(!e)return s;var n=!1,i=2,o;return e.replace(dr,function(c){var l=Pe(c);switch(Ia(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":s.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<s.Types.length;++d)s.Types[d].name==l.name&&(o=s.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?s.Cell.push({type:s.Types[l.t-1].name,index:+l.v}):i==0&&s.Value.push({type:s.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return c}),s}function SA(e){var t=[];if(!e)return t;var r=1;return(e.match(dr)||[]).forEach(function(s){var n=Pe(s);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function AA(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ge(r);var s=e.read_shift(1);return s&2&&(t.l="1"),s&8&&(t.a="1"),t}function CA(e,t,r){var s=[];return as(e,function(i,o,c){switch(c){case 63:s.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),s}function kA(e,t,r,s){if(!e)return e;var n=s||{},i=!1;as(e,function(c,l,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function RA(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Am(e,t,r,s){var n=Array.isArray(e),i;t.forEach(function(o){var c=xr(o.ref);if(n?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[o.ref],!i){i={t:"z"},n?e[c.r][c.c]=i:e[o.ref]=i;var l=Rt(e["!ref"]||"BDWGO1000001:A1");l.s.r>c.r&&(l.s.r=c.r),l.e.r<c.r&&(l.e.r=c.r),l.s.c>c.c&&(l.s.c=c.c),l.e.c<c.c&&(l.e.c=c.c);var d=Je(l);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&s){for(f=0;f<s.length;++f)if(u.a==s[f].id){u.a=s[f].name||u.a;break}}i.c.push(u)})}function IA(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],s=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var l=Pe(c[0]),d={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=xr(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&zu(f[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=h.h),s.push(d)}}}}),s}function OA(e,t){var r=[],s=!1,n={},i=0;return e.replace(dr,function(c,l){var d=Pe(c);switch(Ia(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=l+c.length;break;case"</text>":n.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":s=!0;break;case"</mentions>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),r}function PA(e,t){var r=[],s=!1;return e.replace(dr,function(i){var o=Pe(i);switch(Ia(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(!s&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function DA(e){var t={};t.iauthor=e.read_shift(4);var r=gn(e);return t.rfx=r.s,t.ref=Ge(r.s),e.l+=16,t}var LA=cr;function FA(e,t){var r=[],s=[],n={},i=!1;return as(e,function(c,l,d){switch(d){case 632:s.push(c);break;case 635:n=c;break;case 637:n.t=c.t,n.h=c.h,n.r=c.r;break;case 636:if(n.author=s[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var MA="application/vnd.ms-office.vbaProject";function UA(e){var t=Qe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,s){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qe.utils.cfb_add(t,n,e.FileIndex[s].content)}}),Qe.write(t)}function $A(){return{"!type":"dialog"}}function BA(){return{"!type":"dialog"}}function GA(){return{"!type":"macro"}}function VA(){return{"!type":"macro"}}var On=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(s,n,i,o){var c=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return c?u+=t.c:--u,l?d+=t.r:--d,n+(c?"":"$")+Gt(u)+(l?"":"$")+er(d)}return function(n,i){return t=i,n.replace(e,r)}}(),mv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,HA=function(){return function(t,r){return t.replace(mv,function(s,n,i,o,c,l){var d=Bu(o)-(i?0:r.c),u=$u(l)-(c?0:r.r),f=u==0?"":c?u+1:"["+u+"]",h=d==0?"":i?d+1:"["+d+"]";return n+"R"+f+"C"+h})}}();function pv(e,t){return e.replace(mv,function(r,s,n,i,o,c){return s+(n=="$"?n+i:Gt(Bu(i)+t.c))+(o=="$"?o+c:er($u(c)+t.r))})}function qA(e,t,r){var s=ni(t),n=s.s,i=xr(r),o={r:i.r-n.r,c:i.c-n.c};return pv(e,o)}function WA(e){return e.length!=1}function Cm(e){return e.replace(/_xlfn\./g,"")}function Dt(e){e.l+=1}function Cs(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function gv(e,t,r){var s=2;if(r){if(r.biff>=2&&r.biff<=5)return xv(e);r.biff==12&&(s=4)}var n=e.read_shift(s),i=e.read_shift(s),o=Cs(e),c=Cs(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function xv(e){var t=Cs(e),r=Cs(e),s=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:s,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function zA(e,t,r){if(r.biff<8)return xv(e);var s=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=Cs(e),o=Cs(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function vv(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return YA(e);var s=e.read_shift(r&&r.biff==12?4:2),n=Cs(e);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function YA(e){var t=Cs(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function KA(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function XA(e,t,r){var s=r&&r.biff?r.biff:8;if(s>=2&&s<=5)return QA(e);var n=e.read_shift(s>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:c}}function QA(e){var t=e.read_shift(2),r=e.read_shift(1),s=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,s==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:s}}function JA(e,t,r){var s=(e[e.l++]&96)>>5,n=gv(e,r.biff>=2&&r.biff<=5?6:8,r);return[s,n]}function ZA(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=gv(e,i,r);return[s,n,o]}function eC(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[s]}function tC(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[s,n]}function rC(e,t,r){var s=(e[e.l++]&96)>>5,n=zA(e,t-1,r);return[s,n]}function aC(e,t,r){var s=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[s]}function km(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function sC(e,t,r){e.l+=2;for(var s=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=s;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function nC(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function iC(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(r&&r.biff==2?1:2)]}function oC(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function cC(e,t,r){var s=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[s]}function yv(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function lC(e){return e.read_shift(2),yv(e)}function dC(e){return e.read_shift(2),yv(e)}function uC(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=vv(e,0,r);return[s,n]}function fC(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=XA(e,0,r);return[s,n]}function hC(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=vv(e,0,r);return[s,n,i]}function mC(e,t,r){var s=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[p3[n],bv[n],s]}function pC(e,t,r){var s=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[s==88?-1:0,e.read_shift(1)]:gC(e);return[n,(i[0]===0?bv:m3)[i[1]]]}function gC(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function xC(e,t,r){e.l+=r&&r.biff==2?3:4}function vC(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function yC(e){return e.l++,xn[e.read_shift(1)]}function wC(e){return e.l++,e.read_shift(2)}function _C(e){return e.l++,e.read_shift(1)!==0}function bC(e){return e.l++,ir(e)}function NC(e,t,r){return e.l++,No(e,t-1,r)}function jC(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=It(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=xn[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ir(e);break;case 2:r[1]=vn(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function TC(e,t,r){for(var s=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=s;++i)n.push((r.biff==12?gn:ol)(e));return n}function EC(e,t,r){var s=0,n=0;r.biff==12?(s=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),s=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--s,--n==0&&(n=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var c=0;c!=n;++c)o[i][c]=jC(e,r.biff);return o}function SC(e,t,r){var s=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,i]}function AC(e,t,r){if(r.biff==5)return CC(e);var s=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[s,n,i]}function CC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[t,r,s]}function kC(e,t,r){var s=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function RC(e,t,r){var s=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[s,n]}function IC(e,t,r){var s=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[s]}function OC(e,t,r){var s=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[s,n]}var PC=lr,DC=lr,LC=lr;function To(e,t,r){return e.l+=2,[KA(e)]}function Ku(e){return e.l+=6,[]}var FC=To,MC=Ku,UC=Ku,$C=To;function wv(e){return e.l+=2,[Ft(e),e.read_shift(2)&1]}var BC=To,GC=wv,VC=Ku,HC=To,qC=To,WC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function zC(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),s=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),o=WC[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:s,c:n,C:i}}function YC(e){return e.l+=2,[e.read_shift(4)]}function KC(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function XC(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function QC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function JC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function ZC(e){return e.l+=4,[0,0]}var Rm={1:{n:"PtgExp",f:vC},2:{n:"PtgTbl",f:LC},3:{n:"PtgAdd",f:Dt},4:{n:"PtgSub",f:Dt},5:{n:"PtgMul",f:Dt},6:{n:"PtgDiv",f:Dt},7:{n:"PtgPower",f:Dt},8:{n:"PtgConcat",f:Dt},9:{n:"PtgLt",f:Dt},10:{n:"PtgLe",f:Dt},11:{n:"PtgEq",f:Dt},12:{n:"PtgGe",f:Dt},13:{n:"PtgGt",f:Dt},14:{n:"PtgNe",f:Dt},15:{n:"PtgIsect",f:Dt},16:{n:"PtgUnion",f:Dt},17:{n:"PtgRange",f:Dt},18:{n:"PtgUplus",f:Dt},19:{n:"PtgUminus",f:Dt},20:{n:"PtgPercent",f:Dt},21:{n:"PtgParen",f:Dt},22:{n:"PtgMissArg",f:Dt},23:{n:"PtgStr",f:NC},26:{n:"PtgSheet",f:KC},27:{n:"PtgEndSheet",f:XC},28:{n:"PtgErr",f:yC},29:{n:"PtgBool",f:_C},30:{n:"PtgInt",f:wC},31:{n:"PtgNum",f:bC},32:{n:"PtgArray",f:aC},33:{n:"PtgFunc",f:mC},34:{n:"PtgFuncVar",f:pC},35:{n:"PtgName",f:SC},36:{n:"PtgRef",f:uC},37:{n:"PtgArea",f:JA},38:{n:"PtgMemArea",f:kC},39:{n:"PtgMemErr",f:PC},40:{n:"PtgMemNoMem",f:DC},41:{n:"PtgMemFunc",f:RC},42:{n:"PtgRefErr",f:IC},43:{n:"PtgAreaErr",f:eC},44:{n:"PtgRefN",f:fC},45:{n:"PtgAreaN",f:rC},46:{n:"PtgMemAreaN",f:QC},47:{n:"PtgMemNoMemN",f:JC},57:{n:"PtgNameX",f:AC},58:{n:"PtgRef3d",f:hC},59:{n:"PtgArea3d",f:ZA},60:{n:"PtgRefErr3d",f:OC},61:{n:"PtgAreaErr3d",f:tC},255:{}},e3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},t3={1:{n:"PtgElfLel",f:wv},2:{n:"PtgElfRw",f:HC},3:{n:"PtgElfCol",f:FC},6:{n:"PtgElfRwV",f:qC},7:{n:"PtgElfColV",f:$C},10:{n:"PtgElfRadical",f:BC},11:{n:"PtgElfRadicalS",f:VC},13:{n:"PtgElfColS",f:MC},15:{n:"PtgElfColSV",f:UC},16:{n:"PtgElfRadicalLel",f:GC},25:{n:"PtgList",f:zC},29:{n:"PtgSxName",f:YC},255:{}},r3={0:{n:"PtgAttrNoop",f:ZC},1:{n:"PtgAttrSemi",f:cC},2:{n:"PtgAttrIf",f:iC},4:{n:"PtgAttrChoose",f:sC},8:{n:"PtgAttrGoto",f:nC},16:{n:"PtgAttrSum",f:xC},32:{n:"PtgAttrBaxcel",f:km},33:{n:"PtgAttrBaxcel",f:km},64:{n:"PtgAttrSpace",f:lC},65:{n:"PtgAttrSpaceSemi",f:dC},128:{n:"PtgAttrIfError",f:oC},255:{}};function Eo(e,t,r,s){if(s.biff<8)return lr(e,t);for(var n=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=EC(e,0,s),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=TC(e,r[o][1],s),i.push(r[o][2]);break;case"PtgExp":s&&s.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&i.push(lr(e,t)),i}function So(e,t,r){for(var s=e.l+t,n,i,o=[];s!=e.l;)t=s-e.l,i=e[e.l],n=Rm[i]||Rm[e3[i]],(i===24||i===25)&&(n=(i===24?t3:r3)[e[e.l+1]]),!n||!n.f?lr(e,t):o.push([n.n,n.f(e,t,r)]);return o}function a3(e){for(var t=[],r=0;r<e.length;++r){for(var s=e[r],n=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var s3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function n3(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function _v(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!s)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[s[0]][0]){case 357:return n=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[s[0]][0][3]?(n=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Im(e,t,r){var s=_v(e,t,r);return s=="#REF"?s:n3(s,r)}function nr(e,t,r,s,n){var i=n&&n.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},c=[],l,d,u,f=0,h=0,m,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,x="",y=0,w=e[0].length;y<w;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=c.pop(),d=c.pop(),p>=0){switch(e[0][p][1][0]){case 0:x=kt(" ",e[0][p][1][1]);break;case 1:x=kt("\r",e[0][p][1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}d=d+x,p=-1}c.push(d+s3[v[0]]+l);break;case"PtgIsect":l=c.pop(),d=c.pop(),c.push(d+" "+l);break;case"PtgUnion":l=c.pop(),d=c.pop(),c.push(d+","+l);break;case"PtgRange":l=c.pop(),d=c.pop(),c.push(d+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Bi(v[1][1],o,n),c.push(Gi(u,i));break;case"PtgRefN":u=r?Bi(v[1][1],r,n):v[1][1],c.push(Gi(u,i));break;case"PtgRef3d":f=v[1][1],u=Bi(v[1][2],o,n),g=Im(s,f,n),c.push(g+"!"+Gi(u,i));break;case"PtgFunc":case"PtgFuncVar":var j=v[1][0],S=v[1][1];j||(j=0),j&=127;var _=j==0?[]:c.slice(-j);c.length-=j,S==="User"&&(S=_.shift()),c.push(S+"("+_.join(",")+")");break;case"PtgBool":c.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(v[1]);break;case"PtgNum":c.push(String(v[1]));break;case"PtgStr":c.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(v[1]);break;case"PtgAreaN":m=fm(v[1][1],r?{s:r}:o,n),c.push(Vl(m,n));break;case"PtgArea":m=fm(v[1][1],o,n),c.push(Vl(m,n));break;case"PtgArea3d":f=v[1][1],m=v[1][2],g=Im(s,f,n),c.push(g+"!"+Vl(m,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var T=(s.names||[])[h-1]||(s[0]||[])[h],N=T?T.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!n.xlfn&&(N=N.slice(6)),c.push(N);break;case"PtgNameX":var b=v[1][1];h=v[1][2];var O;if(n.biff<=5)b<0&&(b=-b),s[b]&&(O=s[b][h]);else{var A="";if(((s[b]||[])[0]||[])[0]==14849||(((s[b]||[])[0]||[])[0]==1025?s[b][h]&&s[b][h].itab>0&&(A=s.SheetNames[s[b][h].itab-1]+"!"):A=s.SheetNames[h-1]+"!"),s[b]&&s[b][h])A+=s[b][h].Name;else if(s[0]&&s[0][h])A+=s[0][h].Name;else{var E=(_v(s,b,n)||"").split(";;");E[h-1]?A=E[h-1]:A+="SH33TJSERRX"}c.push(A);break}O||(O={Name:"SH33TJSERRY"}),c.push(O.Name);break;case"PtgParen":var U="(",Y=")";if(p>=0){switch(x="",e[0][p][1][0]){case 2:U=kt(" ",e[0][p][1][1])+U;break;case 3:U=kt("\r",e[0][p][1][1])+U;break;case 4:Y=kt(" ",e[0][p][1][1])+Y;break;case 5:Y=kt("\r",e[0][p][1][1])+Y;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}c.push(U+c.pop()+Y);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var ee={c:r.c,r:r.r};if(s.sharedf[Ge(u)]){var se=s.sharedf[Ge(u)];c.push(nr(se,o,ee,s,n))}else{var W=!1;for(l=0;l!=s.arrayf.length;++l)if(d=s.arrayf[l],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){c.push(nr(d[1],o,ee,s,n)),W=!0;break}W||c.push(v[1])}break;case"PtgArray":c.push("{"+a3(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&J.indexOf(e[0][y][0])==-1){v=e[0][p];var F=!0;switch(v[1][0]){case 4:F=!1;case 0:x=kt(" ",v[1][1]);break;case 5:F=!1;case 1:x=kt("\r",v[1][1]);break;default:if(x="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}c.push((F?x:"")+c.pop()+(F?"":x)),p=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function i3(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],lr(e,t-2)];var c=So(e,o,r);return t!==o+n&&(i=Eo(e,t-o-n,c,r)),e.l=s,[c,i]}function o3(e,t,r){var s=e.l+t,n=r.biff==2?1:2,i,o=e.read_shift(n);if(o==65535)return[[],lr(e,t-2)];var c=So(e,o,r);return t!==o+n&&(i=Eo(e,t-o-n,c,r)),e.l=s,[c,i]}function c3(e,t,r,s){var n=e.l+t,i=So(e,s,r),o;return n!==e.l&&(o=Eo(e,n-e.l,i,r)),[i,o]}function l3(e,t,r){var s=e.l+t,n,i=e.read_shift(2),o=So(e,i,r);return i==65535?[[],lr(e,t-2)]:(t!==i+2&&(n=Eo(e,s-i-2,o,r)),[o,n])}function d3(e){var t;if(Ga(e,e.l+6)!==65535)return[ir(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Wl(e,t,r){var s=e.l+t,n=Oa(e);r.biff==2&&++e.l;var i=d3(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=o3(e,s-e.l,r);return{cell:n,val:i[0],formula:c,shared:o>>3&1,tt:i[1]}}function cl(e,t,r){var s=e.read_shift(4),n=So(e,s,r),i=e.read_shift(4),o=i>0?Eo(e,i,n,r):null;return[n,o]}var u3=cl,ll=cl,f3=cl,h3=cl,m3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},bv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},p3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Om(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function zl(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Wi={},Pn={};function zi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Nv(e,t,r,s,n,i){try{s.cellNF&&(e.z=We[t])}catch(c){if(s.WTF)throw c}if(!(e.t==="z"&&!s.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Yt(e.v)),(!s||s.cellText!==!1)&&e.t!=="z")try{if(We[t]==null&&Qs(gT[t]||"General",t),e.t==="e")e.w=e.w||xn[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ro(e.v);else if(e.t==="d"){var o=_r(e.v);(o|0)===o?e.w=o.toString(10):e.w=ro(o)}else{if(e.v===void 0)return"";e.w=sn(e.v,Pn)}else e.t==="d"?e.w=Kr(t,_r(e.v),Pn):e.w=Kr(t,e.v,Pn)}catch(c){if(s.WTF)throw c}if(s.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ec(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),s.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ec(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),s.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(s.WTF&&i.Fills)throw c}}}function g3(e,t){var r=Rt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Je(r))}var x3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,v3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,y3=/<(?:\w:)?hyperlink [^>]*>/mg,w3=/"(\w*:\w*)"/,_3=/<(?:\w:)?col\b[^>]*[\/]?>/g,b3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,N3=/<(?:\w:)?pageMargins[^>]*\/>/g,jv=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,j3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,T3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function E3(e,t,r,s,n,i,o){if(!e)return e;s||(s={"!id":{}});var c=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=e.match(v3);f?(d=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):d=u=e;var h=d.match(jv);h?Xu(h[0],c,n,r):(h=d.match(j3))&&S3(h[0],h[1]||"",c,n,r);var m=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var g=d.slice(m,m+50).match(w3);g&&g3(c,g[1])}var p=d.match(T3);p&&p[1]&&O3(p[1],n);var x=[];if(t.cellStyles){var y=d.match(_3);y&&k3(x,y)}f&&P3(f[1],c,t,l,i,o);var w=u.match(b3);w&&(c["!autofilter"]=R3(w[0]));var v=[],j=u.match(x3);if(j)for(m=0;m!=j.length;++m)v[m]=Rt(j[m].slice(j[m].indexOf('"')+1));var S=u.match(y3);S&&A3(c,S,s);var _=u.match(N3);if(_&&(c["!margins"]=C3(Pe(_[0]))),!c["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(c["!ref"]=Je(l)),t.sheetRows>0&&c["!ref"]){var T=Rt(c["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Je(T))}return x.length>0&&(c["!cols"]=x),v.length>0&&(c["!merges"]=v),c}function Xu(e,t,r,s){var n=Pe(e);r.Sheets[s]||(r.Sheets[s]={}),n.codeName&&(r.Sheets[s].CodeName=Ze(xt(n.codeName)))}function S3(e,t,r,s,n){Xu(e.slice(0,e.indexOf(">")),r,s,n)}function A3(e,t,r){for(var s=Array.isArray(e),n=0;n!=t.length;++n){var i=Pe(xt(t[n]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Ze(i.location))):(i.Target="#"+Ze(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=Rt(i.ref),l=c.s.r;l<=c.e.r;++l)for(var d=c.s.c;d<=c.e.c;++d){var u=Ge({c:d,r:l});s?(e[l]||(e[l]=[]),e[l][d]||(e[l][d]={t:"z",v:void 0}),e[l][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function C3(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function k3(e,t){for(var r=!1,s=0;s!=t.length;++s){var n=Pe(t[s],!0);n.hidden&&(n.hidden=Tt(n.hidden));var i=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Yu(n.width)),Xn(n);i<=o;)e[i++]=Zt(n)}}function R3(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var I3=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function O3(e,t){t.Views||(t.Views=[{}]),(e.match(I3)||[]).forEach(function(r,s){var n=Pe(r);t.Views[s]||(t.Views[s]={}),+n.zoomScale&&(t.Views[s].zoom=+n.zoomScale),Tt(n.rightToLeft)&&(t.Views[s].RTL=!0)})}var P3=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,s=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=ao("v"),o=ao("f");return function(l,d,u,f,h,m){for(var g=0,p="",x=[],y=[],w=0,v=0,j=0,S="",_,T,N=0,b=0,O,A,E=0,U=0,Y=Array.isArray(m.CellXf),ee,se=[],W=[],J=Array.isArray(d),F=[],te={},fe=!1,R=!!u.sheetStubs,G=l.split(t),P=0,C=G.length;P!=C;++P){p=G[P].trim();var K=p.length;if(K!==0){var D=0;e:for(g=0;g<K;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(T=Pe(p.slice(D,g),!0),N=T.r!=null?parseInt(T.r,10):N+1,b=-1,u.sheetRows&&u.sheetRows<N)continue;te={},fe=!1,T.ht&&(fe=!0,te.hpt=parseFloat(T.ht),te.hpx=oo(te.hpt)),T.hidden=="1"&&(fe=!0,te.hidden=!0),T.outlineLevel!=null&&(fe=!0,te.level=+T.outlineLevel),fe&&(F[N-1]=te)}break;case"<":D=g;break}if(D>=g)break;if(T=Pe(p.slice(D,g),!0),N=T.r!=null?parseInt(T.r,10):N+1,b=-1,!(u.sheetRows&&u.sheetRows<N)){f.s.r>N-1&&(f.s.r=N-1),f.e.r<N-1&&(f.e.r=N-1),u&&u.cellStyles&&(te={},fe=!1,T.ht&&(fe=!0,te.hpt=parseFloat(T.ht),te.hpx=oo(te.hpt)),T.hidden=="1"&&(fe=!0,te.hidden=!0),T.outlineLevel!=null&&(fe=!0,te.level=+T.outlineLevel),fe&&(F[N-1]=te)),x=p.slice(g).split(e);for(var Q=0;Q!=x.length&&x[Q].trim().charAt(0)=="<";++Q);for(x=x.slice(Q),g=0;g!=x.length;++g)if(p=x[g].trim(),p.length!==0){if(y=p.match(r),w=g,v=0,j=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(w=0,S=y[1],v=0;v!=S.length&&!((j=S.charCodeAt(v)-64)<1||j>26);++v)w=26*w+j;--w,b=w}else++b;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,T=Pe(p.slice(0,v),!0),T.r||(T.r=Ge({r:N-1,c:b})),S=p.slice(v),_={t:""},(y=S.match(i))!=null&&y[1]!==""&&(_.v=Ze(y[1])),u.cellFormula){if((y=S.match(o))!=null&&y[1]!==""){if(_.f=Ze(xt(y[1])).replace(/\r\n/g,`
`),u.xlfn||(_.f=Cm(_.f)),y[0].indexOf('t="array"')>-1)_.F=(S.match(n)||[])[1],_.F.indexOf(":")>-1&&se.push([Rt(_.F),_.F]);else if(y[0].indexOf('t="shared"')>-1){A=Pe(y[0]);var z=Ze(xt(y[1]));u.xlfn||(z=Cm(z)),W[parseInt(A.si,10)]=[A,z,T.r]}}else(y=S.match(/<f[^>]*\/>/))&&(A=Pe(y[0]),W[A.si]&&(_.f=qA(W[A.si][1],W[A.si][2],T.r)));var X=xr(T.r);for(v=0;v<se.length;++v)X.r>=se[v][0].s.r&&X.r<=se[v][0].e.r&&X.c>=se[v][0].s.c&&X.c<=se[v][0].e.c&&(_.F=se[v][1])}if(T.t==null&&_.v===void 0)if(_.f||_.F)_.v=0,_.t="n";else if(R)_.t="z";else continue;else _.t=T.t||"n";switch(f.s.c>b&&(f.s.c=b),f.e.c<b&&(f.e.c=b),_.t){case"n":if(_.v==""||_.v==null){if(!R)continue;_.t="z"}else _.v=parseFloat(_.v);break;case"s":if(typeof _.v>"u"){if(!R)continue;_.t="z"}else O=Wi[parseInt(_.v,10)],_.v=O.t,_.r=O.r,u.cellHTML&&(_.h=O.h);break;case"str":_.t="s",_.v=_.v!=null?xt(_.v):"",u.cellHTML&&(_.h=Fu(_.v));break;case"inlineStr":y=S.match(s),_.t="s",y!=null&&(O=zu(y[1]))?(_.v=O.t,u.cellHTML&&(_.h=O.h)):_.v="";break;case"b":_.v=Tt(_.v);break;case"d":u.cellDates?_.v=Yt(_.v,1):(_.v=_r(Yt(_.v,1)),_.t="n");break;case"e":(!u||u.cellText!==!1)&&(_.w=_.v),_.v=q1[_.v];break}if(E=U=0,ee=null,Y&&T.s!==void 0&&(ee=m.CellXf[T.s],ee!=null&&(ee.numFmtId!=null&&(E=ee.numFmtId),u.cellStyles&&ee.fillId!=null&&(U=ee.fillId))),Nv(_,E,U,u,h,m),u.cellDates&&Y&&_.t=="n"&&si(We[E])&&(_.t="d",_.v=il(_.v)),T.cm&&u.xlmeta){var ne=(u.xlmeta.Cell||[])[+T.cm-1];ne&&ne.type=="XLDAPR"&&(_.D=!0)}if(J){var k=xr(T.r);d[k.r]||(d[k.r]=[]),d[k.r][k.c]=_}else d[T.r]=_}}}}F.length>0&&(d["!rows"]=F)}}();function D3(e,t){var r={},s=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=s,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}var L3=gn;function F3(){}function M3(e,t){var r={},s=e[e.l];return++e.l,r.above=!(s&64),r.left=!(s&128),e.l+=18,r.name=iE(e),r}function U3(e){var t=Qr(e);return[t]}function $3(e){var t=pn(e);return[t]}function B3(e){var t=Qr(e),r=e.read_shift(1);return[t,r,"b"]}function G3(e){var t=pn(e),r=e.read_shift(1);return[t,r,"b"]}function V3(e){var t=Qr(e),r=e.read_shift(1);return[t,r,"e"]}function H3(e){var t=pn(e),r=e.read_shift(1);return[t,r,"e"]}function q3(e){var t=Qr(e),r=e.read_shift(4);return[t,r,"s"]}function W3(e){var t=pn(e),r=e.read_shift(4);return[t,r,"s"]}function z3(e){var t=Qr(e),r=ir(e);return[t,r,"n"]}function Tv(e){var t=pn(e),r=ir(e);return[t,r,"n"]}function Y3(e){var t=Qr(e),r=Hu(e);return[t,r,"n"]}function K3(e){var t=pn(e),r=Hu(e);return[t,r,"n"]}function X3(e){var t=Qr(e),r=Gu(e);return[t,r,"is"]}function Q3(e){var t=Qr(e),r=cr(e);return[t,r,"str"]}function J3(e){var t=pn(e),r=cr(e);return[t,r,"str"]}function Z3(e,t,r){var s=e.l+t,n=Qr(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"b"];if(r.cellFormula){e.l+=2;var c=ll(e,s-e.l,r);o[3]=nr(c,null,n,r.supbooks,r)}else e.l=s;return o}function ek(e,t,r){var s=e.l+t,n=Qr(e);n.r=r["!row"];var i=e.read_shift(1),o=[n,i,"e"];if(r.cellFormula){e.l+=2;var c=ll(e,s-e.l,r);o[3]=nr(c,null,n,r.supbooks,r)}else e.l=s;return o}function tk(e,t,r){var s=e.l+t,n=Qr(e);n.r=r["!row"];var i=ir(e),o=[n,i,"n"];if(r.cellFormula){e.l+=2;var c=ll(e,s-e.l,r);o[3]=nr(c,null,n,r.supbooks,r)}else e.l=s;return o}function rk(e,t,r){var s=e.l+t,n=Qr(e);n.r=r["!row"];var i=cr(e),o=[n,i,"str"];if(r.cellFormula){e.l+=2;var c=ll(e,s-e.l,r);o[3]=nr(c,null,n,r.supbooks,r)}else e.l=s;return o}var ak=gn;function sk(e,t){var r=e.l+t,s=gn(e),n=Vu(e),i=cr(e),o=cr(e),c=cr(e);e.l=r;var l={rfx:s,relId:n,loc:i,display:c};return o&&(l.Tooltip=o),l}function nk(){}function ik(e,t,r){var s=e.l+t,n=G1(e),i=e.read_shift(1),o=[n];if(o[2]=i,r.cellFormula){var c=u3(e,s-e.l,r);o[1]=c}else e.l=s;return o}function ok(e,t,r){var s=e.l+t,n=gn(e),i=[n];if(r.cellFormula){var o=h3(e,s-e.l,r);i[1]=o,e.l=s}else e.l=s;return i}var ck=["left","right","top","bottom","header","footer"];function lk(e){var t={};return ck.forEach(function(r){t[r]=ir(e)}),t}function dk(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function uk(){}function fk(){}function hk(e,t,r,s,n,i,o){if(!e)return e;var c=t||{};s||(s={"!id":{}});var l=c.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,g,p,x,y,w,v,j,S,_=[];c.biff=12,c["!row"]=0;var T=0,N=!1,b=[],O={},A=c.supbooks||n.supbooks||[[]];if(A.sharedf=O,A.arrayf=b,A.SheetNames=n.SheetNames||n.Sheets.map(function(J){return J.name}),!c.supbooks&&(c.supbooks=A,n.Names))for(var E=0;E<n.Names.length;++E)A[0][E+1]=n.Names[E];var U=[],Y=[],ee=!1;Cc[16]={n:"BrtShortReal",f:Tv};var se;if(as(e,function(F,te,fe){if(!h)switch(fe){case 148:d=F;break;case 0:m=F,c.sheetRows&&c.sheetRows<=m.r&&(h=!0),j=er(x=m.r),c["!row"]=m.r,(F.hidden||F.hpt||F.level!=null)&&(F.hpt&&(F.hpx=oo(F.hpt)),Y[F.r]=F);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:F[2]},F[2]){case"n":g.v=F[1];break;case"s":v=Wi[F[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!F[1];break;case"e":g.v=F[1],c.cellText!==!1&&(g.w=xn[g.v]);break;case"str":g.t="s",g.v=F[1];break;case"is":g.t="s",g.v=F[1].t;break}if((p=o.CellXf[F[0].iStyleRef])&&Nv(g,p.numFmtId,null,c,i,o),y=F[0].c==-1?y+1:F[0].c,c.dense?(l[x]||(l[x]=[]),l[x][y]=g):l[Gt(y)+j]=g,c.cellFormula){for(N=!1,T=0;T<b.length;++T){var R=b[T];m.r>=R[0].s.r&&m.r<=R[0].e.r&&y>=R[0].s.c&&y<=R[0].e.c&&(g.F=Je(R[0]),N=!0)}!N&&F.length>3&&(g.f=F[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>y&&(u.s.c=y),u.e.r<m.r&&(u.e.r=m.r),u.e.c<y&&(u.e.c=y),c.cellDates&&p&&g.t=="n"&&si(We[p.numFmtId])){var G=Bs(g.v);G&&(g.t="d",g.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}se&&(se.type=="XLDAPR"&&(g.D=!0),se=void 0);break;case 1:case 12:if(!c.sheetStubs||f)break;g={t:"z",v:void 0},y=F[0].c==-1?y+1:F[0].c,c.dense?(l[x]||(l[x]=[]),l[x][y]=g):l[Gt(y)+j]=g,u.s.r>m.r&&(u.s.r=m.r),u.s.c>y&&(u.s.c=y),u.e.r<m.r&&(u.e.r=m.r),u.e.c<y&&(u.e.c=y),se&&(se.type=="XLDAPR"&&(g.D=!0),se=void 0);break;case 176:_.push(F);break;case 49:se=((c.xlmeta||{}).Cell||[])[F-1];break;case 494:var P=s["!id"][F.relId];for(P?(F.Target=P.Target,F.loc&&(F.Target+="#"+F.loc),F.Rel=P):F.relId==""&&(F.Target="#"+F.loc),x=F.rfx.s.r;x<=F.rfx.e.r;++x)for(y=F.rfx.s.c;y<=F.rfx.e.c;++y)c.dense?(l[x]||(l[x]=[]),l[x][y]||(l[x][y]={t:"z",v:void 0}),l[x][y].l=F):(w=Ge({c:y,r:x}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=F);break;case 426:if(!c.cellFormula)break;b.push(F),S=c.dense?l[x][y]:l[Gt(y)+j],S.f=nr(F[1],u,{r:m.r,c:y},A,c),S.F=Je(F[0]);break;case 427:if(!c.cellFormula)break;O[Ge(F[0].s)]=F[1],S=c.dense?l[x][y]:l[Gt(y)+j],S.f=nr(F[1],u,{r:m.r,c:y},A,c);break;case 60:if(!c.cellStyles)break;for(;F.e>=F.s;)U[F.e--]={width:F.w/256,hidden:!!(F.flags&1),level:F.level},ee||(ee=!0,Yu(F.w/256)),Xn(U[F.e+1]);break;case 161:l["!autofilter"]={ref:Je(F)};break;case 476:l["!margins"]=F;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),F.name&&(n.Sheets[r].CodeName=F.name),(F.above||F.left)&&(l["!outline"]={above:F.above,left:F.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),F.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!te.T){if(!f||c.WTF)throw new Error("Unexpected record 0x"+fe.toString(16))}}},c),delete c.supbooks,delete c["!row"],!l["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(l["!ref"]=Je(d||u)),c.sheetRows&&l["!ref"]){var W=Rt(l["!ref"]);c.sheetRows<=+W.e.r&&(W.e.r=c.sheetRows-1,W.e.r>u.e.r&&(W.e.r=u.e.r),W.e.r<W.s.r&&(W.s.r=W.e.r),W.e.c>u.e.c&&(W.e.c=u.e.c),W.e.c<W.s.c&&(W.s.c=W.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Je(W))}return _.length>0&&(l["!merges"]=_),U.length>0&&(l["!cols"]=U),Y.length>0&&(l["!rows"]=Y),l}function mk(e){var t=[],r=e.match(/^<c:numCache>/),s;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=Ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){s=i.replace(/<.*?>/g,"")}),[t,n,s]}function pk(e,t,r,s,n,i){var o=i||{"!type":"chart"};if(!e)return i;var c=0,l=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=mk(f);u.s.r=u.s.c=0,u.e.c=c,d=Gt(c),h[0].forEach(function(m,g){o[d+er(g)]={t:"n",v:m,z:h[1]},l=g}),u.e.r<l&&(u.e.r=l),++c}),c>0&&(o["!ref"]=Je(u)),o}function gk(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,c=e.match(jv);return c&&Xu(c[0],i,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}function xk(e,t){e.l+=10;var r=cr(e);return{name:r}}function vk(e,t,r,s,n){if(!e)return e;s||(s={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return as(e,function(l,d,u){switch(u){case 550:i["!rel"]=l;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),l.name&&(n.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),s["!id"][i["!rel"]]&&(i["!drawel"]=s["!id"][i["!rel"]]),i}var Ev=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],yk=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],wk=[],_k=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Pm(e,t){for(var r=0;r!=e.length;++r)for(var s=e[r],n=0;n!=t.length;++n){var i=t[n];if(s[i[0]]==null)s[i[0]]=i[1];else switch(i[2]){case"bool":typeof s[i[0]]=="string"&&(s[i[0]]=Tt(s[i[0]]));break;case"int":typeof s[i[0]]=="string"&&(s[i[0]]=parseInt(s[i[0]],10));break}}}function Dm(e,t){for(var r=0;r!=t.length;++r){var s=t[r];if(e[s[0]]==null)e[s[0]]=s[1];else switch(s[2]){case"bool":typeof e[s[0]]=="string"&&(e[s[0]]=Tt(e[s[0]]));break;case"int":typeof e[s[0]]=="string"&&(e[s[0]]=parseInt(e[s[0]],10));break}}}function Sv(e){Dm(e.WBProps,Ev),Dm(e.CalcPr,_k),Pm(e.WBView,yk),Pm(e.Sheets,wk),Pn.date1904=Tt(e.WBProps.date1904)}var bk="][*?/\\".split("");function Nk(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return bk.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var jk=/<\w+:workbook/;function Tk(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},s=!1,n="xmlns",i={},o=0;if(e.replace(dr,function(l,d){var u=Pe(l);switch(Ia(u[0])){case"<?xml":break;case"<workbook":l.match(jk)&&(n="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[n];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ev.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Tt(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=xt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ze(xt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":s=!0;break;case"</definedNames>":s=!1;break;case"<definedName":i={},i.Name=xt(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Tt(u.hidden||"0")&&(i.Hidden=!0),o=d+l.length;break;case"</definedName>":i.Ref=Ze(xt(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":s=!0;break;case"</AlternateContent>":s=!1;break;case"<revisionPtr":break;default:if(!s&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),VT.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Sv(r),r}function Ek(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Cd(e),r.name=cr(e),r}function Sk(e,t){var r={},s=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?cr(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(s&65536),r.backupFile=!!(s&64),r.checkCompatibility=!!(s&4096),r.date1904=!!(s&1),r.filterPrivacy=!!(s&8),r.hidePivotFieldList=!!(s&1024),r.promptedSolutions=!!(s&16),r.publishItems=!!(s&2048),r.refreshAllConnections=!!(s&262144),r.saveExternalLinkValues=!!(s&128),r.showBorderUnselectedTables=!!(s&4),r.showInkAnnotation=!!(s&32),r.showObjects=["all","placeholders","none"][s>>13&3],r.showPivotChartFilter=!!(s&32768),r.updateLinks=["userSet","never","always"][s>>8&3],r}function Ak(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Ck(e,t,r){var s=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=oE(e),o=f3(e,0,r),c=Vu(e);e.l=s;var l={Name:i,Ptg:o};return n<268435455&&(l.Sheet=n),c&&(l.Comment=c),l}function kk(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},s=[],n=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Cc[16]={n:"BrtFRTArchID$",f:Ak},as(e,function(l,d,u){switch(u){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=nr(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:s.push(u),n=!0;break;case 36:s.pop(),n=!1;break;case 37:s.push(u),n=!0;break;case 38:s.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||t.WTF&&s[s.length-1]!=37&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),Sv(r),r.Names=i,r.supbooks=o,r}function Rk(e,t,r){return t.slice(-4)===".bin"?kk(e,r):Tk(e,r)}function Ik(e,t,r,s,n,i,o,c){return t.slice(-4)===".bin"?hk(e,s,r,n,i,o,c):E3(e,s,r,n,i,o,c)}function Ok(e,t,r,s,n,i,o,c){return t.slice(-4)===".bin"?vk(e,s,r,n,i):gk(e,s,r,n,i)}function Pk(e,t,r,s,n,i,o,c){return t.slice(-4)===".bin"?GA():VA()}function Dk(e,t,r,s,n,i,o,c){return t.slice(-4)===".bin"?$A():BA()}function Lk(e,t,r,s){return t.slice(-4)===".bin"?aA(e,r,s):Q4(e,r,s)}function Fk(e,t,r){return hv(e,r)}function Mk(e,t,r){return t.slice(-4)===".bin"?y4(e,r):x4(e,r)}function Uk(e,t,r){return t.slice(-4)===".bin"?FA(e,r):IA(e,r)}function $k(e,t,r){return t.slice(-4)===".bin"?CA(e):SA(e)}function Bk(e,t,r,s){return r.slice(-4)===".bin"?kA(e,t,r,s):void 0}function Gk(e,t,r){return t.slice(-4)===".bin"?TA(e,t,r):EA(e,t,r)}var Av=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Cv=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ea(e,t){var r=e.split(/\s+/),s=[];if(s[0]=r[0],r.length===1)return s;var n=e.match(Av),i,o,c,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(Cv),(o=i[1].indexOf(":"))===-1?s[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),s[c]=i[2].slice(1,i[2].length-1));return s}function Vk(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var s=e.match(Av),n,i,o,c;if(s)for(c=0;c!=s.length;++c)n=s[c].match(Cv),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(i+1),r[o]=n[2].slice(1,n[2].length-1));return r}var Yi;function Hk(e,t){var r=Yi[e]||Ze(e);return r==="General"?sn(t):Kr(r,t)}function qk(e,t,r,s){var n=s;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Tt(s);break;case"i2":case"int":n=parseInt(s,10);break;case"r4":case"float":n=parseFloat(s);break;case"date":case"dateTime.tz":n=Yt(s);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ze(t)]=n}function Wk(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||xn[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ro(e.v):e.w=sn(e.v):e.w=Hk(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var s=Yi[t]||t||"General";if(r.cellNF&&(e.z=s),r.cellDates&&e.t=="n"&&si(s)){var n=Bs(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function zk(e,t,r){if(r.cellStyles&&t.Interior){var s=t.Interior;s.Pattern&&(s.patternType=q4[s.Pattern]||s.Pattern)}e[t.ID]=t}function Yk(e,t,r,s,n,i,o,c,l,d){var u="General",f=s.StyleID,h={};d=d||{};var m=[],g=0;for(f===void 0&&c&&(f=c.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&m.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":s.t="b",s.v=Tt(e);break;case"String":s.t="s",s.r=am(Ze(e)),s.v=e.indexOf("<")>-1?Ze(t||e).replace(/<.*?>/g,""):s.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),s.v=(Yt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),s.v!==s.v?s.v=Ze(e):s.v<60&&(s.v=s.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":s.v===void 0&&(s.v=+e),s.t||(s.t="n");break;case"Error":s.t="e",s.v=q1[e],d.cellText!==!1&&(s.w=e);break;default:e==""&&t==""?s.t="z":(s.t="s",s.v=am(t||e));break}if(Wk(s,u,d),d.cellFormula!==!1)if(s.Formula){var p=Ze(s.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),s.f=On(p,n),delete s.Formula,s.ArrayRange=="RC"?s.F=On("RC:RC",n):s.ArrayRange&&(s.F=On(s.ArrayRange,n),l.push([Rt(s.F),s.F]))}else for(g=0;g<l.length;++g)n.r>=l[g][0].s.r&&n.r<=l[g][0].e.r&&n.c>=l[g][0].s.c&&n.c<=l[g][0].e.c&&(s.F=l[g][1]);d.cellStyles&&(m.forEach(function(x){!h.patternType&&x.patternType&&(h.patternType=x.patternType)}),s.s=h),s.StyleID!==void 0&&(s.ixfe=s.StyleID)}function Kk(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Yl(e,t){var r=t||{};x1();var s=Oi(Mu(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(s=xt(s));var n=s.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=Zt(r);return o.type="string",no.to_workbook(s,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(je){n.indexOf("<"+je)>=0&&(i=!0)}),i)return s5(s,r);Yi={"General Number":"General","General Date":We[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":We[15],"Short Date":We[14],"Long Time":We[19],"Medium Time":We[18],"Short Time":We[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:We[2],Standard:We[4],Percent:We[10],Scientific:We[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[],d,u={},f=[],h=r.dense?[]:{},m="",g={},p={},x=ea('<Data ss:Type="String">'),y=0,w=0,v=0,j={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},_={},T="",N=0,b=[],O={},A={},E=0,U=[],Y=[],ee={},se=[],W,J=!1,F=[],te=[],fe={},R=0,G=0,P={Sheets:[],WBProps:{date1904:!1}},C={};so.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";c=so.exec(s);)switch(c[3]=(K=c[3]).toLowerCase()){case"data":if(K=="data"){if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break}if(l[l.length-1][1])break;c[1]==="/"?Yk(s.slice(y,c.index),T,x,l[l.length-1][0]=="comment"?ee:g,{c:w,r:v},S,se[w],p,F,r):(T="",x=ea(c[0]),y=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Y.length>0&&(g.c=Y),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][w]=g):h[Gt(w)+er(v)]=g),g.HRef&&(g.l={Target:Ze(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(R=w+(parseInt(g.MergeAcross,10)|0),G=v+(parseInt(g.MergeDown,10)|0),b.push({s:{c:w,r:v},e:{c:R,r:G}})),!r.sheetStubs)g.MergeAcross?w=R+1:++w;else if(g.MergeAcross||g.MergeDown){for(var D=w;D<=R;++D)for(var Q=v;Q<=G;++Q)(D>w||Q>v)&&(r.dense?(h[Q]||(h[Q]=[]),h[Q][D]={t:"z"}):h[Gt(D)+er(Q)]={t:"z"});w=R+1}else++w;else g=Vk(c[0]),g.Index&&(w=+g.Index-1),w<j.s.c&&(j.s.c=w),w>j.e.c&&(j.e.c=w),c[0].slice(-2)==="/>"&&++w,Y=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(v<j.s.r&&(j.s.r=v),v>j.e.r&&(j.e.r=v),c[0].slice(-2)==="/>"&&(p=ea(c[0]),p.Index&&(v=+p.Index-1)),w=0,++v):(p=ea(c[0]),p.Index&&(v=+p.Index-1),fe={},(p.AutoFitHeight=="0"||p.Height)&&(fe.hpx=parseInt(p.Height,10),fe.hpt=fv(fe.hpx),te[v]=fe),p.Hidden=="1"&&(fe.hidden=!0,te[v]=fe));break;case"worksheet":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));f.push(m),j.s.r<=j.e.r&&j.s.c<=j.e.c&&(h["!ref"]=Je(j),r.sheetRows&&r.sheetRows<=j.e.r&&(h["!fullref"]=h["!ref"],j.e.r=r.sheetRows-1,h["!ref"]=Je(j))),b.length&&(h["!merges"]=b),se.length>0&&(h["!cols"]=se),te.length>0&&(h["!rows"]=te),u[m]=h}else j={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,l.push([c[3],!1]),d=ea(c[0]),m=Ze(d.Name),h=r.dense?[]:{},b=[],F=[],te=[],C={name:m,Hidden:0},P.Sheets.push(C);break;case"table":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;l.push([c[3],!1]),se=[],J=!1}break;case"style":c[1]==="/"?zk(S,_,r):_=ea(c[0]);break;case"numberformat":_.nf=Ze(ea(c[0]).Format||"General"),Yi[_.nf]&&(_.nf=Yi[_.nf]);for(var z=0;z!=392&&We[z]!=_.nf;++z);if(z==392){for(z=57;z!=392;++z)if(We[z]==null){Qs(_.nf,z);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(W=ea(c[0]),W.Hidden&&(W.hidden=!0,delete W.Hidden),W.Width&&(W.wpx=parseInt(W.Width,10)),!J&&W.wpx>10){J=!0,pr=dv;for(var X=0;X<se.length;++X)se[X]&&Xn(se[X])}J&&Xn(W),se[W.Index-1||se.length]=W;for(var ne=0;ne<+W.Span;++ne)se[se.length]=Zt(W);break;case"namedrange":if(c[1]==="/")break;P.Names||(P.Names=[]);var k=Pe(c[0]),Ce={Name:k.Name,Ref:On(k.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(Ce.Sheet=P.Sheets.length-1),P.Names.push(Ce);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?T+=s.slice(N,c.index):N=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;_.Interior=ea(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?IE(O,K,s.slice(E,c.index)):E=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else l.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));Kk(ee),Y.push(ee)}else l.push([c[3],!1]),d=ea(c[0]),ee={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var _e=ea(c[0]);h["!autofilter"]={ref:On(_e.Range).replace(/\$/g,"")},l.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"null":break;default:if(l.length==0&&c[3]=="document"||l.length==0&&c[3]=="uof")return Bm(s,r);var me=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:me=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:me=!1}break;case"excelworkbook":switch(c[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:me=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:me=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(s.slice(E,c.index)){case"SheetHidden":C.Hidden=1;break;case"SheetVeryHidden":C.Hidden=2;break}else E=c.index+c[0].length;break;case"header":h["!margins"]||zi(h["!margins"]={},"xlml"),isNaN(+Pe(c[0]).Margin)||(h["!margins"].header=+Pe(c[0]).Margin);break;case"footer":h["!margins"]||zi(h["!margins"]={},"xlml"),isNaN(+Pe(c[0]).Margin)||(h["!margins"].footer=+Pe(c[0]).Margin);break;case"pagemargins":var pe=Pe(c[0]);h["!margins"]||zi(h["!margins"]={},"xlml"),isNaN(+pe.Top)||(h["!margins"].top=+pe.Top),isNaN(+pe.Left)||(h["!margins"].left=+pe.Left),isNaN(+pe.Right)||(h["!margins"].right=+pe.Right),isNaN(+pe.Bottom)||(h["!margins"].bottom=+pe.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:me=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:me=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:me=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:me=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:me=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:me=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:me=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:me=!1}break;case"smarttags":break;default:me=!1;break}if(me||c[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?qk(A,K,U,s.slice(E,c.index)):(U=c,E=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+l.join("|")}var ue={};return!r.bookSheets&&!r.bookProps&&(ue.Sheets=u),ue.SheetNames=f,ue.Workbook=P,ue.SSF=Zt(We),ue.Props=O,ue.Custprops=A,ue}function Od(e,t){switch(Zu(t=t||{}),t.type||"base64"){case"base64":return Yl(Fr(e),t);case"binary":case"buffer":case"file":return Yl(e,t);case"array":return Yl(mn(e),t)}}function Xk(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=dE(r),r.length-r.l<=4)return t;var s=r.read_shift(4);if(s==0||s>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(s=r.read_shift(4),s!==1907505652)||(t.UnicodeClipboardFormat=uE(r),s=r.read_shift(4),s==0||s>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Qk=[60,1084,2066,2165,2175];function Jk(e,t,r,s,n){var i=s,o=[],c=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(c)}o.push(c),r.l+=i;for(var l=Ga(r,r.l),d=Pd[l],u=0;d!=null&&Qk.indexOf(l)>-1;)i=Ga(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),c=r.slice(u,r.l+4+i),o.push(c),r.l+=4+i,d=Pd[l=Ga(r,r.l)];var f=fs(o);Qt(f,0);var h=0;f.lens=[];for(var m=0;m<o.length;++m)f.lens.push(h),h+=o[m].length;if(f.length<s)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+s;return t.f(f,f.length,n)}function va(e,t,r){if(e.t!=="z"&&e.XF){var s=0;try{s=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=We[s])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||xn[e.v]:s===0||s=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ro(e.v):e.w=sn(e.v):e.w=Kr(s,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&s&&e.t=="n"&&si(We[s]||String(s))){var n=Bs(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Xo(e,t,r){return{v:e,ixfe:t,t:r}}function Zk(e,t){var r={opts:{}},s={},n=t.dense?[]:{},i={},o={},c=null,l=[],d="",u={},f,h="",m,g,p,x,y={},w=[],v,j,S=[],_=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},b=function(Fe){return Fe<8?Js[Fe]:Fe<64&&_[Fe-8]||Js[Fe]},O=function(Fe,rt,ft){var st=rt.XF.data;if(!(!st||!st.patternType||!ft||!ft.cellStyles)){rt.s={},rt.s.patternType=st.patternType;var Xt;(Xt=io(b(st.icvFore)))&&(rt.s.fgColor={rgb:Xt}),(Xt=io(b(st.icvBack)))&&(rt.s.bgColor={rgb:Xt})}},A=function(Fe,rt,ft){if(!(fe>1)&&!(ft.sheetRows&&Fe.r>=ft.sheetRows)){if(ft.cellStyles&&rt.XF&&rt.XF.data&&O(Fe,rt,ft),delete rt.ixfe,delete rt.XF,f=Fe,h=Ge(Fe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Fe.r<o.s.r&&(o.s.r=Fe.r),Fe.c<o.s.c&&(o.s.c=Fe.c),Fe.r+1>o.e.r&&(o.e.r=Fe.r+1),Fe.c+1>o.e.c&&(o.e.c=Fe.c+1),ft.cellFormula&&rt.f){for(var st=0;st<w.length;++st)if(!(w[st][0].s.c>Fe.c||w[st][0].s.r>Fe.r)&&!(w[st][0].e.c<Fe.c||w[st][0].e.r<Fe.r)){rt.F=Je(w[st][0]),(w[st][0].s.c!=Fe.c||w[st][0].s.r!=Fe.r)&&delete rt.f,rt.f&&(rt.f=""+nr(w[st][1],o,Fe,F,E));break}}ft.dense?(n[Fe.r]||(n[Fe.r]=[]),n[Fe.r][Fe.c]=rt):n[h]=rt}},E={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(E.password=t.password);var U,Y=[],ee=[],se=[],W=[],J=!1,F=[];F.SheetNames=E.snames,F.sharedf=E.sharedf,F.arrayf=E.arrayf,F.names=[],F.XTI=[];var te=0,fe=0,R=0,G=[],P=[],C;E.codepage=1200,ca(1200);for(var K=!1;e.l<e.length-1;){var D=e.l,Q=e.read_shift(2);if(Q===0&&te===10)break;var z=e.l===e.length?0:e.read_shift(2),X=Pd[Q];if(X&&X.f){if(t.bookSheets&&te===133&&Q!==133)break;if(te=Q,X.r===2||X.r==12){var ne=e.read_shift(2);if(z-=2,!E.enc&&ne!==Q&&((ne&255)<<8|ne>>8)!==Q)throw new Error("rt mismatch: "+ne+"!="+Q);X.r==12&&(e.l+=10,z-=10)}var k={};if(Q===10?k=X.f(e,z,E):k=Jk(Q,X,e,z,E),fe==0&&[9,521,1033,2057].indexOf(te)===-1)continue;switch(Q){case 34:r.opts.Date1904=T.WBProps.date1904=k;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(E.enc||(e.l=0),E.enc=k,!t.password)throw new Error("File is password-protected");if(k.valid==null)throw new Error("Encryption scheme unsupported");if(!k.valid)throw new Error("Password is incorrect");break;case 92:E.lastuser=k;break;case 66:var Ce=Number(k);switch(Ce){case 21010:Ce=1200;break;case 32768:Ce=1e4;break;case 32769:Ce=1252;break}ca(E.codepage=Ce),K=!0;break;case 317:E.rrtabid=k;break;case 25:E.winlocked=k;break;case 439:r.opts.RefreshAll=k;break;case 12:r.opts.CalcCount=k;break;case 16:r.opts.CalcDelta=k;break;case 17:r.opts.CalcIter=k;break;case 13:r.opts.CalcMode=k;break;case 14:r.opts.CalcPrecision=k;break;case 95:r.opts.CalcSaveRecalc=k;break;case 15:E.CalcRefMode=k;break;case 2211:r.opts.FullCalc=k;break;case 129:k.fDialog&&(n["!type"]="dialog"),k.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),k.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:S.push(k);break;case 430:F.push([k]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(k);break;case 24:case 536:C={Name:k.Name,Ref:nr(k.rgce,o,null,F,E)},k.itab>0&&(C.Sheet=k.itab-1),F.names.push(C),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(k),k.Name=="_xlnm._FilterDatabase"&&k.itab>0&&k.rgce&&k.rgce[0]&&k.rgce[0][0]&&k.rgce[0][0][0]=="PtgArea3d"&&(P[k.itab-1]={ref:Je(k.rgce[0][0][1][2])});break;case 22:E.ExternCount=k;break;case 23:F.length==0&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(k),F.XTI=F.XTI.concat(k);break;case 2196:if(E.biff<8)break;C!=null&&(C.Comment=k[1]);break;case 18:n["!protect"]=k;break;case 19:k!==0&&E.WTF&&console.error("Password verifier: "+k);break;case 133:i[k.pos]=k,E.snames.push(k.name);break;case 10:{if(--fe)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=Je(o),t.sheetRows&&t.sheetRows<=o.e.r){var _e=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Je(o),o.e.r=_e}o.e.r++,o.e.c++}Y.length>0&&(n["!merges"]=Y),ee.length>0&&(n["!objects"]=ee),se.length>0&&(n["!cols"]=se),W.length>0&&(n["!rows"]=W),T.Sheets.push(N)}d===""?u=n:s[d]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(E.biff===8&&(E.biff={9:2,521:3,1033:4}[Q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[k.BIFFVer]||8),E.biffguess=k.BIFFVer==0,k.BIFFVer==0&&k.dt==4096&&(E.biff=5,K=!0,ca(E.codepage=28591)),E.biff==8&&k.BIFFVer==0&&k.dt==16&&(E.biff=2),fe++)break;if(n=t.dense?[]:{},E.biff<8&&!K&&(K=!0,ca(E.codepage=t.codepage||1252)),E.biff<5||k.BIFFVer==0&&k.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var me={pos:e.l-z,name:d};i[me.pos]=me,E.snames.push(d)}else d=(i[D]||{name:""}).name;k.dt==32&&(n["!type"]="chart"),k.dt==64&&(n["!type"]="macro"),Y=[],ee=[],E.arrayf=w=[],se=[],W=[],J=!1,N={Hidden:(i[D]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[k.r]||[])[k.c]:n[Ge({c:k.c,r:k.r})])&&++k.c,v={ixfe:k.ixfe,XF:S[k.ixfe]||{},v:k.val,t:"n"},R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A({c:k.c,r:k.r},v,t);break;case 5:case 517:v={ixfe:k.ixfe,XF:S[k.ixfe],v:k.val,t:k.t},R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A({c:k.c,r:k.r},v,t);break;case 638:v={ixfe:k.ixfe,XF:S[k.ixfe],v:k.rknum,t:"n"},R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A({c:k.c,r:k.r},v,t);break;case 189:for(var pe=k.c;pe<=k.C;++pe){var ue=k.rkrec[pe-k.c][0];v={ixfe:ue,XF:S[ue],v:k.rkrec[pe-k.c][1],t:"n"},R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A({c:pe,r:k.r},v,t)}break;case 6:case 518:case 1030:{if(k.val=="String"){c=k;break}if(v=Xo(k.val,k.cell.ixfe,k.tt),v.XF=S[v.ixfe],t.cellFormula){var je=k.formula;if(je&&je[0]&&je[0][0]&&je[0][0][0]=="PtgExp"){var $e=je[0][0][1][0],ot=je[0][0][1][1],tt=Ge({r:$e,c:ot});y[tt]?v.f=""+nr(k.formula,o,k.cell,F,E):v.F=((t.dense?(n[$e]||[])[ot]:n[tt])||{}).F}else v.f=""+nr(k.formula,o,k.cell,F,E)}R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A(k.cell,v,t),c=k}break;case 7:case 519:if(c)c.val=k,v=Xo(k,c.cell.ixfe,"s"),v.XF=S[v.ixfe],t.cellFormula&&(v.f=""+nr(c.formula,o,c.cell,F,E)),R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A(c.cell,v,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(k);var jt=Ge(k[0].s);if(m=t.dense?(n[k[0].s.r]||[])[k[0].s.c]:n[jt],t.cellFormula&&m){if(!c||!jt||!m)break;m.f=""+nr(k[1],o,k[0],F,E),m.F=Je(k[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!c)break;y[Ge(c.cell)]=k[0],m=t.dense?(n[c.cell.r]||[])[c.cell.c]:n[Ge(c.cell)],(m||{}).f=""+nr(k[0],o,f,F,E)}}break;case 253:v=Xo(l[k.isst].t,k.ixfe,"s"),l[k.isst].h&&(v.h=l[k.isst].h),v.XF=S[v.ixfe],R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A({c:k.c,r:k.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:k.ixfe,XF:S[k.ixfe],t:"z"},R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A({c:k.c,r:k.r},v,t));break;case 190:if(t.sheetStubs)for(var yt=k.c;yt<=k.C;++yt){var Xe=k.ixfe[yt-k.c];v={ixfe:Xe,XF:S[Xe],t:"z"},R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A({c:yt,r:k.r},v,t)}break;case 214:case 516:case 4:v=Xo(k.val,k.ixfe,"s"),v.XF=S[v.ixfe],R>0&&(v.z=G[v.ixfe>>8&63]),va(v,t,r.opts.Date1904),A({c:k.c,r:k.r},v,t);break;case 0:case 512:fe===1&&(o=k);break;case 252:l=k;break;case 1054:if(E.biff==4){G[R++]=k[1];for(var ut=0;ut<R+163&&We[ut]!=k[1];++ut);ut>=163&&Qs(k[1],R+163)}else Qs(k[1],k[0]);break;case 30:{G[R++]=k;for(var qe=0;qe<R+163&&We[qe]!=k;++qe);qe>=163&&Qs(k,R+163)}break;case 229:Y=Y.concat(k);break;case 93:ee[k.cmo[0]]=E.lastobj=k;break;case 438:E.lastobj.TxO=k;break;case 127:E.lastobj.ImData=k;break;case 440:for(x=k[0].s.r;x<=k[0].e.r;++x)for(p=k[0].s.c;p<=k[0].e.c;++p)m=t.dense?(n[x]||[])[p]:n[Ge({c:p,r:x})],m&&(m.l=k[1]);break;case 2048:for(x=k[0].s.r;x<=k[0].e.r;++x)for(p=k[0].s.c;p<=k[0].e.c;++p)m=t.dense?(n[x]||[])[p]:n[Ge({c:p,r:x})],m&&m.l&&(m.l.Tooltip=k[1]);break;case 28:{if(E.biff<=5&&E.biff>=2)break;m=t.dense?(n[k[0].r]||[])[k[0].c]:n[Ge(k[0])];var Oe=ee[k[2]];m||(t.dense?(n[k[0].r]||(n[k[0].r]=[]),m=n[k[0].r][k[0].c]={t:"z"}):m=n[Ge(k[0])]={t:"z"},o.e.r=Math.max(o.e.r,k[0].r),o.s.r=Math.min(o.s.r,k[0].r),o.e.c=Math.max(o.e.c,k[0].c),o.s.c=Math.min(o.s.c,k[0].c)),m.c||(m.c=[]),g={a:k[1],t:Oe.TxO.t},m.c.push(g)}break;case 2173:_A(S[k.ixfe],k.ext);break;case 125:{if(!E.cellStyles)break;for(;k.e>=k.s;)se[k.e--]={width:k.w/256,level:k.level||0,hidden:!!(k.flags&1)},J||(J=!0,Yu(k.w/256)),Xn(se[k.e+1])}break;case 520:{var ze={};k.level!=null&&(W[k.r]=ze,ze.level=k.level),k.hidden&&(W[k.r]=ze,ze.hidden=!0),k.hpt&&(W[k.r]=ze,ze.hpt=k.hpt,ze.hpx=oo(k.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||zi(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Q]]=k;break;case 161:n["!margins"]||zi(n["!margins"]={}),n["!margins"].header=k.header,n["!margins"].footer=k.footer;break;case 574:k.RTL&&(T.Views[0].RTL=!0);break;case 146:_=k;break;case 2198:U=k;break;case 140:j=k;break;case 442:d?N.CodeName=k||N.name:T.WBProps.CodeName=k||"ThisWorkbook";break}}else X||console.error("Missing Info for XLS Record 0x"+Q.toString(16)),e.l+=z}return r.SheetNames=Ca(i).sort(function(tr,Fe){return Number(tr)-Number(Fe)}).map(function(tr){return i[tr].name}),t.bookSheets||(r.Sheets=s),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&P.forEach(function(tr,Fe){r.Sheets[r.SheetNames[Fe]]["!autofilter"]=tr}),r.Strings=l,r.SSF=Zt(We),E.enc&&(r.Encryption=E.enc),U&&(r.Themes=U),r.Metadata={},j!==void 0&&(r.Metadata.Country=j),F.names.length>0&&(T.Names=F.names),r.Workbook=T,r}var Lm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function e5(e,t,r){var s=Qe.find(e,"/!DocumentSummaryInformation");if(s&&s.size>0)try{var n=ym(s,xE,Lm.DSI);for(var i in n)t[i]=n[i]}catch(d){if(r.WTF)throw d}var o=Qe.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var c=ym(o,vE,Lm.SI);for(var l in c)t[l]==null&&(t[l]=c[l])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(z1(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function kv(e,t){t||(t={}),Zu(t),n1(),t.codepage&&Ru(t.codepage);var r,s;if(e.FullPaths){if(Qe.find(e,"/encryption"))throw new Error("File is password-protected");r=Qe.find(e,"!CompObj"),s=Qe.find(e,"/Workbook")||Qe.find(e,"/Book")}else{switch(t.type){case"base64":e=na(Fr(e));break;case"binary":e=na(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Qt(e,0),s={content:e}}var n,i;if(r&&Xk(r),t.bookProps&&!t.bookSheets)n={};else{var o=Ke?"buffer":"array";if(s&&s.content)n=Zk(s.content,t);else if((i=Qe.find(e,"PerfectOffice_MAIN"))&&i.content)n=qi.to_workbook(i.content,(t.type=o,t));else if((i=Qe.find(e,"NativeContent_MAIN"))&&i.content)n=qi.to_workbook(i.content,(t.type=o,t));else throw(i=Qe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Qe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=UA(e))}var c={};return e.FullPaths&&e5(e,c,t),n.Props=n.Custprops=c,t.bookFiles&&(n.cfb=e),n}var Cc={0:{f:D3},1:{f:U3},2:{f:Y3},3:{f:V3},4:{f:B3},5:{f:z3},6:{f:Q3},7:{f:q3},8:{f:rk},9:{f:tk},10:{f:Z3},11:{f:ek},12:{f:$3},13:{f:K3},14:{f:H3},15:{f:G3},16:{f:Tv},17:{f:J3},18:{f:W3},19:{f:Gu},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Ck},40:{},42:{},43:{f:Z4},44:{f:J4},45:{f:eA},46:{f:rA},47:{f:tA},48:{},49:{f:aE},50:{},51:{f:NA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:nv},62:{f:X3},63:{f:AA},64:{f:uk},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:lr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:dk},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:M3},148:{f:L3,p:16},151:{f:nk},152:{},153:{f:Sk},154:{},155:{},156:{f:Ek},157:{},158:{},159:{T:1,f:v4},160:{T:-1},161:{T:1,f:gn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ak},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bA},336:{T:-1},337:{f:jA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Cd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:sv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ik},427:{f:ok},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:lk},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:F3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:sk},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Cd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:LA},633:{T:1},634:{T:-1},635:{T:1,f:DA},636:{T:-1},637:{f:nE},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:xk},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:fk},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Pd={6:{f:Wl},10:{f:cs},12:{f:Ft},13:{f:Ft},14:{f:It},15:{f:It},16:{f:ir},17:{f:It},18:{f:It},19:{f:Ft},20:{f:Nm},21:{f:Nm},23:{f:sv},24:{f:Tm},25:{f:It},26:{},27:{},28:{f:OS},29:{},34:{f:It},35:{f:jm},38:{f:ir},39:{f:ir},40:{f:ir},41:{f:ir},42:{f:It},43:{f:It},47:{f:F4},49:{f:mS},51:{f:Ft},60:{},61:{f:uS},64:{f:It},65:{f:hS},66:{f:Ft},77:{},80:{},81:{},82:{},85:{f:Ft},89:{},90:{},91:{},92:{f:aS},93:{f:DS},94:{},95:{f:It},96:{},97:{},99:{f:It},125:{f:nv},128:{f:jS},129:{f:sS},130:{f:Ft},131:{f:It},132:{f:It},133:{f:nS},134:{},140:{f:BS},141:{f:Ft},144:{},146:{f:VS},151:{},152:{},153:{},154:{},155:{},156:{f:Ft},157:{},158:{},160:{f:YS},161:{f:qS},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:wS},190:{f:_S},193:{f:cs},197:{},198:{},199:{},200:{},201:{},202:{f:It},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ft},220:{},221:{f:It},222:{},224:{f:NS},225:{f:rS},226:{f:cs},227:{},229:{f:PS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:iS},253:{f:pS},255:{f:oS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:J1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:It},353:{f:cs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:ES},431:{f:It},432:{},433:{},434:{},437:{},438:{f:MS},439:{f:It},440:{f:US},441:{},442:{f:jo},443:{},444:{f:Ft},445:{},446:{},448:{f:cs},449:{f:dS,r:2},450:{f:cs},512:{f:_m},513:{f:zS},515:{f:TS},516:{f:gS},517:{f:bm},519:{f:KS},520:{f:cS},523:{},545:{f:Em},549:{f:wm},566:{},574:{f:fS},638:{f:yS},659:{},1048:{},1054:{f:xS},1084:{},1212:{f:kS},2048:{f:$S},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:zo},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:cs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:HS,r:12},2173:{f:wA,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:It,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:CS,r:12},2197:{},2198:{f:mA,r:12},2199:{},2200:{},2201:{},2202:{f:RS,r:12},2203:{f:cs},2204:{},2205:{},2206:{},2207:{},2211:{f:lS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ft},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:WS},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:GS},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_m},1:{},2:{f:ZS},3:{f:JS},4:{f:QS},5:{f:bm},7:{f:e4},8:{},9:{f:zo},11:{},22:{f:Ft},30:{f:vS},31:{},32:{},33:{f:Em},36:{},37:{f:wm},50:{f:t4},62:{},52:{},67:{},68:{f:Ft},69:{},86:{},126:{},127:{f:XS},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:r4},223:{},234:{},354:{},421:{},518:{f:Wl},521:{f:zo},536:{f:Tm},547:{f:jm},561:{},579:{},1030:{f:Wl},1033:{f:zo},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ta(e,t,r,s){var n=t;if(!isNaN(n)){var i=(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&U1(r)&&e.push(r)}}function Fm(e,t){var r=t||{},s=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=n.index,c=i&&i.index||e.length,l=TT(e.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<l.length;++o){var p=l[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(x!="<td"&&x!="<th")){var y=p.split(/<\/t[dh]>/i);for(c=0;c<y.length;++c){var w=y[c].trim();if(w.match(/<t[dh]/i)){for(var v=w,j=0;v.charAt(0)=="<"&&(j=v.indexOf(">"))>-1;)v=v.slice(j+1);for(var S=0;S<g.length;++S){var _=g[S];_.s.c==u&&_.s.r<d&&d<=_.e.r&&(u=_.e.c+1,S=-1)}var T=Pe(w.slice(0,w.indexOf(">")));h=T.colspan?+T.colspan:1,((f=+T.rowspan)>1||h>1)&&g.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+h-1}});var N=T.t||T["data-t"]||"";if(!v.length){u+=h;continue}if(v=E1(v),m.s.r>d&&(m.s.r=d),m.e.r<d&&(m.e.r=d),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!v.length){u+=h;continue}var b={t:"s",v};r.raw||!v.trim().length||N=="s"||(v==="TRUE"?b={t:"b",v:!0}:v==="FALSE"?b={t:"b",v:!1}:isNaN(ua(v))?isNaN(Kn(v).getDate())||(b={t:"d",v:Yt(v)},r.cellDates||(b={t:"n",v:_r(b.v)}),b.z=r.dateNF||We[14]):b={t:"n",v:ua(v)}),r.dense?(s[d]||(s[d]=[]),s[d][u]=b):s[Ge({r:d,c:u})]=b,u+=h}}}}return s["!ref"]=Je(m),g.length&&(s["!merges"]=g),s}function t5(e,t,r,s){for(var n=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var c=0,l=0,d=0;d<n.length;++d)if(!(n[d].s.r>r||n[d].s.c>o)&&!(n[d].e.r<r||n[d].e.c<o)){if(n[d].s.r<r||n[d].s.c<o){c=-1;break}c=n[d].e.r-n[d].s.r+1,l=n[d].e.c-n[d].s.c+1;break}if(!(c<0)){var u=Ge({r,c:o}),f=s.dense?(e[r]||[])[o]:e[u],h=f&&f.v!=null&&(f.h||Fu(f.w||(Ja(f),f.w)||""))||"",m={};c>1&&(m.rowspan=c),l>1&&(m.colspan=l),s.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(s.id||"sjs")+"-"+u,i.push(BT("td",h,m))}}var g="<tr>";return g+i.join("")+"</tr>"}var r5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',a5="</body></html>";function s5(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Rs(Fm(r[0],t),t);var s=tf();return r.forEach(function(n,i){rf(s,Fm(n,t),"Sheet"+(i+1))}),s}function n5(e,t,r){var s=[];return s.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function i5(e,t){var r=t||{},s=r.header!=null?r.header:r5,n=r.footer!=null?r.footer:a5,i=[s],o=ni(e["!ref"]);r.dense=Array.isArray(e),i.push(n5(e,o,r));for(var c=o.s.r;c<=o.e.r;++c)i.push(t5(e,o,c,r));return i.push("</table>"+n),i.join("")}function Rv(e,t,r){var s=r||{},n=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var o=typeof s.origin=="string"?xr(s.origin):s.origin;n=o.r,i=o.c}var c=t.getElementsByTagName("tr"),l=Math.min(s.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var u=ni(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),n==-1&&(d.e.r=n=u.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),g=0,p=0,x=0,y=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);g<c.length&&p<l;++g){var j=c[g];if(Mm(j)){if(s.display)continue;m[p]={hidden:!0}}var S=j.children;for(x=y=0;x<S.length;++x){var _=S[x];if(!(s.display&&Mm(_))){var T=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):E1(_.innerHTML),N=_.getAttribute("data-z")||_.getAttribute("z");for(h=0;h<f.length;++h){var b=f[h];b.s.c==y+i&&b.s.r<p+n&&p+n<=b.e.r&&(y=b.e.c+1-i,h=-1)}v=+_.getAttribute("colspan")||1,((w=+_.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+n,c:y+i},e:{r:p+n+(w||1)-1,c:y+i+(v||1)-1}});var O={t:"s",v:T},A=_.getAttribute("data-t")||_.getAttribute("t")||"";T!=null&&(T.length==0?O.t=A||"z":s.raw||T.trim().length==0||A=="s"||(T==="TRUE"?O={t:"b",v:!0}:T==="FALSE"?O={t:"b",v:!1}:isNaN(ua(T))?isNaN(Kn(T).getDate())||(O={t:"d",v:Yt(T)},s.cellDates||(O={t:"n",v:_r(O.v)}),O.z=s.dateNF||We[14]):O={t:"n",v:ua(T)})),O.z===void 0&&N!=null&&(O.z=N);var E="",U=_.getElementsByTagName("A");if(U&&U.length)for(var Y=0;Y<U.length&&!(U[Y].hasAttribute("href")&&(E=U[Y].getAttribute("href"),E.charAt(0)!="#"));++Y);E&&E.charAt(0)!="#"&&(O.l={Target:E}),s.dense?(e[p+n]||(e[p+n]=[]),e[p+n][y+i]=O):e[Ge({c:y+i,r:p+n})]=O,d.e.c<y+i&&(d.e.c=y+i),y+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,p-1+n),e["!ref"]=Je(d),p>=l&&(e["!fullref"]=Je((d.e.r=c.length-g+p-1+n,d))),e}function Iv(e,t){var r=t||{},s=r.dense?[]:{};return Rv(s,e,t)}function o5(e,t){return Rs(Iv(e,t),t)}function Mm(e){var t="",r=c5(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function c5(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function l5(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(s,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ze(t.replace(/<[^>]*>/g,""));return[r]}var Um={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ov(e,t){var r=t||{},s=Mu(e),n=[],i,o,c={name:""},l="",d=0,u,f,h={},m=[],g=r.dense?[]:{},p,x,y={value:""},w="",v=0,j=[],S=-1,_=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,b={},O=[],A={},E=0,U=0,Y=[],ee=1,se=1,W=[],J={Names:[]},F={},te=["",""],fe=[],R={},G="",P=0,C=!1,K=!1,D=0;for(so.lastIndex=0,s=s.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=so.exec(s);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?g["!ref"]=Je(T):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(g["!fullref"]=g["!ref"],T.e.r=r.sheetRows-1,g["!ref"]=Je(T)),O.length&&(g["!merges"]=O),Y.length&&(g["!rows"]=Y),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),h[u.name]=g,K=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Pe(p[0],!1),S=_=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,g=r.dense?[]:{},O=[],Y=[],K=!0);break;case"table-row-group":p[1]==="/"?--N:++N;break;case"table-row":case"":if(p[1]==="/"){S+=ee,ee=1;break}if(f=Pe(p[0],!1),f.?S=f.-1:S==-1&&(S=0),ee=+f["number-rows-repeated"]||1,ee<10)for(D=0;D<ee;++D)N>0&&(Y[S+D]={level:N});_=-1;break;case"covered-table-cell":p[1]!=="/"&&++_,r.sheetStubs&&(r.dense?(g[S]||(g[S]=[]),g[S][_]={t:"z"}):g[Ge({r:S,c:_})]={t:"z"}),w="",j=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++_,y=Pe(p[0],!1),se=parseInt(y["number-columns-repeated"]||"1",10),x={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(x.f=Om(Ze(y.formula))),(y.||y["value-type"])=="string"&&(x.t="s",x.v=Ze(y["string-value"]||""),r.dense?(g[S]||(g[S]=[]),g[S][_]=x):g[Ge({r:S,c:_})]=x),_+=se-1;else if(p[1]!=="/"){++_,w="",v=0,j=[],se=1;var Q=ee?S+ee-1:S;if(_>T.e.c&&(T.e.c=_),_<T.s.c&&(T.s.c=_),S<T.s.r&&(T.s.r=S),Q>T.e.r&&(T.e.r=Q),y=Pe(p[0],!1),fe=[],R={},x={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Ze(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(E=parseInt(y["number-matrix-rows-spanned"],10)||0,U=parseInt(y["number-matrix-columns-spanned"],10)||0,A={s:{r:S,c:_},e:{r:S+E-1,c:_+U-1}},x.F=Je(A),W.push([A,x.F])),y.formula)x.f=Om(y.formula);else for(D=0;D<W.length;++D)S>=W[D][0].s.r&&S<=W[D][0].e.r&&_>=W[D][0].s.c&&_<=W[D][0].e.c&&(x.F=W[D][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(E=parseInt(y["number-rows-spanned"],10)||0,U=parseInt(y["number-columns-spanned"],10)||0,A={s:{r:S,c:_},e:{r:S+E-1,c:_+U-1}},O.push(A)),y["number-columns-repeated"]&&(se=parseInt(y["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Tt(y["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(y.value);break;case"percentage":x.t="n",x.v=parseFloat(y.value);break;case"currency":x.t="n",x.v=parseFloat(y.value);break;case"date":x.t="d",x.v=Yt(y["date-value"]),r.cellDates||(x.t="n",x.v=_r(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=bT(y["time-value"])/86400,r.cellDates&&(x.t="d",x.v=il(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(y.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",y["string-value"]!=null&&(w=Ze(y["string-value"]),j=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(C=!1,x.t==="s"&&(x.v=w||"",j.length&&(x.R=j),C=v==0),F.Target&&(x.l=F),fe.length>0&&(x.c=fe,fe=[]),w&&r.cellText!==!1&&(x.w=w),C&&(x.t="z",delete x.v),(!C||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var z=0;z<ee;++z){if(se=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[S+z]||(g[S+z]=[]),g[S+z][_]=z==0?x:Zt(x);--se>0;)g[S+z][_+se]=Zt(x);else for(g[Ge({r:S+z,c:_})]=x;--se>0;)g[Ge({r:S+z,c:_+se})]=Zt(x);T.e.c<=_&&(T.e.c=_)}se=parseInt(y["number-columns-repeated"]||"1",10),_+=se-1,se=0,x={},w="",j=[]}F={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i;R.t=w,j.length&&(R.R=j),R.a=G,fe.push(R)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);G="",P=0,w="",v=0,j=[];break;case"creator":p[1]==="/"?G=s.slice(P,p.index):P=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);w="",v=0,j=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(b[c.name]=l,(i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(l="",c=Pe(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Pe(p[0],!1),l+=Um[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=Pe(p[0],!1),l+=Um[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":l+=s.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":o=Pe(p[0],!1),te=zl(o["cell-range-address"]);var X={Name:o.name,Ref:te[0]+"!"+te[1]};K&&(X.Sheet=m.length),J.Names.push(X);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var ne=l5(s.slice(v,p.index));w=(w.length>0?w+`
`:"")+ne[0]}else Pe(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{te=zl(Pe(p[0])["target-range-address"]),h[te[0]]["!autofilter"]={ref:te[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(F=Pe(p[0],!1),!F.href)break;F.Target=Ze(F.href),delete F.href,F.Target.charAt(0)=="#"&&F.Target.indexOf(".")>-1?(te=zl(F.Target.slice(1)),F.Target="#"+te[0]+"!"+te[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var k={Sheets:h,SheetNames:m,Workbook:J};return r.bookSheets&&delete k.Sheets,k}function $m(e,t){t=t||{},qr(e,"META-INF/manifest.xml")&&TE(Lt(e,"META-INF/manifest.xml"),t);var r=Rr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var s=Ov(xt(r),t);return qr(e,"meta.xml")&&(s.Props=W1(Lt(e,"meta.xml"))),s}function Bm(e,t){return Ov(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Qu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Dd(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):xt(mn(e))}function Ld(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),s=0;return e.forEach(function(n){r.set(n,s),s+=n.length}),r}function Gm(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function d5(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,s=e[t+14]&1,n=t+13;n>=t;--n)s=s*256+e[n];return(e[t+15]&128?-s:s)*Math.pow(10,r-6176)}function co(e,t){var r=t?t[0]:0,s=e[r]&127;e:if(e[r++]>=128&&(s|=(e[r]&127)<<7,e[r++]<128||(s|=(e[r]&127)<<14,e[r++]<128)||(s|=(e[r]&127)<<21,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(s+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),s}function Vt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function or(e){for(var t=[],r=[0];r[0]<e.length;){var s=r[0],n=co(e,r),i=n&7;n=Math.floor(n/8);var o=0,c;if(n==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);c=e.slice(l,r[0])}break;case 5:o=4,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=co(e,r),c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var d={data:c,type:i};t[n]==null?t[n]=[d]:t[n].push(d)}return t}function Ju(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function u5(e){for(var t,r=[],s=[0];s[0]<e.length;){var n=co(e,s),i=or(e.slice(s[0],s[0]+n));s[0]+=n;var o={id:Vt(i[1][0].data),messages:[]};i[2].forEach(function(c){var l=or(c.data),d=Vt(l[3][0].data);o.messages.push({meta:l,data:e.slice(s[0],s[0]+d)}),s[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=Vt(i[3][0].data)>>>0>0),r.push(o)}return r}function f5(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],s=co(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[r[0]],c>1&&(o|=t[r[0]+1]<<8),c>2&&(o|=t[r[0]+2]<<16),c>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Ld(n)],l==0)throw new Error("Invalid offset 0");if(l>n[0].length)throw new Error("Invalid offset beyond length");if(d>=l)for(n.push(n[0].slice(-l)),d-=l;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-l,-l+d))}}var u=Ld(n);if(u.length!=s)throw new Error("Unexpected length: ".concat(u.length," != ").concat(s));return u}function h5(e){for(var t=[],r=0;r<e.length;){var s=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(f5(s,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ld(t)}function m5(e,t,r,s){var n=Qu(e),i=n.getUint32(4,!0),o=(s>1?12:8)+Gm(i&(s>1?3470:398))*4,c=-1,l=-1,d=NaN,u=new Date(2001,0,1);i&512&&(c=n.getUint32(o,!0),o+=4),o+=Gm(i&(s>1?12288:4096))*4,i&16&&(l=n.getUint32(o,!0),o+=4),i&32&&(d=n.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(c>-1)f={t:"s",v:r[c]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function p5(e,t,r){var s=Qu(e),n=s.getUint32(8,!0),i=12,o=-1,c=-1,l=NaN,d=NaN,u=new Date(2001,0,1);n&1&&(l=d5(e,i),i+=16),n&2&&(d=s.getFloat64(i,!0),i+=8),n&4&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8),n&8&&(c=s.getUint32(i,!0),i+=4),n&16&&(o=s.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return f}function g5(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return m5(e,t,r,e[0]);case 5:return p5(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function _s(e){var t=or(e);return co(t[1][0].data)}function Vm(e,t){var r=or(t.data),s=Vt(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(o){var c=or(o.data),l=Vt(c[1][0].data)>>>0;switch(s){case 1:i[l]=Dd(c[3][0].data);break;case 8:{var d=e[_s(c[9][0].data)][0],u=or(d.data),f=e[_s(u[1][0].data)][0],h=Vt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=or(f.data);i[l]=m[3].map(function(g){return Dd(g.data)}).join("")}break}}),i}function x5(e,t){var r,s,n,i,o,c,l,d,u,f,h,m,g,p,x=or(e),y=Vt(x[1][0].data)>>>0,w=Vt(x[2][0].data)>>>0,v=((s=(r=x[8])==null?void 0:r[0])==null?void 0:s.data)&&Vt(x[8][0].data)>0||!1,j,S;if((i=(n=x[7])==null?void 0:n[0])!=null&&i.data&&t!=0)j=(c=(o=x[7])==null?void 0:o[0])==null?void 0:c.data,S=(d=(l=x[6])==null?void 0:l[0])==null?void 0:d.data;else if((f=(u=x[4])==null?void 0:u[0])!=null&&f.data&&t!=1)j=(m=(h=x[4])==null?void 0:h[0])==null?void 0:m.data,S=(p=(g=x[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var _=v?4:1,T=Qu(j),N=[],b=0;b<j.length/2;++b){var O=T.getUint16(b*2,!0);O<65535&&N.push([b,O])}if(N.length!=w)throw"Expected ".concat(w," cells, found ").concat(N.length);var A=[];for(b=0;b<N.length-1;++b)A[N[b][0]]=S.subarray(N[b][1]*_,N[b+1][1]*_);return N.length>=1&&(A[N[N.length-1][0]]=S.subarray(N[N.length-1][1]*_)),{R:y,cells:A}}function v5(e,t){var r,s=or(t.data),n=(r=s==null?void 0:s[7])!=null&&r[0]?Vt(s[7][0].data)>>>0>0?1:0:-1,i=Ju(s[5],function(o){return x5(o,n)});return{nrows:Vt(s[4][0].data)>>>0,data:i.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(l,d){if(o[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));o[c.R][d]=l}),o},[])}}function y5(e,t,r){var s,n=or(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Vt(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Vt(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Je(i);var o=or(n[4][0].data),c=Vm(e,e[_s(o[4][0].data)][0]),l=(s=o[17])!=null&&s[0]?Vm(e,e[_s(o[17][0].data)][0]):[],d=or(o[3][0].data),u=0;d[1].forEach(function(f){var h=or(f.data),m=e[_s(h[2][0].data)][0],g=Vt(m.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=v5(e,m);p.data.forEach(function(x,y){x.forEach(function(w,v){var j=Ge({r:u+y,c:v}),S=g5(w,c,l);S&&(r[j]=S)})}),u+=p.nrows})}function w5(e,t){var r=or(t.data),s={"!ref":"A1"},n=e[_s(r[2][0].data)],i=Vt(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return y5(e,n[0],s),s}function _5(e,t){var r,s=or(t.data),n={name:(r=s[1])!=null&&r[0]?Dd(s[1][0].data):"",sheets:[]},i=Ju(s[2],_s);return i.forEach(function(o){e[o].forEach(function(c){var l=Vt(c.meta[1][0].data);l==6e3&&n.sheets.push(w5(e,c))})}),n}function b5(e,t){var r=tf(),s=or(t.data),n=Ju(s[1],_s);if(n.forEach(function(i){e[i].forEach(function(o){var c=Vt(o.meta[1][0].data);if(c==2){var l=_5(e,o);l.sheets.forEach(function(d,u){rf(r,d,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Kl(e){var t,r,s,n,i={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var d;try{d=h5(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=u5(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var c=((n=(s=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:s[1])==null?void 0:n[0].data)&&Vt(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||o.forEach(function(l){i[l].forEach(function(d){var u=Vt(d.meta[1][0].data)>>>0;if(u==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return b5(i,c)}function N5(e){return function(r){for(var s=0;s!=e.length;++s){var n=e[s];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Zu(e){N5([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function j5(e){return Cn.WS.indexOf(e)>-1?"sheet":e==Cn.CS?"chart":e==Cn.DS?"dialog":e==Cn.MS?"macro":e&&e.length?e:"sheet"}function T5(e,t){if(!e)return 0;try{e=t.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,j5(e["!id"][s.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function E5(e,t,r,s,n,i,o,c,l,d,u,f){try{i[s]=Vi(Rr(e,r,!0),t);var h=Lt(e,t),m;switch(c){case"sheet":m=Ik(h,t,n,l,i[s],d,u,f);break;case"chart":if(m=Ok(h,t,n,l,i[s],d,u,f),!m||!m["!drawel"])break;var g=Di(m["!drawel"].Target,t),p=kd(g),x=RA(Rr(e,g,!0),Vi(Rr(e,p,!0),g)),y=Di(x,g),w=kd(y);m=pk(Rr(e,y,!0),y,l,Vi(Rr(e,w,!0),y),d,m);break;case"macro":m=Pk(h,t,n,l,i[s],d,u,f);break;case"dialog":m=Dk(h,t,n,l,i[s],d,u,f);break;default:throw new Error("Unrecognized sheet type "+c)}o[s]=m;var v=[];i&&i[s]&&Ca(i[s]).forEach(function(j){var S="";if(i[s][j].Type==Cn.CMNT){S=Di(i[s][j].Target,t);var _=Uk(Lt(e,S,!0),S,l);if(!_||!_.length)return;Am(m,_,!1)}i[s][j].Type==Cn.TCMNT&&(S=Di(i[s][j].Target,t),v=v.concat(OA(Lt(e,S,!0),l)))}),v&&v.length&&Am(m,v,!0,l.people||[])}catch(j){if(l.WTF)throw j}}function $r(e){return e.charAt(0)=="/"?e.slice(1):e}function S5(e,t){if(x1(),t=t||{},Zu(t),qr(e,"META-INF/manifest.xml")||qr(e,"objectdata.xml"))return $m(e,t);if(qr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Kl<"u"){if(e.FileIndex)return Kl(e);var r=Qe.utils.cfb_new();return tm(e).forEach(function(Y){AT(r,Y,ST(e,Y))}),Kl(r)}throw new Error("Unsupported NUMBERS file")}if(!qr(e,"[Content_Types].xml"))throw qr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):qr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var s=tm(e),n=NE(Rr(e,"[Content_Types].xml")),i=!1,o,c;if(n.workbooks.length===0&&(c="xl/workbook.xml",Lt(e,c,!0)&&n.workbooks.push(c)),n.workbooks.length===0){if(c="xl/workbook.bin",!Lt(e,c,!0))throw new Error("Could not find workbook");n.workbooks.push(c),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},d={};if(!t.bookSheets&&!t.bookProps){if(Wi=[],n.sst)try{Wi=Mk(Lt(e,$r(n.sst)),n.sst,t)}catch(Y){if(t.WTF)throw Y}t.cellStyles&&n.themes.length&&(l=Fk(Rr(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(d=Lk(Lt(e,$r(n.style)),n.style,l,t))}n.links.map(function(Y){try{var ee=Vi(Rr(e,kd($r(Y))),Y);return Bk(Lt(e,$r(Y)),ee,Y,t)}catch{}});var u=Rk(Lt(e,$r(n.workbooks[0])),n.workbooks[0],t),f={},h="";n.coreprops.length&&(h=Lt(e,$r(n.coreprops[0]),!0),h&&(f=W1(h)),n.extprops.length!==0&&(h=Lt(e,$r(n.extprops[0]),!0),h&&AE(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(h=Rr(e,$r(n.custprops[0]),!0),h&&(m=kE(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(ee){return ee.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=m),t.bookSheets&&typeof o<"u"&&(g.SheetNames=o),t.bookSheets?g.SheetNames:t.bookProps))return g;o={};var p={};t.bookDeps&&n.calcchain&&(p=$k(Lt(e,$r(n.calcchain)),n.calcchain));var x=0,y={},w,v;{var j=u.Sheets;f.Worksheets=j.length,f.SheetNames=[];for(var S=0;S!=j.length;++S)f.SheetNames[S]=j[S].name}var _=i?"bin":"xml",T=n.workbooks[0].lastIndexOf("/"),N=(n.workbooks[0].slice(0,T+1)+"_rels/"+n.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");qr(e,N)||(N="xl/_rels/workbook."+_+".rels");var b=Vi(Rr(e,N,!0),N.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=Gk(Lt(e,$r(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=PA(Lt(e,$r(n.people[0])),t)),b&&(b=T5(b,u.Sheets));var O=Lt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=f.Worksheets;++x){var A="sheet";if(b&&b[x]?(w="xl/"+b[x][1].replace(/[\/]?xl\//,""),qr(e,w)||(w=b[x][1]),qr(e,w)||(w=N.replace(/_rels\/.*$/,"")+b[x][1]),A=b[x][2]):(w="xl/worksheets/sheet"+(x+1-O)+"."+_,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(f.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var E=!1,U=0;U!=t.sheets.length;++U)typeof t.sheets[U]=="number"&&t.sheets[U]==x&&(E=1),typeof t.sheets[U]=="string"&&t.sheets[U].toLowerCase()==f.SheetNames[x].toLowerCase()&&(E=1);if(!E)continue e}}E5(e,w,v,f.SheetNames[x],x,y,o,A,t,u,l,d)}return g={Directory:n,Workbook:u,Props:f,Custprops:m,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Wi,Styles:d,Themes:l,SSF:Zt(We)},t&&t.bookFiles&&(e.files?(g.keys=s,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(Y,ee){Y=Y.replace(/^Root Entry[\/]/,""),g.keys.push(Y),g.files[Y]=e.FileIndex[ee]}))),t&&t.bookVBA&&(n.vba.length>0?g.vbaraw=Lt(e,$r(n.vba[0]),!0):n.defaults&&n.defaults.bin===MA&&(g.vbaraw=Lt(e,"xl/vbaProject.bin",!0))),g}function A5(e,t){var r=t||{},s="Workbook",n=Qe.find(e,s);try{if(s="/!DataSpaces/Version",n=Qe.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(w4(n.content),s="/!DataSpaces/DataSpaceMap",n=Qe.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var i=b4(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Qe.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=N4(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Qe.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);T4(n.content)}catch{}if(s="/EncryptionInfo",n=Qe.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);var c=E4(n.content);if(s="/EncryptedPackage",n=Qe.find(e,s),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],n.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function ef(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Fr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function C5(e,t){return Qe.find(e,"EncryptedPackage")?A5(e,t):kv(e,t)}function k5(e,t){var r,s=e,n=t||{};return n.type||(n.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r=N1(s,n),S5(r,n)}function Pv(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Od(e.slice(r),t);default:break e}return no.to_workbook(e,t)}function R5(e,t){var r="",s=ef(e,t);switch(t.type){case"base64":r=Fr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=nn(e);break;default:throw new Error("Unrecognized type "+t.type)}return s[0]==239&&s[1]==187&&s[2]==191&&(r=xt(r)),t.type="binary",Pv(r,t)}function I5(e,t){var r=e;return t.type=="base64"&&(r=Fr(r)),r=us.utils.decode(1200,r.slice(2),"str"),t.type="binary",Pv(r,t)}function O5(e){return e.match(/[^\x00-\x7F]/)?Li(e):e}function Xl(e,t,r,s){return s?(r.type="string",no.to_workbook(e,r)):no.to_workbook(t,r)}function Fd(e,t){n1();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Fd(new Uint8Array(e),(r=Zt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var s=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Pn={},r.dateNF&&(Pn.dateNF=r.dateNF),r.type||(r.type=Ke&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ke?"buffer":"binary",s=wT(e),typeof Uint8Array<"u"&&!Ke&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,s=O5(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=Zt(r),r.type="array",Fd(Iu(s),r)}switch((n=ef(s,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return C5(Qe.read(s,r),r);break;case 9:if(n[1]<=8)return kv(s,r);break;case 60:return Od(s,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return o4(s,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return n4.to_workbook(s,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?k5(s,r):Xl(e,s,r,i);case 239:return n[3]===60?Od(s,r):Xl(e,s,r,i);case 255:if(n[1]===254)return I5(s,r);if(n[1]===0&&n[2]===2&&n[3]===0)return qi.to_workbook(s,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return qi.to_workbook(s,r);break;case 3:case 131:case 139:case 140:return Sm.to_workbook(s,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return M4.to_workbook(s,r);break;case 10:case 13:case 32:return R5(s,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return a4.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Sm.to_workbook(s,r):Xl(e,s,r,i)}function P5(e,t,r,s,n,i,o,c){var l=er(r),d=c.defval,u=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),f=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var g=o?e[r][m]:e[s[m]+l];if(g===void 0||g.t===void 0){if(d===void 0)continue;i[m]!=null&&(h[i[m]]=d);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[m]!=null){if(p==null)if(g.t=="e"&&p===null)h[i[m]]=null;else if(d!==void 0)h[i[m]]=d;else if(u&&p===null)h[i[m]]=null;else continue;else h[i[m]]=u&&(g.t!=="n"||g.t==="n"&&c.rawNumbers!==!1)?p:Ja(g,p,c);p!=null&&(f=!1)}}return{row:h,isempty:f}}function Md(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},s=0,n=1,i=[],o=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?s=1:d.header==="A"?s=2:Array.isArray(d.header)?s=3:d.header==null&&(s=0),typeof u){case"string":l=Rt(u);break;case"number":l=Rt(e["!ref"]),l.s.r=u;break;default:l=u}s>0&&(n=0);var f=er(l.s.r),h=[],m=[],g=0,p=0,x=Array.isArray(e),y=l.s.r,w=0,v={};x&&!e[y]&&(e[y]=[]);var j=d.skipHidden&&e["!cols"]||[],S=d.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(j[w]||{}).hidden)switch(h[w]=Gt(w),r=x?e[y][w]:e[h[w]+f],s){case 1:i[w]=w-l.s.c;break;case 2:i[w]=h[w];break;case 3:i[w]=d.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=Ja(r,null,d),p=v[o]||0,!p)v[o]=1;else{do c=o+"_"+p++;while(v[c]);v[o]=p,v[c]=1}i[w]=c}for(y=l.s.r+n;y<=l.e.r;++y)if(!(S[y]||{}).hidden){var _=P5(e,l,y,h,s,i,x,d);(_.isempty===!1||(s===1?d.blankrows!==!1:d.blankrows))&&(m[g++]=_.row)}return m.length=g,m}var Hm=/"/g;function D5(e,t,r,s,n,i,o,c){for(var l=!0,d=[],u="",f=er(r),h=t.s.c;h<=t.e.c;++h)if(s[h]){var m=c.dense?(e[r]||[])[h]:e[s[h]+f];if(m==null)u="";else if(m.v!=null){l=!1,u=""+(c.rawNumbers&&m.t=="n"?m.v:Ja(m,null,c));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===n||p===i||p===34||c.forceQuotes){u='"'+u.replace(Hm,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(l=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(Hm,'""')+'"')):u="";d.push(u)}return c.blankrows===!1&&l?null:d.join(o)}function Dv(e,t){var r=[],s=t??{};if(e==null||e["!ref"]==null)return"";var n=Rt(e["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),c=s.RS!==void 0?s.RS:`
`,l=c.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];s.dense=Array.isArray(e);for(var h=s.skipHidden&&e["!cols"]||[],m=s.skipHidden&&e["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(h[g]||{}).hidden||(f[g]=Gt(g));for(var p=0,x=n.s.r;x<=n.e.r;++x)(m[x]||{}).hidden||(u=D5(e,n,x,f,o,l,i,s),u!=null&&(s.strip&&(u=u.replace(d,"")),(u||s.blankrows!==!1)&&r.push((p++?c:"")+u)));return delete s.dense,r.join("")}function L5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Dv(e,t);return r}function F5(e){var t="",r,s="";if(e==null||e["!ref"]==null)return[];var n=Rt(e["!ref"]),i="",o=[],c,l=[],d=Array.isArray(e);for(c=n.s.c;c<=n.e.c;++c)o[c]=Gt(c);for(var u=n.s.r;u<=n.e.r;++u)for(i=er(u),c=n.s.c;c<=n.e.c;++c)if(t=o[c]+i,r=d?(e[u]||[])[c]:e[t],s="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;s=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)s=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)s=""+r.v;else if(r.t=="b")s=r.v?"TRUE":"FALSE";else if(r.w!==void 0)s="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?s="'"+r.v:s=""+r.v}}l[l.length]=t+"="+s}return l}function Lv(e,t,r){var s=r||{},n=+!s.skipHeader,i=e||{},o=0,c=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var l=typeof s.origin=="string"?xr(s.origin):s.origin;o=l.r,c=l.c}var d,u={s:{c:0,r:0},e:{c,r:o+t.length-1+n}};if(i["!ref"]){var f=Rt(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+n)}else o==-1&&(o=0,u.e.r=t.length-1+n);var h=s.header||[],m=0;t.forEach(function(p,x){Ca(p).forEach(function(y){(m=h.indexOf(y))==-1&&(h[m=h.length]=y);var w=p[y],v="z",j="",S=Ge({c:c+m,r:o+x+n});d=lo(i,S),w&&typeof w=="object"&&!(w instanceof Date)?i[S]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",s.cellDates||(v="n",w=_r(w)),j=s.dateNF||We[14]):w===null&&s.nullError&&(v="e",w=0),d?(d.t=v,d.v=w,delete d.w,delete d.R,j&&(d.z=j)):i[S]=d={t:v,v:w},j&&(d.z=j))})}),u.e.c=Math.max(u.e.c,c+h.length-1);var g=er(o);if(n)for(m=0;m<h.length;++m)i[Gt(m+c)+g]={t:"s",v:h[m]};return i["!ref"]=Je(u),i}function M5(e,t){return Lv(null,e,t)}function lo(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var s=xr(t);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?lo(e,Ge(t)):lo(e,Ge({r:t,c:r||0}))}function U5(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function tf(){return{SheetNames:[],Sheets:{}}}function rf(e,t,r,s){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(Nk(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function $5(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=U5(e,t);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[s].Hidden=r}function B5(e,t){return e.z=t,e}function Fv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function G5(e,t,r){return Fv(e,"#"+t,r)}function V5(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function H5(e,t,r,s){for(var n=typeof t!="string"?t:Rt(t),i=typeof t=="string"?t:Je(t),o=n.s.r;o<=n.e.r;++o)for(var c=n.s.c;c<=n.e.c;++c){var l=lo(e,o,c);l.t="n",l.F=i,delete l.v,o==n.s.r&&c==n.s.c&&(l.f=r,s&&(l.D=!0))}return e}var q5={encode_col:Gt,encode_row:er,encode_cell:Ge,encode_range:Je,decode_col:Bu,decode_row:$u,split_cell:rE,decode_cell:xr,decode_range:ni,format_cell:Ja,sheet_add_aoa:B1,sheet_add_json:Lv,sheet_add_dom:Rv,aoa_to_sheet:ii,json_to_sheet:M5,table_to_sheet:Iv,table_to_book:o5,sheet_to_csv:Dv,sheet_to_txt:L5,sheet_to_json:Md,sheet_to_html:i5,sheet_to_formulae:F5,sheet_to_row_object_array:Md,sheet_get_cell:lo,book_new:tf,book_append_sheet:rf,book_set_sheet_visibility:$5,cell_set_number_format:B5,cell_set_hyperlink:Fv,cell_set_internal_link:G5,cell_add_comment:V5,sheet_set_array_formula:H5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const W5=({isOpen:e,onClose:t,onImport:r,clientName:s,clientId:n})=>{const[i,o]=L.useState(null),[c,l]=L.useState(""),[d,u]=L.useState(null),[f,h]=L.useState(!1),[m,g]=L.useState(!1),[p,x]=L.useState(0),y=L.useRef(null),w=async b=>{var A;const O=(A=b.target.files)==null?void 0:A[0];if(O){o(O),l(O.name.replace(/\.[^/.]+$/,"")),h(!0),u(null);try{const E=await v(O);u(E)}catch(E){console.error("Validation error:",E),u({isValid:!1,errors:["Failed to validate file. Please check the format."],warnings:[],data:[],summary:{totalRows:0,totalViews:0,totalVisitors:0,avgDuration:0,dateRange:{start:"",end:""},resourceCodes:[]}})}finally{h(!1)}}},v=async b=>{const O=[],A=[];let E=[];if(b.size>10*1024*1024)return O.push("File size exceeds 10MB limit"),{isValid:!1,errors:O,warnings:A,data:[],summary:S()};const U=[".csv",".xlsx",".xls"],Y=b.name.toLowerCase().substring(b.name.lastIndexOf("."));if(!U.includes(Y))return O.push("Invalid file type. Please upload CSV or Excel files only."),{isValid:!1,errors:O,warnings:A,data:[],summary:S()};try{if(Y===".csv"){const R=await b.text(),G=Vj.parse(R,{header:!0,skipEmptyLines:!0,transformHeader:P=>P.trim().toLowerCase().replace(/"/g,""),transform:P=>P.trim().replace(/"/g,"")});G.errors.length>0&&O.push(`CSV parsing errors: ${G.errors.map(P=>P.message).join(", ")}`),E=G.data}else{const R=await b.arrayBuffer(),G=Fd(R),P=G.SheetNames[0],C=G.Sheets[P];if(E=q5.sheet_to_json(C,{header:1}),E.length>0){const K=E[0];E=E.slice(1).map(Q=>{const z={};return K.forEach((X,ne)=>{z[(X==null?void 0:X.trim().toLowerCase().replace(/"/g,""))||`col_${ne}`]=Q[ne]||""}),z})}}const ee=["date","resource_code","pv","uv","duration","avg_duration"],se=Object.keys(E[0]||{}),W=ee.filter(R=>!se.includes(R));W.length>0&&O.push(`Missing required columns: ${W.join(", ")}`);const J=[],F=new Set,te=[];E.forEach((R,G)=>{const P=[],C=R.date||R.Date;C?j(C)?te.push(C):P.push(`Row ${G+1}: Invalid date format (${C})`):P.push(`Row ${G+1}: Missing date`);const K=R.resource_code||R.resourceCode;K?F.add(K):P.push(`Row ${G+1}: Missing resource_code`);const D=parseInt(R.pv||R.PV||"0"),Q=parseInt(R.uv||R.UV||"0"),z=parseInt(R.duration||R.Duration||"0"),X=parseInt(R.avg_duration||R.avgDuration||"0");(isNaN(D)||D<0)&&P.push(`Row ${G+1}: Invalid PV value`),(isNaN(Q)||Q<0)&&P.push(`Row ${G+1}: Invalid UV value`),(isNaN(z)||z<0)&&P.push(`Row ${G+1}: Invalid duration value`),(isNaN(X)||X<0)&&P.push(`Row ${G+1}: Invalid avg_duration value`),P.length===0?J.push({date:C,resource_code:K,page_views:D,visitors:Q,total_time:z,avg_time:X}):O.push(...P)});const fe={totalRows:J.length,totalViews:J.reduce((R,G)=>R+G.page_views,0),totalVisitors:J.reduce((R,G)=>R+G.visitors,0),avgDuration:J.length>0?Math.round(J.reduce((R,G)=>R+G.avg_time,0)/J.length):0,dateRange:{start:te.length>0?Math.min(...te.map(R=>new Date(R).getTime())).toString():"",end:te.length>0?Math.max(...te.map(R=>new Date(R).getTime())).toString():""},resourceCodes:Array.from(F)};return J.length===0&&A.push("No valid data rows found"),F.size>1&&A.push(`Multiple resource codes found: ${Array.from(F).join(", ")}`),{isValid:O.length===0,errors:O,warnings:A,data:J,summary:fe}}catch(ee){return O.push(`File parsing error: ${ee instanceof Error?ee.message:"Unknown error"}`),{isValid:!1,errors:O,warnings:A,data:[],summary:S()}}},j=b=>{const O=new Date(b);return O instanceof Date&&!isNaN(O.getTime())},S=()=>({totalRows:0,totalViews:0,totalVisitors:0,avgDuration:0,dateRange:{start:"",end:""},resourceCodes:[]}),_=async()=>{if(!(!(d!=null&&d.isValid)||!c.trim())){g(!0),x(0);try{const b=setInterval(()=>{x(O=>Math.min(O+10,90))},100);await r(d.data,c.trim()),clearInterval(b),x(100),setTimeout(()=>{T()},1e3)}catch(b){console.error("Import error:",b)}finally{g(!1)}}},T=()=>{o(null),l(""),u(null),x(0),t()},N=b=>b?new Date(parseInt(b)).toLocaleDateString():"N/A";return a.jsx(ai,{open:e,onOpenChange:T,children:a.jsxs(dn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(un,{children:[a.jsxs(fn,{className:"flex items-center gap-2",children:[a.jsx(gd,{className:"h-5 w-5"}),"Import Analytics Data"]}),a.jsxs(nl,{children:["Import analytics data for ",a.jsx("strong",{children:s}),". The data will be associated with this client only."]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"file-input",children:"Select File"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ue,{ref:y,id:"file-input",type:"file",accept:".csv,.xlsx,.xls",onChange:w,className:"flex-1",disabled:f||m}),i&&a.jsx(le,{variant:"outline",size:"sm",onClick:()=>{o(null),u(null),y.current&&(y.current.value="")},disabled:f||m,children:a.jsx(yr,{className:"h-4 w-4"})})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Supported formats: CSV, Excel (.xlsx, .xls). Max size: 10MB"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"project-name",children:"Project Name"}),a.jsx(Ue,{id:"project-name",value:c,onChange:b=>l(b.target.value),placeholder:"Enter a name for this analytics dataset",disabled:f||m}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This name will help you identify this dataset later"})]}),f&&a.jsxs("div",{className:"flex items-center gap-2 p-4 bg-blue-50 rounded-lg",children:[a.jsx(De,{className:"h-4 w-4 animate-spin text-blue-600"}),a.jsx("span",{className:"text-blue-600",children:"Validating file..."})]}),d&&a.jsxs("div",{className:"space-y-4",children:[d.errors.length>0&&a.jsxs(xc,{variant:"destructive",children:[a.jsx(Mt,{className:"h-4 w-4"}),a.jsxs(vc,{children:[a.jsx("div",{className:"font-medium mb-2",children:"Validation Errors:"}),a.jsx("ul",{className:"list-disc list-inside space-y-1",children:d.errors.map((b,O)=>a.jsx("li",{className:"text-sm",children:b},O))})]})]}),d.warnings.length>0&&a.jsxs(xc,{children:[a.jsx(Mt,{className:"h-4 w-4"}),a.jsxs(vc,{children:[a.jsx("div",{className:"font-medium mb-2",children:"Warnings:"}),a.jsx("ul",{className:"list-disc list-inside space-y-1",children:d.warnings.map((b,O)=>a.jsx("li",{className:"text-sm",children:b},O))})]})]}),d.isValid&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"h-5 w-5 text-green-600"}),a.jsx("span",{className:"font-medium text-green-600",children:"File validation successful!"})]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.summary.totalRows}),a.jsx("div",{className:"text-sm text-gray-600",children:"Data Rows"})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:Bh(d.summary.totalViews)}),a.jsx("div",{className:"text-sm text-gray-600",children:Bo("page_views")})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Bh(d.summary.totalVisitors)}),a.jsx("div",{className:"text-sm text-gray-600",children:Bo("visitors")})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:gc(d.summary.avgDuration)}),a.jsx("div",{className:"text-sm text-gray-600",children:Bo("avg_time")})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Or,{className:"h-4 w-4"}),a.jsx("span",{className:"font-medium",children:"Data Range:"}),a.jsxs("span",{className:"text-sm text-gray-600",children:[N(d.summary.dateRange.start)," - ",N(d.summary.dateRange.end)]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gr,{className:"h-4 w-4"}),a.jsxs("span",{className:"font-medium",children:[Bo("resource_code"),"s:"]}),a.jsx("div",{className:"flex gap-1",children:d.summary.resourceCodes.map((b,O)=>a.jsx(Le,{variant:"secondary",children:b},O))})]})]})]})]}),m&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(De,{className:"h-4 w-4 animate-spin"}),a.jsx("span",{children:"Importing data..."})]}),a.jsx(qa,{value:p,className:"w-full"})]})]}),a.jsxs(sl,{children:[a.jsx(le,{variant:"outline",onClick:T,disabled:m,children:"Cancel"}),a.jsx(le,{onClick:_,disabled:!(d!=null&&d.isValid)||!c.trim()||m,className:"flex items-center gap-2",children:m?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 animate-spin"}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(gd,{className:"h-4 w-4"}),"Import Data"]})})]})]})})},z5=({isOpen:e,onClose:t,onConfirm:r,clientName:s,isResetting:n})=>{const i=async()=>{try{await r(),t()}catch(o){console.error("Reset error:",o)}};return a.jsx(ai,{open:e,onOpenChange:t,children:a.jsxs(dn,{className:"max-w-md",children:[a.jsxs(un,{children:[a.jsxs(fn,{className:"flex items-center gap-2 text-red-600",children:[a.jsx(Zf,{className:"h-5 w-5"}),"Reset Analytics Data"]}),a.jsxs(nl,{children:["This action will permanently delete all analytics data for ",a.jsx("strong",{children:s}),"."]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs(xc,{variant:"destructive",children:[a.jsx(Zf,{className:"h-4 w-4"}),a.jsxs(vc,{children:[a.jsx("div",{className:"font-medium mb-2",children:"Warning: This action cannot be undone!"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm",children:[a.jsx("li",{children:"All imported analytics data will be permanently deleted"}),a.jsx("li",{children:"All charts and visualizations will be cleared"}),a.jsx("li",{children:"Analytics cards will reset to zero"}),a.jsxs("li",{children:["This action affects only ",s,"'s data"]})]})]})]}),a.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[a.jsx(js,{className:"h-4 w-4"}),a.jsx("span",{children:"This will delete all analytics records associated with this client from the database."})]})})]}),a.jsxs(sl,{children:[a.jsx(le,{variant:"outline",onClick:t,disabled:n,children:"Cancel"}),a.jsx(le,{variant:"destructive",onClick:i,disabled:n,className:"flex items-center gap-2",children:n?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 animate-spin"}),"Resetting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(js,{className:"h-4 w-4"}),"Reset Analytics"]})})]})]})})};var Y5=Array.isArray,Tr=Y5,K5=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Mv=K5,X5=Mv,Q5=typeof self=="object"&&self&&self.Object===Object&&self,J5=X5||Q5||Function("return this")(),Pa=J5,Z5=Pa,eR=Z5.Symbol,Ao=eR,qm=Ao,Uv=Object.prototype,tR=Uv.hasOwnProperty,rR=Uv.toString,Ti=qm?qm.toStringTag:void 0;function aR(e){var t=tR.call(e,Ti),r=e[Ti];try{e[Ti]=void 0;var s=!0}catch{}var n=rR.call(e);return s&&(t?e[Ti]=r:delete e[Ti]),n}var sR=aR,nR=Object.prototype,iR=nR.toString;function oR(e){return iR.call(e)}var cR=oR,Wm=Ao,lR=sR,dR=cR,uR="[object Null]",fR="[object Undefined]",zm=Wm?Wm.toStringTag:void 0;function hR(e){return e==null?e===void 0?fR:uR:zm&&zm in Object(e)?lR(e):dR(e)}var ss=hR;function mR(e){return e!=null&&typeof e=="object"}var ns=mR,pR=ss,gR=ns,xR="[object Symbol]";function vR(e){return typeof e=="symbol"||gR(e)&&pR(e)==xR}var oi=vR,yR=Tr,wR=oi,_R=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bR=/^\w*$/;function NR(e,t){if(yR(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||wR(e)?!0:bR.test(e)||!_R.test(e)||t!=null&&e in Object(t)}var af=NR;function jR(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Is=jR;const Bq=nt(Is);var TR=ss,ER=Is,SR="[object AsyncFunction]",AR="[object Function]",CR="[object GeneratorFunction]",kR="[object Proxy]";function RR(e){if(!ER(e))return!1;var t=TR(e);return t==AR||t==CR||t==SR||t==kR}var sf=RR;const Gq=nt(sf);var IR=Pa,OR=IR["__core-js_shared__"],PR=OR,Ql=PR,Ym=function(){var e=/[^.]+$/.exec(Ql&&Ql.keys&&Ql.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function DR(e){return!!Ym&&Ym in e}var LR=DR,FR=Function.prototype,MR=FR.toString;function UR(e){if(e!=null){try{return MR.call(e)}catch{}try{return e+""}catch{}}return""}var $v=UR,$R=sf,BR=LR,GR=Is,VR=$v,HR=/[\\^$.*+?()[\]{}|]/g,qR=/^\[object .+?Constructor\]$/,WR=Function.prototype,zR=Object.prototype,YR=WR.toString,KR=zR.hasOwnProperty,XR=RegExp("^"+YR.call(KR).replace(HR,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function QR(e){if(!GR(e)||BR(e))return!1;var t=$R(e)?XR:qR;return t.test(VR(e))}var JR=QR;function ZR(e,t){return e==null?void 0:e[t]}var e6=ZR,t6=JR,r6=e6;function a6(e,t){var r=r6(e,t);return t6(r)?r:void 0}var yn=a6,s6=yn,n6=s6(Object,"create"),dl=n6,Km=dl;function i6(){this.__data__=Km?Km(null):{},this.size=0}var o6=i6;function c6(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var l6=c6,d6=dl,u6="__lodash_hash_undefined__",f6=Object.prototype,h6=f6.hasOwnProperty;function m6(e){var t=this.__data__;if(d6){var r=t[e];return r===u6?void 0:r}return h6.call(t,e)?t[e]:void 0}var p6=m6,g6=dl,x6=Object.prototype,v6=x6.hasOwnProperty;function y6(e){var t=this.__data__;return g6?t[e]!==void 0:v6.call(t,e)}var w6=y6,_6=dl,b6="__lodash_hash_undefined__";function N6(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=_6&&t===void 0?b6:t,this}var j6=N6,T6=o6,E6=l6,S6=p6,A6=w6,C6=j6;function ci(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}ci.prototype.clear=T6;ci.prototype.delete=E6;ci.prototype.get=S6;ci.prototype.has=A6;ci.prototype.set=C6;var k6=ci;function R6(){this.__data__=[],this.size=0}var I6=R6;function O6(e,t){return e===t||e!==e&&t!==t}var nf=O6,P6=nf;function D6(e,t){for(var r=e.length;r--;)if(P6(e[r][0],t))return r;return-1}var ul=D6,L6=ul,F6=Array.prototype,M6=F6.splice;function U6(e){var t=this.__data__,r=L6(t,e);if(r<0)return!1;var s=t.length-1;return r==s?t.pop():M6.call(t,r,1),--this.size,!0}var $6=U6,B6=ul;function G6(e){var t=this.__data__,r=B6(t,e);return r<0?void 0:t[r][1]}var V6=G6,H6=ul;function q6(e){return H6(this.__data__,e)>-1}var W6=q6,z6=ul;function Y6(e,t){var r=this.__data__,s=z6(r,e);return s<0?(++this.size,r.push([e,t])):r[s][1]=t,this}var K6=Y6,X6=I6,Q6=$6,J6=V6,Z6=W6,eI=K6;function li(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}li.prototype.clear=X6;li.prototype.delete=Q6;li.prototype.get=J6;li.prototype.has=Z6;li.prototype.set=eI;var fl=li,tI=yn,rI=Pa,aI=tI(rI,"Map"),of=aI,Xm=k6,sI=fl,nI=of;function iI(){this.size=0,this.__data__={hash:new Xm,map:new(nI||sI),string:new Xm}}var oI=iI;function cI(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var lI=cI,dI=lI;function uI(e,t){var r=e.__data__;return dI(t)?r[typeof t=="string"?"string":"hash"]:r.map}var hl=uI,fI=hl;function hI(e){var t=fI(this,e).delete(e);return this.size-=t?1:0,t}var mI=hI,pI=hl;function gI(e){return pI(this,e).get(e)}var xI=gI,vI=hl;function yI(e){return vI(this,e).has(e)}var wI=yI,_I=hl;function bI(e,t){var r=_I(this,e),s=r.size;return r.set(e,t),this.size+=r.size==s?0:1,this}var NI=bI,jI=oI,TI=mI,EI=xI,SI=wI,AI=NI;function di(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}di.prototype.clear=jI;di.prototype.delete=TI;di.prototype.get=EI;di.prototype.has=SI;di.prototype.set=AI;var cf=di,Bv=cf,CI="Expected a function";function lf(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(CI);var r=function(){var s=arguments,n=t?t.apply(this,s):s[0],i=r.cache;if(i.has(n))return i.get(n);var o=e.apply(this,s);return r.cache=i.set(n,o)||i,o};return r.cache=new(lf.Cache||Bv),r}lf.Cache=Bv;var Gv=lf;const Vq=nt(Gv);var kI=Gv,RI=500;function II(e){var t=kI(e,function(s){return r.size===RI&&r.clear(),s}),r=t.cache;return t}var OI=II,PI=OI,DI=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,LI=/\\(\\)?/g,FI=PI(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(DI,function(r,s,n,i){t.push(n?i.replace(LI,"$1"):s||r)}),t}),MI=FI;function UI(e,t){for(var r=-1,s=e==null?0:e.length,n=Array(s);++r<s;)n[r]=t(e[r],r,e);return n}var df=UI,Qm=Ao,$I=df,BI=Tr,GI=oi,VI=1/0,Jm=Qm?Qm.prototype:void 0,Zm=Jm?Jm.toString:void 0;function Vv(e){if(typeof e=="string")return e;if(BI(e))return $I(e,Vv)+"";if(GI(e))return Zm?Zm.call(e):"";var t=e+"";return t=="0"&&1/e==-VI?"-0":t}var HI=Vv,qI=HI;function WI(e){return e==null?"":qI(e)}var Hv=WI,zI=Tr,YI=af,KI=MI,XI=Hv;function QI(e,t){return zI(e)?e:YI(e,t)?[e]:KI(XI(e))}var qv=QI,JI=oi,ZI=1/0;function eO(e){if(typeof e=="string"||JI(e))return e;var t=e+"";return t=="0"&&1/e==-ZI?"-0":t}var ml=eO,tO=qv,rO=ml;function aO(e,t){t=tO(t,e);for(var r=0,s=t.length;e!=null&&r<s;)e=e[rO(t[r++])];return r&&r==s?e:void 0}var uf=aO,sO=uf;function nO(e,t,r){var s=e==null?void 0:sO(e,t);return s===void 0?r:s}var Wv=nO;const Hq=nt(Wv);function iO(e){return e==null}var oO=iO;const qq=nt(oO);var cO=ss,lO=Tr,dO=ns,uO="[object String]";function fO(e){return typeof e=="string"||!lO(e)&&dO(e)&&cO(e)==uO}var hO=fO;const Wq=nt(hO);var mO=ss,pO=ns,gO="[object Number]";function xO(e){return typeof e=="number"||pO(e)&&mO(e)==gO}var zv=xO;const zq=nt(zv);var vO=zv;function yO(e){return vO(e)&&e!=+e}var wO=yO;const Yq=nt(wO);function _O(e,t,r){var s=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(n);++s<n;)i[s]=e[s+t];return i}var bO=_O,NO=bO;function jO(e,t,r){var s=e.length;return r=r===void 0?s:r,!t&&r>=s?e:NO(e,t,r)}var TO=jO,EO="\\ud800-\\udfff",SO="\\u0300-\\u036f",AO="\\ufe20-\\ufe2f",CO="\\u20d0-\\u20ff",kO=SO+AO+CO,RO="\\ufe0e\\ufe0f",IO="\\u200d",OO=RegExp("["+IO+EO+kO+RO+"]");function PO(e){return OO.test(e)}var Yv=PO;function DO(e){return e.split("")}var LO=DO,Kv="\\ud800-\\udfff",FO="\\u0300-\\u036f",MO="\\ufe20-\\ufe2f",UO="\\u20d0-\\u20ff",$O=FO+MO+UO,BO="\\ufe0e\\ufe0f",GO="["+Kv+"]",Ud="["+$O+"]",$d="\\ud83c[\\udffb-\\udfff]",VO="(?:"+Ud+"|"+$d+")",Xv="[^"+Kv+"]",Qv="(?:\\ud83c[\\udde6-\\uddff]){2}",Jv="[\\ud800-\\udbff][\\udc00-\\udfff]",HO="\\u200d",Zv=VO+"?",ey="["+BO+"]?",qO="(?:"+HO+"(?:"+[Xv,Qv,Jv].join("|")+")"+ey+Zv+")*",WO=ey+Zv+qO,zO="(?:"+[Xv+Ud+"?",Ud,Qv,Jv,GO].join("|")+")",YO=RegExp($d+"(?="+$d+")|"+zO+WO,"g");function KO(e){return e.match(YO)||[]}var XO=KO,QO=LO,JO=Yv,ZO=XO;function eP(e){return JO(e)?ZO(e):QO(e)}var tP=eP,rP=TO,aP=Yv,sP=tP,nP=Hv;function iP(e){return function(t){t=nP(t);var r=aP(t)?sP(t):void 0,s=r?r[0]:t.charAt(0),n=r?rP(r,1).join(""):t.slice(1);return s[e]()+n}}var oP=iP,cP=oP,lP=cP("toUpperCase"),dP=lP;const Kq=nt(dP);function mt(e){return function(){return e}}const ty=Math.cos,kc=Math.sin,pa=Math.sqrt,Rc=Math.PI,pl=2*Rc,Bd=Math.PI,Gd=2*Bd,Fs=1e-6,uP=Gd-Fs;function ry(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function fP(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ry;const r=10**t;return function(s){this._+=s[0];for(let n=1,i=s.length;n<i;++n)this._+=Math.round(arguments[n]*r)/r+s[n]}}class hP{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?ry:fP(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,s,n){this._append`Q${+t},${+r},${this._x1=+s},${this._y1=+n}`}bezierCurveTo(t,r,s,n,i,o){this._append`C${+t},${+r},${+s},${+n},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,s,n,i){if(t=+t,r=+r,s=+s,n=+n,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,c=this._y1,l=s-t,d=n-r,u=o-t,f=c-r,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Fs)if(!(Math.abs(f*l-d*u)>Fs)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=s-o,g=n-c,p=l*l+d*d,x=m*m+g*g,y=Math.sqrt(p),w=Math.sqrt(h),v=i*Math.tan((Bd-Math.acos((p+h-x)/(2*y*w)))/2),j=v/w,S=v/y;Math.abs(j-1)>Fs&&this._append`L${t+j*u},${r+j*f}`,this._append`A${i},${i},0,0,${+(f*m>u*g)},${this._x1=t+S*l},${this._y1=r+S*d}`}}arc(t,r,s,n,i,o){if(t=+t,r=+r,s=+s,o=!!o,s<0)throw new Error(`negative radius: ${s}`);let c=s*Math.cos(n),l=s*Math.sin(n),d=t+c,u=r+l,f=1^o,h=o?n-i:i-n;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Fs||Math.abs(this._y1-u)>Fs)&&this._append`L${d},${u}`,s&&(h<0&&(h=h%Gd+Gd),h>uP?this._append`A${s},${s},0,1,${f},${t-c},${r-l}A${s},${s},0,1,${f},${this._x1=d},${this._y1=u}`:h>Fs&&this._append`A${s},${s},0,${+(h>=Bd)},${f},${this._x1=t+s*Math.cos(i)},${this._y1=r+s*Math.sin(i)}`)}rect(t,r,s,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${s=+s}v${+n}h${-s}Z`}toString(){return this._}}function ff(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const s=Math.floor(r);if(!(s>=0))throw new RangeError(`invalid digits: ${r}`);t=s}return e},()=>new hP(t)}function hf(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ay(e){this._context=e}ay.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function sy(e){return new ay(e)}function ny(e){return e[0]}function iy(e){return e[1]}function mP(e,t){var r=mt(!0),s=null,n=sy,i=null,o=ff(c);e=typeof e=="function"?e:e===void 0?ny:mt(e),t=typeof t=="function"?t:t===void 0?iy:mt(t);function c(l){var d,u=(l=hf(l)).length,f,h=!1,m;for(s==null&&(i=n(m=o())),d=0;d<=u;++d)!(d<u&&r(f=l[d],d,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,d,l),+t(f,d,l));if(m)return i=null,m+""||null}return c.x=function(l){return arguments.length?(e=typeof l=="function"?l:mt(+l),c):e},c.y=function(l){return arguments.length?(t=typeof l=="function"?l:mt(+l),c):t},c.defined=function(l){return arguments.length?(r=typeof l=="function"?l:mt(!!l),c):r},c.curve=function(l){return arguments.length?(n=l,s!=null&&(i=n(s)),c):n},c.context=function(l){return arguments.length?(l==null?s=i=null:i=n(s=l),c):s},c}function Xq(e,t,r){var s=null,n=mt(!0),i=null,o=sy,c=null,l=ff(d);e=typeof e=="function"?e:e===void 0?ny:mt(+e),t=typeof t=="function"?t:mt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?iy:mt(+r);function d(f){var h,m,g,p=(f=hf(f)).length,x,y=!1,w,v=new Array(p),j=new Array(p);for(i==null&&(c=o(w=l())),h=0;h<=p;++h){if(!(h<p&&n(x=f[h],h,f))===y)if(y=!y)m=h,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),g=h-1;g>=m;--g)c.point(v[g],j[g]);c.lineEnd(),c.areaEnd()}y&&(v[h]=+e(x,h,f),j[h]=+t(x,h,f),c.point(s?+s(x,h,f):v[h],r?+r(x,h,f):j[h]))}if(w)return c=null,w+""||null}function u(){return mP().defined(n).curve(o).context(i)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:mt(+f),s=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:mt(+f),d):e},d.x1=function(f){return arguments.length?(s=f==null?null:typeof f=="function"?f:mt(+f),d):s},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:mt(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:mt(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:mt(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(s).y(t)},d.defined=function(f){return arguments.length?(n=typeof f=="function"?f:mt(!!f),d):n},d.curve=function(f){return arguments.length?(o=f,i!=null&&(c=o(i)),d):o},d.context=function(f){return arguments.length?(f==null?i=c=null:c=o(i=f),d):i},d}class oy{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Qq(e){return new oy(e,!0)}function Jq(e){return new oy(e,!1)}const pP={draw(e,t){const r=pa(t/Rc);e.moveTo(r,0),e.arc(0,0,r,0,pl)}},Zq={draw(e,t){const r=pa(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},cy=pa(1/3),gP=cy*2,eW={draw(e,t){const r=pa(t/gP),s=r*cy;e.moveTo(0,-r),e.lineTo(s,0),e.lineTo(0,r),e.lineTo(-s,0),e.closePath()}},tW={draw(e,t){const r=pa(t),s=-r/2;e.rect(s,s,r,r)}},xP=.8908130915292852,ly=kc(Rc/10)/kc(7*Rc/10),vP=kc(pl/10)*ly,yP=-ty(pl/10)*ly,rW={draw(e,t){const r=pa(t*xP),s=vP*r,n=yP*r;e.moveTo(0,-r),e.lineTo(s,n);for(let i=1;i<5;++i){const o=pl*i/5,c=ty(o),l=kc(o);e.lineTo(l*r,-c*r),e.lineTo(c*s-l*n,l*s+c*n)}e.closePath()}},Jl=pa(3),aW={draw(e,t){const r=-pa(t/(Jl*3));e.moveTo(0,r*2),e.lineTo(-Jl*r,-r),e.lineTo(Jl*r,-r),e.closePath()}},Br=-.5,Gr=pa(3)/2,Vd=1/pa(12),wP=(Vd/2+1)*3,sW={draw(e,t){const r=pa(t/wP),s=r/2,n=r*Vd,i=s,o=r*Vd+r,c=-i,l=o;e.moveTo(s,n),e.lineTo(i,o),e.lineTo(c,l),e.lineTo(Br*s-Gr*n,Gr*s+Br*n),e.lineTo(Br*i-Gr*o,Gr*i+Br*o),e.lineTo(Br*c-Gr*l,Gr*c+Br*l),e.lineTo(Br*s+Gr*n,Br*n-Gr*s),e.lineTo(Br*i+Gr*o,Br*o-Gr*i),e.lineTo(Br*c+Gr*l,Br*l-Gr*c),e.closePath()}};function nW(e,t){let r=null,s=ff(n);e=typeof e=="function"?e:mt(e||pP),t=typeof t=="function"?t:mt(t===void 0?64:+t);function n(){let i;if(r||(r=i=s()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return n.type=function(i){return arguments.length?(e=typeof i=="function"?i:mt(i),n):e},n.size=function(i){return arguments.length?(t=typeof i=="function"?i:mt(+i),n):t},n.context=function(i){return arguments.length?(r=i??null,n):r},n}function Ic(){}function Oc(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function dy(e){this._context=e}dy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Oc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Oc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function iW(e){return new dy(e)}function uy(e){this._context=e}uy.prototype={areaStart:Ic,areaEnd:Ic,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Oc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function oW(e){return new uy(e)}function fy(e){this._context=e}fy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break;case 3:this._point=4;default:Oc(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function cW(e){return new fy(e)}function hy(e){this._context=e}hy.prototype={areaStart:Ic,areaEnd:Ic,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function lW(e){return new hy(e)}function ep(e){return e<0?-1:1}function tp(e,t,r){var s=e._x1-e._x0,n=t-e._x1,i=(e._y1-e._y0)/(s||n<0&&-0),o=(r-e._y1)/(n||s<0&&-0),c=(i*n+o*s)/(s+n);return(ep(i)+ep(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(c))||0}function rp(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Zl(e,t,r){var s=e._x0,n=e._y0,i=e._x1,o=e._y1,c=(i-s)/3;e._context.bezierCurveTo(s+c,n+c*t,i-c,o-c*r,i,o)}function Pc(e){this._context=e}Pc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Zl(this,this._t0,rp(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Zl(this,rp(this,r=tp(this,e,t)),r);break;default:Zl(this,this._t0,r=tp(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function my(e){this._context=new py(e)}(my.prototype=Object.create(Pc.prototype)).point=function(e,t){Pc.prototype.point.call(this,t,e)};function py(e){this._context=e}py.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,s,n,i){this._context.bezierCurveTo(t,e,s,r,i,n)}};function dW(e){return new Pc(e)}function uW(e){return new my(e)}function gy(e){this._context=e}gy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var s=ap(e),n=ap(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(s[0][i],n[0][i],s[1][i],n[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function ap(e){var t,r=e.length-1,s,n=new Array(r),i=new Array(r),o=new Array(r);for(n[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)n[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(n[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)s=n[t]/i[t-1],i[t]-=s,o[t]-=s*o[t-1];for(n[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)n[t]=(o[t]-n[t+1])/i[t];for(i[r-1]=(e[r]+n[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-n[t+1];return[n,i]}function fW(e){return new gy(e)}function gl(e,t){this._context=e,this._t=t}gl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function hW(e){return new gl(e,.5)}function mW(e){return new gl(e,0)}function pW(e){return new gl(e,1)}function uo(e,t){if((o=e.length)>1)for(var r=1,s,n,i=e[t[0]],o,c=i.length;r<o;++r)for(n=i,i=e[t[r]],s=0;s<c;++s)i[s][1]+=i[s][0]=isNaN(n[s][1])?n[s][0]:n[s][1]}function sp(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function _P(e,t){return e[t]}function bP(e){const t=[];return t.key=e,t}function gW(){var e=mt([]),t=sp,r=uo,s=_P;function n(i){var o=Array.from(e.apply(this,arguments),bP),c,l=o.length,d=-1,u;for(const f of i)for(c=0,++d;c<l;++c)(o[c][d]=[0,+s(f,o[c].key,d,i)]).data=f;for(c=0,u=hf(t(o));c<l;++c)o[u[c]].index=c;return r(o,u),o}return n.keys=function(i){return arguments.length?(e=typeof i=="function"?i:mt(Array.from(i)),n):e},n.value=function(i){return arguments.length?(s=typeof i=="function"?i:mt(+i),n):s},n.order=function(i){return arguments.length?(t=i==null?sp:typeof i=="function"?i:mt(Array.from(i)),n):t},n.offset=function(i){return arguments.length?(r=i??uo,n):r},n}function xW(e,t){if((s=e.length)>0){for(var r,s,n=0,i=e[0].length,o;n<i;++n){for(o=r=0;r<s;++r)o+=e[r][n][1]||0;if(o)for(r=0;r<s;++r)e[r][n][1]/=o}uo(e,t)}}function vW(e,t){if((n=e.length)>0){for(var r=0,s=e[t[0]],n,i=s.length;r<i;++r){for(var o=0,c=0;o<n;++o)c+=e[o][r][1]||0;s[r][1]+=s[r][0]=-c/2}uo(e,t)}}function yW(e,t){if(!(!((o=e.length)>0)||!((i=(n=e[t[0]]).length)>0))){for(var r=0,s=1,n,i,o;s<i;++s){for(var c=0,l=0,d=0;c<o;++c){for(var u=e[t[c]],f=u[s][1]||0,h=u[s-1][1]||0,m=(f-h)/2,g=0;g<c;++g){var p=e[t[g]],x=p[s][1]||0,y=p[s-1][1]||0;m+=x-y}l+=f,d+=m*f}n[s-1][1]+=n[s-1][0]=r,l&&(r-=d/l)}n[s-1][1]+=n[s-1][0]=r,uo(e,t)}}var NP=fl;function jP(){this.__data__=new NP,this.size=0}var TP=jP;function EP(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var SP=EP;function AP(e){return this.__data__.get(e)}var CP=AP;function kP(e){return this.__data__.has(e)}var RP=kP,IP=fl,OP=of,PP=cf,DP=200;function LP(e,t){var r=this.__data__;if(r instanceof IP){var s=r.__data__;if(!OP||s.length<DP-1)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new PP(s)}return r.set(e,t),this.size=r.size,this}var FP=LP,MP=fl,UP=TP,$P=SP,BP=CP,GP=RP,VP=FP;function ui(e){var t=this.__data__=new MP(e);this.size=t.size}ui.prototype.clear=UP;ui.prototype.delete=$P;ui.prototype.get=BP;ui.prototype.has=GP;ui.prototype.set=VP;var xy=ui,HP="__lodash_hash_undefined__";function qP(e){return this.__data__.set(e,HP),this}var WP=qP;function zP(e){return this.__data__.has(e)}var YP=zP,KP=cf,XP=WP,QP=YP;function Dc(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new KP;++t<r;)this.add(e[t])}Dc.prototype.add=Dc.prototype.push=XP;Dc.prototype.has=QP;var vy=Dc;function JP(e,t){for(var r=-1,s=e==null?0:e.length;++r<s;)if(t(e[r],r,e))return!0;return!1}var yy=JP;function ZP(e,t){return e.has(t)}var wy=ZP,eD=vy,tD=yy,rD=wy,aD=1,sD=2;function nD(e,t,r,s,n,i){var o=r&aD,c=e.length,l=t.length;if(c!=l&&!(o&&l>c))return!1;var d=i.get(e),u=i.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,m=r&sD?new eD:void 0;for(i.set(e,t),i.set(t,e);++f<c;){var g=e[f],p=t[f];if(s)var x=o?s(p,g,f,t,e,i):s(g,p,f,e,t,i);if(x!==void 0){if(x)continue;h=!1;break}if(m){if(!tD(t,function(y,w){if(!rD(m,w)&&(g===y||n(g,y,r,s,i)))return m.push(w)})){h=!1;break}}else if(!(g===p||n(g,p,r,s,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var _y=nD,iD=Pa,oD=iD.Uint8Array,cD=oD;function lD(e){var t=-1,r=Array(e.size);return e.forEach(function(s,n){r[++t]=[n,s]}),r}var dD=lD;function uD(e){var t=-1,r=Array(e.size);return e.forEach(function(s){r[++t]=s}),r}var mf=uD,np=Ao,ip=cD,fD=nf,hD=_y,mD=dD,pD=mf,gD=1,xD=2,vD="[object Boolean]",yD="[object Date]",wD="[object Error]",_D="[object Map]",bD="[object Number]",ND="[object RegExp]",jD="[object Set]",TD="[object String]",ED="[object Symbol]",SD="[object ArrayBuffer]",AD="[object DataView]",op=np?np.prototype:void 0,ed=op?op.valueOf:void 0;function CD(e,t,r,s,n,i,o){switch(r){case AD:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case SD:return!(e.byteLength!=t.byteLength||!i(new ip(e),new ip(t)));case vD:case yD:case bD:return fD(+e,+t);case wD:return e.name==t.name&&e.message==t.message;case ND:case TD:return e==t+"";case _D:var c=mD;case jD:var l=s&gD;if(c||(c=pD),e.size!=t.size&&!l)return!1;var d=o.get(e);if(d)return d==t;s|=xD,o.set(e,t);var u=hD(c(e),c(t),s,n,i,o);return o.delete(e),u;case ED:if(ed)return ed.call(e)==ed.call(t)}return!1}var kD=CD;function RD(e,t){for(var r=-1,s=t.length,n=e.length;++r<s;)e[n+r]=t[r];return e}var by=RD,ID=by,OD=Tr;function PD(e,t,r){var s=t(e);return OD(e)?s:ID(s,r(e))}var DD=PD;function LD(e,t){for(var r=-1,s=e==null?0:e.length,n=0,i=[];++r<s;){var o=e[r];t(o,r,e)&&(i[n++]=o)}return i}var FD=LD;function MD(){return[]}var UD=MD,$D=FD,BD=UD,GD=Object.prototype,VD=GD.propertyIsEnumerable,cp=Object.getOwnPropertySymbols,HD=cp?function(e){return e==null?[]:(e=Object(e),$D(cp(e),function(t){return VD.call(e,t)}))}:BD,qD=HD;function WD(e,t){for(var r=-1,s=Array(e);++r<e;)s[r]=t(r);return s}var zD=WD,YD=ss,KD=ns,XD="[object Arguments]";function QD(e){return KD(e)&&YD(e)==XD}var JD=QD,lp=JD,ZD=ns,Ny=Object.prototype,e8=Ny.hasOwnProperty,t8=Ny.propertyIsEnumerable,r8=lp(function(){return arguments}())?lp:function(e){return ZD(e)&&e8.call(e,"callee")&&!t8.call(e,"callee")},pf=r8,Lc={exports:{}};function a8(){return!1}var s8=a8;Lc.exports;(function(e,t){var r=Pa,s=s8,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===n,c=o?r.Buffer:void 0,l=c?c.isBuffer:void 0,d=l||s;e.exports=d})(Lc,Lc.exports);var jy=Lc.exports,n8=9007199254740991,i8=/^(?:0|[1-9]\d*)$/;function o8(e,t){var r=typeof e;return t=t??n8,!!t&&(r=="number"||r!="symbol"&&i8.test(e))&&e>-1&&e%1==0&&e<t}var gf=o8,c8=9007199254740991;function l8(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=c8}var xf=l8,d8=ss,u8=xf,f8=ns,h8="[object Arguments]",m8="[object Array]",p8="[object Boolean]",g8="[object Date]",x8="[object Error]",v8="[object Function]",y8="[object Map]",w8="[object Number]",_8="[object Object]",b8="[object RegExp]",N8="[object Set]",j8="[object String]",T8="[object WeakMap]",E8="[object ArrayBuffer]",S8="[object DataView]",A8="[object Float32Array]",C8="[object Float64Array]",k8="[object Int8Array]",R8="[object Int16Array]",I8="[object Int32Array]",O8="[object Uint8Array]",P8="[object Uint8ClampedArray]",D8="[object Uint16Array]",L8="[object Uint32Array]",wt={};wt[A8]=wt[C8]=wt[k8]=wt[R8]=wt[I8]=wt[O8]=wt[P8]=wt[D8]=wt[L8]=!0;wt[h8]=wt[m8]=wt[E8]=wt[p8]=wt[S8]=wt[g8]=wt[x8]=wt[v8]=wt[y8]=wt[w8]=wt[_8]=wt[b8]=wt[N8]=wt[j8]=wt[T8]=!1;function F8(e){return f8(e)&&u8(e.length)&&!!wt[d8(e)]}var M8=F8;function U8(e){return function(t){return e(t)}}var Ty=U8,Fc={exports:{}};Fc.exports;(function(e,t){var r=Mv,s=t&&!t.nodeType&&t,n=s&&!0&&e&&!e.nodeType&&e,i=n&&n.exports===s,o=i&&r.process,c=function(){try{var l=n&&n.require&&n.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();e.exports=c})(Fc,Fc.exports);var $8=Fc.exports,B8=M8,G8=Ty,dp=$8,up=dp&&dp.isTypedArray,V8=up?G8(up):B8,Ey=V8,H8=zD,q8=pf,W8=Tr,z8=jy,Y8=gf,K8=Ey,X8=Object.prototype,Q8=X8.hasOwnProperty;function J8(e,t){var r=W8(e),s=!r&&q8(e),n=!r&&!s&&z8(e),i=!r&&!s&&!n&&K8(e),o=r||s||n||i,c=o?H8(e.length,String):[],l=c.length;for(var d in e)(t||Q8.call(e,d))&&!(o&&(d=="length"||n&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||Y8(d,l)))&&c.push(d);return c}var Z8=J8,eL=Object.prototype;function tL(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||eL;return e===r}var rL=tL;function aL(e,t){return function(r){return e(t(r))}}var Sy=aL,sL=Sy,nL=sL(Object.keys,Object),iL=nL,oL=rL,cL=iL,lL=Object.prototype,dL=lL.hasOwnProperty;function uL(e){if(!oL(e))return cL(e);var t=[];for(var r in Object(e))dL.call(e,r)&&r!="constructor"&&t.push(r);return t}var fL=uL,hL=sf,mL=xf;function pL(e){return e!=null&&mL(e.length)&&!hL(e)}var Co=pL,gL=Z8,xL=fL,vL=Co;function yL(e){return vL(e)?gL(e):xL(e)}var xl=yL,wL=DD,_L=qD,bL=xl;function NL(e){return wL(e,bL,_L)}var jL=NL,fp=jL,TL=1,EL=Object.prototype,SL=EL.hasOwnProperty;function AL(e,t,r,s,n,i){var o=r&TL,c=fp(e),l=c.length,d=fp(t),u=d.length;if(l!=u&&!o)return!1;for(var f=l;f--;){var h=c[f];if(!(o?h in t:SL.call(t,h)))return!1}var m=i.get(e),g=i.get(t);if(m&&g)return m==t&&g==e;var p=!0;i.set(e,t),i.set(t,e);for(var x=o;++f<l;){h=c[f];var y=e[h],w=t[h];if(s)var v=o?s(w,y,h,t,e,i):s(y,w,h,e,t,i);if(!(v===void 0?y===w||n(y,w,r,s,i):v)){p=!1;break}x||(x=h=="constructor")}if(p&&!x){var j=e.constructor,S=t.constructor;j!=S&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof S=="function"&&S instanceof S)&&(p=!1)}return i.delete(e),i.delete(t),p}var CL=AL,kL=yn,RL=Pa,IL=kL(RL,"DataView"),OL=IL,PL=yn,DL=Pa,LL=PL(DL,"Promise"),FL=LL,ML=yn,UL=Pa,$L=ML(UL,"Set"),Ay=$L,BL=yn,GL=Pa,VL=BL(GL,"WeakMap"),HL=VL,Hd=OL,qd=of,Wd=FL,zd=Ay,Yd=HL,Cy=ss,fi=$v,hp="[object Map]",qL="[object Object]",mp="[object Promise]",pp="[object Set]",gp="[object WeakMap]",xp="[object DataView]",WL=fi(Hd),zL=fi(qd),YL=fi(Wd),KL=fi(zd),XL=fi(Yd),Ms=Cy;(Hd&&Ms(new Hd(new ArrayBuffer(1)))!=xp||qd&&Ms(new qd)!=hp||Wd&&Ms(Wd.resolve())!=mp||zd&&Ms(new zd)!=pp||Yd&&Ms(new Yd)!=gp)&&(Ms=function(e){var t=Cy(e),r=t==qL?e.constructor:void 0,s=r?fi(r):"";if(s)switch(s){case WL:return xp;case zL:return hp;case YL:return mp;case KL:return pp;case XL:return gp}return t});var QL=Ms,td=xy,JL=_y,ZL=kD,eF=CL,vp=QL,yp=Tr,wp=jy,tF=Ey,rF=1,_p="[object Arguments]",bp="[object Array]",Qo="[object Object]",aF=Object.prototype,Np=aF.hasOwnProperty;function sF(e,t,r,s,n,i){var o=yp(e),c=yp(t),l=o?bp:vp(e),d=c?bp:vp(t);l=l==_p?Qo:l,d=d==_p?Qo:d;var u=l==Qo,f=d==Qo,h=l==d;if(h&&wp(e)){if(!wp(t))return!1;o=!0,u=!1}if(h&&!u)return i||(i=new td),o||tF(e)?JL(e,t,r,s,n,i):ZL(e,t,l,r,s,n,i);if(!(r&rF)){var m=u&&Np.call(e,"__wrapped__"),g=f&&Np.call(t,"__wrapped__");if(m||g){var p=m?e.value():e,x=g?t.value():t;return i||(i=new td),n(p,x,r,s,i)}}return h?(i||(i=new td),eF(e,t,r,s,n,i)):!1}var nF=sF,iF=nF,jp=ns;function ky(e,t,r,s,n){return e===t?!0:e==null||t==null||!jp(e)&&!jp(t)?e!==e&&t!==t:iF(e,t,r,s,ky,n)}var vf=ky,oF=xy,cF=vf,lF=1,dF=2;function uF(e,t,r,s){var n=r.length,i=n,o=!s;if(e==null)return!i;for(e=Object(e);n--;){var c=r[n];if(o&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++n<i;){c=r[n];var l=c[0],d=e[l],u=c[1];if(o&&c[2]){if(d===void 0&&!(l in e))return!1}else{var f=new oF;if(s)var h=s(d,u,l,e,t,f);if(!(h===void 0?cF(u,d,lF|dF,s,f):h))return!1}}return!0}var fF=uF,hF=Is;function mF(e){return e===e&&!hF(e)}var Ry=mF,pF=Ry,gF=xl;function xF(e){for(var t=gF(e),r=t.length;r--;){var s=t[r],n=e[s];t[r]=[s,n,pF(n)]}return t}var vF=xF;function yF(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var Iy=yF,wF=fF,_F=vF,bF=Iy;function NF(e){var t=_F(e);return t.length==1&&t[0][2]?bF(t[0][0],t[0][1]):function(r){return r===e||wF(r,e,t)}}var jF=NF;function TF(e,t){return e!=null&&t in Object(e)}var EF=TF,SF=qv,AF=pf,CF=Tr,kF=gf,RF=xf,IF=ml;function OF(e,t,r){t=SF(t,e);for(var s=-1,n=t.length,i=!1;++s<n;){var o=IF(t[s]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++s!=n?i:(n=e==null?0:e.length,!!n&&RF(n)&&kF(o,n)&&(CF(e)||AF(e)))}var PF=OF,DF=EF,LF=PF;function FF(e,t){return e!=null&&LF(e,t,DF)}var MF=FF,UF=vf,$F=Wv,BF=MF,GF=af,VF=Ry,HF=Iy,qF=ml,WF=1,zF=2;function YF(e,t){return GF(e)&&VF(t)?HF(qF(e),t):function(r){var s=$F(r,e);return s===void 0&&s===t?BF(r,e):UF(t,s,WF|zF)}}var KF=YF;function XF(e){return e}var hi=XF;function QF(e){return function(t){return t==null?void 0:t[e]}}var JF=QF,ZF=uf;function eM(e){return function(t){return ZF(t,e)}}var tM=eM,rM=JF,aM=tM,sM=af,nM=ml;function iM(e){return sM(e)?rM(nM(e)):aM(e)}var oM=iM,cM=jF,lM=KF,dM=hi,uM=Tr,fM=oM;function hM(e){return typeof e=="function"?e:e==null?dM:typeof e=="object"?uM(e)?lM(e[0],e[1]):cM(e):fM(e)}var Da=hM;function mM(e,t,r,s){for(var n=e.length,i=r+(s?1:-1);s?i--:++i<n;)if(t(e[i],i,e))return i;return-1}var Oy=mM;function pM(e){return e!==e}var gM=pM;function xM(e,t,r){for(var s=r-1,n=e.length;++s<n;)if(e[s]===t)return s;return-1}var vM=xM,yM=Oy,wM=gM,_M=vM;function bM(e,t,r){return t===t?_M(e,t,r):yM(e,wM,r)}var NM=bM,jM=NM;function TM(e,t){var r=e==null?0:e.length;return!!r&&jM(e,t,0)>-1}var EM=TM;function SM(e,t,r){for(var s=-1,n=e==null?0:e.length;++s<n;)if(r(t,e[s]))return!0;return!1}var AM=SM;function CM(){}var kM=CM,rd=Ay,RM=kM,IM=mf,OM=1/0,PM=rd&&1/IM(new rd([,-0]))[1]==OM?function(e){return new rd(e)}:RM,DM=PM,LM=vy,FM=EM,MM=AM,UM=wy,$M=DM,BM=mf,GM=200;function VM(e,t,r){var s=-1,n=FM,i=e.length,o=!0,c=[],l=c;if(r)o=!1,n=MM;else if(i>=GM){var d=t?null:$M(e);if(d)return BM(d);o=!1,n=UM,l=new LM}else l=t?[]:c;e:for(;++s<i;){var u=e[s],f=t?t(u):u;if(u=r||u!==0?u:0,o&&f===f){for(var h=l.length;h--;)if(l[h]===f)continue e;t&&l.push(f),c.push(u)}else n(l,f,r)||(l!==c&&l.push(f),c.push(u))}return c}var HM=VM,qM=Da,WM=HM;function zM(e,t){return e&&e.length?WM(e,qM(t)):[]}var YM=zM;const wW=nt(YM);var Tp=Ao,KM=pf,XM=Tr,Ep=Tp?Tp.isConcatSpreadable:void 0;function QM(e){return XM(e)||KM(e)||!!(Ep&&e&&e[Ep])}var JM=QM,ZM=by,e7=JM;function Py(e,t,r,s,n){var i=-1,o=e.length;for(r||(r=e7),n||(n=[]);++i<o;){var c=e[i];t>0&&r(c)?t>1?Py(c,t-1,r,s,n):ZM(n,c):s||(n[n.length]=c)}return n}var Dy=Py;function t7(e){return function(t,r,s){for(var n=-1,i=Object(t),o=s(t),c=o.length;c--;){var l=o[e?c:++n];if(r(i[l],l,i)===!1)break}return t}}var r7=t7,a7=r7,s7=a7(),n7=s7,i7=n7,o7=xl;function c7(e,t){return e&&i7(e,t,o7)}var Ly=c7,l7=Co;function d7(e,t){return function(r,s){if(r==null)return r;if(!l7(r))return e(r,s);for(var n=r.length,i=t?n:-1,o=Object(r);(t?i--:++i<n)&&s(o[i],i,o)!==!1;);return r}}var u7=d7,f7=Ly,h7=u7,m7=h7(f7),yf=m7,p7=yf,g7=Co;function x7(e,t){var r=-1,s=g7(e)?Array(e.length):[];return p7(e,function(n,i,o){s[++r]=t(n,i,o)}),s}var Fy=x7;function v7(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var y7=v7,Sp=oi;function w7(e,t){if(e!==t){var r=e!==void 0,s=e===null,n=e===e,i=Sp(e),o=t!==void 0,c=t===null,l=t===t,d=Sp(t);if(!c&&!d&&!i&&e>t||i&&o&&l&&!c&&!d||s&&o&&l||!r&&l||!n)return 1;if(!s&&!i&&!d&&e<t||d&&r&&n&&!s&&!i||c&&r&&n||!o&&n||!l)return-1}return 0}var _7=w7,b7=_7;function N7(e,t,r){for(var s=-1,n=e.criteria,i=t.criteria,o=n.length,c=r.length;++s<o;){var l=b7(n[s],i[s]);if(l){if(s>=c)return l;var d=r[s];return l*(d=="desc"?-1:1)}}return e.index-t.index}var j7=N7,ad=df,T7=uf,E7=Da,S7=Fy,A7=y7,C7=Ty,k7=j7,R7=hi,I7=Tr;function O7(e,t,r){t.length?t=ad(t,function(i){return I7(i)?function(o){return T7(o,i.length===1?i[0]:i)}:i}):t=[R7];var s=-1;t=ad(t,C7(E7));var n=S7(e,function(i,o,c){var l=ad(t,function(d){return d(i)});return{criteria:l,index:++s,value:i}});return A7(n,function(i,o){return k7(i,o,r)})}var P7=O7;function D7(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var L7=D7,F7=L7,Ap=Math.max;function M7(e,t,r){return t=Ap(t===void 0?e.length-1:t,0),function(){for(var s=arguments,n=-1,i=Ap(s.length-t,0),o=Array(i);++n<i;)o[n]=s[t+n];n=-1;for(var c=Array(t+1);++n<t;)c[n]=s[n];return c[t]=r(o),F7(e,this,c)}}var U7=M7;function $7(e){return function(){return e}}var B7=$7,G7=yn,V7=function(){try{var e=G7(Object,"defineProperty");return e({},"",{}),e}catch{}}(),My=V7,H7=B7,Cp=My,q7=hi,W7=Cp?function(e,t){return Cp(e,"toString",{configurable:!0,enumerable:!1,value:H7(t),writable:!0})}:q7,z7=W7,Y7=800,K7=16,X7=Date.now;function Q7(e){var t=0,r=0;return function(){var s=X7(),n=K7-(s-r);if(r=s,n>0){if(++t>=Y7)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var J7=Q7,Z7=z7,e9=J7,t9=e9(Z7),r9=t9,a9=hi,s9=U7,n9=r9;function i9(e,t){return n9(s9(e,t,a9),e+"")}var o9=i9,c9=nf,l9=Co,d9=gf,u9=Is;function f9(e,t,r){if(!u9(r))return!1;var s=typeof t;return(s=="number"?l9(r)&&d9(t,r.length):s=="string"&&t in r)?c9(r[t],e):!1}var vl=f9,h9=Dy,m9=P7,p9=o9,kp=vl,g9=p9(function(e,t){if(e==null)return[];var r=t.length;return r>1&&kp(e,t[0],t[1])?t=[]:r>2&&kp(t[0],t[1],t[2])&&(t=[t[0]]),m9(e,h9(t,1),[])}),x9=g9;const _W=nt(x9);var v9=Pa,y9=function(){return v9.Date.now()},w9=y9,_9=/\s/;function b9(e){for(var t=e.length;t--&&_9.test(e.charAt(t)););return t}var N9=b9,j9=N9,T9=/^\s+/;function E9(e){return e&&e.slice(0,j9(e)+1).replace(T9,"")}var S9=E9,A9=S9,Rp=Is,C9=oi,Ip=NaN,k9=/^[-+]0x[0-9a-f]+$/i,R9=/^0b[01]+$/i,I9=/^0o[0-7]+$/i,O9=parseInt;function P9(e){if(typeof e=="number")return e;if(C9(e))return Ip;if(Rp(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Rp(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=A9(e);var r=R9.test(e);return r||I9.test(e)?O9(e.slice(2),r?2:8):k9.test(e)?Ip:+e}var Uy=P9,D9=Is,sd=w9,Op=Uy,L9="Expected a function",F9=Math.max,M9=Math.min;function U9(e,t,r){var s,n,i,o,c,l,d=0,u=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(L9);t=Op(t)||0,D9(r)&&(u=!!r.leading,f="maxWait"in r,i=f?F9(Op(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function m(_){var T=s,N=n;return s=n=void 0,d=_,o=e.apply(N,T),o}function g(_){return d=_,c=setTimeout(y,t),u?m(_):o}function p(_){var T=_-l,N=_-d,b=t-T;return f?M9(b,i-N):b}function x(_){var T=_-l,N=_-d;return l===void 0||T>=t||T<0||f&&N>=i}function y(){var _=sd();if(x(_))return w(_);c=setTimeout(y,p(_))}function w(_){return c=void 0,h&&s?m(_):(s=n=void 0,o)}function v(){c!==void 0&&clearTimeout(c),d=0,s=l=n=c=void 0}function j(){return c===void 0?o:w(sd())}function S(){var _=sd(),T=x(_);if(s=arguments,n=this,l=_,T){if(c===void 0)return g(l);if(f)return clearTimeout(c),c=setTimeout(y,t),m(l)}return c===void 0&&(c=setTimeout(y,t)),o}return S.cancel=v,S.flush=j,S}var $9=U9,B9=$9,G9=Is,V9="Expected a function";function H9(e,t,r){var s=!0,n=!0;if(typeof e!="function")throw new TypeError(V9);return G9(r)&&(s="leading"in r?!!r.leading:s,n="trailing"in r?!!r.trailing:n),B9(e,t,{leading:s,maxWait:t,trailing:n})}var q9=H9;const bW=nt(q9);function bs(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function W9(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function wf(e){let t,r,s;e.length!==2?(t=bs,r=(c,l)=>bs(e(c),l),s=(c,l)=>e(c)-l):(t=e===bs||e===W9?e:z9,r=e,s=e);function n(c,l,d=0,u=c.length){if(d<u){if(t(l,l)!==0)return u;do{const f=d+u>>>1;r(c[f],l)<0?d=f+1:u=f}while(d<u)}return d}function i(c,l,d=0,u=c.length){if(d<u){if(t(l,l)!==0)return u;do{const f=d+u>>>1;r(c[f],l)<=0?d=f+1:u=f}while(d<u)}return d}function o(c,l,d=0,u=c.length){const f=n(c,l,d,u-1);return f>d&&s(c[f-1],l)>-s(c[f],l)?f-1:f}return{left:n,center:o,right:i}}function z9(){return 0}function $y(e){return e===null?NaN:+e}function*Y9(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const K9=wf(bs),ko=K9.right;wf($y).center;class Pp extends Map{constructor(t,r=J9){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[s,n]of t)this.set(s,n)}get(t){return super.get(Dp(this,t))}has(t){return super.has(Dp(this,t))}set(t,r){return super.set(X9(this,t),r)}delete(t){return super.delete(Q9(this,t))}}function Dp({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):r}function X9({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):(e.set(s,r),r)}function Q9({_intern:e,_key:t},r){const s=t(r);return e.has(s)&&(r=e.get(s),e.delete(s)),r}function J9(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Z9(e=bs){if(e===bs)return By;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const s=e(t,r);return s||s===0?s:(e(r,r)===0)-(e(t,t)===0)}}function By(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const eU=Math.sqrt(50),tU=Math.sqrt(10),rU=Math.sqrt(2);function Mc(e,t,r){const s=(t-e)/Math.max(0,r),n=Math.floor(Math.log10(s)),i=s/Math.pow(10,n),o=i>=eU?10:i>=tU?5:i>=rU?2:1;let c,l,d;return n<0?(d=Math.pow(10,-n)/o,c=Math.round(e*d),l=Math.round(t*d),c/d<e&&++c,l/d>t&&--l,d=-d):(d=Math.pow(10,n)*o,c=Math.round(e/d),l=Math.round(t/d),c*d<e&&++c,l*d>t&&--l),l<c&&.5<=r&&r<2?Mc(e,t,r*2):[c,l,d]}function Kd(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const s=t<e,[n,i,o]=s?Mc(t,e,r):Mc(e,t,r);if(!(i>=n))return[];const c=i-n+1,l=new Array(c);if(s)if(o<0)for(let d=0;d<c;++d)l[d]=(i-d)/-o;else for(let d=0;d<c;++d)l[d]=(i-d)*o;else if(o<0)for(let d=0;d<c;++d)l[d]=(n+d)/-o;else for(let d=0;d<c;++d)l[d]=(n+d)*o;return l}function Xd(e,t,r){return t=+t,e=+e,r=+r,Mc(e,t,r)[2]}function Qd(e,t,r){t=+t,e=+e,r=+r;const s=t<e,n=s?Xd(t,e,r):Xd(e,t,r);return(s?-1:1)*(n<0?1/-n:n)}function Lp(e,t){let r;for(const s of e)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);return r}function Fp(e,t){let r;for(const s of e)s!=null&&(r>s||r===void 0&&s>=s)&&(r=s);return r}function Gy(e,t,r=0,s=1/0,n){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),s=Math.floor(Math.min(e.length-1,s)),!(r<=t&&t<=s))return e;for(n=n===void 0?By:Z9(n);s>r;){if(s-r>600){const l=s-r+1,d=t-r+1,u=Math.log(l),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(l-f)/l)*(d-l/2<0?-1:1),m=Math.max(r,Math.floor(t-d*f/l+h)),g=Math.min(s,Math.floor(t+(l-d)*f/l+h));Gy(e,t,m,g,n)}const i=e[t];let o=r,c=s;for(Ei(e,r,t),n(e[s],i)>0&&Ei(e,r,s);o<c;){for(Ei(e,o,c),++o,--c;n(e[o],i)<0;)++o;for(;n(e[c],i)>0;)--c}n(e[r],i)===0?Ei(e,r,c):(++c,Ei(e,c,s)),c<=t&&(r=c+1),t<=c&&(s=c-1)}return e}function Ei(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}function aU(e,t,r){if(e=Float64Array.from(Y9(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return Fp(e);if(t>=1)return Lp(e);var s,n=(s-1)*t,i=Math.floor(n),o=Lp(Gy(e,i).subarray(0,i+1)),c=Fp(e.subarray(i+1));return o+(c-o)*(n-i)}}function sU(e,t,r=$y){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+r(e[0],0,e);if(t>=1)return+r(e[s-1],s-1,e);var s,n=(s-1)*t,i=Math.floor(n),o=+r(e[i],i,e),c=+r(e[i+1],i+1,e);return o+(c-o)*(n-i)}}function nU(e,t,r){e=+e,t=+t,r=(n=arguments.length)<2?(t=e,e=0,1):n<3?1:+r;for(var s=-1,n=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(n);++s<n;)i[s]=e+s*r;return i}function Jr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function is(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Jd=Symbol("implicit");function _f(){var e=new Pp,t=[],r=[],s=Jd;function n(i){let o=e.get(i);if(o===void 0){if(s!==Jd)return s;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return n.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Pp;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return n},n.range=function(i){return arguments.length?(r=Array.from(i),n):r.slice()},n.unknown=function(i){return arguments.length?(s=i,n):s},n.copy=function(){return _f(t,r).unknown(s)},Jr.apply(n,arguments),n}function bf(){var e=_f().unknown(void 0),t=e.domain,r=e.range,s=0,n=1,i,o,c=!1,l=0,d=0,u=.5;delete e.unknown;function f(){var h=t().length,m=n<s,g=m?n:s,p=m?s:n;i=(p-g)/Math.max(1,h-l+d*2),c&&(i=Math.floor(i)),g+=(p-g-i*(h-l))*u,o=i*(1-l),c&&(g=Math.round(g),o=Math.round(o));var x=nU(h).map(function(y){return g+i*y});return r(m?x.reverse():x)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([s,n]=h,s=+s,n=+n,f()):[s,n]},e.rangeRound=function(h){return[s,n]=h,s=+s,n=+n,c=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(h){return arguments.length?(c=!!h,f()):c},e.padding=function(h){return arguments.length?(l=Math.min(1,d=+h),f()):l},e.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),f()):l},e.paddingOuter=function(h){return arguments.length?(d=+h,f()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.copy=function(){return bf(t(),[s,n]).round(c).paddingInner(l).paddingOuter(d).align(u)},Jr.apply(f(),arguments)}function Vy(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Vy(t())},e}function iU(){return Vy(bf.apply(null,arguments).paddingInner(1))}function Nf(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Hy(e,t){var r=Object.create(e.prototype);for(var s in t)r[s]=t[s];return r}function Ro(){}var fo=.7,Uc=1/fo,Dn="\\s*([+-]?\\d+)\\s*",ho="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ea="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",oU=/^#([0-9a-f]{3,8})$/,cU=new RegExp(`^rgb\\(${Dn},${Dn},${Dn}\\)$`),lU=new RegExp(`^rgb\\(${Ea},${Ea},${Ea}\\)$`),dU=new RegExp(`^rgba\\(${Dn},${Dn},${Dn},${ho}\\)$`),uU=new RegExp(`^rgba\\(${Ea},${Ea},${Ea},${ho}\\)$`),fU=new RegExp(`^hsl\\(${ho},${Ea},${Ea}\\)$`),hU=new RegExp(`^hsla\\(${ho},${Ea},${Ea},${ho}\\)$`),Mp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Nf(Ro,mo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Up,formatHex:Up,formatHex8:mU,formatHsl:pU,formatRgb:$p,toString:$p});function Up(){return this.rgb().formatHex()}function mU(){return this.rgb().formatHex8()}function pU(){return qy(this).formatHsl()}function $p(){return this.rgb().formatRgb()}function mo(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=oU.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Bp(t):r===3?new jr(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Jo(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Jo(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=cU.exec(e))?new jr(t[1],t[2],t[3],1):(t=lU.exec(e))?new jr(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=dU.exec(e))?Jo(t[1],t[2],t[3],t[4]):(t=uU.exec(e))?Jo(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=fU.exec(e))?Hp(t[1],t[2]/100,t[3]/100,1):(t=hU.exec(e))?Hp(t[1],t[2]/100,t[3]/100,t[4]):Mp.hasOwnProperty(e)?Bp(Mp[e]):e==="transparent"?new jr(NaN,NaN,NaN,0):null}function Bp(e){return new jr(e>>16&255,e>>8&255,e&255,1)}function Jo(e,t,r,s){return s<=0&&(e=t=r=NaN),new jr(e,t,r,s)}function gU(e){return e instanceof Ro||(e=mo(e)),e?(e=e.rgb(),new jr(e.r,e.g,e.b,e.opacity)):new jr}function Zd(e,t,r,s){return arguments.length===1?gU(e):new jr(e,t,r,s??1)}function jr(e,t,r,s){this.r=+e,this.g=+t,this.b=+r,this.opacity=+s}Nf(jr,Zd,Hy(Ro,{brighter(e){return e=e==null?Uc:Math.pow(Uc,e),new jr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?fo:Math.pow(fo,e),new jr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new jr(Zs(this.r),Zs(this.g),Zs(this.b),$c(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Gp,formatHex:Gp,formatHex8:xU,formatRgb:Vp,toString:Vp}));function Gp(){return`#${Gs(this.r)}${Gs(this.g)}${Gs(this.b)}`}function xU(){return`#${Gs(this.r)}${Gs(this.g)}${Gs(this.b)}${Gs((isNaN(this.opacity)?1:this.opacity)*255)}`}function Vp(){const e=$c(this.opacity);return`${e===1?"rgb(":"rgba("}${Zs(this.r)}, ${Zs(this.g)}, ${Zs(this.b)}${e===1?")":`, ${e})`}`}function $c(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Zs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Gs(e){return e=Zs(e),(e<16?"0":"")+e.toString(16)}function Hp(e,t,r,s){return s<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ia(e,t,r,s)}function qy(e){if(e instanceof ia)return new ia(e.h,e.s,e.l,e.opacity);if(e instanceof Ro||(e=mo(e)),!e)return new ia;if(e instanceof ia)return e;e=e.rgb();var t=e.r/255,r=e.g/255,s=e.b/255,n=Math.min(t,r,s),i=Math.max(t,r,s),o=NaN,c=i-n,l=(i+n)/2;return c?(t===i?o=(r-s)/c+(r<s)*6:r===i?o=(s-t)/c+2:o=(t-r)/c+4,c/=l<.5?i+n:2-i-n,o*=60):c=l>0&&l<1?0:o,new ia(o,c,l,e.opacity)}function vU(e,t,r,s){return arguments.length===1?qy(e):new ia(e,t,r,s??1)}function ia(e,t,r,s){this.h=+e,this.s=+t,this.l=+r,this.opacity=+s}Nf(ia,vU,Hy(Ro,{brighter(e){return e=e==null?Uc:Math.pow(Uc,e),new ia(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?fo:Math.pow(fo,e),new ia(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*t,n=2*r-s;return new jr(nd(e>=240?e-240:e+120,n,s),nd(e,n,s),nd(e<120?e+240:e-120,n,s),this.opacity)},clamp(){return new ia(qp(this.h),Zo(this.s),Zo(this.l),$c(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=$c(this.opacity);return`${e===1?"hsl(":"hsla("}${qp(this.h)}, ${Zo(this.s)*100}%, ${Zo(this.l)*100}%${e===1?")":`, ${e})`}`}}));function qp(e){return e=(e||0)%360,e<0?e+360:e}function Zo(e){return Math.max(0,Math.min(1,e||0))}function nd(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const jf=e=>()=>e;function yU(e,t){return function(r){return e+r*t}}function wU(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(s){return Math.pow(e+s*t,r)}}function _U(e){return(e=+e)==1?Wy:function(t,r){return r-t?wU(t,r,e):jf(isNaN(t)?r:t)}}function Wy(e,t){var r=t-e;return r?yU(e,r):jf(isNaN(e)?t:e)}const Wp=function e(t){var r=_U(t);function s(n,i){var o=r((n=Zd(n)).r,(i=Zd(i)).r),c=r(n.g,i.g),l=r(n.b,i.b),d=Wy(n.opacity,i.opacity);return function(u){return n.r=o(u),n.g=c(u),n.b=l(u),n.opacity=d(u),n+""}}return s.gamma=e,s}(1);function bU(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,s=t.slice(),n;return function(i){for(n=0;n<r;++n)s[n]=e[n]*(1-i)+t[n]*i;return s}}function NU(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function jU(e,t){var r=t?t.length:0,s=e?Math.min(r,e.length):0,n=new Array(s),i=new Array(r),o;for(o=0;o<s;++o)n[o]=mi(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(c){for(o=0;o<s;++o)i[o]=n[o](c);return i}}function TU(e,t){var r=new Date;return e=+e,t=+t,function(s){return r.setTime(e*(1-s)+t*s),r}}function Bc(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function EU(e,t){var r={},s={},n;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in e?r[n]=mi(e[n],t[n]):s[n]=t[n];return function(i){for(n in r)s[n]=r[n](i);return s}}var eu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,id=new RegExp(eu.source,"g");function SU(e){return function(){return e}}function AU(e){return function(t){return e(t)+""}}function CU(e,t){var r=eu.lastIndex=id.lastIndex=0,s,n,i,o=-1,c=[],l=[];for(e=e+"",t=t+"";(s=eu.exec(e))&&(n=id.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),c[o]?c[o]+=i:c[++o]=i),(s=s[0])===(n=n[0])?c[o]?c[o]+=n:c[++o]=n:(c[++o]=null,l.push({i:o,x:Bc(s,n)})),r=id.lastIndex;return r<t.length&&(i=t.slice(r),c[o]?c[o]+=i:c[++o]=i),c.length<2?l[0]?AU(l[0].x):SU(t):(t=l.length,function(d){for(var u=0,f;u<t;++u)c[(f=l[u]).i]=f.x(d);return c.join("")})}function mi(e,t){var r=typeof t,s;return t==null||r==="boolean"?jf(t):(r==="number"?Bc:r==="string"?(s=mo(t))?(t=s,Wp):CU:t instanceof mo?Wp:t instanceof Date?TU:NU(t)?bU:Array.isArray(t)?jU:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?EU:Bc)(e,t)}function Tf(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function kU(e,t){t===void 0&&(t=e,e=mi);for(var r=0,s=t.length-1,n=t[0],i=new Array(s<0?0:s);r<s;)i[r]=e(n,n=t[++r]);return function(o){var c=Math.max(0,Math.min(s-1,Math.floor(o*=s)));return i[c](o-c)}}function RU(e){return function(){return e}}function Gc(e){return+e}var zp=[0,1];function vr(e){return e}function tu(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:RU(isNaN(t)?NaN:.5)}function IU(e,t){var r;return e>t&&(r=e,e=t,t=r),function(s){return Math.max(e,Math.min(t,s))}}function OU(e,t,r){var s=e[0],n=e[1],i=t[0],o=t[1];return n<s?(s=tu(n,s),i=r(o,i)):(s=tu(s,n),i=r(i,o)),function(c){return i(s(c))}}function PU(e,t,r){var s=Math.min(e.length,t.length)-1,n=new Array(s),i=new Array(s),o=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<s;)n[o]=tu(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(c){var l=ko(e,c,1,s)-1;return i[l](n[l](c))}}function Io(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function yl(){var e=zp,t=zp,r=mi,s,n,i,o=vr,c,l,d;function u(){var h=Math.min(e.length,t.length);return o!==vr&&(o=IU(e[0],e[h-1])),c=h>2?PU:OU,l=d=null,f}function f(h){return h==null||isNaN(h=+h)?i:(l||(l=c(e.map(s),t,r)))(s(o(h)))}return f.invert=function(h){return o(n((d||(d=c(t,e.map(s),Bc)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Gc),u()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),u()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=Tf,u()},f.clamp=function(h){return arguments.length?(o=h?!0:vr,u()):o!==vr},f.interpolate=function(h){return arguments.length?(r=h,u()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,m){return s=h,n=m,u()}}function Ef(){return yl()(vr,vr)}function DU(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Vc(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,s=e.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+e.slice(r+1)]}function Qn(e){return e=Vc(Math.abs(e)),e?e[1]:NaN}function LU(e,t){return function(r,s){for(var n=r.length,i=[],o=0,c=e[0],l=0;n>0&&c>0&&(l+c+1>s&&(c=Math.max(1,s-l)),i.push(r.substring(n-=c,n+c)),!((l+=c+1)>s));)c=e[o=(o+1)%e.length];return i.reverse().join(t)}}function FU(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var MU=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function po(e){if(!(t=MU.exec(e)))throw new Error("invalid format: "+e);var t;return new Sf({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}po.prototype=Sf.prototype;function Sf(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Sf.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function UU(e){e:for(var t=e.length,r=1,s=-1,n;r<t;++r)switch(e[r]){case".":s=n=r;break;case"0":s===0&&(s=r),n=r;break;default:if(!+e[r])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(n+1):e}var zy;function $U(e,t){var r=Vc(e,t);if(!r)return e+"";var s=r[0],n=r[1],i=n-(zy=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,o=s.length;return i===o?s:i>o?s+new Array(i-o+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+Vc(e,Math.max(0,t+i-1))[0]}function Yp(e,t){var r=Vc(e,t);if(!r)return e+"";var s=r[0],n=r[1];return n<0?"0."+new Array(-n).join("0")+s:s.length>n+1?s.slice(0,n+1)+"."+s.slice(n+1):s+new Array(n-s.length+2).join("0")}const Kp={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:DU,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Yp(e*100,t),r:Yp,s:$U,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Xp(e){return e}var Qp=Array.prototype.map,Jp=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function BU(e){var t=e.grouping===void 0||e.thousands===void 0?Xp:LU(Qp.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",n=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?Xp:FU(Qp.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function d(f){f=po(f);var h=f.fill,m=f.align,g=f.sign,p=f.symbol,x=f.zero,y=f.width,w=f.comma,v=f.precision,j=f.trim,S=f.type;S==="n"?(w=!0,S="g"):Kp[S]||(v===void 0&&(v=12),j=!0,S="g"),(x||h==="0"&&m==="=")&&(x=!0,h="0",m="=");var _=p==="$"?r:p==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",T=p==="$"?s:/[%p]/.test(S)?o:"",N=Kp[S],b=/[defgprs%]/.test(S);v=v===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function O(A){var E=_,U=T,Y,ee,se;if(S==="c")U=N(A)+U,A="";else{A=+A;var W=A<0||1/A<0;if(A=isNaN(A)?l:N(Math.abs(A),v),j&&(A=UU(A)),W&&+A==0&&g!=="+"&&(W=!1),E=(W?g==="("?g:c:g==="-"||g==="("?"":g)+E,U=(S==="s"?Jp[8+zy/3]:"")+U+(W&&g==="("?")":""),b){for(Y=-1,ee=A.length;++Y<ee;)if(se=A.charCodeAt(Y),48>se||se>57){U=(se===46?n+A.slice(Y+1):A.slice(Y))+U,A=A.slice(0,Y);break}}}w&&!x&&(A=t(A,1/0));var J=E.length+A.length+U.length,F=J<y?new Array(y-J+1).join(h):"";switch(w&&x&&(A=t(F+A,F.length?y-U.length:1/0),F=""),m){case"<":A=E+A+U+F;break;case"=":A=E+F+A+U;break;case"^":A=F.slice(0,J=F.length>>1)+E+A+U+F.slice(J);break;default:A=F+E+A+U;break}return i(A)}return O.toString=function(){return f+""},O}function u(f,h){var m=d((f=po(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(Qn(h)/3)))*3,p=Math.pow(10,-g),x=Jp[8+g/3];return function(y){return m(p*y)+x}}return{format:d,formatPrefix:u}}var ec,Af,Yy;GU({thousands:",",grouping:[3],currency:["$",""]});function GU(e){return ec=BU(e),Af=ec.format,Yy=ec.formatPrefix,ec}function VU(e){return Math.max(0,-Qn(Math.abs(e)))}function HU(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qn(t)/3)))*3-Qn(Math.abs(e)))}function qU(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Qn(t)-Qn(e))+1}function Ky(e,t,r,s){var n=Qd(e,t,r),i;switch(s=po(s??",f"),s.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(i=HU(n,o))&&(s.precision=i),Yy(s,o)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=qU(n,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=VU(n))&&(s.precision=i-(s.type==="%")*2);break}}return Af(s)}function Os(e){var t=e.domain;return e.ticks=function(r){var s=t();return Kd(s[0],s[s.length-1],r??10)},e.tickFormat=function(r,s){var n=t();return Ky(n[0],n[n.length-1],r??10,s)},e.nice=function(r){r==null&&(r=10);var s=t(),n=0,i=s.length-1,o=s[n],c=s[i],l,d,u=10;for(c<o&&(d=o,o=c,c=d,d=n,n=i,i=d);u-- >0;){if(d=Xd(o,c,r),d===l)return s[n]=o,s[i]=c,t(s);if(d>0)o=Math.floor(o/d)*d,c=Math.ceil(c/d)*d;else if(d<0)o=Math.ceil(o*d)/d,c=Math.floor(c*d)/d;else break;l=d}return e},e}function Xy(){var e=Ef();return e.copy=function(){return Io(e,Xy())},Jr.apply(e,arguments),Os(e)}function Qy(e){var t;function r(s){return s==null||isNaN(s=+s)?t:s}return r.invert=r,r.domain=r.range=function(s){return arguments.length?(e=Array.from(s,Gc),r):e.slice()},r.unknown=function(s){return arguments.length?(t=s,r):t},r.copy=function(){return Qy(e).unknown(t)},e=arguments.length?Array.from(e,Gc):[0,1],Os(r)}function Jy(e,t){e=e.slice();var r=0,s=e.length-1,n=e[r],i=e[s],o;return i<n&&(o=r,r=s,s=o,o=n,n=i,i=o),e[r]=t.floor(n),e[s]=t.ceil(i),e}function Zp(e){return Math.log(e)}function e0(e){return Math.exp(e)}function WU(e){return-Math.log(-e)}function zU(e){return-Math.exp(-e)}function YU(e){return isFinite(e)?+("1e"+e):e<0?0:e}function KU(e){return e===10?YU:e===Math.E?Math.exp:t=>Math.pow(e,t)}function XU(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function t0(e){return(t,r)=>-e(-t,r)}function Cf(e){const t=e(Zp,e0),r=t.domain;let s=10,n,i;function o(){return n=XU(s),i=KU(s),r()[0]<0?(n=t0(n),i=t0(i),e(WU,zU)):e(Zp,e0),t}return t.base=function(c){return arguments.length?(s=+c,o()):s},t.domain=function(c){return arguments.length?(r(c),o()):r()},t.ticks=c=>{const l=r();let d=l[0],u=l[l.length-1];const f=u<d;f&&([d,u]=[u,d]);let h=n(d),m=n(u),g,p;const x=c==null?10:+c;let y=[];if(!(s%1)&&m-h<x){if(h=Math.floor(h),m=Math.ceil(m),d>0){for(;h<=m;++h)for(g=1;g<s;++g)if(p=h<0?g/i(-h):g*i(h),!(p<d)){if(p>u)break;y.push(p)}}else for(;h<=m;++h)for(g=s-1;g>=1;--g)if(p=h>0?g/i(-h):g*i(h),!(p<d)){if(p>u)break;y.push(p)}y.length*2<x&&(y=Kd(d,u,x))}else y=Kd(h,m,Math.min(m-h,x)).map(i);return f?y.reverse():y},t.tickFormat=(c,l)=>{if(c==null&&(c=10),l==null&&(l=s===10?"s":","),typeof l!="function"&&(!(s%1)&&(l=po(l)).precision==null&&(l.trim=!0),l=Af(l)),c===1/0)return l;const d=Math.max(1,s*c/t.ticks().length);return u=>{let f=u/i(Math.round(n(u)));return f*s<s-.5&&(f*=s),f<=d?l(u):""}},t.nice=()=>r(Jy(r(),{floor:c=>i(Math.floor(n(c))),ceil:c=>i(Math.ceil(n(c)))})),t}function Zy(){const e=Cf(yl()).domain([1,10]);return e.copy=()=>Io(e,Zy()).base(e.base()),Jr.apply(e,arguments),e}function r0(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function a0(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function kf(e){var t=1,r=e(r0(t),a0(t));return r.constant=function(s){return arguments.length?e(r0(t=+s),a0(t)):t},Os(r)}function ew(){var e=kf(yl());return e.copy=function(){return Io(e,ew()).constant(e.constant())},Jr.apply(e,arguments)}function s0(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function QU(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function JU(e){return e<0?-e*e:e*e}function Rf(e){var t=e(vr,vr),r=1;function s(){return r===1?e(vr,vr):r===.5?e(QU,JU):e(s0(r),s0(1/r))}return t.exponent=function(n){return arguments.length?(r=+n,s()):r},Os(t)}function If(){var e=Rf(yl());return e.copy=function(){return Io(e,If()).exponent(e.exponent())},Jr.apply(e,arguments),e}function ZU(){return If.apply(null,arguments).exponent(.5)}function n0(e){return Math.sign(e)*e*e}function e$(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function tw(){var e=Ef(),t=[0,1],r=!1,s;function n(i){var o=e$(e(i));return isNaN(o)?s:r?Math.round(o):o}return n.invert=function(i){return e.invert(n0(i))},n.domain=function(i){return arguments.length?(e.domain(i),n):e.domain()},n.range=function(i){return arguments.length?(e.range((t=Array.from(i,Gc)).map(n0)),n):t.slice()},n.rangeRound=function(i){return n.range(i).round(!0)},n.round=function(i){return arguments.length?(r=!!i,n):r},n.clamp=function(i){return arguments.length?(e.clamp(i),n):e.clamp()},n.unknown=function(i){return arguments.length?(s=i,n):s},n.copy=function(){return tw(e.domain(),t).round(r).clamp(e.clamp()).unknown(s)},Jr.apply(n,arguments),Os(n)}function rw(){var e=[],t=[],r=[],s;function n(){var o=0,c=Math.max(1,t.length);for(r=new Array(c-1);++o<c;)r[o-1]=sU(e,o/c);return i}function i(o){return o==null||isNaN(o=+o)?s:t[ko(r,o)]}return i.invertExtent=function(o){var c=t.indexOf(o);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let c of o)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(bs),n()},i.range=function(o){return arguments.length?(t=Array.from(o),n()):t.slice()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.quantiles=function(){return r.slice()},i.copy=function(){return rw().domain(e).range(t).unknown(s)},Jr.apply(i,arguments)}function aw(){var e=0,t=1,r=1,s=[.5],n=[0,1],i;function o(l){return l!=null&&l<=l?n[ko(s,l,0,r)]:i}function c(){var l=-1;for(s=new Array(r);++l<r;)s[l]=((l+1)*t-(l-r)*e)/(r+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,c()):[e,t]},o.range=function(l){return arguments.length?(r=(n=Array.from(l)).length-1,c()):n.slice()},o.invertExtent=function(l){var d=n.indexOf(l);return d<0?[NaN,NaN]:d<1?[e,s[0]]:d>=r?[s[r-1],t]:[s[d-1],s[d]]},o.unknown=function(l){return arguments.length&&(i=l),o},o.thresholds=function(){return s.slice()},o.copy=function(){return aw().domain([e,t]).range(n).unknown(i)},Jr.apply(Os(o),arguments)}function sw(){var e=[.5],t=[0,1],r,s=1;function n(i){return i!=null&&i<=i?t[ko(e,i,0,s)]:r}return n.domain=function(i){return arguments.length?(e=Array.from(i),s=Math.min(e.length,t.length-1),n):e.slice()},n.range=function(i){return arguments.length?(t=Array.from(i),s=Math.min(e.length,t.length-1),n):t.slice()},n.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},n.unknown=function(i){return arguments.length?(r=i,n):r},n.copy=function(){return sw().domain(e).range(t).unknown(r)},Jr.apply(n,arguments)}const od=new Date,cd=new Date;function Ht(e,t,r,s){function n(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return n.floor=i=>(e(i=new Date(+i)),i),n.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),n.round=i=>{const o=n(i),c=n.ceil(i);return i-o<c-i?o:c},n.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),n.range=(i,o,c)=>{const l=[];if(i=n.ceil(i),c=c==null?1:Math.floor(c),!(i<o)||!(c>0))return l;let d;do l.push(d=new Date(+i)),t(i,c),e(i);while(d<i&&i<o);return l},n.filter=i=>Ht(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;t(o,-1),!i(o););else for(;--c>=0;)for(;t(o,1),!i(o););}),r&&(n.count=(i,o)=>(od.setTime(+i),cd.setTime(+o),e(od),e(cd),Math.floor(r(od,cd))),n.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?n.filter(s?o=>s(o)%i===0:o=>n.count(0,o)%i===0):n)),n}const Hc=Ht(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Hc.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ht(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Hc);Hc.range;const Va=1e3,zr=Va*60,Ha=zr*60,Za=Ha*24,Of=Za*7,i0=Za*30,ld=Za*365,Vs=Ht(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Va)},(e,t)=>(t-e)/Va,e=>e.getUTCSeconds());Vs.range;const Pf=Ht(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Va)},(e,t)=>{e.setTime(+e+t*zr)},(e,t)=>(t-e)/zr,e=>e.getMinutes());Pf.range;const Df=Ht(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*zr)},(e,t)=>(t-e)/zr,e=>e.getUTCMinutes());Df.range;const Lf=Ht(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Va-e.getMinutes()*zr)},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getHours());Lf.range;const Ff=Ht(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ha)},(e,t)=>(t-e)/Ha,e=>e.getUTCHours());Ff.range;const Oo=Ht(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*zr)/Za,e=>e.getDate()-1);Oo.range;const wl=Ht(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Za,e=>e.getUTCDate()-1);wl.range;const nw=Ht(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Za,e=>Math.floor(e/Za));nw.range;function wn(e){return Ht(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*zr)/Of)}const _l=wn(0),qc=wn(1),t$=wn(2),r$=wn(3),Jn=wn(4),a$=wn(5),s$=wn(6);_l.range;qc.range;t$.range;r$.range;Jn.range;a$.range;s$.range;function _n(e){return Ht(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Of)}const bl=_n(0),Wc=_n(1),n$=_n(2),i$=_n(3),Zn=_n(4),o$=_n(5),c$=_n(6);bl.range;Wc.range;n$.range;i$.range;Zn.range;o$.range;c$.range;const Mf=Ht(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Mf.range;const Uf=Ht(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Uf.range;const es=Ht(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());es.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ht(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});es.range;const ts=Ht(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ts.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ht(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ts.range;function iw(e,t,r,s,n,i){const o=[[Vs,1,Va],[Vs,5,5*Va],[Vs,15,15*Va],[Vs,30,30*Va],[i,1,zr],[i,5,5*zr],[i,15,15*zr],[i,30,30*zr],[n,1,Ha],[n,3,3*Ha],[n,6,6*Ha],[n,12,12*Ha],[s,1,Za],[s,2,2*Za],[r,1,Of],[t,1,i0],[t,3,3*i0],[e,1,ld]];function c(d,u,f){const h=u<d;h&&([d,u]=[u,d]);const m=f&&typeof f.range=="function"?f:l(d,u,f),g=m?m.range(d,+u+1):[];return h?g.reverse():g}function l(d,u,f){const h=Math.abs(u-d)/f,m=wf(([,,x])=>x).right(o,h);if(m===o.length)return e.every(Qd(d/ld,u/ld,f));if(m===0)return Hc.every(Math.max(Qd(d,u,f),1));const[g,p]=o[h/o[m-1][2]<o[m][2]/h?m-1:m];return g.every(p)}return[c,l]}const[l$,d$]=iw(ts,Uf,bl,nw,Ff,Df),[u$,f$]=iw(es,Mf,_l,Oo,Lf,Pf);function dd(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function ud(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Si(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function h$(e){var t=e.dateTime,r=e.date,s=e.time,n=e.periods,i=e.days,o=e.shortDays,c=e.months,l=e.shortMonths,d=Ai(n),u=Ci(n),f=Ai(i),h=Ci(i),m=Ai(o),g=Ci(o),p=Ai(c),x=Ci(c),y=Ai(l),w=Ci(l),v={a:W,A:J,b:F,B:te,c:null,d:f0,e:f0,f:L$,g:W$,G:Y$,H:O$,I:P$,j:D$,L:ow,m:F$,M:M$,p:fe,q:R,Q:p0,s:g0,S:U$,u:$$,U:B$,V:G$,w:V$,W:H$,x:null,X:null,y:q$,Y:z$,Z:K$,"%":m0},j={a:G,A:P,b:C,B:K,c:null,d:h0,e:h0,f:Z$,g:lB,G:uB,H:X$,I:Q$,j:J$,L:lw,m:eB,M:tB,p:D,q:Q,Q:p0,s:g0,S:rB,u:aB,U:sB,V:nB,w:iB,W:oB,x:null,X:null,y:cB,Y:dB,Z:fB,"%":m0},S={a:O,A,b:E,B:U,c:Y,d:d0,e:d0,f:C$,g:l0,G:c0,H:u0,I:u0,j:T$,L:A$,m:j$,M:E$,p:b,q:N$,Q:R$,s:I$,S:S$,u:v$,U:y$,V:w$,w:x$,W:_$,x:ee,X:se,y:l0,Y:c0,Z:b$,"%":k$};v.x=_(r,v),v.X=_(s,v),v.c=_(t,v),j.x=_(r,j),j.X=_(s,j),j.c=_(t,j);function _(z,X){return function(ne){var k=[],Ce=-1,_e=0,me=z.length,pe,ue,je;for(ne instanceof Date||(ne=new Date(+ne));++Ce<me;)z.charCodeAt(Ce)===37&&(k.push(z.slice(_e,Ce)),(ue=o0[pe=z.charAt(++Ce)])!=null?pe=z.charAt(++Ce):ue=pe==="e"?" ":"0",(je=X[pe])&&(pe=je(ne,ue)),k.push(pe),_e=Ce+1);return k.push(z.slice(_e,Ce)),k.join("")}}function T(z,X){return function(ne){var k=Si(1900,void 0,1),Ce=N(k,z,ne+="",0),_e,me;if(Ce!=ne.length)return null;if("Q"in k)return new Date(k.Q);if("s"in k)return new Date(k.s*1e3+("L"in k?k.L:0));if(X&&!("Z"in k)&&(k.Z=0),"p"in k&&(k.H=k.H%12+k.p*12),k.m===void 0&&(k.m="q"in k?k.q:0),"V"in k){if(k.V<1||k.V>53)return null;"w"in k||(k.w=1),"Z"in k?(_e=ud(Si(k.y,0,1)),me=_e.getUTCDay(),_e=me>4||me===0?Wc.ceil(_e):Wc(_e),_e=wl.offset(_e,(k.V-1)*7),k.y=_e.getUTCFullYear(),k.m=_e.getUTCMonth(),k.d=_e.getUTCDate()+(k.w+6)%7):(_e=dd(Si(k.y,0,1)),me=_e.getDay(),_e=me>4||me===0?qc.ceil(_e):qc(_e),_e=Oo.offset(_e,(k.V-1)*7),k.y=_e.getFullYear(),k.m=_e.getMonth(),k.d=_e.getDate()+(k.w+6)%7)}else("W"in k||"U"in k)&&("w"in k||(k.w="u"in k?k.u%7:"W"in k?1:0),me="Z"in k?ud(Si(k.y,0,1)).getUTCDay():dd(Si(k.y,0,1)).getDay(),k.m=0,k.d="W"in k?(k.w+6)%7+k.W*7-(me+5)%7:k.w+k.U*7-(me+6)%7);return"Z"in k?(k.H+=k.Z/100|0,k.M+=k.Z%100,ud(k)):dd(k)}}function N(z,X,ne,k){for(var Ce=0,_e=X.length,me=ne.length,pe,ue;Ce<_e;){if(k>=me)return-1;if(pe=X.charCodeAt(Ce++),pe===37){if(pe=X.charAt(Ce++),ue=S[pe in o0?X.charAt(Ce++):pe],!ue||(k=ue(z,ne,k))<0)return-1}else if(pe!=ne.charCodeAt(k++))return-1}return k}function b(z,X,ne){var k=d.exec(X.slice(ne));return k?(z.p=u.get(k[0].toLowerCase()),ne+k[0].length):-1}function O(z,X,ne){var k=m.exec(X.slice(ne));return k?(z.w=g.get(k[0].toLowerCase()),ne+k[0].length):-1}function A(z,X,ne){var k=f.exec(X.slice(ne));return k?(z.w=h.get(k[0].toLowerCase()),ne+k[0].length):-1}function E(z,X,ne){var k=y.exec(X.slice(ne));return k?(z.m=w.get(k[0].toLowerCase()),ne+k[0].length):-1}function U(z,X,ne){var k=p.exec(X.slice(ne));return k?(z.m=x.get(k[0].toLowerCase()),ne+k[0].length):-1}function Y(z,X,ne){return N(z,t,X,ne)}function ee(z,X,ne){return N(z,r,X,ne)}function se(z,X,ne){return N(z,s,X,ne)}function W(z){return o[z.getDay()]}function J(z){return i[z.getDay()]}function F(z){return l[z.getMonth()]}function te(z){return c[z.getMonth()]}function fe(z){return n[+(z.getHours()>=12)]}function R(z){return 1+~~(z.getMonth()/3)}function G(z){return o[z.getUTCDay()]}function P(z){return i[z.getUTCDay()]}function C(z){return l[z.getUTCMonth()]}function K(z){return c[z.getUTCMonth()]}function D(z){return n[+(z.getUTCHours()>=12)]}function Q(z){return 1+~~(z.getUTCMonth()/3)}return{format:function(z){var X=_(z+="",v);return X.toString=function(){return z},X},parse:function(z){var X=T(z+="",!1);return X.toString=function(){return z},X},utcFormat:function(z){var X=_(z+="",j);return X.toString=function(){return z},X},utcParse:function(z){var X=T(z+="",!0);return X.toString=function(){return z},X}}}var o0={"-":"",_:" ",0:"0"},Kt=/^\s*\d+/,m$=/^%/,p$=/[\\^$*+?|[\]().{}]/g;function et(e,t,r){var s=e<0?"-":"",n=(s?-e:e)+"",i=n.length;return s+(i<r?new Array(r-i+1).join(t)+n:n)}function g$(e){return e.replace(p$,"\\$&")}function Ai(e){return new RegExp("^(?:"+e.map(g$).join("|")+")","i")}function Ci(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function x$(e,t,r){var s=Kt.exec(t.slice(r,r+1));return s?(e.w=+s[0],r+s[0].length):-1}function v$(e,t,r){var s=Kt.exec(t.slice(r,r+1));return s?(e.u=+s[0],r+s[0].length):-1}function y$(e,t,r){var s=Kt.exec(t.slice(r,r+2));return s?(e.U=+s[0],r+s[0].length):-1}function w$(e,t,r){var s=Kt.exec(t.slice(r,r+2));return s?(e.V=+s[0],r+s[0].length):-1}function _$(e,t,r){var s=Kt.exec(t.slice(r,r+2));return s?(e.W=+s[0],r+s[0].length):-1}function c0(e,t,r){var s=Kt.exec(t.slice(r,r+4));return s?(e.y=+s[0],r+s[0].length):-1}function l0(e,t,r){var s=Kt.exec(t.slice(r,r+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),r+s[0].length):-1}function b$(e,t,r){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),r+s[0].length):-1}function N$(e,t,r){var s=Kt.exec(t.slice(r,r+1));return s?(e.q=s[0]*3-3,r+s[0].length):-1}function j$(e,t,r){var s=Kt.exec(t.slice(r,r+2));return s?(e.m=s[0]-1,r+s[0].length):-1}function d0(e,t,r){var s=Kt.exec(t.slice(r,r+2));return s?(e.d=+s[0],r+s[0].length):-1}function T$(e,t,r){var s=Kt.exec(t.slice(r,r+3));return s?(e.m=0,e.d=+s[0],r+s[0].length):-1}function u0(e,t,r){var s=Kt.exec(t.slice(r,r+2));return s?(e.H=+s[0],r+s[0].length):-1}function E$(e,t,r){var s=Kt.exec(t.slice(r,r+2));return s?(e.M=+s[0],r+s[0].length):-1}function S$(e,t,r){var s=Kt.exec(t.slice(r,r+2));return s?(e.S=+s[0],r+s[0].length):-1}function A$(e,t,r){var s=Kt.exec(t.slice(r,r+3));return s?(e.L=+s[0],r+s[0].length):-1}function C$(e,t,r){var s=Kt.exec(t.slice(r,r+6));return s?(e.L=Math.floor(s[0]/1e3),r+s[0].length):-1}function k$(e,t,r){var s=m$.exec(t.slice(r,r+1));return s?r+s[0].length:-1}function R$(e,t,r){var s=Kt.exec(t.slice(r));return s?(e.Q=+s[0],r+s[0].length):-1}function I$(e,t,r){var s=Kt.exec(t.slice(r));return s?(e.s=+s[0],r+s[0].length):-1}function f0(e,t){return et(e.getDate(),t,2)}function O$(e,t){return et(e.getHours(),t,2)}function P$(e,t){return et(e.getHours()%12||12,t,2)}function D$(e,t){return et(1+Oo.count(es(e),e),t,3)}function ow(e,t){return et(e.getMilliseconds(),t,3)}function L$(e,t){return ow(e,t)+"000"}function F$(e,t){return et(e.getMonth()+1,t,2)}function M$(e,t){return et(e.getMinutes(),t,2)}function U$(e,t){return et(e.getSeconds(),t,2)}function $$(e){var t=e.getDay();return t===0?7:t}function B$(e,t){return et(_l.count(es(e)-1,e),t,2)}function cw(e){var t=e.getDay();return t>=4||t===0?Jn(e):Jn.ceil(e)}function G$(e,t){return e=cw(e),et(Jn.count(es(e),e)+(es(e).getDay()===4),t,2)}function V$(e){return e.getDay()}function H$(e,t){return et(qc.count(es(e)-1,e),t,2)}function q$(e,t){return et(e.getFullYear()%100,t,2)}function W$(e,t){return e=cw(e),et(e.getFullYear()%100,t,2)}function z$(e,t){return et(e.getFullYear()%1e4,t,4)}function Y$(e,t){var r=e.getDay();return e=r>=4||r===0?Jn(e):Jn.ceil(e),et(e.getFullYear()%1e4,t,4)}function K$(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+et(t/60|0,"0",2)+et(t%60,"0",2)}function h0(e,t){return et(e.getUTCDate(),t,2)}function X$(e,t){return et(e.getUTCHours(),t,2)}function Q$(e,t){return et(e.getUTCHours()%12||12,t,2)}function J$(e,t){return et(1+wl.count(ts(e),e),t,3)}function lw(e,t){return et(e.getUTCMilliseconds(),t,3)}function Z$(e,t){return lw(e,t)+"000"}function eB(e,t){return et(e.getUTCMonth()+1,t,2)}function tB(e,t){return et(e.getUTCMinutes(),t,2)}function rB(e,t){return et(e.getUTCSeconds(),t,2)}function aB(e){var t=e.getUTCDay();return t===0?7:t}function sB(e,t){return et(bl.count(ts(e)-1,e),t,2)}function dw(e){var t=e.getUTCDay();return t>=4||t===0?Zn(e):Zn.ceil(e)}function nB(e,t){return e=dw(e),et(Zn.count(ts(e),e)+(ts(e).getUTCDay()===4),t,2)}function iB(e){return e.getUTCDay()}function oB(e,t){return et(Wc.count(ts(e)-1,e),t,2)}function cB(e,t){return et(e.getUTCFullYear()%100,t,2)}function lB(e,t){return e=dw(e),et(e.getUTCFullYear()%100,t,2)}function dB(e,t){return et(e.getUTCFullYear()%1e4,t,4)}function uB(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Zn(e):Zn.ceil(e),et(e.getUTCFullYear()%1e4,t,4)}function fB(){return"+0000"}function m0(){return"%"}function p0(e){return+e}function g0(e){return Math.floor(+e/1e3)}var En,uw,fw;hB({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function hB(e){return En=h$(e),uw=En.format,En.parse,fw=En.utcFormat,En.utcParse,En}function mB(e){return new Date(e)}function pB(e){return e instanceof Date?+e:+new Date(+e)}function $f(e,t,r,s,n,i,o,c,l,d){var u=Ef(),f=u.invert,h=u.domain,m=d(".%L"),g=d(":%S"),p=d("%I:%M"),x=d("%I %p"),y=d("%a %d"),w=d("%b %d"),v=d("%B"),j=d("%Y");function S(_){return(l(_)<_?m:c(_)<_?g:o(_)<_?p:i(_)<_?x:s(_)<_?n(_)<_?y:w:r(_)<_?v:j)(_)}return u.invert=function(_){return new Date(f(_))},u.domain=function(_){return arguments.length?h(Array.from(_,pB)):h().map(mB)},u.ticks=function(_){var T=h();return e(T[0],T[T.length-1],_??10)},u.tickFormat=function(_,T){return T==null?S:d(T)},u.nice=function(_){var T=h();return(!_||typeof _.range!="function")&&(_=t(T[0],T[T.length-1],_??10)),_?h(Jy(T,_)):u},u.copy=function(){return Io(u,$f(e,t,r,s,n,i,o,c,l,d))},u}function gB(){return Jr.apply($f(u$,f$,es,Mf,_l,Oo,Lf,Pf,Vs,uw).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function xB(){return Jr.apply($f(l$,d$,ts,Uf,bl,wl,Ff,Df,Vs,fw).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Nl(){var e=0,t=1,r,s,n,i,o=vr,c=!1,l;function d(f){return f==null||isNaN(f=+f)?l:o(n===0?.5:(f=(i(f)-r)*n,c?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),s=i(t=+t),n=r===s?0:1/(s-r),d):[e,t]},d.clamp=function(f){return arguments.length?(c=!!f,d):c},d.interpolator=function(f){return arguments.length?(o=f,d):o};function u(f){return function(h){var m,g;return arguments.length?([m,g]=h,o=f(m,g),d):[o(0),o(1)]}}return d.range=u(mi),d.rangeRound=u(Tf),d.unknown=function(f){return arguments.length?(l=f,d):l},function(f){return i=f,r=f(e),s=f(t),n=r===s?0:1/(s-r),d}}function Ps(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function hw(){var e=Os(Nl()(vr));return e.copy=function(){return Ps(e,hw())},is.apply(e,arguments)}function mw(){var e=Cf(Nl()).domain([1,10]);return e.copy=function(){return Ps(e,mw()).base(e.base())},is.apply(e,arguments)}function pw(){var e=kf(Nl());return e.copy=function(){return Ps(e,pw()).constant(e.constant())},is.apply(e,arguments)}function Bf(){var e=Rf(Nl());return e.copy=function(){return Ps(e,Bf()).exponent(e.exponent())},is.apply(e,arguments)}function vB(){return Bf.apply(null,arguments).exponent(.5)}function gw(){var e=[],t=vr;function r(s){if(s!=null&&!isNaN(s=+s))return t((ko(e,s,1)-1)/(e.length-1))}return r.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let n of s)n!=null&&!isNaN(n=+n)&&e.push(n);return e.sort(bs),r},r.interpolator=function(s){return arguments.length?(t=s,r):t},r.range=function(){return e.map((s,n)=>t(n/(e.length-1)))},r.quantiles=function(s){return Array.from({length:s+1},(n,i)=>aU(e,i/s))},r.copy=function(){return gw(t).domain(e)},is.apply(r,arguments)}function jl(){var e=0,t=.5,r=1,s=1,n,i,o,c,l,d=vr,u,f=!1,h;function m(p){return isNaN(p=+p)?h:(p=.5+((p=+u(p))-i)*(s*p<s*i?c:l),d(f?Math.max(0,Math.min(1,p)):p))}m.domain=function(p){return arguments.length?([e,t,r]=p,n=u(e=+e),i=u(t=+t),o=u(r=+r),c=n===i?0:.5/(i-n),l=i===o?0:.5/(o-i),s=i<n?-1:1,m):[e,t,r]},m.clamp=function(p){return arguments.length?(f=!!p,m):f},m.interpolator=function(p){return arguments.length?(d=p,m):d};function g(p){return function(x){var y,w,v;return arguments.length?([y,w,v]=x,d=kU(p,[y,w,v]),m):[d(0),d(.5),d(1)]}}return m.range=g(mi),m.rangeRound=g(Tf),m.unknown=function(p){return arguments.length?(h=p,m):h},function(p){return u=p,n=p(e),i=p(t),o=p(r),c=n===i?0:.5/(i-n),l=i===o?0:.5/(o-i),s=i<n?-1:1,m}}function xw(){var e=Os(jl()(vr));return e.copy=function(){return Ps(e,xw())},is.apply(e,arguments)}function vw(){var e=Cf(jl()).domain([.1,1,10]);return e.copy=function(){return Ps(e,vw()).base(e.base())},is.apply(e,arguments)}function yw(){var e=kf(jl());return e.copy=function(){return Ps(e,yw()).constant(e.constant())},is.apply(e,arguments)}function Gf(){var e=Rf(jl());return e.copy=function(){return Ps(e,Gf()).exponent(e.exponent())},is.apply(e,arguments)}function yB(){return Gf.apply(null,arguments).exponent(.5)}const NW=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:bf,scaleDiverging:xw,scaleDivergingLog:vw,scaleDivergingPow:Gf,scaleDivergingSqrt:yB,scaleDivergingSymlog:yw,scaleIdentity:Qy,scaleImplicit:Jd,scaleLinear:Xy,scaleLog:Zy,scaleOrdinal:_f,scalePoint:iU,scalePow:If,scaleQuantile:rw,scaleQuantize:aw,scaleRadial:tw,scaleSequential:hw,scaleSequentialLog:mw,scaleSequentialPow:Bf,scaleSequentialQuantile:gw,scaleSequentialSqrt:vB,scaleSequentialSymlog:pw,scaleSqrt:ZU,scaleSymlog:ew,scaleThreshold:sw,scaleTime:gB,scaleUtc:xB,tickFormat:Ky},Symbol.toStringTag,{value:"Module"}));var wB=oi;function _B(e,t,r){for(var s=-1,n=e.length;++s<n;){var i=e[s],o=t(i);if(o!=null&&(c===void 0?o===o&&!wB(o):r(o,c)))var c=o,l=i}return l}var Tl=_B;function bB(e,t){return e>t}var ww=bB,NB=Tl,jB=ww,TB=hi;function EB(e){return e&&e.length?NB(e,TB,jB):void 0}var SB=EB;const jW=nt(SB);function AB(e,t){return e<t}var _w=AB,CB=Tl,kB=_w,RB=hi;function IB(e){return e&&e.length?CB(e,RB,kB):void 0}var OB=IB;const TW=nt(OB);var PB=df,DB=Da,LB=Fy,FB=Tr;function MB(e,t){var r=FB(e)?PB:LB;return r(e,DB(t))}var UB=MB,$B=Dy,BB=UB;function GB(e,t){return $B(BB(e,t),1)}var VB=GB;const EW=nt(VB);var HB=vf;function qB(e,t){return HB(e,t)}var WB=qB;const SW=nt(WB);var pi=1e9,zB={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Hf,Et=!0,Xr="[DecimalError] ",en=Xr+"Invalid argument: ",Vf=Xr+"Exponent out of range: ",gi=Math.floor,Us=Math.pow,YB=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ir,zt=1e7,_t=7,bw=9007199254740991,zc=gi(bw/_t),Re={};Re.absoluteValue=Re.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Re.comparedTo=Re.cmp=function(e){var t,r,s,n,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(s=i.d.length,n=e.d.length,t=0,r=s<n?s:n;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return s===n?0:s>n^i.s<0?1:-1};Re.decimalPlaces=Re.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*_t;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Re.dividedBy=Re.div=function(e){return Ya(this,new this.constructor(e))};Re.dividedToIntegerBy=Re.idiv=function(e){var t=this,r=t.constructor;return dt(Ya(t,new r(e),0,1),r.precision)};Re.equals=Re.eq=function(e){return!this.cmp(e)};Re.exponent=function(){return Ut(this)};Re.greaterThan=Re.gt=function(e){return this.cmp(e)>0};Re.greaterThanOrEqualTo=Re.gte=function(e){return this.cmp(e)>=0};Re.isInteger=Re.isint=function(){return this.e>this.d.length-2};Re.isNegative=Re.isneg=function(){return this.s<0};Re.isPositive=Re.ispos=function(){return this.s>0};Re.isZero=function(){return this.s===0};Re.lessThan=Re.lt=function(e){return this.cmp(e)<0};Re.lessThanOrEqualTo=Re.lte=function(e){return this.cmp(e)<1};Re.logarithm=Re.log=function(e){var t,r=this,s=r.constructor,n=s.precision,i=n+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(Ir))throw Error(Xr+"NaN");if(r.s<1)throw Error(Xr+(r.s?"NaN":"-Infinity"));return r.eq(Ir)?new s(0):(Et=!1,t=Ya(go(r,i),go(e,i),i),Et=!0,dt(t,n))};Re.minus=Re.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Tw(t,e):Nw(t,(e.s=-e.s,e))};Re.modulo=Re.mod=function(e){var t,r=this,s=r.constructor,n=s.precision;if(e=new s(e),!e.s)throw Error(Xr+"NaN");return r.s?(Et=!1,t=Ya(r,e,0,1).times(e),Et=!0,r.minus(t)):dt(new s(r),n)};Re.naturalExponential=Re.exp=function(){return jw(this)};Re.naturalLogarithm=Re.ln=function(){return go(this)};Re.negated=Re.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Re.plus=Re.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Nw(t,e):Tw(t,(e.s=-e.s,e))};Re.precision=Re.sd=function(e){var t,r,s,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(en+e);if(t=Ut(n)+1,s=n.d.length-1,r=s*_t+1,s=n.d[s],s){for(;s%10==0;s/=10)r--;for(s=n.d[0];s>=10;s/=10)r++}return e&&t>r?t:r};Re.squareRoot=Re.sqrt=function(){var e,t,r,s,n,i,o,c=this,l=c.constructor;if(c.s<1){if(!c.s)return new l(0);throw Error(Xr+"NaN")}for(e=Ut(c),Et=!1,n=Math.sqrt(+c),n==0||n==1/0?(t=ja(c.d),(t.length+e)%2==0&&(t+="0"),n=Math.sqrt(t),e=gi((e+1)/2)-(e<0||e%2),n==1/0?t="5e"+e:(t=n.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new l(t)):s=new l(n.toString()),r=l.precision,n=o=r+3;;)if(i=s,s=i.plus(Ya(c,i,o+2)).times(.5),ja(i.d).slice(0,o)===(t=ja(s.d)).slice(0,o)){if(t=t.slice(o-3,o+1),n==o&&t=="4999"){if(dt(i,r+1,0),i.times(i).eq(c)){s=i;break}}else if(t!="9999")break;o+=4}return Et=!0,dt(s,r)};Re.times=Re.mul=function(e){var t,r,s,n,i,o,c,l,d,u=this,f=u.constructor,h=u.d,m=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,l=h.length,d=m.length,l<d&&(i=h,h=m,m=i,o=l,l=d,d=o),i=[],o=l+d,s=o;s--;)i.push(0);for(s=d;--s>=0;){for(t=0,n=l+s;n>s;)c=i[n]+m[s]*h[n-s-1]+t,i[n--]=c%zt|0,t=c/zt|0;i[n]=(i[n]+t)%zt|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Et?dt(e,f.precision):e};Re.toDecimalPlaces=Re.todp=function(e,t){var r=this,s=r.constructor;return r=new s(r),e===void 0?r:(ka(e,0,pi),t===void 0?t=s.rounding:ka(t,0,8),dt(r,e+Ut(r)+1,t))};Re.toExponential=function(e,t){var r,s=this,n=s.constructor;return e===void 0?r=cn(s,!0):(ka(e,0,pi),t===void 0?t=n.rounding:ka(t,0,8),s=dt(new n(s),e+1,t),r=cn(s,!0,e+1)),r};Re.toFixed=function(e,t){var r,s,n=this,i=n.constructor;return e===void 0?cn(n):(ka(e,0,pi),t===void 0?t=i.rounding:ka(t,0,8),s=dt(new i(n),e+Ut(n)+1,t),r=cn(s.abs(),!1,e+Ut(s)+1),n.isneg()&&!n.isZero()?"-"+r:r)};Re.toInteger=Re.toint=function(){var e=this,t=e.constructor;return dt(new t(e),Ut(e)+1,t.rounding)};Re.toNumber=function(){return+this};Re.toPower=Re.pow=function(e){var t,r,s,n,i,o,c=this,l=c.constructor,d=12,u=+(e=new l(e));if(!e.s)return new l(Ir);if(c=new l(c),!c.s){if(e.s<1)throw Error(Xr+"Infinity");return c}if(c.eq(Ir))return c;if(s=l.precision,e.eq(Ir))return dt(c,s);if(t=e.e,r=e.d.length-1,o=t>=r,i=c.s,o){if((r=u<0?-u:u)<=bw){for(n=new l(Ir),t=Math.ceil(s/_t+4),Et=!1;r%2&&(n=n.times(c),v0(n.d,t)),r=gi(r/2),r!==0;)c=c.times(c),v0(c.d,t);return Et=!0,e.s<0?new l(Ir).div(n):dt(n,s)}}else if(i<0)throw Error(Xr+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,c.s=1,Et=!1,n=e.times(go(c,s+d)),Et=!0,n=jw(n),n.s=i,n};Re.toPrecision=function(e,t){var r,s,n=this,i=n.constructor;return e===void 0?(r=Ut(n),s=cn(n,r<=i.toExpNeg||r>=i.toExpPos)):(ka(e,1,pi),t===void 0?t=i.rounding:ka(t,0,8),n=dt(new i(n),e,t),r=Ut(n),s=cn(n,e<=r||r<=i.toExpNeg,e)),s};Re.toSignificantDigits=Re.tosd=function(e,t){var r=this,s=r.constructor;return e===void 0?(e=s.precision,t=s.rounding):(ka(e,1,pi),t===void 0?t=s.rounding:ka(t,0,8)),dt(new s(r),e,t)};Re.toString=Re.valueOf=Re.val=Re.toJSON=Re[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ut(e),r=e.constructor;return cn(e,t<=r.toExpNeg||t>=r.toExpPos)};function Nw(e,t){var r,s,n,i,o,c,l,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Et?dt(t,f):t;if(l=e.d,d=t.d,o=e.e,n=t.e,l=l.slice(),i=o-n,i){for(i<0?(s=l,i=-i,c=d.length):(s=d,n=o,c=l.length),o=Math.ceil(f/_t),c=o>c?o+1:c+1,i>c&&(i=c,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(c=l.length,i=d.length,c-i<0&&(i=c,s=d,d=l,l=s),r=0;i;)r=(l[--i]=l[i]+d[i]+r)/zt|0,l[i]%=zt;for(r&&(l.unshift(r),++n),c=l.length;l[--c]==0;)l.pop();return t.d=l,t.e=n,Et?dt(t,f):t}function ka(e,t,r){if(e!==~~e||e<t||e>r)throw Error(en+e)}function ja(e){var t,r,s,n=e.length-1,i="",o=e[0];if(n>0){for(i+=o,t=1;t<n;t++)s=e[t]+"",r=_t-s.length,r&&(i+=ds(r)),i+=s;o=e[t],s=o+"",r=_t-s.length,r&&(i+=ds(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Ya=function(){function e(s,n){var i,o=0,c=s.length;for(s=s.slice();c--;)i=s[c]*n+o,s[c]=i%zt|0,o=i/zt|0;return o&&s.unshift(o),s}function t(s,n,i,o){var c,l;if(i!=o)l=i>o?1:-1;else for(c=l=0;c<i;c++)if(s[c]!=n[c]){l=s[c]>n[c]?1:-1;break}return l}function r(s,n,i){for(var o=0;i--;)s[i]-=o,o=s[i]<n[i]?1:0,s[i]=o*zt+s[i]-n[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,n,i,o){var c,l,d,u,f,h,m,g,p,x,y,w,v,j,S,_,T,N,b=s.constructor,O=s.s==n.s?1:-1,A=s.d,E=n.d;if(!s.s)return new b(s);if(!n.s)throw Error(Xr+"Division by zero");for(l=s.e-n.e,T=E.length,S=A.length,m=new b(O),g=m.d=[],d=0;E[d]==(A[d]||0);)++d;if(E[d]>(A[d]||0)&&--l,i==null?w=i=b.precision:o?w=i+(Ut(s)-Ut(n))+1:w=i,w<0)return new b(0);if(w=w/_t+2|0,d=0,T==1)for(u=0,E=E[0],w++;(d<S||u)&&w--;d++)v=u*zt+(A[d]||0),g[d]=v/E|0,u=v%E|0;else{for(u=zt/(E[0]+1)|0,u>1&&(E=e(E,u),A=e(A,u),T=E.length,S=A.length),j=T,p=A.slice(0,T),x=p.length;x<T;)p[x++]=0;N=E.slice(),N.unshift(0),_=E[0],E[1]>=zt/2&&++_;do u=0,c=t(E,p,T,x),c<0?(y=p[0],T!=x&&(y=y*zt+(p[1]||0)),u=y/_|0,u>1?(u>=zt&&(u=zt-1),f=e(E,u),h=f.length,x=p.length,c=t(f,p,h,x),c==1&&(u--,r(f,T<h?N:E,h))):(u==0&&(c=u=1),f=E.slice()),h=f.length,h<x&&f.unshift(0),r(p,f,x),c==-1&&(x=p.length,c=t(E,p,T,x),c<1&&(u++,r(p,T<x?N:E,x))),x=p.length):c===0&&(u++,p=[0]),g[d++]=u,c&&p[0]?p[x++]=A[j]||0:(p=[A[j]],x=1);while((j++<S||p[0]!==void 0)&&w--)}return g[0]||g.shift(),m.e=l,dt(m,o?i+Ut(m)+1:i)}}();function jw(e,t){var r,s,n,i,o,c,l=0,d=0,u=e.constructor,f=u.precision;if(Ut(e)>16)throw Error(Vf+Ut(e));if(!e.s)return new u(Ir);for(t==null?(Et=!1,c=f):c=t,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(s=Math.log(Us(2,d))/Math.LN10*2+5|0,c+=s,r=n=i=new u(Ir),u.precision=c;;){if(n=dt(n.times(e),c),r=r.times(++l),o=i.plus(Ya(n,r,c)),ja(o.d).slice(0,c)===ja(i.d).slice(0,c)){for(;d--;)i=dt(i.times(i),c);return u.precision=f,t==null?(Et=!0,dt(i,f)):i}i=o}}function Ut(e){for(var t=e.e*_t,r=e.d[0];r>=10;r/=10)t++;return t}function fd(e,t,r){if(t>e.LN10.sd())throw Et=!0,r&&(e.precision=r),Error(Xr+"LN10 precision limit exceeded");return dt(new e(e.LN10),t)}function ds(e){for(var t="";e--;)t+="0";return t}function go(e,t){var r,s,n,i,o,c,l,d,u,f=1,h=10,m=e,g=m.d,p=m.constructor,x=p.precision;if(m.s<1)throw Error(Xr+(m.s?"NaN":"-Infinity"));if(m.eq(Ir))return new p(0);if(t==null?(Et=!1,d=x):d=t,m.eq(10))return t==null&&(Et=!0),fd(p,d);if(d+=h,p.precision=d,r=ja(g),s=r.charAt(0),i=Ut(m),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&r.charAt(1)>3;)m=m.times(e),r=ja(m.d),s=r.charAt(0),f++;i=Ut(m),s>1?(m=new p("0."+r),i++):m=new p(s+"."+r.slice(1))}else return l=fd(p,d+2,x).times(i+""),m=go(new p(s+"."+r.slice(1)),d-h).plus(l),p.precision=x,t==null?(Et=!0,dt(m,x)):m;for(c=o=m=Ya(m.minus(Ir),m.plus(Ir),d),u=dt(m.times(m),d),n=3;;){if(o=dt(o.times(u),d),l=c.plus(Ya(o,new p(n),d)),ja(l.d).slice(0,d)===ja(c.d).slice(0,d))return c=c.times(2),i!==0&&(c=c.plus(fd(p,d+2,x).times(i+""))),c=Ya(c,new p(f),d),p.precision=x,t==null?(Et=!0,dt(c,x)):c;c=l,n+=2}}function x0(e,t){var r,s,n;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(r<0&&(r=s),r+=+t.slice(s+1),t=t.substring(0,s)):r<0&&(r=t.length),s=0;t.charCodeAt(s)===48;)++s;for(n=t.length;t.charCodeAt(n-1)===48;)--n;if(t=t.slice(s,n),t){if(n-=s,r=r-s-1,e.e=gi(r/_t),e.d=[],s=(r+1)%_t,r<0&&(s+=_t),s<n){for(s&&e.d.push(+t.slice(0,s)),n-=_t;s<n;)e.d.push(+t.slice(s,s+=_t));t=t.slice(s),s=_t-t.length}else s-=n;for(;s--;)t+="0";if(e.d.push(+t),Et&&(e.e>zc||e.e<-zc))throw Error(Vf+r)}else e.s=0,e.e=0,e.d=[0];return e}function dt(e,t,r){var s,n,i,o,c,l,d,u,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(s=t-o,s<0)s+=_t,n=t,d=f[u=0];else{if(u=Math.ceil((s+1)/_t),i=f.length,u>=i)return e;for(d=i=f[u],o=1;i>=10;i/=10)o++;s%=_t,n=s-_t+o}if(r!==void 0&&(i=Us(10,o-n-1),c=d/i%10|0,l=t<0||f[u+1]!==void 0||d%i,l=r<4?(c||l)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||l||r==6&&(s>0?n>0?d/Us(10,o-n):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return l?(i=Ut(e),f.length=1,t=t-i-1,f[0]=Us(10,(_t-t%_t)%_t),e.e=gi(-t/_t)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(s==0?(f.length=u,i=1,u--):(f.length=u+1,i=Us(10,_t-s),f[u]=n>0?(d/Us(10,o-n)%Us(10,n)|0)*i:0),l)for(;;)if(u==0){(f[0]+=i)==zt&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=zt)break;f[u--]=0,i=1}for(s=f.length;f[--s]===0;)f.pop();if(Et&&(e.e>zc||e.e<-zc))throw Error(Vf+Ut(e));return e}function Tw(e,t){var r,s,n,i,o,c,l,d,u,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Et?dt(t,m):t;if(l=e.d,f=t.d,s=t.e,d=e.e,l=l.slice(),o=d-s,o){for(u=o<0,u?(r=l,o=-o,c=f.length):(r=f,s=d,c=l.length),n=Math.max(Math.ceil(m/_t),c)+2,o>n&&(o=n,r.length=1),r.reverse(),n=o;n--;)r.push(0);r.reverse()}else{for(n=l.length,c=f.length,u=n<c,u&&(c=n),n=0;n<c;n++)if(l[n]!=f[n]){u=l[n]<f[n];break}o=0}for(u&&(r=l,l=f,f=r,t.s=-t.s),c=l.length,n=f.length-c;n>0;--n)l[c++]=0;for(n=f.length;n>o;){if(l[--n]<f[n]){for(i=n;i&&l[--i]===0;)l[i]=zt-1;--l[i],l[n]+=zt}l[n]-=f[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;l.shift())--s;return l[0]?(t.d=l,t.e=s,Et?dt(t,m):t):new h(0)}function cn(e,t,r){var s,n=Ut(e),i=ja(e.d),o=i.length;return t?(r&&(s=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+ds(s):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(n<0?"e":"e+")+n):n<0?(i="0."+ds(-n-1)+i,r&&(s=r-o)>0&&(i+=ds(s))):n>=o?(i+=ds(n+1-o),r&&(s=r-n-1)>0&&(i=i+"."+ds(s))):((s=n+1)<o&&(i=i.slice(0,s)+"."+i.slice(s)),r&&(s=r-o)>0&&(n+1===o&&(i+="."),i+=ds(s))),e.s<0?"-"+i:i}function v0(e,t){if(e.length>t)return e.length=t,!0}function Ew(e){var t,r,s;function n(i){var o=this;if(!(o instanceof n))return new n(i);if(o.constructor=n,i instanceof n){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(en+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return x0(o,i.toString())}else if(typeof i!="string")throw Error(en+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,YB.test(i))x0(o,i);else throw Error(en+i)}if(n.prototype=Re,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.clone=Ew,n.config=n.set=KB,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(r=s[t++])||(e[r]=this[r]);return n.config(e),n}function KB(e){if(!e||typeof e!="object")throw Error(Xr+"Object expected");var t,r,s,n=["precision",1,pi,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<n.length;t+=3)if((s=e[r=n[t]])!==void 0)if(gi(s)===s&&s>=n[t+1]&&s<=n[t+2])this[r]=s;else throw Error(en+r+": "+s);if((s=e[r="LN10"])!==void 0)if(s==Math.LN10)this[r]=new this(s);else throw Error(en+r+": "+s);return this}var Hf=Ew(zB);Ir=new Hf(1);const AW=Hf;var XB="Invariant failed";function CW(e,t){throw new Error(XB)}function QB(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var JB=QB;const kW=nt(JB);var Sw={exports:{}},ZB="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",eG=ZB,tG=eG;function Aw(){}function Cw(){}Cw.resetWarningCache=Aw;var rG=function(){function e(s,n,i,o,c,l){if(l!==tG){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Cw,resetWarningCache:Aw};return r.PropTypes=r,r};Sw.exports=rG();var aG=Sw.exports;const RW=nt(aG);var sG=Object.getOwnPropertyNames,nG=Object.getOwnPropertySymbols,iG=Object.prototype.hasOwnProperty;function y0(e,t){return function(s,n,i){return e(s,n,i)&&t(s,n,i)}}function tc(e){return function(r,s,n){if(!r||!s||typeof r!="object"||typeof s!="object")return e(r,s,n);var i=n.cache,o=i.get(r),c=i.get(s);if(o&&c)return o===s&&c===r;i.set(r,s),i.set(s,r);var l=e(r,s,n);return i.delete(r),i.delete(s),l}}function w0(e){return sG(e).concat(nG(e))}var oG=Object.hasOwn||function(e,t){return iG.call(e,t)};function bn(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var cG="__v",lG="__o",dG="_owner",_0=Object.getOwnPropertyDescriptor,b0=Object.keys;function uG(e,t,r){var s=e.length;if(t.length!==s)return!1;for(;s-- >0;)if(!r.equals(e[s],t[s],s,s,e,t,r))return!1;return!0}function fG(e,t){return bn(e.getTime(),t.getTime())}function hG(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function mG(e,t){return e===t}function N0(e,t,r){var s=e.size;if(s!==t.size)return!1;if(!s)return!0;for(var n=new Array(s),i=e.entries(),o,c,l=0;(o=i.next())&&!o.done;){for(var d=t.entries(),u=!1,f=0;(c=d.next())&&!c.done;){if(n[f]){f++;continue}var h=o.value,m=c.value;if(r.equals(h[0],m[0],l,f,e,t,r)&&r.equals(h[1],m[1],h[0],m[0],e,t,r)){u=n[f]=!0;break}f++}if(!u)return!1;l++}return!0}var pG=bn;function gG(e,t,r){var s=b0(e),n=s.length;if(b0(t).length!==n)return!1;for(;n-- >0;)if(!kw(e,t,r,s[n]))return!1;return!0}function ki(e,t,r){var s=w0(e),n=s.length;if(w0(t).length!==n)return!1;for(var i,o,c;n-- >0;)if(i=s[n],!kw(e,t,r,i)||(o=_0(e,i),c=_0(t,i),(o||c)&&(!o||!c||o.configurable!==c.configurable||o.enumerable!==c.enumerable||o.writable!==c.writable)))return!1;return!0}function xG(e,t){return bn(e.valueOf(),t.valueOf())}function vG(e,t){return e.source===t.source&&e.flags===t.flags}function j0(e,t,r){var s=e.size;if(s!==t.size)return!1;if(!s)return!0;for(var n=new Array(s),i=e.values(),o,c;(o=i.next())&&!o.done;){for(var l=t.values(),d=!1,u=0;(c=l.next())&&!c.done;){if(!n[u]&&r.equals(o.value,c.value,o.value,c.value,e,t,r)){d=n[u]=!0;break}u++}if(!d)return!1}return!0}function yG(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function wG(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function kw(e,t,r,s){return(s===dG||s===lG||s===cG)&&(e.$$typeof||t.$$typeof)?!0:oG(t,s)&&r.equals(e[s],t[s],s,s,e,t,r)}var _G="[object Arguments]",bG="[object Boolean]",NG="[object Date]",jG="[object Error]",TG="[object Map]",EG="[object Number]",SG="[object Object]",AG="[object RegExp]",CG="[object Set]",kG="[object String]",RG="[object URL]",IG=Array.isArray,T0=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,E0=Object.assign,OG=Object.prototype.toString.call.bind(Object.prototype.toString);function PG(e){var t=e.areArraysEqual,r=e.areDatesEqual,s=e.areErrorsEqual,n=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,c=e.areObjectsEqual,l=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(g,p,x){if(g===p)return!0;if(g==null||p==null)return!1;var y=typeof g;if(y!==typeof p)return!1;if(y!=="object")return y==="number"?o(g,p,x):y==="function"?n(g,p,x):!1;var w=g.constructor;if(w!==p.constructor)return!1;if(w===Object)return c(g,p,x);if(IG(g))return t(g,p,x);if(T0!=null&&T0(g))return f(g,p,x);if(w===Date)return r(g,p,x);if(w===RegExp)return d(g,p,x);if(w===Map)return i(g,p,x);if(w===Set)return u(g,p,x);var v=OG(g);return v===NG?r(g,p,x):v===AG?d(g,p,x):v===TG?i(g,p,x):v===CG?u(g,p,x):v===SG?typeof g.then!="function"&&typeof p.then!="function"&&c(g,p,x):v===RG?h(g,p,x):v===jG?s(g,p,x):v===_G?c(g,p,x):v===bG||v===EG||v===kG?l(g,p,x):!1}}function DG(e){var t=e.circular,r=e.createCustomConfig,s=e.strict,n={areArraysEqual:s?ki:uG,areDatesEqual:fG,areErrorsEqual:hG,areFunctionsEqual:mG,areMapsEqual:s?y0(N0,ki):N0,areNumbersEqual:pG,areObjectsEqual:s?ki:gG,arePrimitiveWrappersEqual:xG,areRegExpsEqual:vG,areSetsEqual:s?y0(j0,ki):j0,areTypedArraysEqual:s?ki:yG,areUrlsEqual:wG};if(r&&(n=E0({},n,r(n))),t){var i=tc(n.areArraysEqual),o=tc(n.areMapsEqual),c=tc(n.areObjectsEqual),l=tc(n.areSetsEqual);n=E0({},n,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:c,areSetsEqual:l})}return n}function LG(e){return function(t,r,s,n,i,o,c){return e(t,r,c)}}function FG(e){var t=e.circular,r=e.comparator,s=e.createState,n=e.equals,i=e.strict;if(s)return function(l,d){var u=s(),f=u.cache,h=f===void 0?t?new WeakMap:void 0:f,m=u.meta;return r(l,d,{cache:h,equals:n,meta:m,strict:i})};if(t)return function(l,d){return r(l,d,{cache:new WeakMap,equals:n,meta:void 0,strict:i})};var o={cache:void 0,equals:n,meta:void 0,strict:i};return function(l,d){return r(l,d,o)}}var IW=Ds();Ds({strict:!0});Ds({circular:!0});Ds({circular:!0,strict:!0});Ds({createInternalComparator:function(){return bn}});Ds({strict:!0,createInternalComparator:function(){return bn}});Ds({circular:!0,createInternalComparator:function(){return bn}});Ds({circular:!0,createInternalComparator:function(){return bn},strict:!0});function Ds(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,s=e.createInternalComparator,n=e.createState,i=e.strict,o=i===void 0?!1:i,c=DG(e),l=PG(c),d=s?s(l):LG(l);return FG({circular:r,comparator:l,createState:n,equals:d,strict:o})}var MG=Tl,UG=ww,$G=Da;function BG(e,t){return e&&e.length?MG(e,$G(t),UG):void 0}var GG=BG;const OW=nt(GG);var VG=Tl,HG=Da,qG=_w;function WG(e,t){return e&&e.length?VG(e,HG(t),qG):void 0}var zG=WG;const PW=nt(zG);var YG=Sy,KG=YG(Object.getPrototypeOf,Object),XG=KG,QG=ss,JG=XG,ZG=ns,eV="[object Object]",tV=Function.prototype,rV=Object.prototype,Rw=tV.toString,aV=rV.hasOwnProperty,sV=Rw.call(Object);function nV(e){if(!ZG(e)||QG(e)!=eV)return!1;var t=JG(e);if(t===null)return!0;var r=aV.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Rw.call(r)==sV}var iV=nV;const DW=nt(iV);var oV=ss,cV=ns,lV="[object Boolean]";function dV(e){return e===!0||e===!1||cV(e)&&oV(e)==lV}var uV=dV;const LW=nt(uV);var fV=Math.ceil,hV=Math.max;function mV(e,t,r,s){for(var n=-1,i=hV(fV((t-e)/(r||1)),0),o=Array(i);i--;)o[s?i:++n]=e,e+=r;return o}var pV=mV,gV=Uy,S0=1/0,xV=17976931348623157e292;function vV(e){if(!e)return e===0?e:0;if(e=gV(e),e===S0||e===-S0){var t=e<0?-1:1;return t*xV}return e===e?e:0}var Iw=vV,yV=pV,wV=vl,hd=Iw;function _V(e){return function(t,r,s){return s&&typeof s!="number"&&wV(t,r,s)&&(r=s=void 0),t=hd(t),r===void 0?(r=t,t=0):r=hd(r),s=s===void 0?t<r?1:-1:hd(s),yV(t,r,s,e)}}var bV=_V,NV=bV,jV=NV(),TV=jV;const FW=nt(TV);var EV=yf;function SV(e,t){var r;return EV(e,function(s,n,i){return r=t(s,n,i),!r}),!!r}var AV=SV,CV=yy,kV=Da,RV=AV,IV=Tr,OV=vl;function PV(e,t,r){var s=IV(e)?CV:RV;return r&&OV(e,t,r)&&(t=void 0),s(e,kV(t))}var DV=PV;const MW=nt(DV);var A0=My;function LV(e,t,r){t=="__proto__"&&A0?A0(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var FV=LV,MV=FV,UV=Ly,$V=Da;function BV(e,t){var r={};return t=$V(t),UV(e,function(s,n,i){MV(r,n,t(s,n,i))}),r}var GV=BV;const UW=nt(GV);function VV(e,t){for(var r=-1,s=e==null?0:e.length;++r<s;)if(!t(e[r],r,e))return!1;return!0}var HV=VV,qV=yf;function WV(e,t){var r=!0;return qV(e,function(s,n,i){return r=!!t(s,n,i),r}),r}var zV=WV,YV=HV,KV=zV,XV=Da,QV=Tr,JV=vl;function ZV(e,t,r){var s=QV(e)?YV:KV;return r&&JV(e,t,r)&&(t=void 0),s(e,XV(t))}var eH=ZV;const $W=nt(eH);var tH=Da,rH=Co,aH=xl;function sH(e){return function(t,r,s){var n=Object(t);if(!rH(t)){var i=tH(r);t=aH(t),r=function(c){return i(n[c],c,n)}}var o=e(t,r,s);return o>-1?n[i?t[o]:o]:void 0}}var nH=sH,iH=Iw;function oH(e){var t=iH(e),r=t%1;return t===t?r?t-r:t:0}var cH=oH,lH=Oy,dH=Da,uH=cH,fH=Math.max;function hH(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var n=r==null?0:uH(r);return n<0&&(n=fH(s+n,0)),lH(e,dH(t),n)}var mH=hH,pH=nH,gH=mH,xH=pH(gH),vH=xH;const BW=nt(vH);var Ow={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function n(l,d,u){this.fn=l,this.context=d,this.once=u||!1}function i(l,d,u,f,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new n(u,f||l,h),g=r?r+d:d;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],m]:l._events[g].push(m):(l._events[g]=m,l._eventsCount++),l}function o(l,d){--l._eventsCount===0?l._events=new s:delete l._events[d]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},c.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,g=new Array(m);h<m;h++)g[h]=f[h].fn;return g},c.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},c.prototype.emit=function(d,u,f,h,m,g){var p=r?r+d:d;if(!this._events[p])return!1;var x=this._events[p],y=arguments.length,w,v;if(x.fn){switch(x.once&&this.removeListener(d,x.fn,void 0,!0),y){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,f),!0;case 4:return x.fn.call(x.context,u,f,h),!0;case 5:return x.fn.call(x.context,u,f,h,m),!0;case 6:return x.fn.call(x.context,u,f,h,m,g),!0}for(v=1,w=new Array(y-1);v<y;v++)w[v-1]=arguments[v];x.fn.apply(x.context,w)}else{var j=x.length,S;for(v=0;v<j;v++)switch(x[v].once&&this.removeListener(d,x[v].fn,void 0,!0),y){case 1:x[v].fn.call(x[v].context);break;case 2:x[v].fn.call(x[v].context,u);break;case 3:x[v].fn.call(x[v].context,u,f);break;case 4:x[v].fn.call(x[v].context,u,f,h);break;default:if(!w)for(S=1,w=new Array(y-1);S<y;S++)w[S-1]=arguments[S];x[v].fn.apply(x[v].context,w)}}return!0},c.prototype.on=function(d,u,f){return i(this,d,u,f,!1)},c.prototype.once=function(d,u,f){return i(this,d,u,f,!0)},c.prototype.removeListener=function(d,u,f,h){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===u&&(!h||g.once)&&(!f||g.context===f)&&o(this,m);else{for(var p=0,x=[],y=g.length;p<y;p++)(g[p].fn!==u||h&&!g[p].once||f&&g[p].context!==f)&&x.push(g[p]);x.length?this._events[m]=x.length===1?x[0]:x:o(this,m)}return this},c.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c})(Ow);var yH=Ow.exports;const GW=nt(yH),wH=({client:e,onBack:t})=>{const{projectId:r}=Xc(),{user:s}=Mr(),[n,i]=L.useState(e||null),o=Cu({projectId:r,endClientId:n==null?void 0:n.id}),[c,l]=L.useState([]),[d,u]=L.useState(!0),[f,h]=L.useState(!1),[m,g]=L.useState([]),[p,x]=L.useState([]),[y,w]=L.useState(!1),[v,j]=L.useState(!1),[S,_]=L.useState(!1),[T,N]=L.useState(!1),{toast:b}=vt();L.useRef(null),L.useRef(null),console.log(" [ClientDashboard] Component initialized with client:",n,"projectId:",r),L.useEffect(()=>{(async()=>{if(!n&&r)try{console.log(" [ClientDashboard] Loading client data from projectId:",r);const{data:Q,error:z}=await he.from("projects").select(`
              id,
              title,
              description,
              status,
              created_at,
              updated_at,
              end_client_id
            `).eq("id",r).single();if(z){console.error(" [ClientDashboard] Error loading project:",z),b({title:"Error Loading Project",description:`Failed to load project: ${z.message}`,variant:"destructive"});return}if(!Q){console.error(" [ClientDashboard] No project found for projectId:",r);return}const{data:X,error:ne}=await he.from("end_clients").select("id, name, email, company, phone").eq("id",Q.end_client_id).single();if(ne){console.error(" [ClientDashboard] Error loading client:",ne),b({title:"Error Loading Client",description:`Failed to load client: ${ne.message}`,variant:"destructive"});return}if(!X){console.error(" [ClientDashboard] No client found for end_client_id:",Q.end_client_id);return}const k={...Q,end_clients:X};if(k&&k.end_clients){const Ce={id:k.end_clients.id,name:k.end_clients.name,email:k.end_clients.email,company:k.end_clients.company,phone:k.end_clients.phone,project:{id:k.id,title:k.title,description:k.description,status:k.status,created_at:k.created_at,updated_at:k.updated_at}};console.log(" [ClientDashboard] Client data loaded:",Ce),i(Ce)}}catch(Q){console.error(" [ClientDashboard] Error loading client from project:",Q),b({title:"Error Loading Client Data",description:"Failed to load client information. Please try again.",variant:"destructive"})}})()},[n,r]);const O=[],A=!1,E=null,U=()=>{},[Y,ee]=L.useState(null),se=o.totalViews,W=o.totalVisitors,J=o.avgEngagementTime,F=o.totalLeads,te=o.conversionRate,fe=o.avgSatisfaction,R={totalViews:se,uniqueVisitors:W,avgSessionDuration:gc(J),bounceRate:W>0?Math.round((W-se)/W*100):0,conversionRate:te,totalProjects:0,completedProjects:0,satisfactionScore:fe,totalInteractions:0,avgEngagementTime:gc(J),totalLeadsGenerated:F,inProgressProjects:0};if(L.useEffect(()=>{l([]),u(!1)},[n==null?void 0:n.id]),console.log(" [ClientDashboard] Using hardcoded analytics for client:",n==null?void 0:n.id,n==null?void 0:n.name),!n)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:a.jsx(De,{className:"h-8 w-8 animate-spin text-primary"})});const G=D=>{switch(D){case"active":return"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800";case"inactive":return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700";case"draft":return"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700"}},P=D=>{switch(D){case"active":return"Live";case"inactive":return"Inactive";case"draft":return"In Progress";default:return D}},C=async(D,Q)=>{h(!0);try{const{data:z,error:X}=await he.from("projects").select("id").eq("end_client_id",n.id).limit(1).single();if(X||!z)throw new Error("No project found for this client. Please create a project first.");g(D);const ne=D.map(ue=>({date:ue.date,page_views:ue.page_views,visitors:ue.visitors,total_time:ue.total_time,avg_time:ue.avg_time,resource_code:ue.resource_code}));x(ne),w(!0);const{data:k,error:Ce}=await he.from("creators").select("id").eq("user_id",s==null?void 0:s.id).single();if(Ce||!k)throw new Error("Creator not found");const _e=D.map(ue=>({project_id:z.id,end_client_id:n.id,creator_id:k.id,date:ue.date,resource_code:ue.resource_code,page_views:ue.page_views||0,visitors:ue.visitors||0,total_time:ue.total_time||0,avg_time:ue.avg_time||0})),{error:me}=await he.from("imported_analytics").insert(_e);if(me)throw me;b({title:"Import Successful",description:`Successfully imported ${D.length} analytics records for ${n.name} (${Q}). Visual charts have been generated.`});const{data:pe}=await he.rpc("get_client_analytics",{client_uuid:n.id});pe&&ee(pe)}catch(z){throw console.error("Import error:",z),b({title:"Import Failed",description:z instanceof Error?z.message:"Failed to import analytics data. Please try again.",variant:"destructive"}),z}finally{h(!1)}},K=async()=>{N(!0);try{const[D,Q]=await Promise.all([he.from("analytics").delete().eq("end_client_id",n.id),he.from("imported_analytics").delete().eq("end_client_id",n.id)]);if(D.error)throw console.error("Error deleting from analytics table:",D.error),D.error;if(Q.error)throw console.error("Error deleting from imported_analytics table:",Q.error),Q.error;g([]),x([]),w(!1),ee(null),b({title:"Analytics Reset Successful",description:`All analytics data for ${n.name} has been permanently deleted.`})}catch(D){throw console.error("Reset error:",D),b({title:"Reset Failed",description:"Failed to reset analytics data. Please try again.",variant:"destructive"}),D}finally{N(!1)}};return a.jsxs("div",{className:"space-y-8 animate-fade-in",children:[a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[a.jsxs(le,{variant:"outline",size:"sm",onClick:t,className:"flex items-center gap-2 flex-shrink-0",children:[a.jsx(Xi,{className:"h-4 w-4"}),"Back to Projects"]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground truncate",children:n.name}),a.jsxs("p",{className:"text-foreground-secondary truncate",children:[n.company,"  Client Dashboard"]})]})]}),a.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:a.jsx(Le,{variant:n.status==="active"?"default":"secondary",children:n.status})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Analytics Overview"}),a.jsxs("p",{className:"text-foreground-secondary",children:["Performance metrics and insights for ",n.name]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(le,{variant:"outline",size:"sm",onClick:()=>j(!0),disabled:f||T,className:"flex items-center gap-2",children:f?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 animate-spin"}),"Importing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(gd,{className:"h-4 w-4"}),"Import Data"]})}),a.jsx(le,{variant:"outline",size:"sm",onClick:()=>_(!0),disabled:f||T,className:"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200",children:T?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 animate-spin"}),"Resetting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(js,{className:"h-4 w-4"}),"Reset Analytics"]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Total Views"}),a.jsx(Ot,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:R.totalViews}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Real-time view data"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Unique Visitors"}),a.jsx(gr,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:R.uniqueVisitors}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Real-time visitor data"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Avg. Session"}),a.jsx(it,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:R.avgSessionDuration}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Real-time session data"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Satisfaction"}),a.jsx(oa,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsxs("div",{className:"text-2xl font-bold",children:[R.satisfactionScore,"/5"]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Real-time satisfaction data"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Total Projects"}),a.jsx(P_,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:R.totalProjects}),a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Completed"}),a.jsx("span",{children:R.completedProjects})]}),a.jsxs("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"In Progress"}),a.jsx("span",{children:R.inProgressProjects})]})]})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Conversion Rate"}),a.jsx(Pr,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsxs("div",{className:"text-2xl font-bold",children:[R.conversionRate,"%"]}),a.jsx(qa,{value:R.conversionRate,className:"mt-2"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Real-time conversion data"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Bounce Rate"}),a.jsx(Ba,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsxs("div",{className:"text-2xl font-bold",children:[R.bounceRate,"%"]}),a.jsx(qa,{value:R.bounceRate,className:"mt-2"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Real-time bounce rate data"})]})]})]})]}),y&&p.length>0&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Data Visualization"}),a.jsx("p",{className:"text-foreground-secondary",children:"Visual representation of imported analytics data"})]}),a.jsxs(le,{variant:"outline",size:"sm",onClick:()=>w(!1),className:"flex items-center gap-2",children:[a.jsx(Cg,{className:"h-4 w-4"}),"Hide Charts"]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsx(we,{children:"Page Views & Unique Visitors Over Time"}),a.jsx(He,{children:"Trend analysis of visitor engagement"})]}),a.jsx(de,{children:a.jsx(Ol,{width:"100%",height:300,children:a.jsxs(Y_,{data:p,children:[a.jsx(sh,{strokeDasharray:"3 3"}),a.jsx(nh,{dataKey:"date"}),a.jsx(ih,{}),a.jsx(Pl,{}),a.jsx(oh,{}),a.jsx(ch,{type:"monotone",dataKey:"pv",stroke:"#8884d8",strokeWidth:2,name:"Page Views"}),a.jsx(ch,{type:"monotone",dataKey:"uv",stroke:"#82ca9d",strokeWidth:2,name:"Unique Visitors"})]})})})]}),a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsx(we,{children:"Session Duration Analysis"}),a.jsx(He,{children:"Average session duration by date"})]}),a.jsx(de,{children:a.jsx(Ol,{width:"100%",height:300,children:a.jsxs(K_,{data:p,children:[a.jsx(sh,{strokeDasharray:"3 3"}),a.jsx(nh,{dataKey:"date"}),a.jsx(ih,{}),a.jsx(Pl,{}),a.jsx(oh,{}),a.jsx(X_,{dataKey:"avgDuration",fill:"#8884d8",name:"Avg Duration (seconds)"})]})})})]}),a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsx(we,{children:"Resource Code Distribution"}),a.jsx(He,{children:"Page views by resource code"})]}),a.jsx(de,{children:a.jsx(Ol,{width:"100%",height:300,children:a.jsxs(Q_,{children:[a.jsx(J_,{data:p.reduce((D,Q)=>{const z=D.find(X=>X.name===Q.resourceCode);return z?z.value+=Q.pv:D.push({name:Q.resourceCode,value:Q.pv}),D},[]),cx:"50%",cy:"50%",labelLine:!1,label:({name:D,percent:Q})=>`${D} ${(Q*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:p.map((D,Q)=>a.jsx(Z_,{fill:`hsl(${Q*45}, 70%, 50%)`},`cell-${Q}`))}),a.jsx(Pl,{})]})})})]}),a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsx(we,{children:"Data Summary"}),a.jsx(He,{children:"Key metrics from imported data"})]}),a.jsx(de,{children:a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-primary",children:p.reduce((D,Q)=>D+Q.pv,0)}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Page Views"})]}),a.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-primary",children:p.reduce((D,Q)=>D+Q.uv,0)}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Unique Visitors"})]}),a.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[a.jsxs("div",{className:"text-2xl font-bold text-primary",children:[Math.round(p.reduce((D,Q)=>D+Q.avgDuration,0)/p.length),"s"]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Session Duration"})]}),a.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-primary",children:new Set(p.map(D=>D.resourceCode)).size}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Unique Resources"})]})]})})})]})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Your Projects"}),a.jsx("p",{className:"text-foreground-secondary",children:"Manage and view your virtual tour projects"})]})}),d?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:3}).map((D,Q)=>a.jsxs(oe,{className:"animate-pulse",children:[a.jsx("div",{className:"aspect-video bg-muted"}),a.jsxs(ye,{children:[a.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),a.jsx("div",{className:"h-3 bg-muted rounded w-full"})]}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-3 bg-muted rounded w-1/2"}),a.jsx("div",{className:"h-3 bg-muted rounded w-2/3"})]})})]},Q))}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(D=>a.jsxs(oe,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"aspect-video bg-muted relative",children:[D.thumbnail_url?a.jsx("img",{src:D.thumbnail_url,alt:D.title,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"No Thumbnail"}),a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx(Le,{className:G(D.status),children:P(D.status)})}),a.jsx("div",{className:"absolute inset-0 bg-black/0 hover:bg-black/20 transition-colors flex items-center justify-center opacity-0 hover:opacity-100",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(le,{size:"sm",variant:"secondary",children:[a.jsx(lc,{size:16,className:"mr-1"}),"View Tour"]}),a.jsx(le,{size:"sm",variant:"secondary",children:a.jsx(Lr,{size:16})})]})})]}),a.jsxs(ye,{className:"pb-3",children:[a.jsx(we,{className:"text-lg line-clamp-1",children:D.title}),a.jsx(He,{className:"line-clamp-2",children:D.description})]}),a.jsx(de,{className:"pt-0",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[a.jsx("span",{children:"Views"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ot,{size:14}),a.jsx("span",{children:D.views})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[a.jsx("span",{children:"Created"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yr,{size:14}),a.jsx("span",{children:new Date(D.created_at).toLocaleDateString()})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(le,{variant:"outline",size:"sm",className:"flex-1",children:[a.jsx(Lr,{className:"w-4 h-4 mr-2"}),"View Media"]}),a.jsx(le,{variant:"outline",size:"sm",children:a.jsx(nu,{className:"w-4 h-4"})})]})]})})]},D.id))})]}),a.jsx("div",{className:"space-y-6",children:a.jsx(Au,{activities:O,loading:A,error:E,onRefresh:U,title:"Recent Activity",description:"Latest updates and interactions for this client",showStats:!0,maxItems:8})}),a.jsx(W5,{isOpen:v,onClose:()=>j(!1),onImport:C,clientName:n.name,clientId:n.id}),a.jsx(z5,{isOpen:S,onClose:()=>_(!1),onConfirm:K,clientName:n.name,isResetting:T})]})},Pw=(e={})=>{const[t,r]=L.useState([]),[s,n]=L.useState(!0),[i,o]=L.useState(null),{clientId:c,projectId:l,creatorId:d,limit:u=50,filters:f}=e,h=L.useRef(null),m=L.useRef(null),g=async()=>{try{n(!0),o(null);const w=[],v=new Date;v.setDate(v.getDate()-2);const j=v.toISOString(),S=he.from("projects").select(`
          *,
          end_clients!inner(
            id,
            name,
            company,
            creator_id
          )
        `).gte("created_at",j).order("created_at",{ascending:!1});c&&S.eq("end_client_id",c),l&&S.eq("id",l),d&&S.eq("end_clients.creator_id",d);const{data:_,error:T}=await S;if(T)throw T;const N=he.from("chatbots").select(`
          *,
          projects!inner(
            id,
            title,
            end_client_id,
            end_clients!inner(
              id,
              name,
              company,
              creator_id
            )
          )
        `).gte("created_at",j).order("created_at",{ascending:!1});l?N.eq("project_id",l):c?N.eq("projects.end_client_id",c):d&&N.eq("projects.end_clients.creator_id",d);const{data:b,error:O}=await N;if(O)throw O;const A=he.from("leads").select(`
          *,
          chatbots!inner(
            id,
            name,
            projects!inner(
              id,
              title,
              end_client_id,
              end_clients!inner(
                id,
                name,
                company,
                creator_id
              )
            )
          )
        `).gte("created_at",j).order("created_at",{ascending:!1});l?A.eq("chatbots.project_id",l):c?A.eq("chatbots.projects.end_client_id",c):d&&A.eq("chatbots.projects.end_clients.creator_id",d);const{data:E,error:U}=await A;if(U)throw U;const Y=he.from("requests").select(`
          *,
          projects!inner(
            id,
            title,
            end_client_id,
            end_clients!inner(
              id,
              name,
              company,
              creator_id
            )
          )
        `).gte("created_at",j).order("created_at",{ascending:!1});l?Y.eq("project_id",l):c?Y.eq("end_client_id",c):d&&Y.eq("projects.end_clients.creator_id",d);const{data:ee,error:se}=await Y;if(se)throw se;const W=he.from("analytics").select(`
          *,
          projects!inner(
            id,
            title,
            end_client_id,
            end_clients!inner(
              id,
              name,
              company,
              creator_id
            )
          )
        `).gte("created_at",j).order("created_at",{ascending:!1});l?W.eq("project_id",l):c?W.eq("projects.end_client_id",c):d&&W.eq("projects.end_clients.creator_id",d);const J=he.from("imported_analytics").select(`
          *,
          projects!inner(
            id,
            title,
            end_client_id,
            end_clients!inner(
              id,
              name,
              company,
              creator_id
            )
          )
        `).gte("created_at",j).order("created_at",{ascending:!1});l?J.eq("project_id",l):c?J.eq("projects.end_client_id",c):d&&J.eq("projects.end_clients.creator_id",d);const[F,te]=await Promise.all([W,J]);if(F.error)throw F.error;if(te.error)throw te.error;const fe=F.data||[],G=(te.data||[]).flatMap(D=>{const Q=[];return D.pv>0&&Q.push({id:`${D.id}_pv`,metric_type:"view",metric_value:D.pv,date:D.date,created_at:D.created_at,project_id:D.project_id,projects:D.projects}),D.uv>0&&Q.push({id:`${D.id}_uv`,metric_type:"unique_visitor",metric_value:D.uv,date:D.date,created_at:D.created_at,project_id:D.project_id,projects:D.projects}),D.avg_duration>0&&Q.push({id:`${D.id}_time`,metric_type:"time_spent",metric_value:D.avg_duration,date:D.date,created_at:D.created_at,project_id:D.project_id,projects:D.projects}),Q}),P=[...fe,...G];_==null||_.forEach(D=>{w.push({id:`project-${D.id}`,type:"project_created",title:`Project "${D.title}" created`,description:`New project created for ${D.end_clients.name}`,timestamp:D.created_at,metadata:{projectId:D.id,projectTitle:D.title,clientId:D.end_client_id,clientName:D.end_clients.name,status:D.status},icon:{component:"Plus",color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/20"},priority:"medium"}),D.updated_at!==D.created_at&&w.push({id:`project-updated-${D.id}`,type:"project_updated",title:`Project "${D.title}" updated`,description:`Project status changed to ${D.status}`,timestamp:D.updated_at,metadata:{projectId:D.id,projectTitle:D.title,clientId:D.end_client_id,clientName:D.end_clients.name,status:D.status},icon:{component:"Edit",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/20"},priority:"low"})}),b==null||b.forEach(D=>{w.push({id:`chatbot-${D.id}`,type:"chatbot_created",title:`Chatbot "${D.name}" created`,description:`AI assistant created for project "${D.projects.title}"`,timestamp:D.created_at,metadata:{projectId:D.project_id,projectTitle:D.projects.title,clientId:D.projects.end_client_id,clientName:D.projects.end_clients.name,status:D.status},icon:{component:"Bot",color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-100 dark:bg-purple-900/20"},priority:"medium"}),D.updated_at!==D.created_at&&w.push({id:`chatbot-updated-${D.id}`,type:"chatbot_updated",title:`Chatbot "${D.name}" updated`,description:`Chatbot status changed to ${D.status}`,timestamp:D.updated_at,metadata:{projectId:D.project_id,projectTitle:D.projects.title,clientId:D.projects.end_client_id,clientName:D.projects.end_clients.name,status:D.status},icon:{component:"Settings",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/20"},priority:"low"})}),E==null||E.forEach(D=>{w.push({id:`lead-${D.id}`,type:"lead_captured",title:"New lead captured",description:`${D.visitor_name||"Anonymous visitor"} from "${D.chatbots.projects.title}"`,timestamp:D.created_at,metadata:{projectId:D.chatbots.project_id,projectTitle:D.chatbots.projects.title,clientId:D.chatbots.projects.end_client_id,clientName:D.chatbots.projects.end_clients.name,leadName:D.visitor_name,leadEmail:D.visitor_email,leadScore:D.lead_score},icon:{component:"UserPlus",color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-100 dark:bg-emerald-900/20"},priority:"high"})}),ee==null||ee.forEach(D=>{w.push({id:`request-${D.id}`,type:"request_submitted",title:`New request: "${D.title}"`,description:`Request submitted for project "${D.projects.title}"`,timestamp:D.created_at,metadata:{projectId:D.project_id,projectTitle:D.projects.title,clientId:D.end_client_id,clientName:D.projects.end_clients.name,requestType:D.request_type,priority:D.priority,status:D.status},icon:{component:"MessageSquare",color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-100 dark:bg-orange-900/20"},priority:D.priority==="urgent"?"high":D.priority==="high"?"medium":"low"}),D.updated_at!==D.created_at&&w.push({id:`request-updated-${D.id}`,type:"request_updated",title:`Request updated: "${D.title}"`,description:`Request status changed to ${D.status}`,timestamp:D.updated_at,metadata:{projectId:D.project_id,projectTitle:D.projects.title,clientId:D.end_client_id,clientName:D.projects.end_clients.name,requestType:D.request_type,priority:D.priority,status:D.status},icon:{component:"Edit",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/20"},priority:"low"})}),(P||[]).forEach(D=>{let Q="",z="",X={component:"BarChart3",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/20"};D.metric_type==="view"?(Q=`${D.metric_value} views on "${D.projects.title}"`,z="Project received traffic",X={component:"Eye",color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/20"}):D.metric_type==="unique_visitor"?(Q=`${D.metric_value} unique visitors on "${D.projects.title}"`,z="Project attracted new visitors",X={component:"Users",color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/20"}):D.metric_type==="lead_generated"?(Q=`${D.metric_value} leads generated from "${D.projects.title}"`,z="New leads captured through chatbot",X={component:"UserPlus",color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-100 dark:bg-emerald-900/20"}):D.metric_type==="chatbot_interaction"?(Q=`${D.metric_value} chatbot interactions on "${D.projects.title}"`,z="Visitors engaged with the chatbot",X={component:"MessageSquare",color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-100 dark:bg-purple-900/20"}):D.metric_type==="time_spent"?(Q=`${D.metric_value} minutes spent on "${D.projects.title}"`,z="Average time visitors spent on project",X={component:"Clock",color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-100 dark:bg-orange-900/20"}):D.metric_type==="hotspot_click"&&(Q=`${D.metric_value} hotspot clicks on "${D.projects.title}"`,z="Visitors interacted with hotspots",X={component:"Award",color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/20"}),w.push({id:`analytics-${D.id}`,type:"analytics_interaction",title:Q,description:z,timestamp:D.created_at,metadata:{projectId:D.project_id,projectTitle:D.projects.title,clientId:D.projects.end_client_id,clientName:D.projects.end_clients.name,metricType:D.metric_type,metricValue:D.metric_value},icon:X,priority:"medium"})}),w.sort((D,Q)=>new Date(Q.timestamp).getTime()-new Date(D.timestamp).getTime());let K=w;if(f!=null&&f.types&&f.types.length>0&&(K=K.filter(D=>f.types.includes(D.type))),f!=null&&f.priority&&f.priority.length>0&&(K=K.filter(D=>f.priority.includes(D.priority))),f!=null&&f.dateRange){const D=new Date(f.dateRange.start),Q=new Date(f.dateRange.end);K=K.filter(z=>{const X=new Date(z.timestamp);return X>=D&&X<=Q})}K=K.slice(0,u),r(K)}catch(w){console.error("Error fetching activities:",w),o(w instanceof Error?w.message:"Failed to fetch activities")}finally{n(!1)}},p=L.useCallback(()=>{m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{console.log("[RecentActivity] Real-time update triggered"),g()},1e3)},[]);L.useEffect(()=>{g()},[c,l,d,u,JSON.stringify(f)]),L.useEffect(()=>{if(!c&&!l&&!d)return;console.log("[RecentActivity] Setting up real-time subscriptions");const w=he.channel("recent-activity-updates").on("postgres_changes",{event:"*",schema:"public",table:"analytics"},v=>{console.log("[RecentActivity] Analytics change detected:",v),p()}).on("postgres_changes",{event:"*",schema:"public",table:"imported_analytics"},v=>{console.log("[RecentActivity] Imported analytics change detected:",v),p()}).on("postgres_changes",{event:"*",schema:"public",table:"projects"},v=>{console.log("[RecentActivity] Project change detected:",v),p()}).on("postgres_changes",{event:"*",schema:"public",table:"chatbots"},v=>{console.log("[RecentActivity] Chatbot change detected:",v),p()}).subscribe(v=>{console.log("[RecentActivity] Subscription status:",v)});return h.current=w,()=>{console.log("[RecentActivity] Cleaning up real-time subscriptions"),h.current&&he.removeChannel(h.current),m.current&&clearTimeout(m.current)}},[c,l,d,p]);const x=L.useMemo(()=>{const w=t.length,v=t.reduce((T,N)=>(T[N.type]=(T[N.type]||0)+1,T),{}),j=t.reduce((T,N)=>(T[N.priority]=(T[N.priority]||0)+1,T),{}),S=new Date;S.setDate(S.getDate()-1);const _=t.filter(T=>new Date(T.timestamp)>S).length;return{total:w,byType:v,byPriority:j,recentCount:_}},[t]);return{activities:t,loading:s,error:i,stats:x,refresh:()=>{g()}}},_H=({onClientSelect:e})=>{var se,W,J,F,te,fe,R,G,P,C,K,D,Q,z,X,ne,k,Ce,_e;vt();const{user:t}=Mr(),{clients:r,projects:s,analytics:n,isLoading:i,error:o,refreshData:c}=r1((t==null?void 0:t.id)||"");console.log("[ClientManagement] Dashboard data:",{clientsCount:(r==null?void 0:r.length)||0,projectsCount:(s==null?void 0:s.length)||0,analyticsCount:(n==null?void 0:n.length)||0,isLoading:i,error:o});const[l,d]=L.useState(null),[u,f]=L.useState(""),[h,m]=L.useState("all"),[g,p]=L.useState("all"),x=L.useRef(null),y=L.useRef(null),{activities:w,loading:v,error:j,refresh:S}=Pw({clientId:l==null?void 0:l.id,limit:10}),_=r||[],N=_.map(me=>{const ue=((s==null?void 0:s.filter(Oe=>Oe.end_client_id===me.id))||[]).map(Oe=>Oe.id),je=(n==null?void 0:n.filter(Oe=>ue.includes(Oe.project_id)))||[];console.log(`[ClientManagement] Client: ${me.name}`,{projectIds:ue,clientAnalytics:je.length,totalAnalytics:(n==null?void 0:n.length)||0});const $e=je.filter(Oe=>Oe.metric_type==="view").reduce((Oe,ze)=>Oe+ze.metric_value,0),ot=je.filter(Oe=>Oe.metric_type==="unique_visitor").reduce((Oe,ze)=>Oe+ze.metric_value,0),tt=je.filter(Oe=>Oe.metric_type==="time_spent"),jt=tt.length>0?`${Math.floor(tt.reduce((Oe,ze)=>Oe+ze.metric_value,0)/tt.length/60)}m ${Math.floor(tt.reduce((Oe,ze)=>Oe+ze.metric_value,0)/tt.length%60)}s`:"0m 0s",yt=je.filter(Oe=>Oe.metric_type==="lead_generated").reduce((Oe,ze)=>Oe+ze.metric_value,0),Xe=$e>0?Math.round(yt/$e*100*100)/100:0,ut=je.filter(Oe=>Oe.metric_type==="satisfaction"),qe=ut.length>0?ut.reduce((Oe,ze)=>Oe+ze.metric_value,0)/ut.length:0;return{...me,analytics:{totalViews:$e,uniqueVisitors:ot,avgEngagementTime:jt,totalLeadsGenerated:yt,conversionRate:Xe,avgSatisfaction:qe}}}).filter(me=>s==null?void 0:s.some(ue=>ue.end_client_id===me.id));L.useEffect(()=>{if(!(t!=null&&t.id))return;console.log("[ClientManagement] Setting up real-time subscriptions");const me=he.channel(`client-management-${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"end_clients"},pe=>{console.log("[ClientManagement] Client change detected:",pe),b()}).on("postgres_changes",{event:"*",schema:"public",table:"projects"},pe=>{console.log("[ClientManagement] Project change detected:",pe),b()}).on("postgres_changes",{event:"*",schema:"public",table:"analytics"},pe=>{console.log("[ClientManagement] Analytics change detected:",pe),b()}).on("postgres_changes",{event:"*",schema:"public",table:"imported_analytics"},pe=>{console.log("[ClientManagement] Imported analytics change detected:",pe),b()}).subscribe(pe=>{console.log("[ClientManagement] Subscription status:",pe)});return x.current=me,()=>{console.log("[ClientManagement] Cleaning up real-time subscriptions"),x.current&&he.removeChannel(x.current),y.current&&clearTimeout(y.current)}},[t==null?void 0:t.id]);const b=()=>{y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{console.log("[ClientManagement] Triggering debounced refresh"),c()},1e3)},O=me=>{switch(me){case"active":return"bg-green-100 text-green-800 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800";case"inactive":return"bg-red-100 text-red-800 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700"}},A=me=>{switch(me){case"enterprise":return"bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900/20 dark:text-purple-400 dark:border-purple-800";case"premium":return"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-800";case"basic":return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700";default:return"bg-gray-100 text-gray-800 border-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700"}},E=N.filter(me=>{const pe=me.name.toLowerCase().includes(u.toLowerCase())||me.company.toLowerCase().includes(u.toLowerCase())||me.email.toLowerCase().includes(u.toLowerCase()),ue=h==="all"||me.status===h,je=g==="all"||me.subscription===g;return pe&&ue&&je}),U=me=>{d(me),e==null||e(me)},Y=N.reduce((me,pe)=>{var ue;return me+(((ue=pe.analytics)==null?void 0:ue.totalViews)||0)},0);N.length,N.filter(me=>me.status==="active").length;const ee=N.length>0?N.reduce((me,pe)=>{var ue;return me+(((ue=pe.analytics)==null?void 0:ue.satisfaction)||0)},0)/N.length:0;return l?a.jsxs("div",{className:"space-y-8 animate-fade-in",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(le,{variant:"outline",onClick:()=>d(null),className:"flex items-center gap-2",children:" Back to Clients"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:l.name}),a.jsxs("p",{className:"text-foreground-secondary text-sm sm:text-base",children:[l.company,"  ",l.subscription," subscription"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Le,{className:O(l.status),children:l.status}),a.jsx(Le,{className:A(l.subscription),children:l.subscription})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Total Views"}),a.jsx(Ot,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:(((se=l.analytics)==null?void 0:se.totalViews)||0).toLocaleString()}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Total views for this client"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Unique Visitors"}),a.jsx(gr,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:(((W=l.analytics)==null?void 0:W.uniqueVisitors)||0).toLocaleString()}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique visitors for this client"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Avg. Engagement Time"}),a.jsx(it,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:((J=l.analytics)==null?void 0:J.avgEngagementTime)||"0m 0s"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Average engagement time"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Total Leads Generated"}),a.jsx(Pr,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:(((F=l.analytics)==null?void 0:F.totalLeadsGenerated)||0).toLocaleString()}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Total leads generated"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Conversion Rate"}),a.jsx(Or,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsxs("div",{className:"text-2xl font-bold",children:[((te=l.analytics)==null?void 0:te.conversionRate)||0,"%"]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Conversion rate for this client"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Avg. Satisfaction"}),a.jsx(oa,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsxs("div",{className:"text-2xl font-bold",children:[((fe=l.analytics)==null?void 0:fe.avgSatisfaction)||0,"/5"]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Based on chatbot feedback"})]})]})]}),a.jsxs(ln,{defaultValue:"overview",className:"space-y-6",children:[a.jsxs(ks,{children:[a.jsx(bt,{value:"overview",children:"Overview"}),a.jsx(bt,{value:"analytics",children:"Analytics"}),a.jsx(bt,{value:"projects",children:"Projects"}),a.jsx(bt,{value:"activity",children:"Recent Activity"}),a.jsx(bt,{value:"settings",children:"Settings"})]}),a.jsx(Nt,{value:"overview",className:"space-y-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsx(we,{children:"Client Information"})}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Name"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:l.name})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Email"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:l.email})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Company"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:l.company})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Website"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:a.jsx("a",{href:l.website,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:l.website})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Phone"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:l.phone})]})]})]}),a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsx(we,{children:"Performance Metrics"})}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[a.jsx("span",{children:"Conversion Rate"}),a.jsxs("span",{children:[((R=l.analytics)==null?void 0:R.conversionRate)||0,"%"]})]}),a.jsx(qa,{value:((G=l.analytics)==null?void 0:G.conversionRate)||0,className:"h-2"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[a.jsx("span",{children:"Leads Generated"}),a.jsx("span",{children:((P=l.analytics)==null?void 0:P.totalLeadsGenerated)||0})]}),a.jsx(qa,{value:(C=l.analytics)!=null&&C.totalViews&&((K=l.analytics)!=null&&K.totalLeadsGenerated)?l.analytics.totalLeadsGenerated/l.analytics.totalViews*100:0,className:"h-2"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[a.jsx("span",{children:"Avg. Satisfaction"}),a.jsxs("span",{children:[((D=l.analytics)==null?void 0:D.avgSatisfaction)||0,"/5"]})]}),a.jsx(qa,{value:(Q=l.analytics)!=null&&Q.avgSatisfaction?l.analytics.avgSatisfaction/5*100:0,className:"h-2"})]})]})]})]})}),a.jsx(Nt,{value:"analytics",className:"space-y-6",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsx(we,{children:"Main Analytics"})}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm",children:"Total Views"}),a.jsx("span",{className:"font-semibold",children:(((z=l.analytics)==null?void 0:z.totalViews)||0).toLocaleString()})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm",children:"Unique Visitors"}),a.jsx("span",{className:"font-semibold",children:(((X=l.analytics)==null?void 0:X.uniqueVisitors)||0).toLocaleString()})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm",children:"Avg. Engagement Time"}),a.jsx("span",{className:"font-semibold",children:((ne=l.analytics)==null?void 0:ne.avgEngagementTime)||"0m 0s"})]})]})]}),a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsx(we,{children:"Performance Metrics"})}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm",children:"Total Leads Generated"}),a.jsx("span",{className:"font-semibold",children:(((k=l.analytics)==null?void 0:k.totalLeadsGenerated)||0).toLocaleString()})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm",children:"Conversion Rate"}),a.jsxs("span",{className:"font-semibold",children:[((Ce=l.analytics)==null?void 0:Ce.conversionRate)||0,"%"]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm",children:"Avg. Satisfaction"}),a.jsxs("span",{className:"font-semibold",children:[((_e=l.analytics)==null?void 0:_e.avgSatisfaction)||0,"/5"]})]})]})]})]})}),a.jsx(Nt,{value:"projects",className:"space-y-6",children:a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsx(we,{children:"Client Projects"}),a.jsxs(He,{children:[l.projects," active projects"]})]}),a.jsx(de,{children:a.jsx("p",{className:"text-muted-foreground",children:"Project management interface would go here..."})})]})}),a.jsx(Nt,{value:"activity",className:"space-y-6",children:a.jsx(Au,{activities:w,loading:v,error:j,onRefresh:S,title:`Recent Activity - ${l.name}`,description:`Latest updates and interactions for ${l.name}`,showStats:!0,maxItems:15})}),a.jsx(Nt,{value:"settings",className:"space-y-6",children:a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsx(we,{children:"Client Settings"})}),a.jsx(de,{children:a.jsx("p",{className:"text-muted-foreground",children:"Client configuration and settings would go here..."})})]})})]})]}):a.jsxs("div",{className:"space-y-8 animate-fade-in",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground mb-2",children:"Client Management"}),a.jsx("p",{className:"text-foreground-secondary text-sm sm:text-base",children:"Manage all your clients and view their detailed analytics"})]}),a.jsxs(le,{className:"bg-primary hover:bg-primary-hover",children:[a.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Add Client"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Total Views"}),a.jsx(Ot,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:Y.toLocaleString()}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all clients"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Unique Visitors"}),a.jsx(gr,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:_.reduce((me,pe)=>{var ue;return me+(((ue=pe.analytics)==null?void 0:ue.uniqueVisitors)||0)},0).toLocaleString()}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique visitors across all clients"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Avg. Engagement Time"}),a.jsx(it,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:"0m 0s"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Average engagement time"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Total Leads Generated"}),a.jsx(Pr,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-2xl font-bold",children:_.reduce((me,pe)=>{var ue;return me+(((ue=pe.analytics)==null?void 0:ue.totalLeadsGenerated)||0)},0).toLocaleString()}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Total leads generated"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Global Conversion Rate"}),a.jsx(Or,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsxs("div",{className:"text-2xl font-bold",children:[Y>0?(_.reduce((me,pe)=>{var ue;return me+(((ue=pe.analytics)==null?void 0:ue.totalLeadsGenerated)||0)},0)/Y*100).toFixed(1):"0.0","%"]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Global conversion rate"})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-medium",children:"Avg. Satisfaction"}),a.jsx(oa,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(de,{children:[a.jsxs("div",{className:"text-2xl font-bold",children:[ee.toFixed(1),"/5"]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Based on chatbot feedback"})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ei,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{placeholder:"Search clients by name, company, or email...",value:u,onChange:me=>f(me.target.value),className:"pl-10"})]}),a.jsxs(pt,{value:h,onValueChange:m,children:[a.jsx(ct,{className:"w-full sm:w-48",children:a.jsx(gt,{placeholder:"Filter by status"})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All Status"}),a.jsx(ve,{value:"active",children:"Active"}),a.jsx(ve,{value:"inactive",children:"Inactive"}),a.jsx(ve,{value:"pending",children:"Pending"})]})]}),a.jsxs(pt,{value:g,onValueChange:p,children:[a.jsx(ct,{className:"w-full sm:w-48",children:a.jsx(gt,{placeholder:"Filter by subscription"})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All Subscriptions"}),a.jsx(ve,{value:"basic",children:"Basic"}),a.jsx(ve,{value:"premium",children:"Premium"}),a.jsx(ve,{value:"enterprise",children:"Enterprise"})]})]})]}),i?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((me,pe)=>a.jsxs(oe,{className:"animate-pulse",children:[a.jsx(ye,{children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-muted rounded-full"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-4 bg-muted rounded w-3/4"}),a.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]})]})}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"h-3 bg-muted rounded w-full"}),a.jsx("div",{className:"h-3 bg-muted rounded w-2/3"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("div",{className:"h-8 bg-muted rounded"}),a.jsx("div",{className:"h-8 bg-muted rounded"})]})]})})]},pe))}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(me=>{var pe,ue,je,$e,ot,tt,jt;return a.jsxs(oe,{className:"hover:shadow-lg transition-all duration-200 hover:scale-[1.02] cursor-pointer group",children:[a.jsx(ye,{className:"pb-3",children:a.jsxs("div",{className:"card-header-safe",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[a.jsx(pc,{name:me.name,size:"sm",className:"flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx(we,{className:"text-lg name-display-safe group-hover:text-primary transition-colors",children:me.name}),a.jsx(He,{className:"company-display-safe",children:me.company})]})]}),a.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:a.jsx(Le,{className:O(me.status),children:me.status})})]})}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(Ot,{className:"h-3 w-3"}),a.jsx("span",{children:"Views"})]}),a.jsx("div",{className:"text-sm font-semibold",children:(((pe=me.analytics)==null?void 0:pe.totalViews)||0).toLocaleString()})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(gr,{className:"h-3 w-3"}),a.jsx("span",{children:"Visitors"})]}),a.jsx("div",{className:"text-sm font-semibold",children:(((ue=me.analytics)==null?void 0:ue.uniqueVisitors)||0).toLocaleString()})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(it,{className:"h-3 w-3"}),a.jsx("span",{children:"Engagement"})]}),a.jsx("div",{className:"text-sm font-semibold",children:((je=me.analytics)==null?void 0:je.avgEngagementTime)||"0m 0s"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(Pr,{className:"h-3 w-3"}),a.jsx("span",{children:"Leads"})]}),a.jsx("div",{className:"text-sm font-semibold",children:(($e=me.analytics)==null?void 0:$e.totalLeadsGenerated)||0})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(Or,{className:"h-3 w-3"}),a.jsx("span",{children:"Conversion"})]}),a.jsxs("div",{className:"text-sm font-semibold",children:[((ot=me.analytics)==null?void 0:ot.conversionRate)||0,"%"]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(oa,{className:"h-3 w-3"}),a.jsx("span",{children:"Satisfaction"})]}),a.jsxs("div",{className:"text-sm font-semibold",children:[((tt=me.analytics)==null?void 0:tt.avgSatisfaction)||0,"/5"]})]})]}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yr,{className:"h-3 w-3"}),a.jsxs("span",{children:["Last activity: ",new Date(me.last_activity).toLocaleDateString()]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(oa,{className:"h-3 w-3"}),a.jsxs("span",{children:[((jt=me.analytics)==null?void 0:jt.satisfaction)||0,"/5"]})]})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs(le,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>U(me),children:[a.jsx(Lr,{className:"h-3 w-3 mr-1"}),"View Details"]}),a.jsx(le,{variant:"outline",size:"sm",children:a.jsx(Ka,{className:"h-3 w-3"})})]})]})]},me.id)})}),!i&&E.length===0&&a.jsx(oe,{children:a.jsx(de,{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(gr,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No clients found"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:u||h!=="all"||g!=="all"?"Try adjusting your search or filters":"No clients have been added yet"}),a.jsxs(le,{children:[a.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Add First Client"]})]})})})]})},bH=({projectId:e,projectTitle:t,clientName:r,onRequestSubmitted:s})=>{const{toast:n}=vt(),[i,o]=L.useState(!1),[c,l]=L.useState({chatbotName:"",chatbotPurpose:"",targetAudience:"",language:"en",websiteUrl:"",existingContent:"",specificQuestions:"",businessInfo:"",fileLinks:"",tone:"professional",responseStyle:"helpful",specialInstructions:"",priority:"medium",preferredContactMethod:"email",timeline:"",additionalNotes:""}),d=(f,h)=>{l(m=>({...m,[f]:h}))},u=async()=>{if(!c.chatbotName||!c.chatbotPurpose){n({title:"Missing Information",description:"Please fill in the chatbot name and purpose",variant:"destructive"});return}try{o(!0);const{data:f,error:h}=await he.from("projects").select("id, end_client_id").eq("id",e).single();if(h||!f)throw new Error("Project not found");const m={chatbotName:Zx(c.chatbotName),chatbotPurpose:cc(c.chatbotPurpose),chatbotPersonality:oc(c.chatbotPersonality||""),chatbotLanguage:c.chatbotLanguage,chatbotTone:c.chatbotTone,websiteUrl:Tj(c.websiteUrl||""),existingContent:cc(c.existingContent||""),specificRequirements:cc(c.specificRequirements||""),targetAudience:oc(c.targetAudience||""),integrationRequirements:oc(c.integrationRequirements||""),priority:c.priority},{data:g,error:p}=await he.from("chatbot_requests").insert({project_id:e,end_client_id:f.end_client_id,title:m.chatbotName||"New Chatbot Request",description:m.chatbotPurpose||"",request_type:"new_feature",chatbot_name:m.chatbotName,chatbot_purpose:m.chatbotPurpose,target_audience:m.targetAudience,language:m.chatbotLanguage,website_url:m.websiteUrl,existing_content:m.existingContent,specific_questions:m.specificRequirements,business_info:m.chatbotPersonality,tone:m.chatbotTone,response_style:m.chatbotTone,special_instructions:m.integrationRequirements,priority:m.priority,preferred_contact_method:c.preferredContactMethod,timeline:c.timeline,additional_notes:c.additionalNotes,file_links:c.fileLinks,status:"pending"}).select().single();if(p)throw p;n({title:"Request Submitted Successfully",description:"Your chatbot request has been sent. We'll review it and get back to you soon!"}),l({chatbotName:"",chatbotPurpose:"",targetAudience:"",language:"en",websiteUrl:"",existingContent:"",specificQuestions:"",businessInfo:"",fileLinks:"",tone:"professional",responseStyle:"helpful",specialInstructions:"",priority:"medium",preferredContactMethod:"email",timeline:"",additionalNotes:""}),s==null||s()}catch(f){console.error("Error submitting request:",f),n({title:"Submission Failed",description:f.message||"Failed to submit chatbot request",variant:"destructive"})}finally{o(!1)}};return a.jsxs(oe,{className:"max-w-4xl mx-auto",children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(da,{className:"h-5 w-5"}),"Chatbot Creation Request"]}),a.jsxs(He,{children:["Submit your requirements and files for custom chatbot creation for ",a.jsx("strong",{children:t})," (Client: ",r,")"]})]}),a.jsxs(de,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Basic Information"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"chatbotName",children:"Chatbot Name *"}),a.jsx(Ue,{id:"chatbotName",placeholder:"e.g., Property Assistant, Tour Guide Bot",value:c.chatbotName,onChange:f=>d("chatbotName",f.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"language",children:"Language"}),a.jsxs(pt,{value:c.language,onValueChange:f=>d("language",f),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"en",children:"English"}),a.jsx(ve,{value:"es",children:"Spanish"}),a.jsx(ve,{value:"fr",children:"French"}),a.jsx(ve,{value:"de",children:"German"}),a.jsx(ve,{value:"it",children:"Italian"}),a.jsx(ve,{value:"pt",children:"Portuguese"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"chatbotPurpose",children:"Chatbot Purpose *"}),a.jsx(Bt,{id:"chatbotPurpose",placeholder:"Describe what the chatbot should help visitors with (e.g., answer property questions, provide tour information, collect leads)",value:c.chatbotPurpose,onChange:f=>d("chatbotPurpose",f.target.value),rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"targetAudience",children:"Target Audience"}),a.jsx(Ue,{id:"targetAudience",placeholder:"e.g., Property buyers, Tour visitors, Potential customers",value:c.targetAudience,onChange:f=>d("targetAudience",f.target.value)})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Content & Knowledge Base"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"websiteUrl",children:"Website URL"}),a.jsx(Ue,{id:"websiteUrl",placeholder:"https://your-website.com",value:c.websiteUrl,onChange:f=>d("websiteUrl",f.target.value),className:"input-safe"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"existingContent",children:"Existing Content/Information"}),a.jsx(Bt,{id:"existingContent",placeholder:"Paste any existing content, FAQs, property details, or information the chatbot should know",value:c.existingContent,onChange:f=>d("existingContent",f.target.value),rows:4})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"specificQuestions",children:"Specific Questions to Handle"}),a.jsx(Bt,{id:"specificQuestions",placeholder:"List common questions visitors ask (e.g., What are the property dimensions? How much does it cost? What are the amenities?)",value:c.specificQuestions,onChange:f=>d("specificQuestions",f.target.value),rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"businessInfo",children:"Business Information"}),a.jsx(Bt,{id:"businessInfo",placeholder:"Company details, contact information, services offered, etc.",value:c.businessInfo,onChange:f=>d("businessInfo",f.target.value),rows:3})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Share Files"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(Se,{htmlFor:"file-links",children:"Cloud Storage Links"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Paste links from Google Drive, Dropbox, WeTransfer, or other cloud storage services"}),a.jsx(Bt,{id:"file-links",placeholder:`https://drive.google.com/file/d/...
https://www.dropbox.com/s/...
https://wetransfer.com/downloads/...`,value:c.fileLinks,onChange:f=>l(h=>({...h,fileLinks:f.target.value})),rows:4,className:"resize-none"})]}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.jsx("p",{children:" One link per line"}),a.jsx("p",{children:" Make sure links are publicly accessible or shared with appropriate permissions"}),a.jsx("p",{children:" Supported: Google Drive, Dropbox, WeTransfer, OneDrive, and other cloud storage services"})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Behavior & Style"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"tone",children:"Tone"}),a.jsxs(pt,{value:c.tone,onValueChange:f=>d("tone",f),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"professional",children:"Professional"}),a.jsx(ve,{value:"friendly",children:"Friendly"}),a.jsx(ve,{value:"casual",children:"Casual"}),a.jsx(ve,{value:"formal",children:"Formal"}),a.jsx(ve,{value:"enthusiastic",children:"Enthusiastic"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"responseStyle",children:"Response Style"}),a.jsxs(pt,{value:c.responseStyle,onValueChange:f=>d("responseStyle",f),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"helpful",children:"Helpful & Informative"}),a.jsx(ve,{value:"concise",children:"Concise & Direct"}),a.jsx(ve,{value:"detailed",children:"Detailed & Comprehensive"}),a.jsx(ve,{value:"conversational",children:"Conversational"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"specialInstructions",children:"Special Instructions"}),a.jsx(Bt,{id:"specialInstructions",placeholder:"Any specific behavior, responses, or features you want the chatbot to have",value:c.specialInstructions,onChange:f=>d("specialInstructions",f.target.value),rows:3})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Contact & Timeline"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"priority",children:"Priority"}),a.jsxs(pt,{value:c.priority,onValueChange:f=>d("priority",f),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"low",children:"Low"}),a.jsx(ve,{value:"medium",children:"Medium"}),a.jsx(ve,{value:"high",children:"High"}),a.jsx(ve,{value:"urgent",children:"Urgent"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"preferredContactMethod",children:"Preferred Contact Method"}),a.jsxs(pt,{value:c.preferredContactMethod,onValueChange:f=>d("preferredContactMethod",f),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"email",children:"Email"}),a.jsx(ve,{value:"phone",children:"Phone"}),a.jsx(ve,{value:"dashboard",children:"Dashboard Message"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"timeline",children:"Timeline"}),a.jsx(Ue,{id:"timeline",placeholder:"e.g., Within 1 week, ASAP, No rush",value:c.timeline,onChange:f=>d("timeline",f.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"additionalNotes",children:"Additional Notes"}),a.jsx(Bt,{id:"additionalNotes",placeholder:"Any other information or special requirements",value:c.additionalNotes,onChange:f=>d("additionalNotes",f.target.value),rows:3})]})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:a.jsx("p",{children:"Your request will be reviewed and you'll be contacted with updates."})}),a.jsx(le,{onClick:u,disabled:i||!c.chatbotName||!c.chatbotPurpose,className:"min-w-[120px]",children:i?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Submitting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Kc,{className:"h-4 w-4 mr-2"}),"Submit Request"]})})]})]})]})},NH=()=>{const{toast:e}=vt(),{user:t}=Mr(),[r,s]=L.useState([]),[n,i]=L.useState(!0),[o,c]=L.useState(""),[l,d]=L.useState("all"),[u,f]=L.useState(!1),[h,m]=L.useState(!1),[g,p]=L.useState([]),[x,y]=L.useState(null),[w,v]=L.useState(null);L.useEffect(()=>{t!=null&&t.id&&(j(),S())},[t==null?void 0:t.id]);const j=async()=>{try{i(!0);const{data:A,error:E}=await he.from("creators").select("id").eq("user_id",t==null?void 0:t.id).single();if(E||!A){console.error("Creator not found:",E);return}const{data:U,error:Y}=await he.from("chatbot_requests").select(`
          *,
          projects!inner(
            id,
            title,
            end_clients!inner(
              id,
              name,
              creator_id
            )
          )
        `).eq("projects.end_clients.creator_id",A.id).eq("deleted_by_creator",!1).order("created_at",{ascending:!1});if(Y)throw Y;const ee=(U||[]).map(se=>({id:se.id,chatbot_name:se.chatbot_name,chatbot_purpose:se.chatbot_purpose,status:se.status,priority:se.priority,created_at:se.created_at,updated_at:se.updated_at,admin_notes:se.admin_notes,chatbot_link:se.chatbot_link,chatbot_url:se.chatbot_url,estimated_completion_date:se.estimated_completion_date,project_title:se.projects.title,client_name:se.projects.end_clients.name,target_audience:se.target_audience,language:se.language,tone:se.tone,response_style:se.response_style,preferred_contact_method:se.preferred_contact_method,timeline:se.timeline,additional_notes:se.additional_notes}));s(ee)}catch(A){console.error("Error loading requests:",A),e({title:"Error",description:"Failed to load chatbot requests",variant:"destructive"})}finally{i(!1)}},S=async()=>{try{const{data:A,error:E}=await he.from("creators").select("id").eq("user_id",t==null?void 0:t.id).single();if(E||!A){console.error("Creator not found:",E);return}const{data:U,error:Y}=await he.from("projects").select(`
          id,
          title,
          end_clients!inner(
            id,
            name,
            creator_id
          )
        `).eq("end_clients.creator_id",A.id).order("created_at",{ascending:!1});if(Y)throw Y;p(U||[])}catch(A){console.error("Error loading projects:",A),e({title:"Error",description:"Failed to load projects",variant:"destructive"})}},_=async A=>{try{v(A);const{error:E}=await he.rpc("soft_delete_chatbot_request",{request_id:A,deletion_reason:"Deleted by creator"});if(E)throw E;e({title:"Request Deleted",description:"Your chatbot request has been deleted successfully."}),await j()}catch(E){console.error("Error deleting request:",E),e({title:"Delete Failed",description:E.message||"Failed to delete the request. Please try again.",variant:"destructive"})}finally{v(null)}},T=A=>{switch(A){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"in_progress":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},N=A=>{switch(A){case"low":return"bg-green-100 text-green-800 border-green-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"urgent":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},b=A=>{switch(A){case"pending":return a.jsx(it,{className:"h-4 w-4"});case"in_progress":return a.jsx(De,{className:"h-4 w-4 animate-spin"});case"completed":return a.jsx(Pt,{className:"h-4 w-4"});case"rejected":return a.jsx(Mt,{className:"h-4 w-4"});default:return a.jsx(it,{className:"h-4 w-4"})}},O=r.filter(A=>{const E=A.chatbot_name.toLowerCase().includes(o.toLowerCase())||A.client_name.toLowerCase().includes(o.toLowerCase())||A.project_title.toLowerCase().includes(o.toLowerCase()),U=l==="all"||A.status===l;return E&&U});return n?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(De,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading your chatbot requests..."})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"My Chatbot Requests"}),a.jsx("p",{className:"text-muted-foreground",children:"Track and manage your chatbot development requests"})]}),a.jsxs(le,{onClick:()=>m(!0),children:[a.jsx(Ts,{className:"h-4 w-4 mr-2"}),"New Request"]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ei,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),a.jsx(Ue,{placeholder:"Search by chatbot name, client, or project...",value:o,onChange:A=>c(A.target.value),className:"pl-10"})]}),a.jsxs(pt,{value:l,onValueChange:d,children:[a.jsx(ct,{className:"w-[180px]",children:a.jsx(gt,{placeholder:"Filter by status"})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All Status"}),a.jsx(ve,{value:"pending",children:"Pending"}),a.jsx(ve,{value:"in_progress",children:"In Progress"}),a.jsx(ve,{value:"completed",children:"Completed"}),a.jsx(ve,{value:"rejected",children:"Rejected"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(oe,{children:a.jsx(de,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(it,{className:"h-4 w-4 text-yellow-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Pending"}),a.jsx("p",{className:"text-2xl font-bold",children:r.filter(A=>A.status==="pending").length})]})]})})}),a.jsx(oe,{children:a.jsx(de,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(De,{className:"h-4 w-4 text-blue-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"In Progress"}),a.jsx("p",{className:"text-2xl font-bold",children:r.filter(A=>A.status==="in_progress").length})]})]})})}),a.jsx(oe,{children:a.jsx(de,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Pt,{className:"h-4 w-4 text-green-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Completed"}),a.jsx("p",{className:"text-2xl font-bold",children:r.filter(A=>A.status==="completed").length})]})]})})}),a.jsx(oe,{children:a.jsx(de,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(da,{className:"h-4 w-4 text-purple-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold",children:r.length})]})]})})})]}),O.length===0?a.jsx(oe,{children:a.jsxs(de,{className:"p-8 text-center",children:[a.jsx(da,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No chatbot requests found"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:o||l!=="all"?"Try adjusting your search or filter criteria.":"You haven't submitted any chatbot requests yet."}),!o&&l==="all"&&a.jsxs(le,{onClick:()=>m(!0),children:[a.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Submit Your First Request"]})]})}):a.jsx("div",{className:"grid gap-4",children:O.map(A=>a.jsx(oe,{className:"hover:shadow-md transition-shadow",children:a.jsx(de,{className:"p-6",children:a.jsx("div",{className:"flex items-start justify-between",children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("h3",{className:"text-lg font-semibold",children:A.chatbot_name}),a.jsx(Le,{className:T(A.status),children:a.jsxs("div",{className:"flex items-center gap-1",children:[b(A.status),A.status.replace("_"," ")]})}),a.jsx(Le,{className:N(A.priority),children:A.priority})]}),a.jsx("p",{className:"text-muted-foreground mb-3",children:A.chatbot_purpose}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qn,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:A.project_title})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(tn,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:A.client_name})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Yr,{className:"h-4 w-4 text-muted-foreground"}),a.jsxs("span",{children:["Submitted ",rn(new Date(A.created_at),"MMM d, yyyy")]})]}),A.language&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jt,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:A.language.toUpperCase()})]})]}),A.admin_notes&&a.jsxs("div",{className:"mt-4 p-3 bg-muted rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Sa,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"text-sm font-medium",children:"Admin Notes"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:A.admin_notes})]}),A.chatbot_link&&a.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(Pt,{className:"h-4 w-4 text-green-600"}),a.jsx("span",{className:"text-sm font-medium text-green-800",children:"Your Chatbot is Ready!"})]}),a.jsxs(le,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>window.open(A.chatbot_link,"_blank"),children:[a.jsx(Lr,{className:"h-4 w-4 mr-2"}),"Open Chatbot"]})]}),A.estimated_completion_date&&A.status!=="completed"&&a.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Yr,{className:"h-4 w-4 text-blue-600"}),a.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["Estimated completion: ",rn(new Date(A.estimated_completion_date),"MMM d, yyyy")]})]})}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsxs(le,{variant:"outline",size:"sm",onClick:()=>_(A.id),disabled:w===A.id,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[w===A.id?a.jsx(De,{className:"h-4 w-4 animate-spin mr-2"}):a.jsx(js,{className:"h-4 w-4 mr-2"}),"Delete Request"]})})]})})})},A.id))}),h&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Select Project for Chatbot Request"}),a.jsx(le,{variant:"ghost",size:"sm",onClick:()=>m(!1),children:a.jsx(yr,{className:"h-4 w-4"})})]}),g.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(qn,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Projects Found"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:"You need to create a project first before submitting a chatbot request."}),a.jsx(le,{onClick:()=>m(!1),children:"Close"})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:"Choose a project to create a chatbot request for:"}),g.map(A=>a.jsx(oe,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>{m(!1),f(!0),y(A)},children:a.jsx(de,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:A.title}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Client: ",A.end_clients.name]})]}),a.jsx(le,{size:"sm",variant:"outline",children:"Select"})]})})},A.id))]})]})})}),u&&x&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Submit New Chatbot Request"}),a.jsx(le,{variant:"ghost",size:"sm",onClick:()=>{f(!1),y(null)},children:a.jsx(yr,{className:"h-4 w-4"})})]}),a.jsx(bH,{projectId:x.id,projectTitle:x.title,clientName:x.end_clients.name,onRequestSubmitted:()=>{f(!1),y(null),j(),e({title:"Request Submitted",description:"Your chatbot request has been submitted successfully!"})}})]})})})]})};function jH(e){try{return JSON.stringify(e,null,2).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}catch(t){return console.error("Error sanitizing JSON data:",t),"{}"}}function TH(e){try{const t=JSON.stringify(e);return![/<script/gi,/javascript:/gi,/on\w+\s*=/gi,/expression\(/gi,/@import/gi].some(s=>s.test(t))}catch{return!1}}const EH=({type:e="website"})=>{const{agencySettings:t}=xu(),s=(()=>{const n={"@context":"https://schema.org","@type":"Organization",name:`${t.agency_name} Dashboard`,description:"gestisci il tuo virtual tour con un click",url:"https://tourcompanion.com",logo:{"@type":"ImageObject",url:`https://tourcompanion.com${t.agency_logo}`,width:512,height:512},sameAs:[],address:{"@type":"PostalAddress",addressCountry:"IT"},contactPoint:{"@type":"ContactPoint",contactType:"customer service",availableLanguage:"Italian"}};return e==="website"?{"@context":"https://schema.org","@type":"WebSite",name:`${t.agency_name} Dashboard`,description:"gestisci il tuo virtual tour con un click",url:"https://tourcompanion.com",publisher:n,potentialAction:{"@type":"SearchAction",target:"https://tourcompanion.com/?search={search_term_string}","query-input":"required name=search_term_string"},inLanguage:"it",applicationCategory:"BusinessApplication",applicationSubCategory:"Real Estate",browserRequirements:"Requires JavaScript. Requires HTML5.",operatingSystem:"Any",offers:{"@type":"Offer",price:"0",priceCurrency:"EUR",category:"Free"}}:e==="realestate"?{"@context":"https://schema.org","@type":"Service",name:"Tour Virtuali Immobiliari",description:"Servizio professionale di tour virtuali per immobili, gestione appuntamenti e analisi statistiche",provider:n,serviceType:"Real Estate Services",areaServed:{"@type":"Country",name:"Italy"},hasOfferCatalog:{"@type":"OfferCatalog",name:"Servizi Immobiliari",itemListElement:[{"@type":"Offer",itemOffered:{"@type":"Service",name:"Tour Virtuali",description:"Creazione e gestione di tour virtuali per immobili"}},{"@type":"Offer",itemOffered:{"@type":"Service",name:"Gestione Appuntamenti",description:"Sistema di prenotazione e gestione appuntamenti per visite immobiliari"}},{"@type":"Offer",itemOffered:{"@type":"Service",name:"Analisi Statistiche",description:"Dashboard con statistiche e analisi performance immobiliare"}}]}}:n})();return TH(s)?a.jsx("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:jH(s)}}):(console.warn("Invalid structured data detected, skipping rendering"),null)},SH=()=>{"serviceWorker"in navigator&&window.addEventListener("load",()=>{const e=window.location.pathname.startsWith("/client/"),t=e?window.location.pathname:"/";console.log("Registering service worker with scope:",t),navigator.serviceWorker.register("/sw.js",{scope:t}).then(r=>{console.log("SW registered with scope:",t,r),r.addEventListener("updatefound",()=>{const s=r.installing;s&&s.addEventListener("statechange",()=>{s.state==="installed"&&navigator.serviceWorker.controller&&confirm(e?"New version available! Reload to update?":"Nuova versione disponibile! Vuoi ricaricare per aggiornare?")&&(s.postMessage({type:"SKIP_WAITING"}),window.location.reload())})})}).catch(r=>{console.log("SW registration failed: ",r)}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()})})},Dw=e=>{switch(new URLSearchParams(window.location.search).get("shortcut")){case"tours":e("tour-virtuali");break;case"appointments":e("appuntamenti");break;case"stats":e("statistiche");break}},AH=()=>{const e=()=>{const t=navigator.onLine?"online":"offline";document.body.setAttribute("data-connection",t),navigator.onLine?kH():CH()};window.addEventListener("online",e),window.addEventListener("offline",e),e()},CH=()=>{if(document.querySelector("[data-offline-message]"))return;const t=document.createElement("div");t.setAttribute("data-offline-message","true"),t.textContent=" Modalit offline - Alcune funzioni potrebbero non essere disponibili",t.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    background: hsl(var(--warning));
    color: hsl(var(--warning-foreground));
    text-align: center;
    padding: 8px;
    font-size: 14px;
    z-index: 9999;
    animation: slideInDown 0.3s ease;
  `,document.body.appendChild(t)},kH=()=>{const e=document.querySelector("[data-offline-message]");e&&e.remove()},RH=Object.freeze(Object.defineProperty({__proto__:null,handleShortcuts:Dw,registerServiceWorker:SH,setupOfflineDetection:AH},Symbol.toStringTag,{value:"Module"})),IH=()=>{const[e,t]=L.useState("projects"),[r,s]=L.useState(null),[n,i]=L.useState(null);L.useEffect(()=>{Dw(t)},[]);const o=d=>{i(d),t("client-dashboard")},c=()=>{i(null),t("projects")},l=()=>{switch(e){case"projects":return a.jsx(ah,{onPageChange:t,onCreateRequest:s,onClientClick:o});case"client-dashboard":return a.jsx(wH,{client:n,onBack:c});case"client-requests":return a.jsx(Oj,{prefilledData:r,onDataUsed:()=>s(null)});case"media-library":return a.jsx(Pj,{});case"clients":return a.jsx(_H,{onClientSelect:o});case"analytics":return a.jsx(z_,{});case"chatbots":return a.jsx(NH,{});case"support":return a.jsx(wj,{});case"settings":return a.jsx(Dj,{});default:return a.jsx(ah,{onPageChange:t,onCreateRequest:s,onClientClick:o})}};return a.jsxs($x,{children:[a.jsx(EH,{type:"website"}),a.jsx(vj,{currentPage:e,onPageChange:t,children:l()})]})},OH=Object.freeze(Object.defineProperty({__proto__:null,default:IH},Symbol.toStringTag,{value:"Module"})),PH=()=>{const e=rs(),t=D_();return L.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-secondary/20 px-4",children:a.jsxs(oe,{className:"w-full max-w-md text-center",children:[a.jsxs(ye,{children:[a.jsx("div",{className:"text-6xl font-bold text-muted-foreground mb-4",children:"404"}),a.jsx(we,{className:"text-2xl",children:"Page Not Found"}),a.jsx(He,{children:"The page you are looking for does not exist or has been moved."})]}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs(le,{onClick:()=>e("/dashboard"),className:"w-full",children:[a.jsx(L_,{className:"mr-2 h-4 w-4"}),"Go to Dashboard"]}),a.jsxs(le,{variant:"outline",onClick:()=>e(-1),className:"w-full",children:[a.jsx(Xi,{className:"mr-2 h-4 w-4"}),"Go Back"]})]})]})})},DH=Object.freeze(Object.defineProperty({__proto__:null,default:PH},Symbol.toStringTag,{value:"Module"})),LH=()=>{const e=rs(),{toast:t}=vt(),{signIn:r,signUp:s}=Mr(),[n,i]=L.useState(!1),[o,c]=L.useState("signin"),[l,d]=L.useState(!1),[u,f]=L.useState({email:"",password:""}),[h,m]=L.useState({email:"",password:"",confirmPassword:"",agencyName:"",contactEmail:"",phone:"",website:""}),g="bg-gray-50 border-gray-300 text-gray-900 placeholder:text-gray-500",p=async y=>{var w;y.preventDefault(),i(!0);try{const{data:v,error:j}=await r(u.email,u.password);if(j){t({title:"Authentication Error",description:j.message||"Failed to sign in. Please check your credentials.",variant:"destructive"});return}if(v!=null&&v.user){console.log(" User signed in successfully:",v.user.id);const{data:S,error:_}=await he.from("creators").select("*").eq("user_id",v.user.id).single();if(console.log(" Creator profile check:",{creatorData:S,creatorError:_}),_){console.error(" Database error:",_),t({title:"Database Connection Issue",description:`Database error: ${_.message}. Please refresh the page and try again.`,variant:"destructive"});return}if(S)console.log(" Creator profile found:",S.agency_name);else if(console.log(" No creator profile found, attempting to create one..."),v.user.email_confirmed_at){const{error:T}=await he.from("creators").insert({user_id:v.user.id,agency_name:((w=v.user.user_metadata)==null?void 0:w.agency_name)||"TourCompanion",contact_email:v.user.email||"",agency_logo:"/tourcompanion-logo.png",subscription_plan:"basic",subscription_status:"active"});if(T){console.error("Failed to create creator profile:",T),console.error("Error details:",T),t({title:"Account Setup Issue",description:`Profile setup failed: ${T.message}. Please try signing out and back in, or contact support if the issue persists.`,variant:"destructive"}),await he.auth.signOut();return}else console.log(" Creator profile created successfully")}else{t({title:" Email Not Confirmed Yet",description:`Please check your email (${v.user.email}) and click the confirmation link before signing in. Check your spam folder if you don't see it.`,variant:"destructive"}),await he.auth.signOut();return}t({title:"Welcome Back!",description:`Signed in successfully as ${(S==null?void 0:S.agency_name)||"My Agency"}`}),d(!1),e("/")}}catch(v){console.error("Sign in error:",v),t({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{i(!1)}},x=async y=>{if(y.preventDefault(),h.password!==h.confirmPassword){t({title:"Validation Error",description:"Passwords do not match.",variant:"destructive"});return}if(h.password.length<6){t({title:"Validation Error",description:"Password must be at least 6 characters long.",variant:"destructive"});return}if(!h.agencyName||!h.contactEmail){t({title:"Validation Error",description:"Please fill in all required fields.",variant:"destructive"});return}const w=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!w.test(h.email)){t({title:"Validation Error",description:"Please enter a valid email address.",variant:"destructive"});return}if(!w.test(h.contactEmail)){t({title:"Validation Error",description:"Please enter a valid contact email address.",variant:"destructive"});return}i(!0);try{const{data:v,error:j}=await s(h.email,h.password,{agency_name:h.agencyName,phone:h.phone,website:h.website});if(j){t({title:"Sign Up Error",description:j.message||"Failed to create account.",variant:"destructive"});return}if(v!=null&&v.user){if(console.log("User created:",v.user.email,"Confirmed:",v.user.email_confirmed_at),v.user.email_confirmed_at===null){t({title:" Email Confirmation Required!",description:`We sent a confirmation link to ${h.email}. Please check your inbox (and spam folder) and click the confirmation link to activate your account. You can then sign in below.`,variant:"default"}),d(!0),c("signin"),f({email:h.email,password:h.password}),m({email:"",password:"",confirmPassword:"",agencyName:"",contactEmail:"",phone:"",website:""});return}console.log("Unexpected: User email already confirmed during signup"),t({title:"Account Created!",description:"Your creator account has been set up successfully. You can now sign in."}),c("signin"),f({email:h.email,password:h.password}),m({email:"",password:"",confirmPassword:"",agencyName:"",contactEmail:"",phone:"",website:""})}}catch(v){console.error("Sign up error:",v),t({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}finally{i(!1)}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white p-4",children:a.jsxs("div",{className:"w-full max-w-md",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-primary rounded-2xl mb-4 shadow-lg",children:a.jsx(eh,{className:"h-8 w-8 text-white"})}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"TourCompanion"}),a.jsx("p",{className:"text-gray-600",children:"Manage your virtual tours and clients"})]}),a.jsxs(oe,{className:"shadow-2xl border-gray-200 bg-white text-gray-900",children:[a.jsxs(ye,{children:[a.jsx(we,{className:"text-gray-900",children:"Tour Creator Portal"}),a.jsx(He,{className:"text-gray-600",children:"Sign in to your account or create a new one"})]}),a.jsx(de,{children:a.jsxs(ln,{value:o,onValueChange:y=>c(y),children:[a.jsxs(ks,{className:"grid w-full grid-cols-2 mb-6",children:[a.jsx(bt,{value:"signin",children:"Sign In"}),a.jsx(bt,{value:"signup",children:"Sign Up"})]}),a.jsxs(Nt,{value:"signin",children:[l&&u.email&&a.jsx("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:a.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[a.jsx("strong",{children:" IMPORTANT: Email Confirmation Required!"}),a.jsx("br",{}),"We sent a confirmation link to ",a.jsx("strong",{children:u.email}),".",a.jsx("br",{}),a.jsx("br",{}),a.jsx("strong",{children:"Next Steps:"}),a.jsx("br",{}),"1. Check your inbox (and spam folder)",a.jsx("br",{}),"2. Click the confirmation link in the email",a.jsx("br",{}),"3. Come back here and sign in below"]})}),a.jsxs("form",{onSubmit:p,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"signin-email",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(Xs,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{id:"signin-email",type:"email",placeholder:"your@email.com",className:`pl-9 ${g}`,value:u.email,onChange:y=>f({...u,email:y.target.value}),required:!0,disabled:n})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"signin-password",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Il,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{id:"signin-password",type:"password",placeholder:"",className:`pl-9 ${g}`,value:u.password,onChange:y=>f({...u,password:y.target.value}),required:!0,disabled:n})]})]}),a.jsx(le,{type:"submit",className:"w-full",disabled:n,children:n?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing In..."]}):"Sign In"})]})]}),a.jsxs(Nt,{value:"signup",children:[a.jsx("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:a.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200",children:[a.jsx("strong",{children:" After signing up:"})," You'll receive an email confirmation link. Click it to activate your account, then return here to sign in."]})}),a.jsxs("form",{onSubmit:x,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"signup-agency",children:"Agency Name *"}),a.jsxs("div",{className:"relative",children:[a.jsx(eh,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{id:"signup-agency",type:"text",placeholder:"Your Agency Name",className:`pl-9 ${g}`,value:h.agencyName,onChange:y=>m({...h,agencyName:y.target.value}),required:!0,disabled:n})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"signup-email",children:"Email *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Xs,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{id:"signup-email",type:"email",placeholder:"your@email.com",className:`pl-9 ${g}`,value:h.email,onChange:y=>m({...h,email:y.target.value}),required:!0,disabled:n})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"signup-contact-email",children:"Contact Email *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Xs,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{id:"signup-contact-email",type:"email",placeholder:"contact@agency.com",className:`pl-9 ${g}`,value:h.contactEmail,onChange:y=>m({...h,contactEmail:y.target.value}),required:!0,disabled:n})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"signup-phone",children:"Phone"}),a.jsxs("div",{className:"relative",children:[a.jsx(F_,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{id:"signup-phone",type:"tel",placeholder:"+1 (555) 000-0000",className:`pl-9 ${g}`,value:h.phone,onChange:y=>m({...h,phone:y.target.value}),disabled:n})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"signup-website",children:"Website"}),a.jsxs("div",{className:"relative",children:[a.jsx(Mi,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{id:"signup-website",type:"url",placeholder:"https://yourwebsite.com",className:`pl-9 ${g}`,value:h.website,onChange:y=>m({...h,website:y.target.value}),disabled:n})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"signup-password",children:"Password *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Il,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{id:"signup-password",type:"password",placeholder:"",className:`pl-9 ${g}`,value:h.password,onChange:y=>m({...h,password:y.target.value}),required:!0,disabled:n})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"signup-confirm-password",children:"Confirm Password *"}),a.jsxs("div",{className:"relative",children:[a.jsx(Il,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{id:"signup-confirm-password",type:"password",placeholder:"",className:`pl-9 ${g}`,value:h.confirmPassword,onChange:y=>m({...h,confirmPassword:y.target.value}),required:!0,disabled:n})]})]}),a.jsx(le,{type:"submit",className:"w-full",disabled:n,children:n?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Account..."]}):"Create Account"})]})]})]})})]}),a.jsxs("div",{className:"text-center mt-4 space-y-2",children:[a.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account yet? ",a.jsx("span",{className:"text-primary font-medium cursor-pointer hover:underline",onClick:()=>c("signup"),children:"Sign up now"})," to start creating amazing virtual tours!"]}),a.jsx("p",{className:"text-xs text-gray-500",children:"By signing in, you agree to our Terms of Service and Privacy Policy"})]})]})})},FH=Object.freeze(Object.defineProperty({__proto__:null,default:LH},Symbol.toStringTag,{value:"Module"})),Lw=({projectId:e})=>{const t=Cu({projectId:e});return console.log("[ClientPortalAnalytics] Using unified analytics:",{projectId:e,loading:t.loading,error:t.error,totalViews:t.totalViews,totalVisitors:t.totalVisitors,avgEngagementTime:t.avgEngagementTime}),t.loading?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(De,{className:"h-8 w-8 animate-spin text-primary"})}):t.error?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"text-center text-red-500",children:a.jsxs("p",{children:["Error loading analytics: ",t.error]})})}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-green-400 to-blue-500 rounded-full mb-4",children:a.jsx(Pr,{className:"h-8 w-8 text-white"})}),a.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent",children:"Analytics Dashboard"}),a.jsx("p",{className:"text-gray-600 max-w-md mx-auto",children:"Real-time performance metrics and insights for your virtual tour"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsxs(oe,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-blue-50 to-blue-100",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-blue-500 rounded-full -translate-y-10 translate-x-10 opacity-10"}),a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-semibold text-blue-700",children:"Total Views"}),a.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:a.jsx(Ot,{className:"h-4 w-4 text-white"})})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:t.totalViews}),a.jsx("p",{className:"text-xs text-blue-500 font-medium",children:"Page impressions"})]})]}),a.jsxs(oe,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-green-50 to-green-100",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-green-500 rounded-full -translate-y-10 translate-x-10 opacity-10"}),a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-semibold text-green-700",children:"Unique Visitors"}),a.jsx("div",{className:"p-2 bg-green-500 rounded-lg",children:a.jsx(gr,{className:"h-4 w-4 text-white"})})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:t.totalVisitors}),a.jsx("p",{className:"text-xs text-green-500 font-medium",children:"Individual users"})]})]}),a.jsxs(oe,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-purple-50 to-purple-100",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-purple-500 rounded-full -translate-y-10 translate-x-10 opacity-10"}),a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-semibold text-purple-700",children:"Avg. Session"}),a.jsx("div",{className:"p-2 bg-purple-500 rounded-lg",children:a.jsx(it,{className:"h-4 w-4 text-white"})})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-1",children:gc(t.avgEngagementTime)}),a.jsx("p",{className:"text-xs text-purple-500 font-medium",children:"Time per visit"})]})]}),a.jsxs(oe,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-orange-50 to-orange-100",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-orange-500 rounded-full -translate-y-10 translate-x-10 opacity-10"}),a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-semibold text-orange-700",children:"Leads"}),a.jsx("div",{className:"p-2 bg-orange-500 rounded-lg",children:a.jsx(Pr,{className:"h-4 w-4 text-white"})})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-1",children:t.totalLeads}),a.jsx("p",{className:"text-xs text-orange-500 font-medium",children:"Generated leads"})]})]})]}),a.jsxs(oe,{className:"border-0 shadow-lg bg-gradient-to-r from-gray-50 to-gray-100",children:[a.jsx(ye,{children:a.jsx(we,{className:"text-lg font-semibold text-gray-800",children:"Performance Summary"})}),a.jsx(de,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[t.conversionRate,"%"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Conversion Rate"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[t.avgSatisfaction,"/5"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Avg. Satisfaction"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"Active"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Tracking Status"})]})]})})]})]})},Fw=({projectId:e})=>{const[t,r]=L.useState(!0),[s,n]=L.useState([]);L.useEffect(()=>{o()},[e]);const i=(c,l)=>c==="audio"||l.toLowerCase().includes("audio")?"Audio":c==="video"||l.toLowerCase().includes("video")?"Video":c==="image"||l.toLowerCase().includes("image")||l.toLowerCase().includes("photo")?"Image":c==="document"||l.toLowerCase().includes("document")||l.toLowerCase().includes("pdf")?"Document":c==="link"?"Link":"File",o=async()=>{try{r(!0);const{data:c,error:l}=await he.from("assets").select("*").eq("project_id",e).order("created_at",{ascending:!1});if(l)throw l;n(c||[])}catch(c){console.error("Error loading media:",c)}finally{r(!1)}};return t?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(De,{className:"h-8 w-8 animate-spin text-primary"})}):s.length===0?a.jsx(oe,{children:a.jsx(de,{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Ua,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No media files yet"}),a.jsx("p",{className:"text-muted-foreground",children:"Media assets for your virtual tour will appear here."})]})})}):a.jsx("div",{className:"space-y-6",children:a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsx(we,{children:"Media Library"}),a.jsx(He,{children:"View and access media links shared by your agency"})]}),a.jsx(de,{children:a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3",children:s.map(c=>a.jsx(oe,{className:"overflow-hidden hover:shadow-md transition-shadow",children:a.jsxs(de,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[(()=>{const l=c.file_type||"",u=(c.title||c.original_filename||"").toLowerCase(),f=l.toLowerCase();return f==="audio"||u.includes("audio")||u.includes("music")||u.includes("sound")?a.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-sm font-bold",children:""})}):f==="video"||u.includes("video")||u.includes("movie")||u.includes("clip")?a.jsx("div",{className:"w-8 h-8 bg-red-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-sm font-bold",children:""})}):f==="image"||u.includes("image")||u.includes("photo")||u.includes("picture")?a.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-sm font-bold",children:""})}):f==="document"||u.includes("document")||u.includes("pdf")||u.includes("file")?a.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-sm font-bold",children:""})}):a.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx("div",{className:"text-white text-sm font-bold",children:""})})})(),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-semibold text-sm truncate",children:c.title||c.original_filename}),a.jsx("p",{className:"text-xs text-muted-foreground",children:i(c.file_type||"",c.title||c.original_filename||"")})]})]}),a.jsx("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-3",children:a.jsx("span",{children:new Date(c.created_at).toLocaleDateString()})}),a.jsx(le,{size:"sm",variant:"outline",className:"w-full h-8 text-xs",asChild:!0,children:a.jsxs("a",{href:c.file_url,target:"_blank",rel:"noopener noreferrer",children:[a.jsx(Lr,{className:"h-3 w-3 mr-1"}),"View Media"]})})]})},c.id))})})]})})},Mw=({projectId:e,endClientId:t})=>{const[r,s]=L.useState(!0),[n,i]=L.useState([]),[o,c]=L.useState(!1),[l,d]=L.useState(!1),{toast:u}=vt(),[f,h]=L.useState({title:"",description:"",request_type:"content_change",priority:"medium"}),[m,g]=L.useState(""),p=L.useRef(null),x=L.useRef(null);L.useEffect(()=>{w()},[e]),L.useEffect(()=>{if(!e)return;console.log("[ClientPortalRequests] Setting up real-time subscriptions");const _=he.channel(`client-portal-requests-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"requests",filter:`project_id=eq.${e}`},T=>{console.log("[ClientPortalRequests] Request change detected:",T),y()}).subscribe(T=>{console.log("[ClientPortalRequests] Subscription status:",T)});return p.current=_,()=>{console.log("[ClientPortalRequests] Cleaning up real-time subscriptions"),p.current&&he.removeChannel(p.current),x.current&&clearTimeout(x.current)}},[e]);const y=()=>{x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{console.log("[ClientPortalRequests] Triggering debounced refresh"),w()},1e3)},w=async()=>{try{s(!0);const{data:_,error:T}=await he.from("requests").select("*").eq("project_id",e).order("created_at",{ascending:!1});if(T)throw T;i(_||[])}catch(_){console.error("Error loading requests:",_)}finally{s(!1)}},v=async()=>{if(!f.title||!f.description){u({title:"Missing information",description:"Please fill in all required fields.",variant:"destructive"});return}try{d(!0);const{error:_}=await he.from("requests").insert({project_id:e,end_client_id:t,title:f.title,description:f.description,request_type:f.request_type,priority:f.priority,status:"open",file_links:m});if(_)throw _;u({title:"Request submitted",description:"Your request has been sent to the creator."}),h({title:"",description:"",request_type:"content_change",priority:"medium"}),g(""),c(!1),w()}catch(_){console.error("Error submitting request:",_),u({title:"Failed to submit",description:_.message,variant:"destructive"})}finally{d(!1)}},j=_=>{switch(_){case"open":return"default";case"in_progress":return"secondary";case"completed":return"outline";case"cancelled":return"destructive";default:return"default"}},S=_=>{switch(_){case"urgent":return"destructive";case"high":return"default";case"medium":return"secondary";case"low":return"outline";default:return"secondary"}};return r?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(De,{className:"h-8 w-8 animate-spin text-primary"})}):a.jsx("div",{className:"space-y-6",children:a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(we,{children:"Requests"}),a.jsx(He,{children:"Submit change requests or view existing ones"})]}),a.jsxs(le,{onClick:()=>c(!o),children:[a.jsx(Ts,{className:"h-4 w-4 mr-2"}),"New Request"]})]})}),a.jsxs(de,{className:"space-y-4",children:[o&&a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsx(we,{className:"text-lg",children:"New Request"})}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"title",children:"Title"}),a.jsx(Ue,{id:"title",placeholder:"Brief description of your request",value:f.title,onChange:_=>h({...f,title:_.target.value})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"description",children:"Description"}),a.jsx(Bt,{id:"description",placeholder:"Provide details about what you'd like changed",rows:4,value:f.description,onChange:_=>h({...f,description:_.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"type",children:"Request Type"}),a.jsxs(pt,{value:f.request_type,onValueChange:_=>h({...f,request_type:_}),children:[a.jsx(ct,{id:"type",children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"content_change",children:"Content Change"}),a.jsx(ve,{value:"hotspot_update",children:"Hotspot Update"}),a.jsx(ve,{value:"design_modification",children:"Design Modification"}),a.jsx(ve,{value:"new_feature",children:"New Feature"}),a.jsx(ve,{value:"bug_fix",children:"Bug Fix"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"priority",children:"Priority"}),a.jsxs(pt,{value:f.priority,onValueChange:_=>h({...f,priority:_}),children:[a.jsx(ct,{id:"priority",children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"low",children:"Low"}),a.jsx(ve,{value:"medium",children:"Medium"}),a.jsx(ve,{value:"high",children:"High"}),a.jsx(ve,{value:"urgent",children:"Urgent"})]})]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"file-links",children:"Share Files (Optional)"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Paste links from Google Drive, Dropbox, WeTransfer, or other cloud storage services"}),a.jsx(Bt,{id:"file-links",placeholder:`https://drive.google.com/file/d/...
https://www.dropbox.com/s/...
https://wetransfer.com/downloads/...`,value:m,onChange:_=>g(_.target.value),rows:3,className:"resize-none"}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.jsx("p",{children:" One link per line"}),a.jsx("p",{children:" Make sure links are publicly accessible or shared with appropriate permissions"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(le,{onClick:v,disabled:l,children:l?a.jsxs(a.Fragment,{children:[a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}),"Submitting..."]}):"Submit Request"}),a.jsx(le,{variant:"outline",onClick:()=>c(!1),children:"Cancel"})]})]})]})]}),n.length>0?a.jsx("div",{className:"space-y-4",children:n.map(_=>a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx(we,{className:"text-base",children:_.title}),a.jsx(He,{className:"mt-1",children:_.description})]}),a.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[a.jsx(Le,{variant:j(_.status),children:_.status.replace("_"," ")}),a.jsx(Le,{variant:S(_.priority),children:_.priority})]})]})}),a.jsxs(de,{children:[a.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Sa,{className:"h-4 w-4"}),_.request_type.replace("_"," ")]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(it,{className:"h-4 w-4"}),rn(new Date(_.created_at),"MMM d, yyyy")]})]}),_.creator_notes&&a.jsxs("div",{className:"mt-4 p-3 bg-muted rounded-lg",children:[a.jsx("p",{className:"text-sm font-semibold mb-1",children:"Creator's Response:"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:_.creator_notes})]})]})]},_.id))}):!o&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Sa,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"No requests yet"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:"Create a request to communicate changes or updates with your creator."})]})]})]})})},Uw=({chatbot:e,projectId:t})=>{const[r,s]=L.useState([]),[n,i]=L.useState(""),[o,c]=L.useState(!1),{toast:l}=vt(),d=async()=>{if(!n.trim()||!e)return;const u=n.trim();i(""),s(f=>[...f,{role:"user",content:u}]),c(!0);try{const{data:f,error:h}=await he.functions.invoke("chat_answer",{body:{chatbot_id:e.id,message:u}});if(h)throw h;if(f!=null&&f.answer)s(m=>[...m,{role:"assistant",content:f.answer}]);else throw new Error("No response from chatbot")}catch(f){console.error("Chat error:",f),l({title:"Chat error",description:"Failed to get a response from the chatbot.",variant:"destructive"}),s(h=>[...h,{role:"assistant",content:"Sorry, I encountered an error. Please try again."}])}finally{c(!1)}};return e?a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(we,{children:e.name}),a.jsx(He,{children:"Ask questions about your virtual tour"})]}),a.jsx(Le,{variant:e.status==="active"?"default":"secondary",children:e.status})]})}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border rounded-lg p-4 h-96 overflow-y-auto space-y-4",children:[r.length===0&&a.jsxs("div",{className:"text-center text-muted-foreground py-12",children:[a.jsx(Jt,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),a.jsx("p",{children:e.welcome_message})]}),r.map((u,f)=>a.jsx("div",{className:`flex ${u.role==="user"?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`max-w-[80%] rounded-lg px-4 py-2 ${u.role==="user"?"bg-primary text-primary-foreground":"bg-muted text-foreground"}`,children:u.content})},f)),o&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"bg-muted rounded-lg px-4 py-2",children:a.jsx(De,{className:"h-4 w-4 animate-spin"})})})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Ue,{placeholder:"Type your message...",value:n,onChange:u=>i(u.target.value),onKeyPress:u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),d())},disabled:o||e.status!=="active"}),a.jsx(le,{onClick:d,disabled:o||!n.trim()||e.status!=="active",children:a.jsx(Kc,{className:"h-4 w-4"})})]})]})})]}):a.jsx(oe,{children:a.jsx(de,{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(da,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-2",children:"Chatbot not configured"}),a.jsx("p",{className:"text-muted-foreground",children:"The chatbot for this project hasn't been set up yet."})]})})})};function MH({projectId:e,onUpdate:t,debounceMs:r=1e3,enableLogging:s=!1}){const[n,i]=L.useState("disconnected"),[o,c]=L.useState(null),[l,d]=L.useState(null),u=L.useRef(null),f=L.useRef(null),h=L.useRef(null),m=L.useRef(0),g=5,p=L.useCallback((v,j)=>{s&&console.log(`[ClientPortalRealtime] ${v}`,j||"")},[s]),x=L.useCallback(()=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{p("Triggering debounced update"),c(new Date),t()},r)},[t,r,p]),y=L.useCallback(()=>{if(m.current>=g){p("Max reconnection attempts reached"),i("error"),d("Connection failed after multiple attempts");return}m.current+=1,p(`Attempting reconnection (${m.current}/${g})`),i("connecting"),h.current=setTimeout(()=>{i("disconnected")},Math.pow(2,m.current)*1e3)},[p]),w=L.useCallback(()=>{p("Force refresh triggered"),c(new Date),t()},[t,p]);return L.useEffect(()=>{if(!e)return;p("Setting up client portal real-time subscriptions",{projectId:e}),i("connecting"),d(null);const v=he.channel(`client-portal-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"projects",filter:`id=eq.${e}`},j=>{p("Project updated",j),x()}).on("postgres_changes",{event:"*",schema:"public",table:"assets",filter:`project_id=eq.${e}`},j=>{p("Assets updated",j),x()}).on("postgres_changes",{event:"*",schema:"public",table:"chatbots",filter:`project_id=eq.${e}`},j=>{p("Chatbot updated",j),x()}).on("postgres_changes",{event:"*",schema:"public",table:"requests",filter:`project_id=eq.${e}`},j=>{p("Requests updated",j),x()}).on("postgres_changes",{event:"*",schema:"public",table:"analytics",filter:`project_id=eq.${e}`},j=>{p("Analytics updated",j),x()}).subscribe(j=>{switch(p("Subscription status changed",j),j){case"SUBSCRIBED":i("connected"),d(null),m.current=0;break;case"CHANNEL_ERROR":case"TIMED_OUT":i("error"),d("Connection error"),y();break;case"CLOSED":i("disconnected");break;default:p("Unknown subscription status",j)}});return f.current=v,()=>{p("Cleaning up client portal subscriptions"),u.current&&clearTimeout(u.current),h.current&&clearTimeout(h.current),f.current&&he.removeChannel(f.current)}},[e,x,p,y]),L.useEffect(()=>{if(n==="disconnected"&&e){const v=setTimeout(()=>{p("Attempting reconnection after disconnect"),i("connecting")},2e3);return()=>clearTimeout(v)}},[n,e,p]),{connectionStatus:n,lastUpdate:o,error:l,forceRefresh:w}}class qf{constructor(t){kl(this,"storage",new Map);kl(this,"config");this.config=t,this.cleanup()}isAllowed(t){const r=Date.now(),s=`${this.config.keyPrefix}:${t}`;this.cleanup();const n=this.storage.get(s);return!n||r>n.resetTime?(this.storage.set(s,{count:1,resetTime:r+this.config.windowMs}),{allowed:!0,remaining:this.config.maxRequests-1,resetTime:r+this.config.windowMs}):n.count>=this.config.maxRequests?{allowed:!1,remaining:0,resetTime:n.resetTime}:(n.count++,this.storage.set(s,n),{allowed:!0,remaining:this.config.maxRequests-n.count,resetTime:n.resetTime})}cleanup(){const t=Date.now();for(const[r,s]of this.storage.entries())t>s.resetTime&&this.storage.delete(r)}getStatus(t){const r=Date.now(),s=`${this.config.keyPrefix}:${t}`,n=this.storage.get(s);return!n||r>n.resetTime?{count:0,remaining:this.config.maxRequests,resetTime:r+this.config.windowMs}:{count:n.count,remaining:this.config.maxRequests-n.count,resetTime:n.resetTime}}reset(t){const r=`${this.config.keyPrefix}:${t}`;this.storage.delete(r)}}const UH=new qf({maxRequests:10,windowMs:60*1e3,keyPrefix:"client_portal"});new qf({maxRequests:100,windowMs:60*1e3,keyPrefix:"api"});new qf({maxRequests:5,windowMs:15*60*1e3,keyPrefix:"auth"});const $H=()=>{const e=navigator.userAgent,t=navigator.language,r=Intl.DateTimeFormat().resolvedOptions().timeZone,s=`${e}:${t}:${r}`;return btoa(s).replace(/[^a-zA-Z0-9]/g,"").substring(0,16)},BH=()=>{const{projectId:e}=Xc(),t=rs(),{toast:r}=vt(),[s,n]=L.useState(!0),[i,o]=L.useState(null),[c,l]=L.useState(null),[d,u]=L.useState(null),[f,h]=L.useState(!1),[m,g]=L.useState(null),{activities:p,loading:x,error:y,refresh:w}=Pw({projectId:e||void 0,limit:10}),v=async()=>{try{n(!0);const S=$H(),_=UH.isAllowed(S);if(!_.allowed){h(!0),g({remaining:_.remaining,resetTime:_.resetTime}),n(!1);return}g({remaining:_.remaining,resetTime:_.resetTime});const{data:{user:T},error:N}=await he.auth.getUser();if(N||!T){r({title:"Authentication required",description:"Please log in to access your portal.",variant:"destructive"}),t("/auth");return}const{data:b,error:O}=await he.from("end_client_users").select("end_client_id, email").eq("auth_user_id",T.id).single();if(O||!b){r({title:"Access denied",description:"You do not have access to this portal.",variant:"destructive"}),t("/");return}const{data:A,error:E}=await he.from("projects").select("*").eq("id",e).single();if(E||!A){r({title:"Project not found",description:"This project does not exist or you do not have access.",variant:"destructive"}),t("/");return}o(A);const{data:U}=await he.from("end_clients").select("*").eq("id",b.end_client_id).single();l(U);const{data:Y}=await he.from("chatbots").select("*").eq("project_id",e).single();u(Y)}catch(S){console.error("Error loading portal data:",S),r({title:"Error",description:"Failed to load portal data.",variant:"destructive"})}finally{n(!1)}};L.useEffect(()=>{e&&v()},[e]),MH(e||"");const j=async()=>{await he.auth.signOut(),t("/auth")};if(s)return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:a.jsx(De,{className:"h-8 w-8 animate-spin text-primary"})});if(f){const S=new Date((m==null?void 0:m.resetTime)||Date.now()+6e4),_=Math.ceil((S.getTime()-Date.now())/1e3);return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:a.jsxs(oe,{className:"w-full max-w-md",children:[a.jsxs(ye,{className:"text-center",children:[a.jsx("div",{className:"mx-auto mb-4 h-12 w-12 rounded-full bg-destructive/10 flex items-center justify-center",children:a.jsx(it,{className:"h-6 w-6 text-destructive"})}),a.jsx(we,{className:"text-destructive",children:"Rate Limit Exceeded"}),a.jsx(He,{children:"Too many requests. Please wait before trying again."})]}),a.jsxs(de,{className:"text-center space-y-4",children:[a.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.jsx("p",{children:"You can try again in:"}),a.jsxs("p",{className:"font-mono text-lg font-semibold text-primary",children:[Math.floor(_/60),":",(_%60).toString().padStart(2,"0")]})]}),a.jsx(le,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full",children:"Try Again"})]})]})})}return i?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("header",{className:"border-b bg-card",children:a.jsx("div",{className:"container mx-auto px-4 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-foreground",children:i.title}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[c==null?void 0:c.company,"  Client Portal"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Le,{variant:i.status==="active"?"default":"secondary",children:i.status}),a.jsxs(le,{variant:"ghost",size:"sm",onClick:j,children:[a.jsx(md,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})})}),a.jsx("main",{className:"container mx-auto px-4 py-8",children:a.jsxs(ln,{defaultValue:"overview",className:"space-y-6",children:[a.jsxs(ks,{className:"grid w-full grid-cols-5",children:[a.jsxs(bt,{value:"overview",children:[a.jsx(Ot,{className:"h-4 w-4 mr-2"}),"Overview"]}),a.jsxs(bt,{value:"analytics",children:[a.jsx(Pr,{className:"h-4 w-4 mr-2"}),"Analytics"]}),a.jsxs(bt,{value:"media",children:[a.jsx(Ua,{className:"h-4 w-4 mr-2"}),"Media"]}),a.jsxs(bt,{value:"chatbot",children:[a.jsx(Jt,{className:"h-4 w-4 mr-2"}),"Chatbot"]}),a.jsxs(bt,{value:"requests",children:[a.jsx(Sa,{className:"h-4 w-4 mr-2"}),"Requests"]})]}),a.jsxs(Nt,{value:"overview",className:"space-y-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsx(we,{children:"Project Overview"}),a.jsx(He,{children:"View your virtual tour details and quick stats"})]}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),a.jsx("p",{className:"text-muted-foreground",children:i.description||"No description provided"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Type"}),a.jsx(Le,{variant:"outline",children:Su(i.project_type)})]}),i.tour_url&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Virtual Tour"}),a.jsx(le,{asChild:!0,children:a.jsxs("a",{href:i.tour_url,target:"_blank",rel:"noopener noreferrer",children:[a.jsx(Ot,{className:"h-4 w-4 mr-2"}),"View Tour"]})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Total Views"})}),a.jsx(de,{children:a.jsx("div",{className:"text-2xl font-bold",children:i.views||0})})]}),a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Chatbot Status"})}),a.jsx(de,{children:a.jsx(Le,{variant:(d==null?void 0:d.status)==="active"?"default":"secondary",children:(d==null?void 0:d.status)||"Not configured"})})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Project Status"})}),a.jsx(de,{children:a.jsx(Le,{variant:i.status==="active"?"default":"secondary",children:i.status})})]}),a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Created"})}),a.jsx(de,{children:a.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(i.created_at).toLocaleDateString()})})]}),a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Last Updated"})}),a.jsx(de,{children:a.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(i.updated_at).toLocaleDateString()})})]})]}),a.jsx(Au,{activities:p,loading:x,error:y,onRefresh:w,title:"Recent Activity",description:"Latest updates and interactions for this project",showStats:!0,maxItems:6})]}),a.jsx(Nt,{value:"analytics",children:a.jsx(Lw,{projectId:e})}),a.jsx(Nt,{value:"media",children:a.jsx(Fw,{projectId:e})}),a.jsx(Nt,{value:"chatbot",children:a.jsx(Uw,{chatbot:d,projectId:e})}),a.jsx(Nt,{value:"requests",children:a.jsx(Mw,{projectId:e,endClientId:c==null?void 0:c.id})})]})})]}):a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:a.jsx(oe,{className:"max-w-md",children:a.jsxs(ye,{children:[a.jsx(we,{children:"Project Not Found"}),a.jsx(He,{children:"The project you're looking for doesn't exist or you don't have access."})]})})})},GH=Object.freeze(Object.defineProperty({__proto__:null,default:BH},Symbol.toStringTag,{value:"Module"})),VH=()=>{const e=rs(),{toast:t}=vt(),[r,s]=L.useState(null),[n,i]=L.useState([]),o=[{id:"basic",name:"Basic",description:"Perfect for small agencies and freelancers",price:50,currency:"usd",interval:"month",features:["5 Virtual Tours","10 End Clients","10 Chatbots","Basic Analytics","Email Support","Standard Templates"],icon:a.jsx(Hn,{className:"h-6 w-6"}),color:"bg-blue-500"},{id:"pro",name:"Pro",description:"For growing agencies and businesses",price:99,currency:"usd",interval:"month",features:["Unlimited Virtual Tours","Unlimited End Clients","Unlimited Chatbots","Advanced Analytics","Priority Support","Custom Branding","API Access","White-label Options"],popular:!0,icon:a.jsx(ac,{className:"h-6 w-6"}),color:"bg-purple-500"}];L.useEffect(()=>{i(o)},[]);const c=async l=>{s(l);try{t({title:"Contact Us",description:`Interested in the ${l==="basic"?"Basic":"Pro"} plan? Please contact us at support@tourcompanion.com to get started.`,variant:"default"}),e("/contact")}catch(d){console.error("Error selecting plan:",d),t({title:"Error",description:"Unable to process your request. Please try again.",variant:"destructive"})}finally{s(null)}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Choose Your Plan"}),a.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Start creating amazing virtual tours and chatbots for your clients. All plans include our core features with no setup fees."})]}),a.jsx("div",{className:"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto",children:n.map(l=>a.jsxs(oe,{className:`relative overflow-hidden transition-all duration-300 hover:shadow-xl ${l.popular?"ring-2 ring-purple-500 scale-105":""}`,children:[l.popular&&a.jsxs("div",{className:"absolute top-0 right-0 bg-purple-500 text-white px-4 py-1 text-sm font-medium",children:[a.jsx(oa,{className:"h-4 w-4 inline mr-1"}),"Most Popular"]}),a.jsxs(ye,{className:"text-center pb-8",children:[a.jsx("div",{className:`inline-flex items-center justify-center w-12 h-12 rounded-full ${l.color} text-white mb-4`,children:l.icon}),a.jsx(we,{className:"text-2xl font-bold",children:l.name}),a.jsx(He,{className:"text-gray-600",children:l.description}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("span",{className:"text-4xl font-bold text-gray-900",children:["$",l.price]}),a.jsxs("span",{className:"text-gray-600",children:["/",l.interval]})]})]}),a.jsx(de,{className:"px-6",children:a.jsx("ul",{className:"space-y-3",children:l.features.map((d,u)=>a.jsxs("li",{className:"flex items-center",children:[a.jsx(Ns,{className:"h-5 w-5 text-green-500 mr-3 flex-shrink-0"}),a.jsx("span",{className:"text-gray-700",children:d})]},u))})}),a.jsx(Vx,{className:"px-6 pb-6",children:a.jsx(le,{onClick:()=>c(l.id),disabled:r===l.id,className:`w-full py-3 text-lg font-medium ${l.popular?"bg-purple-600 hover:bg-purple-700":"bg-blue-600 hover:bg-blue-700"}`,children:r===l.id?a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Processing..."]}):`Get ${l.name} Plan`})})]},l.id))}),a.jsxs("div",{className:"mt-16 text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-8",children:"All Plans Include"}),a.jsxs("div",{className:"grid md:grid-cols-3 gap-8 max-w-4xl mx-auto",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"bg-green-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:a.jsx(Ns,{className:"h-8 w-8 text-green-600"})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Setup Fees"}),a.jsx("p",{className:"text-gray-600",children:"Start immediately with no hidden costs"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"bg-blue-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:a.jsx(Hn,{className:"h-8 w-8 text-blue-600"})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Easy Setup"}),a.jsx("p",{className:"text-gray-600",children:"Get started in minutes, not hours"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"bg-purple-100 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4",children:a.jsx(oa,{className:"h-8 w-8 text-purple-600"})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"24/7 Support"}),a.jsx("p",{className:"text-gray-600",children:"We're here to help you succeed"})]})]})]}),a.jsxs("div",{className:"mt-16 text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-8",children:"Frequently Asked Questions"}),a.jsxs("div",{className:"max-w-3xl mx-auto text-left space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Can I change my plan later?"}),a.jsx("p",{className:"text-gray-600",children:"Yes! You can upgrade or downgrade your plan at any time from your billing dashboard."})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"What happens if I cancel?"}),a.jsx("p",{className:"text-gray-600",children:"You'll continue to have access to your plan until the end of your current billing period."})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Is there a free trial?"}),a.jsx("p",{className:"text-gray-600",children:"We offer a 14-day free trial for all new users. No credit card required to start."})]})]})]})]})})},HH=Object.freeze(Object.defineProperty({__proto__:null,default:VH},Symbol.toStringTag,{value:"Module"})),$w=L.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...s},n)=>a.jsx(kg,{ref:n,decorative:r,orientation:t,className:Ie("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...s}));$w.displayName=kg.displayName;const qH=()=>{const e=rs(),{toast:t}=vt(),[r,s]=L.useState(null),[n,i]=L.useState(!0),[o,c]=L.useState(null);L.useEffect(()=>{l()},[]);const l=async()=>{try{const y=localStorage.getItem("jwt_token");if(!y){e("/auth");return}const w=await fetch("/api/billing/subscription-status",{headers:{Authorization:`Bearer ${y}`}});if(w.status===401){localStorage.removeItem("jwt_token"),e("/auth");return}const v=await w.json();v.success?s(v.data):t({title:"Error",description:"Failed to load subscription data",variant:"destructive"})}catch(y){console.error("Error loading subscription data:",y),t({title:"Error",description:"Failed to load subscription data",variant:"destructive"})}finally{i(!1)}},d=async()=>{c("manage");try{const y=localStorage.getItem("jwt_token");if(!y)return;const v=await(await fetch("/api/billing/customer-portal",{method:"POST",headers:{Authorization:`Bearer ${y}`}})).json();v.success?window.open(v.data.url,"_blank"):t({title:"Error",description:"Failed to open billing portal",variant:"destructive"})}catch(y){console.error("Error opening billing portal:",y),t({title:"Error",description:"Failed to open billing portal",variant:"destructive"})}finally{c(null)}},u=async()=>{if(confirm("Are you sure you want to cancel your subscription? You will lose access at the end of your current billing period.")){c("cancel");try{const y=localStorage.getItem("jwt_token");if(!y)return;const v=await(await fetch("/api/billing/cancel-subscription",{method:"POST",headers:{Authorization:`Bearer ${y}`}})).json();v.success?(t({title:"Subscription Cancelled",description:"Your subscription will be cancelled at the end of the current period."}),l()):t({title:"Error",description:v.error||"Failed to cancel subscription",variant:"destructive"})}catch(y){console.error("Error cancelling subscription:",y),t({title:"Error",description:"Failed to cancel subscription",variant:"destructive"})}finally{c(null)}}},f=async()=>{c("reactivate");try{const y=localStorage.getItem("jwt_token");if(!y)return;const v=await(await fetch("/api/billing/reactivate-subscription",{method:"POST",headers:{Authorization:`Bearer ${y}`}})).json();v.success?(t({title:"Subscription Reactivated",description:"Your subscription has been reactivated."}),l()):t({title:"Error",description:v.error||"Failed to reactivate subscription",variant:"destructive"})}catch(y){console.error("Error reactivating subscription:",y),t({title:"Error",description:"Failed to reactivate subscription",variant:"destructive"})}finally{c(null)}},h=()=>{e("/pricing")};if(n)return a.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[a.jsx(De,{className:"h-12 w-12 animate-spin text-blue-600"}),a.jsx("p",{className:"ml-4 text-lg text-gray-700 dark:text-gray-300",children:"Loading billing information..."})]});if(!r)return a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs(oe,{className:"w-full max-w-md",children:[a.jsxs(ye,{className:"text-center",children:[a.jsx(Mt,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),a.jsx(we,{children:"No Subscription Found"}),a.jsx(He,{children:"You don't have an active subscription. Choose a plan to get started."})]}),a.jsx(de,{children:a.jsx(le,{onClick:h,className:"w-full",children:"Choose a Plan"})})]})});const m=y=>{switch(y){case"active":return"bg-green-100 text-green-800";case"past_due":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"inactive":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},g=y=>{switch(y){case"active":return a.jsx(pd,{className:"h-4 w-4"});case"past_due":return a.jsx(Mt,{className:"h-4 w-4"});case"cancelled":return a.jsx(Mt,{className:"h-4 w-4"});default:return a.jsx(Mt,{className:"h-4 w-4"})}},p=y=>y?new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",x=y=>y===-1?"Unlimited":y.toString();return a.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Billing & Subscription"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Manage your subscription, billing information, and account settings."})]}),a.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsxs(we,{className:"flex items-center",children:[r.plan==="pro"?a.jsx(ac,{className:"h-5 w-5 text-purple-600 mr-2"}):a.jsx(Hn,{className:"h-5 w-5 text-blue-600 mr-2"}),"Current Plan"]})}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-2xl font-bold",children:r.plan?r.plan.charAt(0).toUpperCase()+r.plan.slice(1):"No Plan"}),a.jsxs(Le,{className:m(r.status||"inactive"),children:[g(r.status||"inactive"),a.jsx("span",{className:"ml-1",children:r.status||"Inactive"})]})]}),r.isTester&&a.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(ac,{className:"h-4 w-4 text-blue-600 mr-2"}),a.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Tester Account"})]}),a.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"You have full access to all features as a tester."})]}),r.currentPeriodEnd&&a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(Yr,{className:"h-4 w-4 mr-2"}),a.jsxs("span",{children:[r.cancelAtPeriodEnd?"Cancels on":"Renews on",": ",p(r.currentPeriodEnd)]})]}),r.cancelAtPeriodEnd&&a.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Mt,{className:"h-4 w-4 text-yellow-600 mr-2"}),a.jsx("span",{className:"text-sm font-medium text-yellow-900",children:"Cancellation Scheduled"})]}),a.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Your subscription will be cancelled at the end of the current period."})]}),a.jsx($w,{}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-medium",children:"Plan Limits"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[a.jsxs("div",{children:["Projects: ",x(r.limits.maxProjects)]}),a.jsxs("div",{children:["Clients: ",x(r.limits.maxClients)]}),a.jsxs("div",{children:["Chatbots: ",x(r.limits.maxChatbots)]}),a.jsxs("div",{children:["Analytics: ",r.limits.analyticsAccess?"Yes":"No"]}),a.jsxs("div",{children:["Custom Branding: ",r.limits.customBranding?"Yes":"No"]}),a.jsxs("div",{children:["API Access: ",r.limits.apiAccess?"Yes":"No"]})]})]})]})]}),a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsxs(we,{className:"flex items-center",children:[a.jsx(Ka,{className:"h-5 w-5 mr-2"}),"Manage Subscription"]})}),a.jsxs(de,{className:"space-y-4",children:[!r.isTester&&a.jsxs(a.Fragment,{children:[a.jsxs(le,{onClick:d,disabled:o==="manage",className:"w-full",variant:"outline",children:[o==="manage"?a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}):a.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Manage Billing",a.jsx(Lr,{className:"h-4 w-4 ml-2"})]}),r.plan==="basic"&&r.status==="active"&&a.jsxs(le,{onClick:h,className:"w-full",children:[a.jsx(ac,{className:"h-4 w-4 mr-2"}),"Upgrade to Pro"]}),r.status==="active"&&!r.cancelAtPeriodEnd&&a.jsxs(le,{onClick:u,disabled:o==="cancel",variant:"destructive",className:"w-full",children:[o==="cancel"?a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}):a.jsx(Mt,{className:"h-4 w-4 mr-2"}),"Cancel Subscription"]}),r.cancelAtPeriodEnd&&a.jsxs(le,{onClick:f,disabled:o==="reactivate",className:"w-full",children:[o==="reactivate"?a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}):a.jsx(pd,{className:"h-4 w-4 mr-2"}),"Reactivate Subscription"]}),r.status!=="active"&&!r.isTester&&a.jsxs(le,{onClick:h,className:"w-full",children:[a.jsx(M_,{className:"h-4 w-4 mr-2"}),"Subscribe to a Plan"]})]}),r.isTester&&a.jsx("div",{className:"text-center py-4",children:a.jsx("p",{className:"text-sm text-gray-600",children:"As a tester, you have full access to all features without a subscription."})})]})]})]}),a.jsxs(oe,{className:"mt-6",children:[a.jsxs(ye,{children:[a.jsx(we,{children:"Billing History"}),a.jsx(He,{children:"View your past invoices and payments"})]}),a.jsx(de,{children:a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Fi,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Billing history will be available through the Stripe Customer Portal."}),!r.isTester&&a.jsx(le,{onClick:d,variant:"outline",className:"mt-4",children:"View Billing History"})]})})]})]})})},WH=Object.freeze(Object.defineProperty({__proto__:null,default:qH},Symbol.toStringTag,{value:"Module"})),Bw=L.forwardRef(({className:e,children:t,...r},s)=>a.jsxs(Rg,{ref:s,className:Ie("relative overflow-hidden",e),...r,children:[a.jsx(U_,{className:"h-full w-full rounded-[inherit]",children:t}),a.jsx(Gw,{}),a.jsx($_,{})]}));Bw.displayName=Rg.displayName;const Gw=L.forwardRef(({className:e,orientation:t="vertical",...r},s)=>a.jsx(Ig,{ref:s,orientation:t,className:Ie("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:a.jsx(B_,{className:"relative flex-1 rounded-full bg-border"})}));Gw.displayName=Ig.displayName;const zH=()=>{const{toast:e}=vt(),[t,r]=L.useState([]),[s,n]=L.useState(!0),[i,o]=L.useState(null),[c,l]=L.useState(!1),[d,u]=L.useState(""),[f,h]=L.useState(""),[m,g]=L.useState("all");L.useEffect(()=>{p()},[]);const p=async()=>{try{n(!0);const{data:w,error:v}=await he.rpc("get_all_support_requests");if(v)throw v;r(w||[])}catch(w){console.error("Error loading support requests:",w),e({title:"Error",description:"Failed to load support requests",variant:"destructive"})}finally{n(!1)}},x=async(w,v)=>{try{l(!0);const{error:j}=await he.from("support_requests").update({...v,updated_at:new Date().toISOString()}).eq("id",w);if(j)throw j;e({title:"Request Updated",description:"Support request has been updated successfully."}),r(S=>S.map(_=>_.id===w?{..._,...v}:_)),(i==null?void 0:i.id)===w&&o(S=>S?{...S,...v}:null),u(""),h("")}catch(j){console.error("Error updating support request:",j),e({title:"Update Failed",description:j.message||"Failed to update the request.",variant:"destructive"})}finally{l(!1)}},y=t.filter(w=>m==="all"?!0:w.status===m);return s?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(De,{className:"h-8 w-8 animate-spin text-primary"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Support Requests"}),a.jsx("p",{className:"text-muted-foreground",children:"Manage support requests from tour creators"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(oe,{children:a.jsx(de,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(it,{className:"h-4 w-4 text-yellow-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Open"}),a.jsx("p",{className:"text-2xl font-bold",children:t.filter(w=>w.status==="open").length})]})]})})}),a.jsx(oe,{children:a.jsx(de,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Mt,{className:"h-4 w-4 text-blue-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"In Progress"}),a.jsx("p",{className:"text-2xl font-bold",children:t.filter(w=>w.status==="in_progress").length})]})]})})}),a.jsx(oe,{children:a.jsx(de,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Pt,{className:"h-4 w-4 text-green-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Resolved"}),a.jsx("p",{className:"text-2xl font-bold",children:t.filter(w=>w.status==="resolved").length})]})]})})}),a.jsx(oe,{children:a.jsx(de,{className:"p-4",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Jt,{className:"h-4 w-4 text-purple-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Total"}),a.jsx("p",{className:"text-2xl font-bold",children:t.length})]})]})})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(we,{children:["Support Requests (",y.length,")"]}),a.jsxs(pt,{value:m,onValueChange:g,children:[a.jsx(ct,{className:"w-32",children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All"}),a.jsx(ve,{value:"open",children:"Open"}),a.jsx(ve,{value:"in_progress",children:"In Progress"}),a.jsx(ve,{value:"resolved",children:"Resolved"}),a.jsx(ve,{value:"closed",children:"Closed"})]})]})]})}),a.jsx(de,{children:a.jsx("div",{className:"space-y-3",children:y.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Jt,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No support requests found"}),a.jsx("p",{className:"text-muted-foreground",children:m==="all"?"No support requests have been submitted yet.":`No requests with status "${m}" found.`})]}):y.map(w=>a.jsx(oe,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${(i==null?void 0:i.id)===w.id?"ring-2 ring-primary":""}`,onClick:()=>o(w),children:a.jsxs(de,{className:"p-4",children:[a.jsx("div",{className:"flex items-start justify-between mb-2",children:a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:w.subject}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[w.agency_name,"  ",w.creator_email]})]})}),a.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yr,{className:"h-3 w-3"}),rn(new Date(w.created_at),"MMM d, yyyy")]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Jt,{className:"h-3 w-3"}),w.message.length>50?`${w.message.substring(0,50)}...`:w.message]})]})]})},w.id))})})]}),i?a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsx(we,{children:"Request Details"})}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Subject"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:i.subject})]}),a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Message"}),a.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:i.message})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Status"}),a.jsxs(pt,{value:i.status,onValueChange:w=>x(i.id,{status:w}),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"open",children:"Open"}),a.jsx(ve,{value:"in_progress",children:"In Progress"}),a.jsx(ve,{value:"resolved",children:"Resolved"}),a.jsx(ve,{value:"closed",children:"Closed"})]})]})]}),a.jsxs("div",{children:[a.jsx(Se,{className:"text-sm font-medium",children:"Priority"}),a.jsxs(pt,{value:i.priority,onValueChange:w=>x(i.id,{priority:w}),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"low",children:"Low"}),a.jsx(ve,{value:"medium",children:"Medium"}),a.jsx(ve,{value:"high",children:"High"}),a.jsx(ve,{value:"urgent",children:"Urgent"})]})]})]})]})]}),a.jsxs("div",{className:"space-y-3 border-t pt-4",children:[a.jsx("h3",{className:"font-semibold",children:"Creator Information"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qn,{className:"h-4 w-4"}),a.jsx("span",{children:i.agency_name})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xs,{className:"h-4 w-4"}),a.jsx("span",{children:i.creator_email})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Yr,{className:"h-4 w-4"}),a.jsxs("span",{children:["Submitted ",rn(new Date(i.created_at),"MMM d, yyyy HH:mm")]})]})]})]}),a.jsxs("div",{className:"space-y-2 border-t pt-4",children:[a.jsx(Se,{htmlFor:"adminResponse",children:"Admin Response"}),a.jsx(Bt,{id:"adminResponse",placeholder:"Type your response to the creator...",value:d,onChange:w=>u(w.target.value)}),a.jsx(le,{size:"sm",onClick:()=>x(i.id,{admin_response:d,status:"resolved"}),disabled:c||!d.trim(),children:c?a.jsx(De,{className:"h-3 w-3 animate-spin"}):"Send Response"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"adminNotes",children:"Admin Notes"}),a.jsx(Bt,{id:"adminNotes",placeholder:"Add internal notes about this request...",value:f,onChange:w=>h(w.target.value)}),a.jsx(le,{size:"sm",variant:"outline",onClick:()=>x(i.id,{admin_notes:f}),disabled:c,children:c?a.jsx(De,{className:"h-3 w-3 animate-spin"}):"Save Notes"})]})]})]}):a.jsx(oe,{children:a.jsx(de,{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Jt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a request to view details"})]})})})]})]})},YH=()=>{const{toast:e}=vt(),{user:t}=Mr(),[r,s]=L.useState([]),[n,i]=L.useState(!0),[o,c]=L.useState(null),[l,d]=L.useState(!1),[u,f]=L.useState(""),[h,m]=L.useState(""),[g,p]=L.useState(""),[x,y]=L.useState(""),[w,v]=L.useState("all"),[j,S]=L.useState(null),[_,T]=L.useState(null);L.useEffect(()=>{(async()=>{if(!t){S(!1);return}try{const{data:Y,error:ee}=await he.rpc("check_user_admin_status",{user_id:t.id});ee?(console.error("Error verifying admin access:",ee),T("Failed to verify admin access"),S(!1)):(S(Y===!0),Y===!0&&N())}catch(Y){console.error("Error in admin verification:",Y),T("Failed to verify admin access"),S(!1)}})()},[t]);const N=async()=>{try{i(!0);const{data:U,error:Y}=await he.from("chatbot_requests").select(`
          *,
          projects!inner(
            id,
            title,
            end_clients!inner(
              id,
              name,
              email,
              company,
              creators!inner(
                id,
                agency_name,
                contact_email
              )
            )
          )
        `).order("created_at",{ascending:!1});if(Y)throw Y;s(U||[])}catch(U){console.error("Error loading requests:",U),e({title:"Error",description:"Failed to load chatbot requests",variant:"destructive"})}finally{i(!1)}},b=async(U,Y)=>{try{d(!0);const{error:ee}=await he.from("chatbot_requests").update({...Y,updated_at:new Date().toISOString()}).eq("id",U);if(ee)throw ee;e({title:"Request Updated",description:"The chatbot request has been updated successfully"}),N()}catch(ee){console.error("Error updating request:",ee),e({title:"Update Failed",description:ee.message,variant:"destructive"})}finally{d(!1)}},O=U=>{switch(U){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"in_review":return"bg-blue-100 text-blue-800 border-blue-200";case"in_progress":return"bg-purple-100 text-purple-800 border-purple-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},A=U=>{switch(U){case"urgent":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},E=r.filter(U=>{const Y=U.chatbot_name.toLowerCase().includes(x.toLowerCase())||U.projects.title.toLowerCase().includes(x.toLowerCase())||U.projects.end_clients.name.toLowerCase().includes(x.toLowerCase())||U.projects.end_clients.creators.agency_name.toLowerCase().includes(x.toLowerCase()),ee=w==="all"||U.status===w;return Y&&ee});return j===null?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(De,{className:"h-8 w-8 animate-spin text-primary"})}):_?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(oe,{className:"w-full max-w-md",children:a.jsxs(de,{className:"text-center space-y-4 pt-6",children:[a.jsx(Mt,{className:"h-12 w-12 text-destructive mx-auto"}),a.jsx("h3",{className:"text-lg font-semibold text-destructive",children:"Access Verification Failed"}),a.jsx("p",{className:"text-muted-foreground",children:"Unable to verify your admin status. Please try again or contact support."}),a.jsx(le,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full",children:"Retry"})]})})}):j?n?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(De,{className:"h-8 w-8 animate-spin text-primary"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Admin Dashboard"}),a.jsx("p",{className:"text-muted-foreground",children:"Manage chatbot requests and support tickets from tour creators"})]}),a.jsxs(ln,{defaultValue:"chatbot-requests",className:"w-full",children:[a.jsxs(ks,{className:"grid w-full grid-cols-2",children:[a.jsx(bt,{value:"chatbot-requests",children:"Chatbot Requests"}),a.jsx(bt,{value:"support-requests",children:"Support Requests"})]}),a.jsxs(Nt,{value:"chatbot-requests",className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Chatbot Requests"}),a.jsx("p",{className:"text-muted-foreground",children:"Manage all chatbot creation requests from tour creators"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(oe,{children:a.jsxs(de,{className:"p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(it,{className:"h-4 w-4 text-yellow-600"}),a.jsx("span",{className:"text-sm font-medium",children:"Pending"})]}),a.jsx("div",{className:"text-2xl font-bold",children:r.filter(U=>U.status==="pending").length})]})}),a.jsx(oe,{children:a.jsxs(de,{className:"p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(De,{className:"h-4 w-4 text-blue-600"}),a.jsx("span",{className:"text-sm font-medium",children:"In Progress"})]}),a.jsx("div",{className:"text-2xl font-bold",children:r.filter(U=>U.status==="in_progress").length})]})}),a.jsx(oe,{children:a.jsxs(de,{className:"p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pt,{className:"h-4 w-4 text-green-600"}),a.jsx("span",{className:"text-sm font-medium",children:"Completed"})]}),a.jsx("div",{className:"text-2xl font-bold",children:r.filter(U=>U.status==="completed").length})]})}),a.jsx(oe,{children:a.jsxs(de,{className:"p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(da,{className:"h-4 w-4 text-purple-600"}),a.jsx("span",{className:"text-sm font-medium",children:"Total"})]}),a.jsx("div",{className:"text-2xl font-bold",children:r.length})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(we,{children:["All Requests (",E.length,")"]}),a.jsx(He,{children:"Click on a request to view details and manage it"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ei,{className:"h-4 w-4 absolute left-2 top-2.5 text-muted-foreground"}),a.jsx(Ue,{placeholder:"Search requests...",value:x,onChange:U=>y(U.target.value),className:"pl-8 w-64"})]}),a.jsxs(pt,{value:w,onValueChange:v,children:[a.jsxs(ct,{className:"w-32",children:[a.jsx(G_,{className:"h-4 w-4 mr-2"}),a.jsx(gt,{})]}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:"All"}),a.jsx(ve,{value:"pending",children:"Pending"}),a.jsx(ve,{value:"in_review",children:"In Review"}),a.jsx(ve,{value:"in_progress",children:"In Progress"}),a.jsx(ve,{value:"completed",children:"Completed"}),a.jsx(ve,{value:"cancelled",children:"Cancelled"})]})]})]})]})}),a.jsx(de,{children:a.jsx(Bw,{className:"h-[600px]",children:a.jsx("div",{className:"space-y-3",children:E.map(U=>a.jsx(oe,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${(o==null?void 0:o.id)===U.id?"ring-2 ring-primary":""}`,onClick:()=>{c(U),f(U.admin_notes||""),m(U.chatbot_url||""),p(U.estimated_completion_date?rn(new Date(U.estimated_completion_date),"yyyy-MM-dd"):"")},children:a.jsxs(de,{className:"p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold",children:U.chatbot_name}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[U.projects.title,"  ",U.projects.end_clients.name]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:U.projects.end_clients.creators.agency_name})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Le,{className:O(U.status),children:U.status.replace("_"," ")}),a.jsx(Le,{className:A(U.priority),children:U.priority})]})]}),a.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Yr,{className:"h-3 w-3"}),rn(new Date(U.created_at),"MMM d, yyyy")]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(tn,{className:"h-3 w-3"}),U.projects.end_clients.creators.agency_name]}),U.uploaded_files&&U.uploaded_files.length>0&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Sa,{className:"h-3 w-3"}),U.uploaded_files.length," files"]})]})]})},U.id))})})})]})}),a.jsx("div",{children:o?a.jsxs(oe,{children:[a.jsx(ye,{children:a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(da,{className:"h-5 w-5"}),"Request Details"]})}),a.jsxs(de,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold",children:"Basic Information"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Chatbot Name:"}),a.jsx("p",{children:o.chatbot_name})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Purpose:"}),a.jsx("p",{children:o.chatbot_purpose})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Target Audience:"}),a.jsx("p",{children:o.target_audience||"Not specified"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Language:"}),a.jsx("p",{children:o.language})]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold",children:"Client Information"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qn,{className:"h-4 w-4"}),a.jsx("span",{children:o.projects.end_clients.company})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(tn,{className:"h-4 w-4"}),a.jsx("span",{children:o.projects.end_clients.name})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Jt,{className:"h-4 w-4"}),a.jsx("span",{children:o.projects.end_clients.email})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qn,{className:"h-4 w-4"}),a.jsx("span",{children:o.projects.end_clients.creators.agency_name})]})]})]}),o.existing_content&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold",children:"Existing Content"}),a.jsx("div",{className:"text-sm bg-muted p-3 rounded-lg max-h-32 overflow-y-auto",children:o.existing_content})]}),o.uploaded_files&&o.uploaded_files.length>0&&a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"font-semibold",children:"Shared Files"}),a.jsx("div",{className:"space-y-2",children:o.uploaded_files.map((U,Y)=>a.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Sa,{className:"h-4 w-4"}),a.jsx("span",{className:"text-sm",children:U.name})]}),a.jsx(le,{size:"sm",variant:"outline",onClick:()=>window.open(U.url,"_blank"),children:a.jsx(Og,{className:"h-3 w-3"})})]},Y))})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"font-semibold",children:"Admin Actions"}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"status",children:"Status"}),a.jsxs(pt,{value:o.status,onValueChange:U=>b(o.id,{status:U}),children:[a.jsx(ct,{children:a.jsx(gt,{})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"pending",children:"Pending"}),a.jsx(ve,{value:"in_review",children:"In Review"}),a.jsx(ve,{value:"in_progress",children:"In Progress"}),a.jsx(ve,{value:"completed",children:"Completed"}),a.jsx(ve,{value:"cancelled",children:"Cancelled"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"adminNotes",children:"Admin Notes"}),a.jsx(Bt,{id:"adminNotes",placeholder:"Add notes about this request...",value:u,onChange:U=>f(U.target.value),rows:3}),a.jsx(le,{size:"sm",onClick:()=>b(o.id,{admin_notes:u}),disabled:l,children:l?a.jsx(De,{className:"h-3 w-3 animate-spin"}):"Save Notes"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"chatbotUrl",children:"Chatbot URL"}),a.jsx(Ue,{id:"chatbotUrl",placeholder:"https://your-chatbot-url.com",value:h,onChange:U=>m(U.target.value)}),a.jsx(le,{size:"sm",onClick:()=>b(o.id,{chatbot_url:h}),disabled:l,children:l?a.jsx(De,{className:"h-3 w-3 animate-spin"}):"Save URL"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Se,{htmlFor:"estimatedDate",children:"Estimated Completion"}),a.jsx(Ue,{id:"estimatedDate",type:"date",value:g,onChange:U=>p(U.target.value)}),a.jsx(le,{size:"sm",onClick:()=>b(o.id,{estimated_completion_date:g?new Date(g).toISOString():null}),disabled:l,children:l?a.jsx(De,{className:"h-3 w-3 animate-spin"}):"Save Date"})]})]})]})]}):a.jsx(oe,{children:a.jsx(de,{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(da,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Select a request to view details"})]})})})})]})]}),a.jsx(Nt,{value:"support-requests",className:"space-y-6",children:a.jsx(zH,{})})]})]}):a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(oe,{className:"w-full max-w-md",children:a.jsxs(de,{className:"text-center space-y-4 pt-6",children:[a.jsx(Ki,{className:"h-12 w-12 text-destructive mx-auto"}),a.jsx("h3",{className:"text-lg font-semibold text-destructive",children:"Access Denied"}),a.jsx("p",{className:"text-muted-foreground",children:"You don't have permission to access the admin panel. Only administrators can view this area."}),a.jsx(le,{onClick:()=>window.history.back(),variant:"outline",className:"w-full",children:"Go Back"})]})})})},KH=Object.freeze(Object.defineProperty({__proto__:null,default:YH},Symbol.toStringTag,{value:"Module"})),XH=()=>{const{projectId:e}=Xc(),t=rs(),{toast:r}=vt(),[s,n]=L.useState(!0),[i,o]=L.useState(null),[c,l]=L.useState(null),[d,u]=L.useState(null),f=async()=>{try{if(n(!0),!e){r({title:"Project not found",description:"No project ID provided.",variant:"destructive"}),t("/");return}const{data:h,error:m}=await he.from("projects").select(`
          *,
          end_clients (
            id,
            name,
            email,
            company,
            phone,
            website
          )
        `).eq("id",e).single();if(m||!h){r({title:"Project not found",description:"This project does not exist.",variant:"destructive"}),t("/");return}o(h),l(h.end_clients);const{data:g}=await he.from("chatbots").select("*").eq("project_id",e).single();u(g)}catch(h){console.error("Error loading portal data:",h),r({title:"Error",description:"Failed to load portal data.",variant:"destructive"})}finally{n(!1)}};return L.useEffect(()=>{f()},[e]),s?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(De,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading your portal..."})]})}):!i||!c?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Project Not Found"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:"This project does not exist or has been removed."}),a.jsxs(le,{onClick:()=>t("/"),children:[a.jsx(Xi,{className:"h-4 w-4 mr-2"}),"Go Back"]})]})}):a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("div",{className:"border-b bg-card",children:a.jsx("div",{className:"container mx-auto px-4 py-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-foreground",children:i.title}),a.jsxs("p",{className:"text-muted-foreground",children:["Welcome, ",c.name,"  ",c.company]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(Le,{variant:i.status==="active"?"default":"secondary",children:i.status}),a.jsxs(le,{variant:"outline",onClick:()=>t("/"),children:[a.jsx(Xi,{className:"h-4 w-4 mr-2"}),"Back to Home"]})]})]})})}),a.jsx("div",{className:"container mx-auto px-4 py-8",children:a.jsxs(ln,{defaultValue:"overview",className:"space-y-6",children:[a.jsxs(ks,{className:"grid w-full grid-cols-5",children:[a.jsx(bt,{value:"overview",children:"Overview"}),a.jsx(bt,{value:"analytics",children:"Analytics"}),a.jsx(bt,{value:"media",children:"Media"}),a.jsx(bt,{value:"requests",children:"Requests"}),a.jsx(bt,{value:"chatbot",children:"Chatbot"})]}),a.jsxs(Nt,{value:"overview",className:"space-y-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsx(we,{children:"Project Overview"}),a.jsx(He,{children:"View your virtual tour details and quick stats"})]}),a.jsxs(de,{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),a.jsx("p",{className:"text-muted-foreground",children:i.description||"No description provided"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Type"}),a.jsx(Le,{variant:"outline",children:Su(i.project_type)})]}),i.tour_url&&a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Virtual Tour"}),a.jsx(le,{asChild:!0,children:a.jsxs("a",{href:i.tour_url,target:"_blank",rel:"noopener noreferrer",children:[a.jsx(Ot,{className:"h-4 w-4 mr-2"}),"View Tour"]})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Total Views"})}),a.jsx(de,{children:a.jsx("div",{className:"text-2xl font-bold",children:i.views||0})})]}),a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Chatbot Status"})}),a.jsx(de,{children:a.jsx(Le,{variant:(d==null?void 0:d.status)==="active"?"default":"secondary",children:(d==null?void 0:d.status)||"Not configured"})})]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Project Status"})}),a.jsx(de,{children:a.jsx(Le,{variant:i.status==="active"?"default":"secondary",children:i.status})})]}),a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Created"})}),a.jsx(de,{children:a.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(i.created_at).toLocaleDateString()})})]}),a.jsxs(oe,{children:[a.jsx(ye,{className:"pb-2",children:a.jsx(we,{className:"text-sm",children:"Last Updated"})}),a.jsx(de,{children:a.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(i.updated_at).toLocaleDateString()})})]})]})]}),a.jsx(Nt,{value:"analytics",children:a.jsx(Lw,{projectId:e})}),a.jsx(Nt,{value:"media",children:a.jsx(Fw,{projectId:e})}),a.jsx(Nt,{value:"requests",children:a.jsx(Mw,{projectId:e})}),a.jsx(Nt,{value:"chatbot",children:a.jsx(Uw,{projectId:e,chatbot:d})})]})})]})},Vw=Object.freeze(Object.defineProperty({__proto__:null,default:XH},Symbol.toStringTag,{value:"Module"})),QH=({projectId:e,clientName:t,onComplete:r,onSkip:s})=>{const[n,i]=L.useState(0),o=[{id:"welcome",title:`Welcome to Your Dashboard, ${t}!`,description:"Let's get you familiar with your project portal",icon:a.jsx(oa,{className:"h-6 w-6 text-yellow-500"}),content:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Mi,{className:"h-8 w-8 text-white"})}),a.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Your Project Dashboard"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"This is your personal command center where you can track your project's performance, view analytics, and manage your virtual tour experience."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[a.jsxs("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[a.jsx(Ag,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm font-medium",children:"Secure Access"})]}),a.jsxs("div",{className:"text-center p-3 bg-green-50 dark:bg-green-950 rounded-lg",children:[a.jsx(Hn,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),a.jsx("p",{className:"text-sm font-medium",children:"Real-time Data"})]})]})]})},{id:"analytics",title:"Analytics Overview",description:"Track your project performance",icon:a.jsx(Or,{className:"h-6 w-6 text-blue-500"}),content:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx(Or,{className:"h-12 w-12 text-blue-600 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Real-time Analytics"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Monitor your project's performance with detailed insights and metrics."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[a.jsx(Ot,{className:"h-5 w-5 text-blue-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Visitor Tracking"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"See who's viewing your project"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[a.jsx(gr,{className:"h-5 w-5 text-green-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Lead Generation"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Track potential customers"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[a.jsx(Pr,{className:"h-5 w-5 text-purple-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Performance Metrics"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Engagement and conversion rates"})]})]})]})]})},{id:"navigation",title:"Dashboard Navigation",description:"Learn how to navigate your dashboard",icon:a.jsx(Mi,{className:"h-6 w-6 text-green-500"}),content:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx(Mi,{className:"h-12 w-12 text-green-600 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Dashboard Tabs"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Use the tabs below to navigate between different sections of your dashboard."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[a.jsx(Or,{className:"h-5 w-5 text-blue-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Overview"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Project summary and key metrics"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-950 rounded-lg",children:[a.jsx(Pr,{className:"h-5 w-5 text-green-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Analytics"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Detailed performance data"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-purple-50 dark:bg-purple-950 rounded-lg",children:[a.jsx(Jt,{className:"h-5 w-5 text-purple-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Requests"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Submit and track requests"})]})]})]})]})},{id:"mobile",title:"Mobile Access",description:"Access your dashboard on mobile",icon:a.jsx(th,{className:"h-6 w-6 text-purple-500"}),content:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx(th,{className:"h-12 w-12 text-purple-600 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Mobile Dashboard"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Your dashboard is fully responsive and works great on mobile devices."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-purple-50 dark:bg-purple-950 rounded-lg",children:[a.jsx(Og,{className:"h-5 w-5 text-purple-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Mobile Optimized"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Touch-friendly interface"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-purple-50 dark:bg-purple-950 rounded-lg",children:[a.jsx(au,{className:"h-5 w-5 text-purple-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Real-time Updates"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Stay updated on the go"})]})]}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-purple-50 dark:bg-purple-950 rounded-lg",children:[a.jsx(Hn,{className:"h-5 w-5 text-purple-600"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Fast Loading"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Optimized for mobile performance"})]})]})]})]})},{id:"complete",title:"You're All Set!",description:"Start exploring your dashboard",icon:a.jsx(Pt,{className:"h-6 w-6 text-green-500"}),content:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(Pt,{className:"h-8 w-8 text-white"})}),a.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Welcome to Your Dashboard!"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"You now have full access to your project dashboard. Explore all the features and start tracking your project's success."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center p-4 bg-blue-50 dark:bg-blue-950 rounded-lg",children:[a.jsx(Or,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),a.jsx("p",{className:"font-medium",children:"Analytics"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Track performance"})]}),a.jsxs("div",{className:"text-center p-4 bg-green-50 dark:bg-green-950 rounded-lg",children:[a.jsx(Jt,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),a.jsx("p",{className:"font-medium",children:"Requests"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Submit requests"})]})]})]}),action:{text:"Start Exploring",onClick:()=>{localStorage.setItem(`first-visit-completed-${e}`,"true"),r()}}}],c=o[n],l=(n+1)/o.length*100,d=()=>{n<o.length-1?i(h=>h+1):(localStorage.setItem(`first-visit-completed-${e}`,"true"),r())},u=()=>{n>0&&i(h=>h-1)},f=()=>{localStorage.setItem(`first-visit-completed-${e}`,"true"),s()};return a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:a.jsxs(oe,{className:"w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[a.jsxs(ye,{className:"pb-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[c.icon,a.jsxs("div",{children:[a.jsx(we,{className:"text-lg",children:c.title}),a.jsx(He,{children:c.description})]})]}),a.jsx(le,{variant:"ghost",size:"sm",onClick:f,className:"h-8 w-8 p-0",children:a.jsx(yr,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("span",{children:["Step ",n+1," of ",o.length]}),a.jsxs("span",{children:[Math.round(l),"% Complete"]})]}),a.jsx(qa,{value:l,className:"h-2"})]})]}),a.jsxs(de,{className:"space-y-6",children:[a.jsx("div",{className:"min-h-[300px]",children:c.content}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[a.jsxs(le,{variant:"outline",onClick:u,disabled:n===0,className:"flex items-center gap-2",children:[a.jsx(Xi,{className:"h-4 w-4"}),"Previous"]}),a.jsx("div",{className:"flex items-center gap-2",children:o.map((h,m)=>a.jsx("div",{className:`w-2 h-2 rounded-full ${m===n?"bg-blue-600":m<n?"bg-green-600":"bg-gray-300 dark:bg-gray-600"}`},m))}),a.jsx(le,{onClick:d,className:"flex items-center gap-2",children:n===o.length-1?a.jsxs(a.Fragment,{children:[a.jsx(Pt,{className:"h-4 w-4"}),"Complete"]}):a.jsxs(a.Fragment,{children:["Next",a.jsx(V_,{className:"h-4 w-4"})]})})]}),a.jsx("div",{className:"text-center",children:a.jsx(le,{variant:"ghost",size:"sm",onClick:f,className:"text-gray-500 hover:text-gray-700",children:"Skip onboarding"})})]})]})})},JH=()=>{const{projectId:e}=Xc(),{toast:t}=vt();console.log(" [ClientDashboard] Component loaded with projectId:",e);const[r,s]=L.useState(!0),[n,i]=L.useState(!1),[o,c]=L.useState(null),[l,d]=L.useState(null),[u,f]=L.useState(null),[h,m]=L.useState([]),[g,p]=L.useState([]),[x,y]=L.useState([]),[w,v]=L.useState("overview"),[j,S]=L.useState({title:"",description:"",type:"content_change",priority:"medium"}),[_,T]=L.useState(!1),[N,b]=L.useState(!1),O=Cu({projectId:e,endClientId:l==null?void 0:l.id}),A=async()=>{try{if(s(!0),!e){t({title:"Project not found",description:"No project ID provided.",variant:"destructive"});return}console.log(" [ClientDashboard] Loading data for project:",e),console.log(" [ClientDashboard] Starting data fetch...");const{data:C,error:K}=await he.from("projects").select(`
          *,
          end_clients (
            id,
            name,
            email,
            company,
            phone,
            website
          )
        `).eq("id",e).eq("status","active").single();if(K){console.error("Project error:",K),i(!0),t({title:"Access Denied",description:"This project is not accessible or has been deactivated.",variant:"destructive"});return}if(!C){i(!0),t({title:"Access Denied",description:"This project is not accessible or has been deactivated.",variant:"destructive"});return}if(!C.end_clients){i(!0),t({title:"Access Denied",description:"This project is not properly configured.",variant:"destructive"});return}console.log("Project data loaded:",C),c(C),d(C.end_clients);const[{data:D,error:Q},{data:z,error:X},{data:ne,error:k}]=await Promise.all([he.from("chatbots").select("*").eq("project_id",e).single(),he.from("assets").select("*").eq("project_id",e).order("created_at",{ascending:!1}),he.from("requests").select("*").eq("project_id",e).order("created_at",{ascending:!1})]);Q?console.log("No chatbot found:",Q.message):f(D),m([]),X?(console.log("No assets found:",X.message),p([])):p(z||[]),k?(console.log("No requests found:",k.message),y([])):y(ne||[])}catch(C){console.error(" [ClientDashboard] Error loading data:",C);const K=C instanceof Error?C.message:"Failed to load dashboard data.";t({title:" Error loading data",description:K,variant:"destructive"}),i(!0)}finally{s(!1)}},E=async()=>{if(!j.title||!j.description){t({title:"Missing information",description:"Please fill in all required fields.",variant:"destructive"});return}if(!l){t({title:"Error",description:"Client information not found.",variant:"destructive"});return}try{T(!0),console.log("Submitting request for project:",e,"client:",l.id);const{error:C}=await he.from("requests").insert({project_id:e,end_client_id:l.id,title:j.title,description:j.description,request_type:j.type,priority:j.priority,status:"open"});if(C)throw console.error("Request submission error:",C),C;t({title:"Request submitted",description:"Your request has been sent successfully."}),S({title:"",description:"",type:"content_change",priority:"medium"}),A()}catch(C){console.error("Error submitting request:",C);const K=C instanceof Error?C.message:"Failed to submit request";t({title:"Failed to submit",description:K,variant:"destructive"})}finally{T(!1)}},U=C=>C.startsWith("image/")?a.jsx(Ua,{className:"h-5 w-5"}):C.startsWith("video/")?a.jsx(hg,{className:"h-5 w-5"}):C.startsWith("application/pdf")?a.jsx(Sa,{className:"h-5 w-5"}):a.jsx(q_,{className:"h-5 w-5"}),Y=C=>{switch(C){case"pending":return a.jsx(it,{className:"h-4 w-4 text-amber-500"});case"in_progress":return a.jsx(Ba,{className:"h-4 w-4 text-blue-500"});case"completed":return a.jsx(Pt,{className:"h-4 w-4 text-green-500"});case"cancelled":return a.jsx(Cg,{className:"h-4 w-4 text-red-500"});default:return a.jsx(it,{className:"h-4 w-4 text-gray-500"})}};if(L.useEffect(()=>{A();const C=localStorage.getItem(`first-visit-completed-${e}`);console.log(`First visit check for project ${e}:`,C?"Already visited":"First time"),C||b(!0)},[e]),L.useEffect(()=>{if(o&&l&&e){const C=document.querySelector('link[rel="manifest"]');C&&(C.href=`/api/manifest?projectId=${e}`),document.title=`${o.title} - ${l.company}`;const K=(z,X)=>{let ne=document.querySelector(`meta[name="${z}"]`);ne||(ne=document.createElement("meta"),ne.name=z,document.head.appendChild(ne)),ne.content=X};K("description",`Dashboard for ${l.company} - ${o.title}`),K("apple-mobile-web-app-title",o.title),K("application-name",o.title);const D=(z,X)=>{let ne=document.querySelector(`meta[property="${z}"]`);ne||(ne=document.createElement("meta"),ne.setAttribute("property",z),document.head.appendChild(ne)),ne.content=X};D("og:title",`${o.title} - ${l.company}`),D("og:description",`Dashboard for ${l.company} - ${o.title}`),D("og:url",window.location.href);const Q=(z,X)=>{let ne=document.querySelector(`meta[name="twitter:${z}"]`);ne||(ne=document.createElement("meta"),ne.name=`twitter:${z}`,document.head.appendChild(ne)),ne.content=X};Q("title",`${o.title} - ${l.company}`),Q("description",`Dashboard for ${l.company} - ${o.title}`),console.log("Dynamic manifest and meta tags updated for:",o.title)}},[o,l,e]),r)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#F8F9FA"},children:a.jsxs("div",{className:"text-center",children:[a.jsx(De,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-900 font-medium",children:"Loading your dashboard..."})]})});if(n)return a.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundColor:"#F8F9FA"},children:a.jsxs("div",{className:"text-center max-w-md",children:[a.jsx(Mt,{className:"h-16 w-16 text-red-600 mx-auto mb-4"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"This project is not accessible or has been deactivated. Please contact your project manager for assistance."}),a.jsx("div",{className:"text-sm text-gray-500",children:a.jsx("p",{children:"If you need assistance, please contact your project manager directly."})})]})});if(!o)return a.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundColor:"#F8F9FA"},children:a.jsxs("div",{className:"text-center max-w-md",children:[a.jsx(Mt,{className:"h-16 w-16 text-red-600 mx-auto mb-4"}),a.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Project Not Found"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"This project does not exist or has been removed."}),a.jsx("div",{className:"text-sm text-gray-500",children:a.jsx("p",{children:"If you need assistance, please contact your project manager directly."})})]})});const ee=O.totalViews,se=O.totalVisitors,W=O.avgEngagementTime,J=O.totalLeads,F=O.conversionRate,te=O.avgSatisfaction,fe=0,R=()=>{b(!1),localStorage.setItem(`first-visit-completed-${e}`,"true"),console.log(`Onboarding completed for project ${e} - will not show again`),t({title:"Welcome!",description:"You're all set to explore your dashboard.",variant:"default"})},G=()=>{b(!1),localStorage.setItem(`first-visit-completed-${e}`,"true"),console.log(`Onboarding skipped for project ${e} - will not show again`)};return a.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"#F5F7FA",color:"#1A1A1A"},children:[N&&l&&a.jsx(QH,{projectId:e,clientName:l.name,onComplete:R,onSkip:G}),a.jsxs("div",{className:"hidden lg:flex min-h-screen",children:[a.jsxs("div",{className:"w-64 flex flex-col",style:{backgroundColor:"#FFFFFF",borderRight:"1px solid #E5E7EB"},children:[a.jsx("div",{className:"p-6",style:{borderBottom:"1px solid #E5E7EB"},children:a.jsx("div",{className:"flex items-center space-x-3",children:a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h1",{className:"break-words leading-tight",style:{fontSize:"20px",fontWeight:600,lineHeight:"28px",letterSpacing:"-0.2px",color:"#1A1A1A"},children:o.title}),a.jsx("p",{className:"mt-1",style:{fontSize:"14px",color:"#6B7280"},children:"Client Portal"})]})})}),a.jsx("div",{className:"p-6",style:{borderBottom:"1px solid #E5E7EB"},children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(pc,{name:(l==null?void 0:l.name)||"Client",size:"md",className:"flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"truncate",style:{fontSize:"14px",fontWeight:600,color:"#1A1A1A"},children:(l==null?void 0:l.name)||"Client"}),a.jsx("p",{className:"truncate",style:{fontSize:"12px",color:"#6B7280"},children:(l==null?void 0:l.email)||"client@example.com"})]})]})}),a.jsx("nav",{className:"flex-1 p-4",children:a.jsx("div",{className:"space-y-2",children:[{id:"overview",name:"Overview",icon:Ot},{id:"analytics",name:"Analytics",icon:Or},{id:"media",name:"Media",icon:Ua},{id:"requests",name:"Requests",icon:Jt}].map(C=>a.jsxs("button",{onClick:()=>v(C.id),className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg font-medium transition-all duration-200",style:{backgroundColor:w===C.id?"#4169E1":"transparent",color:w===C.id?"#FFFFFF":"#6B7280",borderRadius:"12px"},onMouseEnter:K=>{w!==C.id&&(K.currentTarget.style.backgroundColor="#F8F9FA",K.currentTarget.style.color="#1A1A1A")},onMouseLeave:K=>{w!==C.id&&(K.currentTarget.style.backgroundColor="transparent",K.currentTarget.style.color="#6B7280")},children:[a.jsx(C.icon,{className:"h-5 w-5"}),a.jsx("span",{style:{fontSize:"14px",fontWeight:500},children:C.name})]},C.id))})})]}),a.jsx("div",{className:"flex-1 overflow-auto scrollbar-hide",children:a.jsx("div",{className:"p-6",children:P()})})]}),a.jsxs("div",{className:"lg:hidden",children:[a.jsx("div",{className:"fixed top-0 left-0 right-0 z-40",style:{backgroundColor:"#FFFFFF",borderBottom:"1px solid #E5E7EB"},children:a.jsx("div",{className:"px-4 py-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h1",{className:"break-words leading-tight",style:{fontSize:"18px",fontWeight:700,color:"#1A1A1A"},children:o.title}),a.jsx("p",{className:"mt-1",style:{fontSize:"12px",color:"#6B7280"},children:"Client Portal"})]})}),a.jsx(pc,{name:(l==null?void 0:l.name)||"Client",size:"sm",className:"flex-shrink-0"})]})})}),a.jsx("div",{className:"pb-24 pt-20",children:a.jsx("div",{className:"p-4",children:P()})}),a.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50",style:{backgroundColor:"#FFFFFF",borderTop:"1px solid #E5E7EB",boxShadow:"0 -2px 10px rgba(0, 0, 0, 0.05)",height:"80px"},children:a.jsx("div",{className:"flex justify-around items-center",style:{padding:"0 24px",height:"100%"},children:[{id:"overview",name:"Overview",icon:Ot},{id:"analytics",name:"Analytics",icon:Or},{id:"media",name:"Media",icon:Ua},{id:"requests",name:"Requests",icon:Jt}].map(C=>a.jsxs("button",{onClick:()=>v(C.id),className:"flex flex-col items-center transition-all duration-200",style:{color:w===C.id?"#4169E1":"#9CA3AF",backgroundColor:w===C.id?"#EBF2FF":"transparent",borderRadius:"12px",padding:"8px 16px"},children:[a.jsx(C.icon,{className:"h-6 w-6 mb-1"}),a.jsx("span",{style:{fontSize:"11px",fontWeight:500},children:C.name})]},C.id))})})]})]});function P(){return a.jsxs("div",{className:"space-y-6",children:[w==="overview"&&a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{style:{background:"linear-gradient(135deg, #87CEEB 0%, #4169E1 100%)",borderRadius:"20px",padding:"24px",boxShadow:"0 4px 12px rgba(65, 105, 225, 0.2)",color:"#FFFFFF",marginBottom:"16px"},children:a.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("h2",{className:"mb-2",style:{fontSize:"24px",fontWeight:600,lineHeight:"32px",letterSpacing:"-0.3px"},children:["Welcome back, ",l==null?void 0:l.name,"!"]}),a.jsx("p",{className:"mb-4",style:{fontSize:"16px",opacity:.9},children:"Here's your latest project overview and performance metrics."}),a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Yr,{className:"h-4 w-4"}),a.jsxs("span",{style:{fontSize:"14px"},children:["Created ",new Date(o.created_at).toLocaleDateString()]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(it,{className:"h-4 w-4"}),a.jsxs("span",{style:{fontSize:"14px"},children:["Updated ",new Date(o.updated_at).toLocaleDateString()]})]})]})]}),a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-20 h-20 rounded-full flex items-center justify-center",style:{backgroundColor:"rgba(255, 255, 255, 0.2)"},children:a.jsx(Ot,{className:"h-10 w-10",style:{color:"#FFFFFF"}})})})]})}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",marginBottom:"16px"},children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"#4169E1"},children:a.jsx(Ot,{className:"h-5 w-5",style:{color:"#FFFFFF"}})}),a.jsxs("div",{children:[a.jsx("p",{style:{fontSize:"12px",color:"#6B7280",fontWeight:400},children:"Total Views"}),a.jsx("p",{style:{fontSize:"24px",fontWeight:700,color:"#1A1A1A"},children:ee})]})]})}),a.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",marginBottom:"16px"},children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"#40E0D0"},children:a.jsx(gr,{className:"h-5 w-5",style:{color:"#FFFFFF"}})}),a.jsxs("div",{children:[a.jsx("p",{style:{fontSize:"12px",color:"#6B7280",fontWeight:400},children:"Visitors"}),a.jsx("p",{style:{fontSize:"24px",fontWeight:700,color:"#1A1A1A"},children:se})]})]})}),a.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",marginBottom:"16px"},children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"#9B59B6"},children:a.jsx(H_,{className:"h-5 w-5",style:{color:"#FFFFFF"}})}),a.jsxs("div",{children:[a.jsx("p",{style:{fontSize:"12px",color:"#6B7280",fontWeight:400},children:"Avg. Time"}),a.jsxs("p",{style:{fontSize:"24px",fontWeight:700,color:"#1A1A1A"},children:[Math.round(W),"s"]})]})]})}),a.jsx("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",marginBottom:"16px"},children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"#FF69B4"},children:a.jsx(Pr,{className:"h-5 w-5",style:{color:"#FFFFFF"}})}),a.jsxs("div",{children:[a.jsx("p",{style:{fontSize:"12px",color:"#6B7280",fontWeight:400},children:"Interactions"}),a.jsx("p",{style:{fontSize:"24px",fontWeight:700,color:"#1A1A1A"},children:fe})]})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",marginBottom:"16px"},children:[a.jsx("div",{className:"pb-3",children:a.jsx("h3",{style:{fontSize:"18px",fontWeight:600,color:"#1A1A1A"},children:"Project Information"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"mb-2",style:{fontSize:"12px",color:"#6B7280"},children:"Description"}),a.jsx("div",{className:"rounded-lg p-3",style:{backgroundColor:"#F8F9FA",border:"none"},children:a.jsx("p",{className:"leading-relaxed break-words overflow-wrap-anywhere",style:{fontSize:"14px",color:"#1A1A1A"},children:o.description||"No description provided"})})]}),a.jsxs("div",{children:[a.jsx("p",{className:"mb-2",style:{fontSize:"12px",color:"#6B7280"},children:"Type"}),a.jsx("span",{className:"px-3 py-1 rounded-lg",style:{backgroundColor:"#4169E1",color:"#FFFFFF",fontSize:"12px",fontWeight:500},children:Su(o.project_type)||"Virtual Tour"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"mb-2",style:{fontSize:"12px",color:"#6B7280"},children:"Status"}),a.jsx("span",{className:"px-3 py-1 rounded-lg",style:{backgroundColor:o.status==="active"?"#10B981":"#6B7280",color:"#FFFFFF",fontSize:"12px",fontWeight:500},children:Rj(o.status)})]})]})]}),a.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",marginBottom:"16px"},children:[a.jsx("div",{className:"pb-3",children:a.jsx("h3",{style:{fontSize:"18px",fontWeight:600,color:"#1A1A1A"},children:"Quick Actions"})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("button",{onClick:()=>v("requests"),className:"w-full flex items-center justify-center py-3 px-4 rounded-lg transition-all duration-200",style:{backgroundColor:"#4169E1",color:"#FFFFFF",fontSize:"16px",fontWeight:600,borderRadius:"12px"},onMouseEnter:C=>{C.currentTarget.style.backgroundColor="#2E4A9F"},onMouseLeave:C=>{C.currentTarget.style.backgroundColor="#4169E1"},children:[a.jsx(Jt,{className:"h-4 w-4 mr-2"}),"Submit Request"]}),a.jsxs("button",{onClick:()=>v("media"),className:"w-full flex items-center justify-center py-3 px-4 rounded-lg transition-all duration-200",style:{backgroundColor:"transparent",color:"#4169E1",fontSize:"16px",fontWeight:600,borderRadius:"12px",border:"2px solid #4169E1"},onMouseEnter:C=>{C.currentTarget.style.backgroundColor="#EBF2FF"},onMouseLeave:C=>{C.currentTarget.style.backgroundColor="transparent"},children:[a.jsx(Ua,{className:"h-4 w-4 mr-2"}),"View Media"]}),a.jsxs("button",{onClick:()=>v("analytics"),className:"w-full flex items-center justify-center py-3 px-4 rounded-lg transition-all duration-200",style:{backgroundColor:"#4169E1",color:"#FFFFFF",fontSize:"16px",fontWeight:600,borderRadius:"12px"},onMouseEnter:C=>{C.currentTarget.style.backgroundColor="#2E4A9F"},onMouseLeave:C=>{C.currentTarget.style.backgroundColor="#4169E1"},children:[a.jsx(Or,{className:"h-4 w-4 mr-2"}),"View Analytics"]})]})]})]})]}),w==="analytics"&&a.jsx("div",{className:"space-y-6",children:O.loading?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):O.error?a.jsx("div",{className:"text-center py-12 text-red-500",children:a.jsxs("p",{children:["Error loading analytics: ",O.error]})}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"text-center space-y-4",children:[a.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-green-400 to-blue-500 rounded-full mb-4",children:a.jsx(Or,{className:"h-8 w-8 text-white"})}),a.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent",children:"Analytics Dashboard"}),a.jsx("p",{className:"text-gray-600 max-w-md mx-auto",children:"Real-time performance metrics and insights for your virtual tour"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsxs(oe,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-blue-50 to-blue-100",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-blue-500 rounded-full -translate-y-10 translate-x-10 opacity-10"}),a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-semibold text-blue-700",children:"Total Views"}),a.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:a.jsx(Ot,{className:"h-4 w-4 text-white"})})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:ee}),a.jsx("p",{className:"text-xs text-blue-500 font-medium",children:"Page impressions"})]})]}),a.jsxs(oe,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-green-50 to-green-100",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-green-500 rounded-full -translate-y-10 translate-x-10 opacity-10"}),a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-semibold text-green-700",children:"Unique Visitors"}),a.jsx("div",{className:"p-2 bg-green-500 rounded-lg",children:a.jsx(gr,{className:"h-4 w-4 text-white"})})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-3xl font-bold text-green-600 mb-1",children:se}),a.jsx("p",{className:"text-xs text-green-500 font-medium",children:"Individual users"})]})]}),a.jsxs(oe,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-purple-50 to-purple-100",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-purple-500 rounded-full -translate-y-10 translate-x-10 opacity-10"}),a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-semibold text-purple-700",children:"Avg. Session"}),a.jsx("div",{className:"p-2 bg-purple-500 rounded-lg",children:a.jsx(it,{className:"h-4 w-4 text-white"})})]}),a.jsxs(de,{children:[a.jsxs("div",{className:"text-3xl font-bold text-purple-600 mb-1",children:[W,"s"]}),a.jsx("p",{className:"text-xs text-purple-500 font-medium",children:"Time per visit"})]})]}),a.jsxs(oe,{className:"relative overflow-hidden border-0 shadow-lg hover:shadow-xl transition-all duration-300 bg-gradient-to-br from-orange-50 to-orange-100",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-orange-500 rounded-full -translate-y-10 translate-x-10 opacity-10"}),a.jsxs(ye,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(we,{className:"text-sm font-semibold text-orange-700",children:"Leads"}),a.jsx("div",{className:"p-2 bg-orange-500 rounded-lg",children:a.jsx(Pr,{className:"h-4 w-4 text-white"})})]}),a.jsxs(de,{children:[a.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-1",children:J}),a.jsx("p",{className:"text-xs text-orange-500 font-medium",children:"Generated leads"})]})]})]}),a.jsxs(oe,{className:"border-0 shadow-lg bg-gradient-to-r from-gray-50 to-gray-100",children:[a.jsx(ye,{children:a.jsx(we,{className:"text-lg font-semibold text-gray-800",children:"Performance Summary"})}),a.jsx(de,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[F,"%"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Conversion Rate"})]}),a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[te,"/5"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Avg. Satisfaction"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"Active"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Tracking Status"})]})]})})]})]})}),w==="media"&&a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",marginBottom:"16px"},children:[a.jsxs("div",{className:"pb-3",children:[a.jsx("h3",{style:{fontSize:"20px",fontWeight:600,lineHeight:"28px",letterSpacing:"-0.2px",color:"#1A1A1A"},children:"Media Library"}),a.jsx("p",{style:{fontSize:"14px",color:"#6B7280"},children:"View and download media assets for your virtual tour"})]}),a.jsx("div",{children:g.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Ua,{className:"h-12 w-12 mx-auto mb-4",style:{color:"#9CA3AF"}}),a.jsx("h3",{className:"mb-2",style:{fontSize:"18px",fontWeight:600,color:"#1A1A1A"},children:"No media files yet"}),a.jsx("p",{style:{fontSize:"14px",color:"#6B7280"},children:"Media assets for your virtual tour will appear here."})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(C=>a.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"12px",border:"1px solid #E5E7EB",overflow:"hidden",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[a.jsx("div",{className:"p-3",children:a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[C.file_type==="url"?a.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx(Mi,{className:"h-4 w-4 text-white"})}):C.file_type.startsWith("image/")?a.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center shadow-md",children:a.jsx(Ua,{className:"h-4 w-4 text-white"})}):a.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-md flex items-center justify-center shadow-md",children:U(C.file_type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"truncate",style:{fontSize:"14px",fontWeight:500,color:"#1A1A1A"},children:C.original_filename}),a.jsx("p",{className:"text-xs",style:{color:"#6B7280"},children:C.file_type==="url"?"Link":C.file_type.split("/")[0]})]})]})}),a.jsxs("div",{className:"px-3 pb-3",children:[a.jsx("p",{className:"text-xs mb-3",style:{color:"#6B7280"},children:new Date(C.created_at).toLocaleDateString()}),C.file_type==="url"?a.jsxs(le,{size:"sm",className:"w-full",style:{backgroundColor:"#10B981",color:"#FFFFFF",border:"none",fontSize:"12px",fontWeight:500},onClick:()=>window.open(C.file_url,"_blank"),children:[a.jsx(Lr,{className:"h-3 w-3 mr-1"}),"View Media"]}):a.jsxs(le,{size:"sm",className:"w-full",style:{backgroundColor:"#4169E1",color:"#FFFFFF",border:"none",fontSize:"12px",fontWeight:500},onClick:()=>window.open(C.file_url,"_blank"),children:[a.jsx(Lr,{className:"h-3 w-3 mr-1"}),"View Media"]})]})]},C.id))})})]})}),w==="requests"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",marginBottom:"16px"},children:[a.jsxs("div",{className:"pb-3",children:[a.jsx("h3",{style:{fontSize:"20px",fontWeight:600,lineHeight:"28px",letterSpacing:"-0.2px",color:"#1A1A1A"},children:"Submit Request"}),a.jsx("p",{style:{fontSize:"14px",color:"#6B7280"},children:"Request changes or ask questions about your virtual tour"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-2 block",style:{fontSize:"14px",fontWeight:500,color:"#1A1A1A"},children:"Title"}),a.jsx(Ue,{value:j.title,onChange:C=>S({...j,title:C.target.value}),placeholder:"Brief description of your request",style:{backgroundColor:"#FFFFFF",border:"1px solid #D1D5DB",color:"#1A1A1A",fontSize:"14px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-2 block",style:{fontSize:"14px",fontWeight:500,color:"#1A1A1A"},children:"Description"}),a.jsx(Bt,{value:j.description,onChange:C=>S({...j,description:C.target.value}),placeholder:"Detailed description of what you need",style:{backgroundColor:"#FFFFFF",border:"1px solid #D1D5DB",color:"#1A1A1A",fontSize:"14px"},rows:4})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-2 block",style:{fontSize:"14px",fontWeight:500,color:"#1A1A1A"},children:"Type"}),a.jsxs(pt,{value:j.type,onValueChange:C=>S({...j,type:C}),children:[a.jsx(ct,{style:{backgroundColor:"#FFFFFF",border:"1px solid #D1D5DB",color:"#1A1A1A",fontSize:"14px"},children:a.jsx(gt,{})}),a.jsxs(lt,{style:{backgroundColor:"#FFFFFF",border:"1px solid #D1D5DB"},children:[a.jsx(ve,{value:"content_change",style:{color:"#1A1A1A"},children:"Content Change"}),a.jsx(ve,{value:"hotspot_update",style:{color:"#1A1A1A"},children:"Hotspot Update"}),a.jsx(ve,{value:"design_modification",style:{color:"#1A1A1A"},children:"Design Modification"}),a.jsx(ve,{value:"new_feature",style:{color:"#1A1A1A"},children:"New Feature"}),a.jsx(ve,{value:"bug_fix",style:{color:"#1A1A1A"},children:"Bug Fix"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-2 block",style:{fontSize:"14px",fontWeight:500,color:"#1A1A1A"},children:"Priority"}),a.jsxs(pt,{value:j.priority,onValueChange:C=>S({...j,priority:C}),children:[a.jsx(ct,{style:{backgroundColor:"#FFFFFF",border:"1px solid #D1D5DB",color:"#1A1A1A",fontSize:"14px"},children:a.jsx(gt,{})}),a.jsxs(lt,{style:{backgroundColor:"#FFFFFF",border:"1px solid #D1D5DB"},children:[a.jsx(ve,{value:"low",style:{color:"#1A1A1A"},children:"Low"}),a.jsx(ve,{value:"medium",style:{color:"#1A1A1A"},children:"Medium"}),a.jsx(ve,{value:"high",style:{color:"#1A1A1A"},children:"High"}),a.jsx(ve,{value:"urgent",style:{color:"#1A1A1A"},children:"Urgent"})]})]})]})]}),a.jsxs(le,{onClick:E,disabled:_,className:"w-full",style:{backgroundColor:"#4169E1",color:"#FFFFFF",border:"none",fontSize:"14px",fontWeight:500},children:[_?a.jsx(De,{className:"h-4 w-4 mr-2 animate-spin"}):a.jsx(Kc,{className:"h-4 w-4 mr-2"}),_?"Submitting...":"Submit Request"]})]})]}),a.jsxs("div",{style:{backgroundColor:"#FFFFFF",borderRadius:"16px",padding:"20px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",marginBottom:"16px"},children:[a.jsxs("div",{className:"pb-3",children:[a.jsx("h3",{style:{fontSize:"20px",fontWeight:600,lineHeight:"28px",letterSpacing:"-0.2px",color:"#1A1A1A"},children:"Your Requests"}),a.jsx("p",{style:{fontSize:"14px",color:"#6B7280"},children:"Track the status of your submitted requests"})]}),a.jsx("div",{children:x.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Jt,{className:"h-12 w-12 mx-auto mb-4",style:{color:"#9CA3AF"}}),a.jsx("h3",{className:"mb-2",style:{fontSize:"18px",fontWeight:600,color:"#1A1A1A"},children:"No requests yet"}),a.jsx("p",{style:{fontSize:"14px",color:"#6B7280"},children:"Submit your first request using the form above."})]}):a.jsx("div",{className:"space-y-4",children:x.map(C=>a.jsx("div",{style:{backgroundColor:"#F8F9FA",borderRadius:"12px",border:"1px solid #E5E7EB",padding:"16px"},children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("h4",{style:{fontSize:"16px",fontWeight:600,color:"#1A1A1A"},children:C.title}),a.jsx("span",{style:{fontSize:"10px",fontWeight:500,padding:"4px 8px",borderRadius:"6px",backgroundColor:C.priority==="urgent"?"#FEE2E2":C.priority==="high"?"#FED7AA":C.priority==="medium"?"#DBEAFE":"#F3F4F6",color:C.priority==="urgent"?"#DC2626":C.priority==="high"?"#EA580C":C.priority==="medium"?"#2563EB":"#6B7280"},children:C.priority})]}),a.jsx("p",{className:"mb-3 leading-relaxed",style:{fontSize:"14px",color:"#4B5563"},children:C.description}),a.jsxs("div",{className:"flex items-center space-x-4",style:{fontSize:"12px",color:"#6B7280"},children:[a.jsx("span",{children:new Date(C.created_at).toLocaleDateString()}),a.jsx("span",{children:""}),a.jsx("span",{className:"capitalize",children:C.request_type.replace("_"," ")})]})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[Y(C.status),a.jsx("span",{className:"capitalize",style:{fontSize:"14px",fontWeight:500,color:"#1A1A1A"},children:C.status.replace("_"," ")})]})]})},C.id))})})]})]})]})}},ZH=Object.freeze(Object.defineProperty({__proto__:null,default:JH},Symbol.toStringTag,{value:"Module"})),eq=()=>{const{toast:e}=vt(),{user:t}=Mr(),[r,s]=L.useState([]),[n,i]=L.useState([]),[o,c]=L.useState([]),[l,d]=L.useState(!0),[u,f]=L.useState(null),[h,m]=L.useState(""),[g,p]=L.useState("all"),x=L.useRef(null),y=L.useRef(null);L.useEffect(()=>{v()},[]),L.useEffect(()=>{if(!(t!=null&&t.id))return;console.log("[ConversationalIntelligence] Setting up real-time subscriptions");const N=he.channel(`conversational-intelligence-${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:"leads"},b=>{console.log("[ConversationalIntelligence] Lead change detected:",b),w()}).on("postgres_changes",{event:"*",schema:"public",table:"analytics"},b=>{console.log("[ConversationalIntelligence] Analytics change detected:",b),w()}).subscribe(b=>{console.log("[ConversationalIntelligence] Subscription status:",b)});return x.current=N,()=>{console.log("[ConversationalIntelligence] Cleaning up real-time subscriptions"),x.current&&he.removeChannel(x.current),y.current&&clearTimeout(y.current)}},[t==null?void 0:t.id]);const w=()=>{y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{console.log("[ConversationalIntelligence] Triggering debounced refresh"),v()},1e3)},v=async()=>{try{d(!0),f(null);const{data:N,error:b}=await he.from("chatbot_questions").select("*").order("frequency",{ascending:!1}).limit(10);if(b)throw b;const{data:O,error:A}=await he.from("chatbot_questions").select("*").eq("answered",!1).order("created_at",{ascending:!1}).limit(10);if(A)throw A;const{data:E,error:U}=await he.from("leads").select("*").order("created_at",{ascending:!1}).limit(20);if(U)throw U;s(N||[]),i(O||[]),c(E||[])}catch(N){console.error("Error loading conversational data:",N),f(Z.ANALYTICS.ERROR_LOADING_QUESTIONS),e({title:Z.TOAST.ERROR,description:Z.ANALYTICS.ERROR_LOADING_QUESTIONS,variant:"destructive"})}finally{d(!1)}},j=N=>{switch(N){case"new":return"default";case"contacted":return"secondary";case"qualified":return"outline";case"converted":return"default";default:return"default"}},S=N=>{switch(N){case"new":return Z.ANALYTICS.LEAD_STATUS.NEW;case"contacted":return Z.ANALYTICS.LEAD_STATUS.CONTACTED;case"qualified":return Z.ANALYTICS.LEAD_STATUS.QUALIFIED;case"converted":return Z.ANALYTICS.LEAD_STATUS.CONVERTED;default:return N}},_=N=>N>=80?"text-green-600":N>=60?"text-yellow-600":"text-red-600",T=r.filter(N=>{const b=N.question.toLowerCase().includes(h.toLowerCase()),O=g==="all"||N.category===g;return b&&O});return l?a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:Z.ANALYTICS.CONVERSATIONAL_INTELLIGENCE}),a.jsx("p",{className:"text-foreground-secondary",children:Z.ANALYTICS.CHATBOT_INSIGHTS})]}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:Array.from({length:4}).map((N,b)=>a.jsxs(oe,{className:"animate-pulse",children:[a.jsx(ye,{children:a.jsx("div",{className:"h-4 bg-muted rounded w-3/4"})}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-3 bg-muted rounded w-full"}),a.jsx("div",{className:"h-3 bg-muted rounded w-2/3"})]})})]},b))})]}):u?a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:Z.ANALYTICS.CONVERSATIONAL_INTELLIGENCE}),a.jsx("p",{className:"text-foreground-secondary",children:Z.ANALYTICS.CHATBOT_INSIGHTS})]}),a.jsx(oe,{children:a.jsx(de,{className:"flex items-center justify-center py-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-destructive mb-2",children:u}),a.jsx(le,{onClick:v,variant:"outline",children:"Try Again"})]})})})]}):a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:Z.ANALYTICS.CONVERSATIONAL_INTELLIGENCE}),a.jsx("p",{className:"text-foreground-secondary",children:Z.ANALYTICS.CHATBOT_INSIGHTS})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(rh,{className:"h-5 w-5"}),Z.ANALYTICS.TOP_ASKED_QUESTIONS]}),a.jsx(He,{children:Z.ANALYTICS.MOST_FREQUENT_QUESTIONS})]}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ei,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Ue,{placeholder:Z.ANALYTICS.SEARCH_QUESTIONS,value:h,onChange:N=>m(N.target.value),className:"pl-10"})]}),a.jsxs(pt,{value:g,onValueChange:p,children:[a.jsx(ct,{className:"w-40",children:a.jsx(gt,{placeholder:Z.ANALYTICS.CATEGORY})}),a.jsxs(lt,{children:[a.jsx(ve,{value:"all",children:Z.ANALYTICS.ALL_CATEGORIES}),a.jsx(ve,{value:"pricing",children:Z.ANALYTICS.CATEGORIES.PRICING}),a.jsx(ve,{value:"features",children:Z.ANALYTICS.CATEGORIES.FEATURES}),a.jsx(ve,{value:"support",children:Z.ANALYTICS.CATEGORIES.SUPPORT}),a.jsx(ve,{value:"technical",children:Z.ANALYTICS.CATEGORIES.TECHNICAL})]})]})]}),a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:T.length===0?a.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(rh,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:Z.ANALYTICS.NO_QUESTIONS_FOUND})]}):T.map((N,b)=>a.jsx("div",{className:"p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-foreground line-clamp-2",children:N.question}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx(Le,{variant:"outline",className:"text-xs",children:N.category}),a.jsx("span",{className:"text-xs text-muted-foreground",children:Z.ANALYTICS.ASKED_TIMES.replace("{count}",N.frequency.toString())})]})]}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(Pr,{className:"h-3 w-3"}),"#",b+1]})]})},N.id))})]})})]}),a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(it,{className:"h-5 w-5"}),Z.ANALYTICS.UNANSWERED_QUESTIONS]}),a.jsx(He,{children:Z.ANALYTICS.QUESTIONS_NEED_ATTENTION})]}),a.jsx(de,{children:a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:n.length===0?a.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(it,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:Z.ANALYTICS.NO_UNANSWERED_QUESTIONS})]}):n.map(N=>a.jsx("div",{className:"p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-foreground line-clamp-2",children:N.question}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx(Le,{variant:"outline",className:"text-xs",children:N.category}),a.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(N.last_asked).toLocaleDateString()})]})]}),a.jsxs(le,{size:"sm",variant:"outline",children:[a.jsx(Lr,{className:"h-3 w-3 mr-1"}),Z.ANALYTICS.ANSWER]})]})},N.id))})})]})]}),a.jsxs(oe,{children:[a.jsxs(ye,{children:[a.jsxs(we,{className:"flex items-center gap-2",children:[a.jsx(gr,{className:"h-5 w-5"}),Z.ANALYTICS.LEADS_GENERATED]}),a.jsx(He,{children:Z.ANALYTICS.POTENTIAL_CUSTOMERS})]}),a.jsx(de,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-sm text-muted-foreground",children:[Z.ANALYTICS.TOTAL_LEADS,": ",a.jsx("span",{className:"font-medium text-foreground",children:o.length})]}),a.jsxs("div",{className:"text-sm text-muted-foreground",children:[Z.ANALYTICS.NEW_THIS_WEEK,": ",a.jsx("span",{className:"font-medium text-foreground",children:o.filter(N=>{const b=new Date;return b.setDate(b.getDate()-7),new Date(N.created_at)>b}).length})]})]})}),a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:o.length===0?a.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[a.jsx(gr,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:Z.ANALYTICS.NO_LEADS_GENERATED})]}):o.map(N=>a.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-foreground truncate",children:N.name}),a.jsx("p",{className:"text-sm text-muted-foreground truncate",children:N.email})]}),a.jsx(Le,{variant:j(N.status),className:"flex-shrink-0",children:S(N.status)})]}),a.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[a.jsxs("span",{children:[Z.ANALYTICS.COMPANY,": ",N.company]}),a.jsxs("span",{children:[Z.ANALYTICS.SOURCE,": ",N.source]}),a.jsxs("span",{children:[Z.ANALYTICS.SCORE,": ",a.jsxs("span",{className:`font-medium ${_(N.score)}`,children:[N.score,"/100"]})]})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(le,{size:"sm",variant:"outline",children:[a.jsx(Lr,{className:"h-3 w-3 mr-1"}),Z.ANALYTICS.CONTACT]})})]})},N.id))})]})})]})]})},VW=Object.freeze(Object.defineProperty({__proto__:null,default:eq},Symbol.toStringTag,{value:"Module"}));export{kW as $,tW as A,le as B,oe as C,rW as D,aW as E,sW as F,wW as G,_W as H,bW as I,AW as J,CW as K,bf as L,Xy as M,iU as N,NW as O,gW as P,sp as Q,TW as R,pt as S,Z as T,jW as U,EW as V,SW as W,xW as X,uo as Y,vW as Z,yW as _,ct as a,bq as a$,Xq as a0,mP as a1,sy as a2,oW as a3,cW as a4,iW as a5,Qq as a6,Jq as a7,lW as a8,dW as a9,Ue as aA,Dq as aB,Lq as aC,Fq as aD,Uq as aE,$q as aF,Xx as aG,wu as aH,_u as aI,Nu as aJ,ju as aK,bu as aL,Eu as aM,Tu as aN,nt as aO,lq as aP,vq as aQ,uq as aR,fq as aS,hq as aT,mq as aU,pq as aV,gq as aW,xq as aX,dq as aY,Rn as aZ,_q as a_,uW as aa,fW as ab,hW as ac,pW as ad,mW as ae,OW as af,PW as ag,DW as ah,LW as ai,FW as aj,UW as ak,$W as al,Vq as am,BW as an,MW as ao,GW as ap,ma as aq,Iq as ar,Rq as as,kq as at,Pq as au,Mq as av,Su as aw,Rj as ax,Lh as ay,Oq as az,gt as b,ic as b0,rl as b1,wq as b2,An as b3,SN as b4,Nq as b5,yq as b6,Sq as b7,pu as b8,Eq as b9,zn as ba,Cq as bb,Tx as bc,Aq as bd,Tq as be,RW as bf,IW as bg,wx as bh,sb as bi,jq as bj,VW as bk,lt as c,ve as d,Mr as e,r1 as f,gc as g,ye as h,de as i,we as j,Le as k,He as l,Wq as m,zq as n,Yq as o,qq as p,Hq as q,Bq as r,he as s,Gq as t,vt as u,Kq as v,nW as w,pP as x,Zq as y,eW as z};
